<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.50" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://hanekawa.top/document/node-doc/Process.html"><meta property="og:site_name" content="hanekawa-shiki"><meta property="og:title" content="Process"><meta property="og:description" content="Process Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸æ‚¨åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ï¼Œè€Œä¸ä»…é™äºæµè§ˆå™¨ä¸­ã€‚process å¯¹è±¡æ˜¯ Node.js çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†ä¸€ç³»åˆ—ä¸å½“å‰ Node.js è¿›ç¨‹äº’åŠ¨çš„åŠŸèƒ½ã€‚è¿™äº›åŠŸèƒ½è®©æ‚¨èƒ½å¤Ÿè·å–ç¯å¢ƒä¿¡æ¯ã€æ§åˆ¶è¿›ç¨‹çš„è¡Œä¸ºã€ä¸æ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ç­‰ã€‚ ..."><meta property="og:type" content="website"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-06-21T09:46:17.000Z"><meta property="article:author" content="hanekawa-shiki"><meta property="article:modified_time" content="2024-06-21T09:46:17.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"Process","description":"Process Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸æ‚¨åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ï¼Œè€Œä¸ä»…é™äºæµè§ˆå™¨ä¸­ã€‚process å¯¹è±¡æ˜¯ Node.js çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†ä¸€ç³»åˆ—ä¸å½“å‰ Node.js è¿›ç¨‹äº’åŠ¨çš„åŠŸèƒ½ã€‚è¿™äº›åŠŸèƒ½è®©æ‚¨èƒ½å¤Ÿè·å–ç¯å¢ƒä¿¡æ¯ã€æ§åˆ¶è¿›ç¨‹çš„è¡Œä¸ºã€ä¸æ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ç­‰ã€‚ ..."}</script><meta name="keywords" content="JavaScript,HTML,CSS"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icons/chrome-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icons/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icons/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#5c92d1"><link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="white"><meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><title>Process | hanekawa-shiki</title><meta name="description" content="Process Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸æ‚¨åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ï¼Œè€Œä¸ä»…é™äºæµè§ˆå™¨ä¸­ã€‚process å¯¹è±¡æ˜¯ Node.js çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†ä¸€ç³»åˆ—ä¸å½“å‰ Node.js è¿›ç¨‹äº’åŠ¨çš„åŠŸèƒ½ã€‚è¿™äº›åŠŸèƒ½è®©æ‚¨èƒ½å¤Ÿè·å–ç¯å¢ƒä¿¡æ¯ã€æ§åˆ¶è¿›ç¨‹çš„è¡Œä¸ºã€ä¸æ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ç­‰ã€‚ ...">
    <link rel="stylesheet" href="/assets/css/styles.2fe8dfd0.css">
    <link rel="preload" href="/assets/js/runtime~app.b30e1963.js" as="script"><link rel="preload" href="/assets/css/styles.2fe8dfd0.css" as="style"><link rel="preload" href="/assets/js/9435.209d772b.js" as="script"><link rel="preload" href="/assets/js/app.e085f460.js" as="script">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo light" src="/assets/svg/logo.svg" alt><img class="vp-nav-logo dark" src="/assets/svg/logo.svg" alt><span class="vp-site-name hide-in-pad">hanekawa-shiki</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å­¦ä¹ ç¬”è®°"><!--[--><span class="font-icon icon framework" style=""></span>å­¦ä¹ ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">å‰ç«¯æ¡†æ¶</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/vue3/" aria-label="Vue3ç¬”è®°"><!--[--><span class="font-icon icon vue" style=""></span><!--]-->Vue3ç¬”è®°<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/framework_front/react/" aria-label="Reactç¬”è®°"><!--[--><span class="font-icon icon react" style=""></span><!--]-->Reactç¬”è®°<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æ–‡æ¡£"><!--[--><span class="font-icon icon framework" style=""></span>æ–‡æ¡£<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">æ¬è¿</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li></ul></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/hanekawa-shiki/hanekawa-shiki.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/" aria-label="Node.jsæ–‡æ¡£"><!--[--><span class="font-icon icon circle-info" style=""></span><!--]-->Node.jsæ–‡æ¡£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Assert.html" aria-label="Assert"><!---->Assert<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Async%20hooks.html" aria-label="Async hooks"><!---->Async hooks<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Asynchronous%20context%20tracking.html" aria-label="Asynchronous context tracking"><!---->Asynchronous context tracking<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Buffer.html" aria-label="Buffer"><!---->Buffer<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20addons.html" aria-label="C++ addons"><!---->C++ addons<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/C__%20embedder%20API.html" aria-label="C++ embedder API"><!---->C++ embedder API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Child%20process.html" aria-label="Child process"><!---->Child process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Cluster.html" aria-label="Cluster"><!---->Cluster<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Command-line%20API.html" aria-label="Command-line API"><!---->Command-line API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Console.html" aria-label="Console"><!---->Console<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Corepack.html" aria-label="Corepack"><!---->Corepack<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Crypto.html" aria-label="Crypto"><!---->Crypto<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Debugger.html" aria-label="Debugger"><!---->Debugger<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Deprecated%20APIs.html" aria-label="Deprecated APIs"><!---->Deprecated APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostic%20report.html" aria-label="Diagnostic report"><!---->Diagnostic report<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Diagnostics%20Channel.html" aria-label="Diagnostics Channel"><!---->Diagnostics Channel<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/DNS.html" aria-label="DNS"><!---->DNS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Domain.html" aria-label="Domain"><!---->Domain<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Errors.html" aria-label="Errors"><!---->Errors<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Events.html" aria-label="Events"><!---->Events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/File%20system.html" aria-label="File system"><!---->File system<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Global%20objects.html" aria-label="Global objects"><!---->Global objects<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTP.html" aria-label="HTTP"><!---->HTTP<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/HTTPS.html" aria-label="HTTPS"><!---->HTTPS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Inspector.html" aria-label="Inspector"><!---->Inspector<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Internationalization%20support.html" aria-label="Internationalization support"><!---->Internationalization support<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-CommonJS%20modules.html" aria-label="Modules: CommonJS modules"><!---->Modules: CommonJS modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-ECMAScript%20modules.html" aria-label="Modules: ECMAScript modules"><!---->Modules: ECMAScript modules<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-node_module%20API.html" aria-label="Modules: node:module API"><!---->Modules: node:module API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Modules-Packages.html" aria-label="Modules: Packages"><!---->Modules: Packages<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Net.html" aria-label="Net"><!---->Net<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Node-API.html" aria-label="Node-API"><!---->Node-API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/OS.html" aria-label="OS"><!---->OS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Path.html" aria-label="Path"><!---->Path<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Performance%20measurement%20APIs.html" aria-label="Performance measurement APIs"><!---->Performance measurement APIs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Permissions.html" aria-label="Permissions"><!---->Permissions<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/document/node-doc/Process.html" aria-label="Process"><!---->Process<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Punycode.html" aria-label="Punycode"><!---->Punycode<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Query%20string.html" aria-label="Query string"><!---->Query string<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Readline.html" aria-label="Readline"><!---->Readline<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/REPL.html" aria-label="REPL"><!---->REPL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Stream.html" aria-label="Stream"><!---->Stream<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/String%20decoder.html" aria-label="String decoder"><!---->String decoder<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Test%20runner.html" aria-label="Test runner"><!---->Test runner<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Timers.html" aria-label="Timers"><!---->Timers<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TLS%20(SSL).html" aria-label="TLS (SSL)"><!---->TLS (SSL)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Trace%20events.html" aria-label="Trace events"><!---->Trace events<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/TTY.html" aria-label="TTY"><!---->TTY<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/URL.html" aria-label="URL"><!---->URL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Util.html" aria-label="Util"><!---->Util<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/V8.html" aria-label="V8"><!---->V8<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/VM%20(executing%20JavaScript).html" aria-label="VM (executing JavaScript)"><!---->VM (executing JavaScript)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Crypto%20API.html" aria-label="Web Crypto API"><!---->Web Crypto API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Web%20Streams%20API.html" aria-label="Web Streams API"><!---->Web Streams API<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/WebAssembly%20System%20Interface%20(WASI).html" aria-label="WebAssembly System Interface (WASI)"><!---->WebAssembly System Interface (WASI)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Worker%20threads.html" aria-label="Worker threads"><!---->Worker threads<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/document/node-doc/Zlib.html" aria-label="Zlib"><!---->Zlib<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Process</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://hanekawa.top" target="_blank" rel="noopener noreferrer">hanekawa-shiki</a></span><span property="author" content="hanekawa-shiki"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-21T09:46:17.000Z"></span><!----><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 227 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT227M"></span><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 68248 å­—</span><meta property="wordCount" content="68248"></span><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-å¯¹è±¡çš„å…³é”®åº”ç”¨">process å¯¹è±¡çš„å…³é”®åº”ç”¨ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-events">Process events</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-exit">1. exit</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-uncaughtexception">2. uncaughtException</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-warning">3. warning</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-beforeexit">4. beforeExit</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-beforeexit">Event: &#39;beforeExit&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#beforeexit-äº‹ä»¶æ˜¯ä»€ä¹ˆ">beforeExit äº‹ä»¶æ˜¯ä»€ä¹ˆ?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#beforeexit-ä¸ä¼šåœ¨å“ªäº›æƒ…å†µä¸‹è§¦å‘">beforeExit ä¸ä¼šåœ¨å“ªäº›æƒ…å†µä¸‹è§¦å‘?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-disconnect">Event: &#39;disconnect&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¤šè¿›ç¨‹ç¼–ç¨‹ç®€ä»‹">å¤šè¿›ç¨‹ç¼–ç¨‹ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#child-process-æ¨¡å—">child_process æ¨¡å—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cluster-æ¨¡å—">cluster æ¨¡å—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-disconnect-1">Event: &#39;disconnect&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-exit">Event: &#39;exit&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯äº‹ä»¶">ä»€ä¹ˆæ˜¯äº‹ä»¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-çš„äº‹ä»¶å¾ªç¯æœºåˆ¶">Node.js çš„äº‹ä»¶å¾ªç¯æœºåˆ¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-exit-è¯¦è§£">Event: &#39;exit&#39;è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-message">Event: &#39;message&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-message-äº‹ä»¶">ä»€ä¹ˆæ˜¯&#39;message&#39;äº‹ä»¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•å·¥ä½œ">å¦‚ä½•å·¥ä½œï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-1">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-multipleresolves">Event: &#39;multipleResolves&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-multipleresolves-äº‹ä»¶">ä»€ä¹ˆæ˜¯ &#39;multipleResolves&#39; äº‹ä»¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ç›‘å¬-multipleresolves-äº‹ä»¶">å¦‚ä½•ç›‘å¬ &#39;multipleResolves&#39; äº‹ä»¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-1">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-rejectionhandled">Event: &#39;rejectionHandled&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-2">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š">è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-uncaughtexception">Event: &#39;uncaughtException&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#uncaughtexceptionäº‹ä»¶">uncaughtExceptionäº‹ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-uncaughtexception">ä»€ä¹ˆæ˜¯ uncaughtException?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-uncaughtexception-çš„ä¸€ä¸ªä¾‹å­">ä½¿ç”¨ uncaughtException çš„ä¸€ä¸ªä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-1">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-uncaughtexceptionmonitor">Event: &#39;uncaughtExceptionMonitor&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-1">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-2">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-unhandledrejection">Event: &#39;unhandledRejection&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#unhandledrejectionäº‹ä»¶æ¦‚è¿°">unhandledRejectionäº‹ä»¶æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆéœ€è¦å…³æ³¨è¿™ä¸ªäº‹ä»¶">ä¸ºä»€ä¹ˆéœ€è¦å…³æ³¨è¿™ä¸ªäº‹ä»¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-1">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-3">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-1">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-warning">Event: &#39;warning&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-process-å¯¹è±¡">ç†è§£ process å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-event-warning">ä»€ä¹ˆæ˜¯ Event: &#39;warning&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-2">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¸¾ä¾‹">å®é™…åº”ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-3">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è‡ªå®šä¹‰è­¦å‘Šçš„æ„ä¹‰">è‡ªå®šä¹‰è­¦å‘Šçš„æ„ä¹‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-ä¸­å‘å‡ºè‡ªå®šä¹‰è­¦å‘Šçš„æ–¹æ³•">Node.js ä¸­å‘å‡ºè‡ªå®šä¹‰è­¦å‘Šçš„æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ›´å¤šåº”ç”¨åœºæ™¯">æ›´å¤šåº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#node-js-warning-names-1">Node.js Warning Names</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-1">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¤„ç†è­¦å‘Š">å¤„ç†è­¦å‘Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-worker">Event: &#39;worker&#39;</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#èƒŒæ™¯çŸ¥è¯†">èƒŒæ™¯çŸ¥è¯†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#event-worker-è¯¦ç»†è¯´æ˜">Event: &#39;worker&#39; è¯¦ç»†è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-2">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#signal-events">Signal events</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯ä¿¡å·">ä»€ä¹ˆæ˜¯ä¿¡å·ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#signal-events-in-node-js">Signal Events in Node.js</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-1">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-4">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-abort">process.abort()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-abort-ç®€ä»‹">process.abort() ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-4">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-5">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-allowednodeenvironmentflags">process.allowedNodeEnvironmentFlags</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-allowednodeenvironmentflags-1">process.allowedNodeEnvironmentFlags</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-arch">process.arch</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¸¸è§çš„æ¶æ„å€¼">å¸¸è§çš„æ¶æ„å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨process-arch">å¦‚ä½•ä½¿ç”¨process.arch</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-6">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-6">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-argv">process.argv</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-7">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-argv0">process.argv0</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-process-argv0">ä»€ä¹ˆæ˜¯ process.argv0ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-argv-vs-process-argv0">process.argv vs process.argv0</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-channel">process.channel</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-channel-1">process.channel</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-3">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-channel-ref">process.channel.ref()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ipc-å’Œprocess-channel">IPC å’Œprocess.channel</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-channel-ref-1">process.channel.ref()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-2">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-channel-unref">process.channel.unref()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-channel-unref-1">process.channel.unref()</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-chdir-directory">process.chdir(directory)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯å·¥ä½œç›®å½•">ä»€ä¹ˆæ˜¯å·¥ä½œç›®å½•ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-chdir-directory-çš„ä½œç”¨">process.chdir(directory)çš„ä½œç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨å®ä¾‹">ä½¿ç”¨å®ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-2">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-config">process.config</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-process-config">ä»€ä¹ˆæ˜¯ process.config</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-process-config">å¦‚ä½•ä½¿ç”¨ process.config</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-7">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-connected">process.connected</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯-1">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-8">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-constrainedmemory">process.constrainedMemory()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-2">å®é™…ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-cpuusage-previousvalue">process.cpuUsage([previousValue])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š">å‚æ•°è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-4">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-10">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-cwd">process.cwd()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-process-cwd">ä»€ä¹ˆæ˜¯ process.cwd()ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆ-process-cwd-é‡è¦">ä¸ºä»€ä¹ˆ process.cwd() é‡è¦ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-3">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-debugport">process.debugPort</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-process-debugport">è§£é‡Š process.debugPort</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-5">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-11">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-disconnect">process.disconnect()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿›ç¨‹é—´é€šä¿¡-ipc">è¿›ç¨‹é—´é€šä¿¡ (IPC)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½•æ—¶ä½¿ç”¨-process-disconnect">ä½•æ—¶ä½¿ç”¨ process.disconnect()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-8">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-2">ç»“è®º</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-dlopen-module-filename-flags">process.dlopen(module, filename[, flags])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è§£é‡Š-1">å‚æ•°è§£é‡Šï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-3">å¦‚ä½•ä½¿ç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-3">æ³¨æ„äº‹é¡¹ï¼š</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-emitwarning-warning-options">process.emitWarning(warning[, options])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-å¯¹è±¡">Process å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è­¦å‘Šç³»ç»Ÿ">è­¦å‘Šç³»ç»Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-emitwarning-warning-options-1">process.emitWarning(warning[, options])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯-2">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-emitwarning-warning-type-code-ctor">process.emitWarning(warning[, type[, code]][, ctor])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£æå‡½æ•°å‚æ•°">è§£æå‡½æ•°å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯åŠä¾‹å­">ä½¿ç”¨åœºæ™¯åŠä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-12">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#avoiding-duplicate-warnings">Avoiding duplicate warnings</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ç°åŸç†">å®ç°åŸç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-4">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-env">process.env</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-env-ç®€ä»‹">process.env ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-process-env-çš„ä¾‹å­">ä½¿ç”¨ process.env çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-13">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-execargv">process.execArgv</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-14">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-execpath">process.execPath</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-process-execpath">ä»€ä¹ˆæ˜¯ process.execPath?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-1">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-15">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-exit-code">process.exit([code])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-process-exit-code">è§£é‡Š process.exit([code])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-6">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-4">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-exitcode">process.exitCode</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-process-exitcode">ä»€ä¹ˆæ˜¯ process.exitCodeï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è®¾ç½®-process-exitcode">è®¾ç½® process.exitCode</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯-1">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-5">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-getactiveresourcesinfo">process.getActiveResourcesInfo()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯process-getactiveresourcesinfo">ä»€ä¹ˆæ˜¯process.getActiveResourcesInfo()ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›çš„ä¿¡æ¯åŒ…æ‹¬">è¿”å›çš„ä¿¡æ¯åŒ…æ‹¬ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-1">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-16">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-getegid">process.getegid()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-getegid-æ–¹æ³•">process.getegid()æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹ä»£ç -2">ç¤ºä¾‹ä»£ç </a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-geteuid">process.geteuid()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯-2">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-1">ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-getgid">process.getgid()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-1">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹-2">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-17">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-getgroups">process.getgroups()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-getgroups-æ–¹æ³•">process.getgroups() æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨å®ƒ">å¦‚ä½•ä½¿ç”¨å®ƒï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-6">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-getuid">process.getuid()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-getuid-1">process.getuid()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„">æ³¨æ„</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-7">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-hasuncaughtexceptioncapturecallback">process.hasUncaughtExceptionCaptureCallback()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-uncaught-exception">ä»€ä¹ˆæ˜¯ Uncaught Exceptionï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¼‚å¸¸æ•è·">å¼‚å¸¸æ•è·</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹-1">ä½¿ç”¨ç¤ºä¾‹ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨åœºæ™¯">å®é™…è¿ç”¨åœºæ™¯</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-hrtime-time">process.hrtime([time])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-1">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯ä¸ä¾‹å­">ä½¿ç”¨åœºæ™¯ä¸ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-3">ç»“è®º</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-hrtime-bigint">process.hrtime.bigint()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-hrtime-bigint-1">process.hrtime.bigint()</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-initgroups-user-extragroup">process.initgroups(user, extraGroup)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-initgroups-user-extragroup-1">process.initgroups(user, extraGroup)</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-kill-pid-signal">process.kill(pid[, signal])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-2">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-7">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-loadenvfile-path">process.loadEnvFile(path)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-2">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç”¨æ³•">ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-8">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-4">ç»“è®º</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-mainmodule">process.mainModule</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯æ¨¡å—">ä»€ä¹ˆæ˜¯æ¨¡å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-mainmodule-çš„å®šä¹‰">process.mainModule çš„å®šä¹‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-3">å®é™…ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯-3">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-memoryusage">process.memoryUsage()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-process-memoryusage">ä»€ä¹ˆæ˜¯ process.memoryUsage()ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-1">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ä¾‹å­-1">ä½¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-18">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-memoryusage-rss">process.memoryUsage.rss()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-2">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-memoryusage-rss-è§£é‡Š">process.memoryUsage.rss() è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-9">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-nexttick-callback-args">process.nextTick(callback[, ...args])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-process-nexttick">ç†è§£ process.nextTick()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹">ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-19">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#when-to-use-queuemicrotask-vs-process-nexttick">When to use queueMicrotask() vs. process.nextTick()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-process-nexttick">1. process.nextTick()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-queuemicrotask">2. queueMicrotask()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¯”è¾ƒä¸é€‰æ‹©">æ¯”è¾ƒä¸é€‰æ‹©</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-nodeprecation">process.noDeprecation</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç®€å•è§£é‡Š">ç®€å•è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯-4">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-20">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-permission">process.permission</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-æ”¹å˜è¿›ç¨‹çš„ç”¨æˆ·å’Œç»„æ ‡è¯†">1. æ”¹å˜è¿›ç¨‹çš„ç”¨æˆ·å’Œç»„æ ‡è¯†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-æŸ¥è¯¢è¿›ç¨‹æƒé™">2. æŸ¥è¯¢è¿›ç¨‹æƒé™</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæƒé™">3. ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæƒé™</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-permission-has-scope-reference">process.permission.has(scope[, reference])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-3">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-3">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“">å°ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-pid">process.pid</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-pid-1">process.pid</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-platform">process.platform</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-platform-å¯èƒ½çš„å€¼">process.platform å¯èƒ½çš„å€¼ï¼š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-4">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-ppid">process.ppid</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-process-ppid">ä»€ä¹ˆæ˜¯ process.ppidï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆ-process-ppid-é‡è¦">ä¸ºä»€ä¹ˆ process.ppid é‡è¦ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-10">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-process-ppid">å¦‚ä½•ä½¿ç”¨ process.ppidï¼Ÿ</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-release">process.release</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-11">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-report">process.report</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š">1. ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-åœ¨å¼‚å¸¸é€€å‡ºæ—¶è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Š">2. åœ¨å¼‚å¸¸é€€å‡ºæ—¶è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-è§¦å‘æ¡ä»¶ä¸‹ç”ŸæˆæŠ¥å‘Š">3. è§¦å‘æ¡ä»¶ä¸‹ç”ŸæˆæŠ¥å‘Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-21">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-report-compact">process.report.compact</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯è¯Šæ–­æŠ¥å‘Š">ä»€ä¹ˆæ˜¯è¯Šæ–­æŠ¥å‘Šï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨process-report-compact">å¦‚ä½•ä½¿ç”¨process.report.compact</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-10">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä½•é€‰æ‹©ç´§å‡‘æ ¼å¼">ä¸ºä½•é€‰æ‹©ç´§å‡‘æ ¼å¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-report-directory">process.report.directory</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£process-report-directory">ç†è§£process.report.directory</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-4">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ç¤ºä¾‹-5">å®é™…åº”ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-report-filename">process.report.filename</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-report-filename-1">process.report.filename</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-5">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-12">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-report-getreport-err">process.report.getReport([err])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-process-report-getreport-err">ä»€ä¹ˆæ˜¯ process.report.getReport([err])ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-6">å¦‚ä½•ä½¿ç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-2">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-8">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-report-reportonfatalerror">process.report.reportOnFatalError</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯process-report-reportonfatalerror">ä»€ä¹ˆæ˜¯process.report.reportOnFatalErrorï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨process-report-reportonfatalerror">å¦‚ä½•ä½¿ç”¨process.report.reportOnFatalErrorï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„ç‚¹">æ³¨æ„ç‚¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-report-reportonsignal">process.report.reportOnSignal</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-11">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-report-reportonuncaughtexception">process.report.reportOnUncaughtException</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-7">å¦‚ä½•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ä¾‹åº”ç”¨">å®ä¾‹åº”ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹ä»£ç -3">ç¤ºä¾‹ä»£ç </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-report-signal">process.report.signal</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-process-report-signal">ä»€ä¹ˆæ˜¯ process.report.signal?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯-5">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-8">å¦‚ä½•ä½¿ç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-13">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-report-writereport-filename-err">process.report.writeReport([filename][, err])</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨æ–¹æ³•-1">ä½¿ç”¨æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-14">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-resourceusage">process.resourceUsage()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-process-resourceusage">ä»€ä¹ˆæ˜¯ process.resourceUsage()ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¿”å›å€¼-2">è¿”å›å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-15">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-send-message-sendhandle-options-callback">process.send(message[, sendHandle[, options]][, callback])</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-send-æ¦‚è¿°">process.send(): æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è¯´æ˜">å‚æ•°è¯´æ˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ç”¨æ³•ç¤ºä¾‹">å®é™…ç”¨æ³•ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-setegid-id">process.setegid(id)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-1">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-setegid-id-1">process.setegid(id)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯ç¤ºä¾‹">ä½¿ç”¨åœºæ™¯ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-23">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-seteuid-id">process.seteuid(id)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆè¦æ›´æ”¹æœ‰æ•ˆç”¨æˆ·-id">ä¸ºä»€ä¹ˆè¦æ›´æ”¹æœ‰æ•ˆç”¨æˆ· ID?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…ä¾‹å­-4">å®é™…ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-setgid-id">process.setgid(id)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨ç¤ºä¾‹-2">ä½¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-9">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-setgroups-groups">process.setgroups(groups)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹-1">ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„ç‚¹-1">æ³¨æ„ç‚¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹ä»£ç -4">ç¤ºä¾‹ä»£ç </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-5">ç»“è®º</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-setuid-id">process.setuid(id)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-uid">ä»€ä¹ˆæ˜¯ UIDï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆéœ€è¦æ›´æ”¹-uid">ä¸ºä»€ä¹ˆéœ€è¦æ›´æ”¹ UIDï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-process-setuid-id">ä½¿ç”¨ process.setuid(id)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯-6">ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-10">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-setsourcemapsenabled-val">process.setSourceMapsEnabled(val)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-16">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-setuncaughtexceptioncapturecallback-fn">process.setUncaughtExceptionCaptureCallback(fn)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-3">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°-1">å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-12">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-11">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-sourcemapsenabled">process.sourceMapsEnabled</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-5">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-stderr">process.stderr</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-4">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-stderr">ç†è§£ stderr</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-3">å®é™…è¿ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“-24">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-stderr-fd">process.stderr.fd</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-2">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-stderr-fd-1">process.stderr.fd</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-13">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-stdin">process.stdin</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-stdin-1">process.stdin</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-1">å®é™…åº”ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-1">å°ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-stdin-fd">process.stdin.fd</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£æ ‡å‡†è¾“å…¥-stdin">ç†è§£æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹">ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-stdout">process.stdout</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ¦‚å¿µ-5">åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆéœ€è¦process-stdout">ä¸ºä»€ä¹ˆéœ€è¦process.stdout?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨process-stdout">å¦‚ä½•ä½¿ç”¨process.stdout?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨åœºæ™¯-3">å®é™…åº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-stdout-fd">process.stdout.fd</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯process-stdout-fd">ä»€ä¹ˆæ˜¯process.stdout.fd?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-2">å®é™…åº”ç”¨ä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-6">ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#a-note-on-process-i-o">A note on process I/O</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆ-process-i-o-é‡è¦">ä¸ºä»€ä¹ˆ process I/O é‡è¦ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-14">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-2">å°ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-throwdeprecation">process.throwDeprecation</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-process-throwdeprecation">ä»€ä¹ˆæ˜¯ process.throwDeprecation?</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-9">å¦‚ä½•ä½¿ç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-17">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-title">process.title</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-process-title">ä»€ä¹ˆæ˜¯ process.titleï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-15">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-7">ç»“è®º</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-tracedeprecation">process.traceDeprecation</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-process-tracedeprecation">å¦‚ä½•ä½¿ç”¨ process.traceDeprecation</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-4">å®é™…è¿ç”¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-umask">process.umask()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨process-umask">å¦‚ä½•ä½¿ç”¨process.umask()</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ç¤ºä¾‹-16">å®é™…è¿ç”¨ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ³¨æ„äº‹é¡¹-12">æ³¨æ„äº‹é¡¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-umask-mask">process.umask(mask)</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºç¡€æ¦‚å¿µ-3">åŸºç¡€æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#process-umask-mask-1">process.umask(mask)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…åº”ç”¨ä¾‹å­-6">å®é™…åº”ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»“è®º-8">ç»“è®º</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-uptime">process.uptime()</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯-process-uptime">ä»€ä¹ˆæ˜¯ process.uptime()ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¦‚ä½•ä½¿ç”¨-process-uptime">å¦‚ä½•ä½¿ç”¨ process.uptime()ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨ä¾‹å­-18">å®é™…è¿ç”¨ä¾‹å­</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°ç»“-3">å°ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-version">process.version</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç†è§£-process-version">ç†è§£ process.version</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨-5">å®é™…è¿ç”¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#process-versions">process.versions</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£é‡Š-4">è§£é‡Š</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-5">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#exit-codes">Exit codes</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¸¸è§çš„é€€å‡ºä»£ç ">å¸¸è§çš„é€€å‡ºä»£ç </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®é™…è¿ç”¨çš„ä¾‹å­-6">å®é™…è¿ç”¨çš„ä¾‹å­</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="process" tabindex="-1"><a class="header-anchor" href="#process"><span><a href="https://nodejs.org/docs/latest/api/process.html#process" target="_blank" rel="noopener noreferrer">Process</a></span></a></h1><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒã€‚å®ƒå…è®¸æ‚¨åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ï¼Œè€Œä¸ä»…é™äºæµè§ˆå™¨ä¸­ã€‚<code>process</code> å¯¹è±¡æ˜¯ Node.js çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†ä¸€ç³»åˆ—ä¸å½“å‰ Node.js è¿›ç¨‹äº’åŠ¨çš„åŠŸèƒ½ã€‚è¿™äº›åŠŸèƒ½è®©æ‚¨èƒ½å¤Ÿè·å–ç¯å¢ƒä¿¡æ¯ã€æ§åˆ¶è¿›ç¨‹çš„è¡Œä¸ºã€ä¸æ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ç­‰ã€‚</p><h3 id="process-å¯¹è±¡çš„å…³é”®åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#process-å¯¹è±¡çš„å…³é”®åº”ç”¨"><span><code>process</code> å¯¹è±¡çš„å…³é”®åº”ç”¨ï¼š</span></a></h3><ol><li><p><strong>ç¯å¢ƒä¿¡æ¯</strong>:</p><ul><li><code>process.env</code>: ä¸€ä¸ªåŒ…å«ç”¨æˆ·ç¯å¢ƒçš„å¯¹è±¡ï¼Œå¯ä»¥è¢«ç”¨æ¥è·å–ç¯å¢ƒå˜é‡ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³æ ¹æ®ä¸åŒçš„ç¯å¢ƒå˜é‡å¯åŠ¨åº”ç”¨ç¨‹åºçš„ä¸åŒæ¨¡å¼ï¼ˆå¼€å‘æ¨¡å¼ã€ç”Ÿäº§æ¨¡å¼ï¼‰ã€‚</li></ul><p><strong>ç¤ºä¾‹</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">NODE_ENV</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;development&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Running in development mode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Running in production mode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ç¨‹åºé€€å‡º</strong>:</p><ul><li><code>process.exit()</code>: å¯ä»¥ç”¨æ¥ç«‹å³ç»ˆæ­¢ Node.js è¿›ç¨‹ã€‚ä½ å¯èƒ½ä¼šåœ¨å‘ç°ä¸¥é‡é”™è¯¯æ—¶ä½¿ç”¨å®ƒæ¥åœæ­¢ç¨‹åºçš„æ‰§è¡Œã€‚</li></ul><p><strong>ç¤ºä¾‹</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">someSeriousErrorOccurred</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éé›¶å€¼é€šå¸¸è¡¨ç¤ºæœ‰é”™è¯¯å‘ç”Ÿ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>å‘½ä»¤è¡Œå‚æ•°ç®¡ç†</strong>:</p><ul><li><code>process.argv</code>: ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å½“å¯åŠ¨ Node.js è¿›ç¨‹æ—¶ä¼ å…¥çš„å‘½ä»¤è¡Œå‚æ•°ã€‚è¿™å¯¹äºåˆ›å»ºæ¥å—å¤–éƒ¨è¾“å…¥çš„å‘½ä»¤è¡Œå·¥å…·ç‰¹åˆ«æœ‰ç”¨ã€‚</li></ul><p><strong>ç¤ºä¾‹</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> args</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">argv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å»é™¤å‰ä¸¤ä¸ªé»˜è®¤å‚æ•°ï¼ˆnodeè·¯å¾„å’Œè„šæœ¬æ–‡ä»¶è·¯å¾„ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Passed arguments:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ€§èƒ½ç›‘æµ‹</strong>:</p><ul><li><code>process.memoryUsage()</code>: è¿”å› Node.js è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨æƒ…å†µçš„å¯¹è±¡ï¼ŒåŒ…æ‹¬æ€»å†…å­˜ä½¿ç”¨é‡ã€å †å†…å­˜ä½¿ç”¨é‡ç­‰ã€‚é€‚ç”¨äºç›‘æ§åº”ç”¨æ€§èƒ½æˆ–è°ƒè¯•å†…å­˜æ³„æ¼ã€‚</li></ul><p><strong>ç¤ºä¾‹</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> memoryUsage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">memoryUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Heap Total: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">memoryUsage</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">heapTotal</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Heap Used: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">memoryUsage</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">heapUsed</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>å¤„ç†æœªæ•è·çš„å¼‚å¸¸</strong>:</p><ul><li><code>process.on(&#39;uncaughtException&#39;, handler)</code>: å…è®¸ä½ ç›‘å¬æœªæ•è·çš„å¼‚å¸¸ï¼Œé¿å…ç¨‹åºç›´æ¥å´©æºƒã€‚è¿™ç»™ä½ ä¸€ä¸ªè®°å½•é”™è¯¯ã€è¿›è¡Œæ¸…ç†æˆ–è€…ä¼˜é›…å…³é—­åº”ç”¨ç¨‹åºçš„æœºä¼šã€‚</li></ul><p><strong>ç¤ºä¾‹</strong>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;uncaughtException&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Unhandled exception:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é€šå¸¸åœ¨å¤„ç†å®Œæˆåç»“æŸè¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  //ï¼ˆä¸é”™è¿™æœ¬ä»½æ–‡æ¡£çš„ä½œè€…æ˜¯ï¼šCherryChat doc.cherrychat.orgï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>è¿™äº›åªæ˜¯ <code>process</code> å¯¹è±¡æä¾›çš„ä¼—å¤šåŠŸèƒ½ä¸­çš„å‡ ä¸ªä¾‹å­ã€‚é€šè¿‡ä½¿ç”¨ <code>process</code> å¯¹è±¡ï¼Œå¼€å‘äººå‘˜å¯ä»¥æ›´å¥½åœ°æ§åˆ¶ Node.js åº”ç”¨ç¨‹åºçš„è¡Œä¸ºå’Œäº¤äº‘ç¯å¢ƒäº’åŠ¨ã€‚</p><h2 id="process-events" tabindex="-1"><a class="header-anchor" href="#process-events"><span><a href="https://nodejs.org/docs/latest/api/process.html#process-events" target="_blank" rel="noopener noreferrer">Process events</a></span></a></h2><p>Node.js ä¸­çš„è¿‡ç¨‹ï¼ˆprocessï¼‰æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†ä¸å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹äº’åŠ¨çš„æ¥å£ã€‚å®ƒå¯ä»¥ç”¨äºæ”¶é›†ä¿¡æ¯å…³äºé‚£ä¸ªè¿›ç¨‹ï¼Œæˆ–è€…æ§åˆ¶é‚£ä¸ªè¿›ç¨‹ã€‚åœ¨ Node.js çš„ç¯å¢ƒä¸­ï¼Œæ¯å½“ä½ è¿è¡Œä¸€ä¸ªè„šæœ¬æ—¶ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ª Process å®ä¾‹ã€‚</p><p>åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­æåˆ°çš„â€œProcess eventsâ€æŒ‡çš„æ˜¯ process å¯¹è±¡å¯ä»¥è§¦å‘çš„å„ç§äº‹ä»¶ã€‚è¿™äº›äº‹ä»¶åæ˜ äº† Node.js è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¸­çš„ä¸åŒé˜¶æ®µå’ŒçŠ¶æ€å˜åŒ–ã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªå¸¸è§çš„ process äº‹ä»¶åŠå…¶åº”ç”¨ç¤ºä¾‹ï¼š</p><h3 id="_1-exit" tabindex="-1"><a class="header-anchor" href="#_1-exit"><span>1. <code>exit</code></span></a></h3><p>å½“ Node.js è¿›ç¨‹å³å°†ç»“æŸæ—¶ï¼Œä¼šè§¦å‘è¯¥äº‹ä»¶ã€‚è¿™ç»™äº†ä½ ä¸€ä¸ªæ‰§è¡Œæ¸…ç†æ“ä½œçš„æœºä¼šï¼Œæ¯”å¦‚å…³é—­æ•°æ®åº“è¿æ¥ã€å†™å…¥æ—¥å¿—ç­‰ï¼Œä½†è¯·æ³¨æ„ï¼Œæ­¤æ—¶åªèƒ½è¿›è¡ŒåŒæ­¥æ“ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;exit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`About to exit with code: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">code</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœç¨‹åºæ­£å¸¸ç»“æŸï¼Œ<code>code</code> é€šå¸¸æ˜¯ <code>0</code>ï¼›å¦åˆ™ï¼Œå¯èƒ½æ˜¯æŸä¸ªé”™è¯¯ç ã€‚</p><h3 id="_2-uncaughtexception" tabindex="-1"><a class="header-anchor" href="#_2-uncaughtexception"><span>2. <code>uncaughtException</code></span></a></h3><p>å½“ä¸€ä¸ªæœªæ•è·çš„å¼‚å¸¸å†’æ³¡å›äº‹ä»¶å¾ªç¯æ—¶ï¼Œä¼šè§¦å‘æ­¤äº‹ä»¶ã€‚è¿™æ˜¯ä¸€ä¸ªå¯¹æœªé¢„æ–™åˆ°çš„é”™è¯¯è¿›è¡Œæœ€åå¤„ç†çš„æœºä¼šã€‚å»ºè®®è®°å½•é”™è¯¯è¯¦æƒ…å¹¶ç»“æŸè¿›ç¨‹ï¼Œå› ä¸ºç¨‹åºå¯èƒ½å¤„äºä¸ç¡®å®šçš„çŠ¶æ€ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;uncaughtException&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æœªæ•è·çš„å¼‚å¸¸:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨èé€€å‡ºè¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-warning" tabindex="-1"><a class="header-anchor" href="#_3-warning"><span>3. <code>warning</code></span></a></h3><p>Node.js è¿›ç¨‹ä¸­äº§ç”Ÿçš„è­¦å‘Šï¼ˆä¾‹å¦‚ä½¿ç”¨åºŸå¼ƒçš„ APIï¼‰ä¼šè§¦å‘æ­¤äº‹ä»¶ã€‚è¿™å¯¹äºå¼€å‘æœŸé—´è¯†åˆ«æ½œåœ¨é—®é¢˜å¾ˆæœ‰å¸®åŠ©ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;warning&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">warning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">warn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è­¦å‘Š:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">warning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è­¦å‘Šåç§°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">warn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è­¦å‘Šä¿¡æ¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">warning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è­¦å‘Šæ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">warn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å †æ ˆ:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">warning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">stack</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å †æ ˆä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-beforeexit" tabindex="-1"><a class="header-anchor" href="#_4-beforeexit"><span>4. <code>beforeExit</code></span></a></h3><p>å½“ Node.js æ¸…ç©ºäº†å…¶äº‹ä»¶å¾ªç¯å¹¶ä¸”æ²¡æœ‰å…¶ä»–å·¥ä½œè¦å®‰æ’æ—¶ï¼Œä¼šè§¦å‘ <code>beforeExit</code> äº‹ä»¶ã€‚è¿™ä¸ <code>exit</code> äº‹ä»¶ä¸åŒï¼Œå› ä¸ºå¼‚æ­¥æ“ä½œä»ç„¶å¯ä»¥é˜»æ­¢ Node.js è¿›ç¨‹é€€å‡ºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;beforeExit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Process beforeExit event with code: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">code</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªäº‹ä»¶ä¸»è¦ç”¨äºå®‰æ’é¢å¤–çš„å·¥ä½œï¼Œä½†å¦‚æœä¸æ·»åŠ æ–°çš„å¼‚æ­¥ä»»åŠ¡ï¼Œè¿›ç¨‹å°†ç»“æŸã€‚</p><p>é€šè¿‡ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œä½ å¯ä»¥æ›´å¥½åœ°æŒæ¡å’Œç®¡ç†ä½ çš„ Node.js åº”ç”¨çš„è¿è¡Œå’Œç”Ÿå‘½å‘¨æœŸã€‚æ¯ä¸ªäº‹ä»¶éƒ½æä¾›äº†ç‰¹å®šåœºæ™¯ä¸‹å¤„ç†é—®é¢˜å’Œèµ„æºçš„æœºä¼šï¼Œä»è€Œä½¿ä½ çš„åº”ç”¨æ›´åŠ å¥å£®å’Œå¯é ã€‚</p><h3 id="event-beforeexit" tabindex="-1"><a class="header-anchor" href="#event-beforeexit"><span><a href="https://nodejs.org/docs/latest/api/process.html#event-beforeexit" target="_blank" rel="noopener noreferrer">Event: &#39;beforeExit&#39;</a></span></a></h3><p>å½“ä½ åœ¨å­¦ä¹  Node.js çš„æ—¶å€™ï¼Œç†è§£ä¸åŒçš„äº‹ä»¶å’Œå®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„éå¸¸é‡è¦ã€‚<code>beforeExit</code> äº‹ä»¶å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œå®ƒç›´æ¥å…³ç³»åˆ° Node.js åº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚</p><h3 id="beforeexit-äº‹ä»¶æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#beforeexit-äº‹ä»¶æ˜¯ä»€ä¹ˆ"><span><code>beforeExit</code> äº‹ä»¶æ˜¯ä»€ä¹ˆ?</span></a></h3><p>ç®€å•æ¥è¯´ï¼Œ<code>beforeExit</code> äº‹ä»¶åœ¨ Node.js è¿›ç¨‹å³å°†ç»“æŸæ—¶è§¦å‘ã€‚ä½†è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œâ€œå³å°†ç»“æŸâ€å¹¶ä¸æ„å‘³ç€è¿›ç¨‹æ­£åœ¨è¢«æ“ä½œç³»ç»Ÿå¼ºåˆ¶é€€å‡ºï¼Œæ¯”å¦‚é€šè¿‡ç»ˆæ­¢å‘½ä»¤æˆ–è€…å› ä¸ºé‡åˆ°æœªæ•è·çš„å¼‚å¸¸ã€‚å®é™…ä¸Šï¼Œ<code>beforeExit</code> æ˜¯åœ¨ Node.js çš„äº‹ä»¶å¾ªç¯é˜Ÿåˆ—ä¸­æ²¡æœ‰å…¶ä»–å·¥ä½œè¦åšæ—¶è§¦å‘ï¼Œç»™äº†ä½ ä¸€ä¸ªâ€œæœ€åçš„æœºä¼šâ€å»æ‰§è¡Œä¸€äº›æ¸…ç†å·¥ä½œï¼Œæ¯”å¦‚å…³é—­æ•°æ®åº“è¿æ¥ã€å†™æ—¥å¿—ç­‰ã€‚</p><h3 id="beforeexit-ä¸ä¼šåœ¨å“ªäº›æƒ…å†µä¸‹è§¦å‘" tabindex="-1"><a class="header-anchor" href="#beforeexit-ä¸ä¼šåœ¨å“ªäº›æƒ…å†µä¸‹è§¦å‘"><span><code>beforeExit</code> ä¸ä¼šåœ¨å“ªäº›æƒ…å†µä¸‹è§¦å‘?</span></a></h3><ul><li>å½“ Node.js è¿›ç¨‹é€šè¿‡ <code>process.exit()</code> ç›´æ¥ç»ˆæ­¢æ—¶ã€‚</li><li>å½“ Node.js è¿›ç¨‹ç”±äºæ¥æ”¶åˆ° SIGINT ç­‰ä¿¡å·è€Œé€€å‡ºæ—¶ã€‚</li><li>å¦‚æœå­˜åœ¨è‡³å°‘ä¸€ä¸ªæœªå®Œæˆçš„ <code>setImmediate</code> æˆ–å®šæ—¶å™¨ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœäº‹ä»¶å¾ªç¯ä¸­è¿˜æœ‰å¾…å¤„ç†çš„ä»»åŠ¡ï¼Œ<code>beforeExit</code> ä¸ä¼šè§¦å‘ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-æ—¥å¿—è®°å½•ä¸æ¸…ç†ä»»åŠ¡" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ—¥å¿—è®°å½•ä¸æ¸…ç†ä»»åŠ¡"><span>ç¤ºä¾‹ 1: æ—¥å¿—è®°å½•ä¸æ¸…ç†ä»»åŠ¡</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;beforeExit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿›ç¨‹ beforeExit äº‹ä»¶çš„é€€å‡ºç : &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾ä½ åœ¨è¿™é‡Œæ‰§è¡Œä¸€äº›æ¸…ç†ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¯”å¦‚å…³é—­æ•°æ®åº“è¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ­¤æ¶ˆæ¯æœ€å…ˆæ˜¾ç¤º&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ­¤æ—¶æ²¡æœ‰å…¶ä»–è®¡åˆ’ä»»åŠ¡ï¼ŒNode.js è¿›ç¨‹å°†å°è¯•é€€å‡ºï¼Œè§¦å‘ beforeExit äº‹ä»¶</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“äº‹ä»¶å¾ªç¯ä¸­æ²¡æœ‰å…¶ä»–ä»»åŠ¡æ—¶ï¼Œ<code>beforeExit</code> äº‹ä»¶è¢«è§¦å‘ï¼Œå…è®¸ä½ æ‰§è¡Œä¸€äº›ä»£ç ï¼ˆä¾‹å¦‚æ—¥å¿—è®°å½•æˆ–æ‰§è¡Œæ¸…ç†ä»»åŠ¡ï¼‰ã€‚</p><h4 id="ç¤ºä¾‹-2-é˜»æ­¢-node-js-è¿›ç¨‹ç«‹å³é€€å‡º" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-é˜»æ­¢-node-js-è¿›ç¨‹ç«‹å³é€€å‡º"><span>ç¤ºä¾‹ 2: é˜»æ­¢ Node.js è¿›ç¨‹ç«‹å³é€€å‡º</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;beforeExit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¿›ç¨‹ä»¥ä»£ç  </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">code</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> é€€å‡ºå‰ï¼Œæˆ‘æƒ³å†åšä¸€äº›äº‹ã€‚`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™éƒ¨åˆ†ä»£ç ç¨åæ‰§è¡Œ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ­¤æ¶ˆæ¯æœ€å…ˆæ˜¾ç¤º&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°½ç®¡æœ‰å»¶è¿Ÿä»»åŠ¡ï¼Œä½†ç”±äºå®ƒä»¬æ˜¯å¼‚æ­¥çš„ï¼ŒbeforeExit ä¾ç„¶ä¼šè§¦å‘</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³ä½¿æˆ‘ä»¬ä½¿ç”¨ <code>setTimeout</code> æ·»åŠ äº†ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œ<code>beforeExit</code> äº‹ä»¶ä¾ç„¶ä¼šè¢«è§¦å‘ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶ <code>beforeExit</code> å…è®¸ä½ æ‰§è¡Œä¸€äº›é¢å¤–çš„ä»»åŠ¡ï¼Œä½†å®ƒä¸ä¼šæ— é™æœŸåœ°é˜»æ­¢è¿›ç¨‹é€€å‡ºï¼Œé™¤éä½ æ·»åŠ æ›´å¤šçš„å¼‚æ­¥ä»»åŠ¡ï¼ˆå¦‚æ–°çš„å®šæ—¶å™¨ã€I/O æ“ä½œç­‰ï¼‰ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>beforeExit</code> äº‹ä»¶ä¸ºä½ æä¾›äº†ä¸€ä¸ªåœ¨ Node.js è¿›ç¨‹å‡†å¤‡é€€å‡ºæ—¶æ‰§è¡Œä»£ç çš„æœºä¼šï¼Œéå¸¸é€‚åˆç”¨æ¥è¿›è¡Œä¸€äº›æ¸…ç†å·¥ä½œæˆ–èµ„æºé‡Šæ”¾ã€‚ç†è§£è¿™ä¸ªäº‹ä»¶å¦‚ä½•å·¥ä½œï¼Œèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°æ§åˆ¶ä½ çš„ Node.js åº”ç”¨ç¨‹åºçš„è¡Œä¸ºå’Œç”Ÿå‘½å‘¨æœŸã€‚</p><h3 id="event-disconnect" tabindex="-1"><a class="header-anchor" href="#event-disconnect"><span><a href="https://nodejs.org/docs/latest/api/process.html#event-disconnect" target="_blank" rel="noopener noreferrer">Event: &#39;disconnect&#39;</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>&#39;disconnect&#39;</code>äº‹ä»¶æ˜¯ä¸€ä¸ªç‰¹åˆ«çš„äº‹ä»¶ï¼Œé€šå¸¸ä¸å¤šè¿›ç¨‹ç¼–ç¨‹æœ‰å…³ã€‚ä¸ºäº†è®©ä½ æ›´å¥½åœ°ç†è§£ï¼Œæˆ‘ä¼šå…ˆä»‹ç»ä¸€ä¸‹åŸºç¡€æ¦‚å¿µï¼Œç„¶åå†è¯¦ç»†è§£é‡Šè¿™ä¸ªäº‹ä»¶ï¼Œå¹¶æä¾›ä¸€äº›å®é™…åº”ç”¨çš„ä¾‹å­ã€‚</p><h3 id="å¤šè¿›ç¨‹ç¼–ç¨‹ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#å¤šè¿›ç¨‹ç¼–ç¨‹ç®€ä»‹"><span>å¤šè¿›ç¨‹ç¼–ç¨‹ç®€ä»‹</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œä½ çš„ä»£ç é»˜è®¤è¿è¡Œåœ¨ä¸€ä¸ªå•ç‹¬çš„è¿›ç¨‹é‡Œã€‚è¿™ä¸ªè¿›ç¨‹è¢«ç§°ä¸ºä¸»è¿›ç¨‹ã€‚ç„¶è€Œï¼Œç”±äº Node.js æ˜¯å•çº¿ç¨‹çš„ï¼Œä¸ºäº†å……åˆ†åˆ©ç”¨å¤šæ ¸ CPUï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åˆ›å»ºé¢å¤–çš„è¿›ç¨‹æ¥å¹¶è¡Œå¤„ç†ä»»åŠ¡ã€‚è¿™äº›é¢å¤–åˆ›å»ºçš„è¿›ç¨‹è¢«ç§°ä¸ºå­è¿›ç¨‹ã€‚</p><h3 id="child-process-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#child-process-æ¨¡å—"><span><code>child_process</code> æ¨¡å—</span></a></h3><p>Node.js æä¾›äº†ä¸€ä¸ªå†…ç½®æ¨¡å—å«åš<code>child_process</code>ï¼Œå®ƒå…è®¸æˆ‘ä»¬åˆ›å»ºå’Œç®¡ç†å­è¿›ç¨‹ã€‚é€šè¿‡ä½¿ç”¨è¿™ä¸ªæ¨¡å—ï¼Œä½ å¯ä»¥æ‰§è¡Œå…¶ä»–ç¨‹åºæˆ–è„šæœ¬ï¼Œå®ç°è¿›ç¨‹é—´çš„é€šä¿¡ï¼ˆIPCï¼‰ï¼Œç­‰ç­‰ã€‚</p><h3 id="cluster-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#cluster-æ¨¡å—"><span>cluster æ¨¡å—</span></a></h3><p>å¯¹äºéœ€è¦é«˜æ€§èƒ½çš„ç½‘ç»œæœåŠ¡æ¥è¯´ï¼ŒNode.js æä¾›äº†<code>cluster</code>æ¨¡å—ï¼Œå…è®¸ä½ è½»æ¾åœ°åˆ›å»ºå…±äº«æœåŠ¡å™¨ç«¯å£çš„å­è¿›ç¨‹ã€‚è¿™æ˜¯ä¸€ä¸ªæé«˜ç½‘ç»œåº”ç”¨æ€§èƒ½çš„å¸¸è§æ–¹æ³•ã€‚</p><h3 id="event-disconnect-1" tabindex="-1"><a class="header-anchor" href="#event-disconnect-1"><span><code>Event: &#39;disconnect&#39;</code></span></a></h3><p>å½“ä½¿ç”¨<code>child_process.fork()</code>æ–¹æ³•å¯åŠ¨çš„å­è¿›ç¨‹æ— æ³•å†ä¸å…¶çˆ¶è¿›ç¨‹é€šä¿¡æ—¶ï¼Œå°±ä¼šè§¦å‘<code>&#39;disconnect&#39;</code>äº‹ä»¶ã€‚åœ¨<code>cluster</code>æ¨¡å—çš„ä½¿ç”¨åœºæ™¯ä¸‹ï¼Œå½“é€šè¿‡ IPC é€šé“ä»ä¸»è¿›ç¨‹æ–­å¼€ä¸€ä¸ªå·¥ä½œè¿›ç¨‹æ—¶ï¼Œä¹Ÿä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ã€‚</p><p>è¿™ä¸ªäº‹ä»¶é€šå¸¸æ„å‘³ç€è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡å·²ç»è¢«å…³é—­ï¼Œè¿™ç§æƒ…å†µå¯èƒ½æ˜¯å› ä¸ºï¼š</p><ul><li>å­è¿›ç¨‹ä¸»åŠ¨è°ƒç”¨<code>.disconnect()</code>æ–¹æ³•ã€‚</li><li>çˆ¶è¿›ç¨‹æˆ–å­è¿›ç¨‹ç»“æŸæ‰§è¡Œï¼Œå¯¼è‡´ IPC é€šé“å…³é—­ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-ç›‘å¬å­è¿›ç¨‹çš„-disconnect-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ç›‘å¬å­è¿›ç¨‹çš„-disconnect-äº‹ä»¶"><span>ç¤ºä¾‹ 1ï¼šç›‘å¬å­è¿›ç¨‹çš„<code>&#39;disconnect&#39;</code>äº‹ä»¶</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå¤æ‚çš„è®¡ç®—ä»»åŠ¡éœ€è¦åœ¨å­è¿›ç¨‹ä¸­æ‰§è¡Œï¼Œä»¥é¿å…é˜»å¡ä¸»è¿›ç¨‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child_process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºå­è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> child</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some-complex-task.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬&#39;disconnect&#39;äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;disconnect&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å­è¿›ç¨‹å·²æ–­å¼€è¿æ¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œå¦‚æœå­è¿›ç¨‹å®Œæˆä»»åŠ¡å¹¶ä¸”åœæ­¢è¿è¡Œï¼Œæˆ–è€…å‡ºäºæŸç§åŸå› å…¶ IPC é€šé“è¢«å…³é—­ï¼Œ<code>&#39;disconnect&#39;</code>äº‹ä»¶ä¼šè¢«è§¦å‘ã€‚</p><h4 id="ç¤ºä¾‹-2-åœ¨-cluster-ç¯å¢ƒä¸‹ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-åœ¨-cluster-ç¯å¢ƒä¸‹ä½¿ç”¨"><span>ç¤ºä¾‹ 2ï¼šåœ¨ cluster ç¯å¢ƒä¸‹ä½¿ç”¨</span></a></h4><p>åœ¨ä½¿ç”¨<code>cluster</code>æ¨¡å—è¿›è¡Œè¿›ç¨‹ç®¡ç†æ—¶ï¼Œå¯ä»¥ç›‘å¬<code>&#39;disconnect&#39;</code>äº‹ä»¶æ¥çŸ¥é“ä½•æ—¶ä¸€ä¸ªå·¥ä½œè¿›ç¨‹ä¸ä¸»è¿›ç¨‹çš„è¿æ¥æ–­å¼€äº†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> cluster</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;cluster&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;http&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> numCPUs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;os&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cpus</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">cluster</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isMaster</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`ä¸»è¿›ç¨‹ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pid</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ­£åœ¨è¿è¡Œ`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¡ç”Ÿå·¥ä½œè¿›ç¨‹ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> numCPUs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> worker</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> cluster</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ç›‘å¬&#39;disconnect&#39;äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    worker</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;disconnect&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å·¥ä½œè¿›ç¨‹ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">worker</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pid</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> å·²æ–­å¼€è¿æ¥`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å·¥ä½œè¿›ç¨‹å¯ä»¥å…±äº«ä»»æ„çš„ TCP è¿æ¥ã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åœ¨æœ¬ä¾‹å­ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ª HTTP æœåŠ¡å™¨ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeHead</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;ä½ å¥½ä¸–ç•Œ</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å·¥ä½œè¿›ç¨‹ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pid</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> å·²å¯åŠ¨`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœå·¥ä½œè¿›ç¨‹å› ä¸ºæŸäº›åŸå› æ–­å¼€äº†ä¸ä¸»è¿›ç¨‹çš„è¿æ¥ï¼Œ<code>&#39;disconnect&#39;</code>äº‹ä»¶ä¼šè¢«è§¦å‘ï¼Œå¹¶æ‰“å°å‡ºç›¸åº”çš„æ—¥å¿—ä¿¡æ¯ã€‚</p><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span>æ€»ç»“</span></a></h3><p><code>&#39;disconnect&#39;</code>äº‹ä»¶åœ¨è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰ä¸­æ˜¯éå¸¸é‡è¦çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤šè¿›ç¨‹ç¼–ç¨‹æ—¶ã€‚ç›‘å¬è¿™ä¸ªäº‹ä»¶å¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œæ§åˆ¶è¿›ç¨‹é—´çš„çŠ¶æ€ï¼Œç¡®ä¿ä½ çš„ Node.js åº”ç”¨èƒ½å¤Ÿæœ‰æ•ˆä¸”ç¨³å®šåœ°è¿è¡Œã€‚</p><h3 id="event-exit" tabindex="-1"><a class="header-anchor" href="#event-exit"><span><a href="https://nodejs.org/docs/latest/api/process.html#event-exit" target="_blank" rel="noopener noreferrer">Event: &#39;exit&#39;</a></span></a></h3><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„<code>Event: &#39;exit&#39;</code>ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºä¸€ä¸ªç‰¹å®šçš„äº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶åœ¨ Node.js ç¨‹åºå³å°†ç»“æŸè¿è¡Œæ—¶è¢«è§¦å‘ã€‚è¦ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œé¦–å…ˆéœ€è¦äº†è§£ä¸¤ä¸ªåŸºæœ¬ç‚¹ï¼šäº‹ä»¶å’Œ Node.js çš„äº‹ä»¶å¾ªç¯æœºåˆ¶ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯äº‹ä»¶"><span>ä»€ä¹ˆæ˜¯äº‹ä»¶ï¼Ÿ</span></a></h3><p>åœ¨ç¼–ç¨‹ä¸–ç•Œé‡Œï¼Œäº‹ä»¶å¯ä»¥è¢«çœ‹ä½œæ˜¯ç¨‹åºè¿è¡Œä¸­å‘ç”Ÿçš„æŸç§ç‰¹å®šè¡Œä¸ºæˆ–æƒ…å†µï¼Œæ¯”å¦‚ç”¨æˆ·ç‚¹å‡»äº†æŒ‰é’®ã€æ–‡ä»¶ä¸‹è½½å®Œæˆç­‰ã€‚Node.js ä½¿ç”¨äº‹ä»¶é©±åŠ¨çš„æ–¹å¼æ¥å¤„ç†å„ç§å„æ ·çš„å¼‚æ­¥æ“ä½œï¼Œè¿™ä½¿å¾—å®ƒéå¸¸é€‚åˆå¼€å‘éœ€è¦é«˜å¹¶å‘å¤„ç†çš„ç½‘ç»œåº”ç”¨ã€‚</p><h3 id="node-js-çš„äº‹ä»¶å¾ªç¯æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#node-js-çš„äº‹ä»¶å¾ªç¯æœºåˆ¶"><span>Node.js çš„äº‹ä»¶å¾ªç¯æœºåˆ¶</span></a></h3><p>Node.js åœ¨å†…éƒ¨ä½¿ç”¨æ‰€è°“çš„â€œäº‹ä»¶å¾ªç¯â€ï¼ˆEvent Loopï¼‰æœºåˆ¶æ¥æŒç»­æ£€æŸ¥æ˜¯å¦æœ‰äº‹ä»¶å‘ç”Ÿï¼Œå¹¶å¯¹è¿™äº›äº‹ä»¶é‡‡å–ç›¸åº”çš„å¤„ç†æªæ–½ã€‚è¿™ç§æœºåˆ¶å…è®¸ Node.js åœ¨æ‰§è¡Œ I/O æ“ä½œï¼ˆå¦‚è¯»å†™æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰ï¼‰æ—¶ä¸ä¼šè¢«é˜»å¡ï¼Œå› æ­¤èƒ½å¤Ÿå¤„ç†å¤§é‡å¹¶å‘çš„è¿æ¥ã€‚</p><h3 id="event-exit-è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#event-exit-è¯¦è§£"><span><code>Event: &#39;exit&#39;</code>è¯¦è§£</span></a></h3><p><code>&#39;exit&#39;</code>äº‹ä»¶å±äº<code>process</code>å¯¹è±¡çš„ä¸€éƒ¨åˆ†ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>process</code>å¯¹è±¡æä¾›äº†ä¸€ç³»åˆ—æœ‰å…³å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶æ–¹æ³•ã€‚å½“ Node.js è¿›ç¨‹å³å°†ç»“æŸæ—¶ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼ŒNode.js å³å°†åœæ­¢è¿è¡Œï¼‰ï¼Œ<code>&#39;exit&#39;</code>äº‹ä»¶è¢«è§¦å‘ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸€æ—¦<code>&#39;exit&#39;</code>äº‹ä»¶çš„å›è°ƒå‡½æ•°å¼€å§‹æ‰§è¡Œï¼ŒNode.js çš„äº‹ä»¶å¾ªç¯å°†åœæ­¢å·¥ä½œï¼Œè¿™æ„å‘³ç€åœ¨è¿™ä¸ªå›è°ƒå‡½æ•°ä¸­ä¸èƒ½æ‰§è¡Œå¼‚æ­¥ä»£ç ï¼Œå› ä¸ºæ²¡æœ‰ä¸œè¥¿ä¼šå»â€œç›‘å¬â€è¿™äº›å¼‚æ­¥æ“ä½œçš„å®Œæˆã€‚</p><h3 id="ä½¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js ç¨‹åºï¼Œä½ æƒ³è¦åœ¨ç¨‹åºç»“æŸå‰æ‰§è¡Œä¸€äº›æ¸…ç†å·¥ä½œï¼Œæ¯”å¦‚å…³é—­æ•°æ®åº“è¿æ¥æˆ–è€…ä¿å­˜æ—¥å¿—ã€‚è¿™æ—¶å€™ï¼Œç›‘å¬<code>&#39;exit&#39;</code>äº‹ä»¶å°±éå¸¸æœ‰ç”¨äº†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;exit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`About to exit with code: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">code</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿›è¡Œä¸€äº›åŒæ­¥çš„æ¸…ç†å·¥ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªç›‘å¬å™¨æ¥ç›‘å¬<code>&#39;exit&#39;</code>äº‹ä»¶ã€‚ä¸€æ—¦ Node.js è¿›ç¨‹å‡†å¤‡é€€å‡ºï¼Œæˆ‘ä»¬çš„å›è°ƒå‡½æ•°å°±ä¼šè¢«è°ƒç”¨ã€‚å‚æ•°<code>code</code>è¡¨ç¤ºè¿›ç¨‹é€€å‡ºæ—¶çš„çŠ¶æ€ç ï¼Œ0 é€šå¸¸è¡¨ç¤ºæˆåŠŸï¼Œé 0 è¡¨ç¤ºæœ‰é”™è¯¯æˆ–å¼‚å¸¸å‘ç”Ÿã€‚</p><p>è¯·è®°ä½ï¼Œåœ¨<code>&#39;exit&#39;</code>äº‹ä»¶çš„å›è°ƒä¸­æ‰§è¡Œå¼‚æ­¥æ“ä½œæ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºäº‹ä»¶å¾ªç¯åœ¨è¿™æ—¶å·²ç»ä¸å†è¿è¡Œäº†ã€‚æ‰€ä»¥ï¼Œä»»ä½•éœ€è¦å¼‚æ­¥å®Œæˆçš„æ¸…ç†å·¥ä½œéƒ½åº”è¯¥åœ¨ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†å¤„ç†ï¼Œè€Œä¸æ˜¯åœ¨è¿™é‡Œã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œé€šè¿‡ç›‘å¬<code>&#39;exit&#39;</code>äº‹ä»¶ï¼Œå¼€å‘è€…å¯ä»¥åœ¨ Node.js åº”ç”¨ç¨‹åºç»“æŸä¹‹å‰ï¼Œè¿›è¡Œå¿…è¦çš„åŒæ­¥æ¸…ç†å·¥ä½œï¼Œç¡®ä¿ç¨‹åºä¼˜é›…åœ°å…³é—­ã€‚</p><h3 id="event-message" tabindex="-1"><a class="header-anchor" href="#event-message"><span><a href="https://nodejs.org/docs/latest/api/process.html#event-message" target="_blank" rel="noopener noreferrer">Event: &#39;message&#39;</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>&#39;message&#39;</code>äº‹ä»¶æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤šè¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰æ—¶ã€‚è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥ç†è§£è¿™ä¸ªæ¦‚å¿µã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-message-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-message-äº‹ä»¶"><span>ä»€ä¹ˆæ˜¯<code>&#39;message&#39;</code>äº‹ä»¶ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œå½“ä½ ä½¿ç”¨å¤šè¿›ç¨‹ï¼ˆæ¯”å¦‚é€šè¿‡<code>child_process.fork()</code>åˆ›å»ºçš„å­è¿›ç¨‹ï¼‰æ—¶ï¼Œä¸»è¿›ç¨‹å’Œå­è¿›ç¨‹ä¹‹é—´å¯ä»¥é€šè¿‡å‘é€å’Œæ¥æ”¶æ¶ˆæ¯æ¥é€šä¿¡ã€‚è¿™ç§é€šä¿¡çš„æ–¹å¼å°±æ˜¯åˆ©ç”¨äº†<code>&#39;message&#39;</code>äº‹ä»¶ã€‚</p><p>ç®€å•åœ°è¯´ï¼Œ<code>&#39;message&#39;</code>äº‹ä»¶å°±æ˜¯å½“ä¸€ä¸ªè¿›ç¨‹æ¥æ”¶åˆ°å¦ä¸€ä¸ªè¿›ç¨‹å‘é€è¿‡æ¥çš„æ¶ˆæ¯æ—¶è§¦å‘çš„äº‹ä»¶ã€‚</p><h3 id="å¦‚ä½•å·¥ä½œ" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•å·¥ä½œ"><span>å¦‚ä½•å·¥ä½œï¼Ÿ</span></a></h3><ol><li><p><strong>å‘é€æ¶ˆæ¯</strong>ï¼šåœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>process.send(message)</code>ï¼ˆåœ¨å­è¿›ç¨‹ä¸­ï¼‰å‘çˆ¶è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼Œæˆ–è€…ä½¿ç”¨<code>child.send(message)</code>ï¼ˆåœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œ<code>child</code>è¡¨ç¤ºå­è¿›ç¨‹å¯¹è±¡ï¼‰å‘å­è¿›ç¨‹å‘é€æ¶ˆæ¯ã€‚</p></li><li><p><strong>æ¥æ”¶æ¶ˆæ¯</strong>ï¼šæ— è®ºæ˜¯çˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹ï¼Œéƒ½å¯ä»¥é€šè¿‡ç›‘å¬<code>&#39;message&#39;</code>äº‹ä»¶æ¥æ¥æ”¶æ¶ˆæ¯ã€‚ç›‘å¬ä½¿ç”¨çš„æ–¹æ³•æ˜¯<code>.on(&#39;message&#39;, callback)</code>ï¼Œå…¶ä¸­<code>callback</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨æ¶ˆæ¯åˆ°æ¥æ—¶æ‰§è¡Œï¼Œå¹¶ä¸”æ¥æ”¶åˆ°çš„æ¶ˆæ¯ä½œä¸ºå‚æ•°ã€‚</p></li></ol><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-1"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦è¿›è¡Œä¸€äº›å¤æ‚è®¡ç®—ï¼Œè€Œè¿™äº›è®¡ç®—å¯èƒ½ä¼šé˜»å¡ä¸»äº‹ä»¶å¾ªç¯ã€‚ä¸ºäº†é¿å…é˜»å¡ï¼Œä½ å†³å®šå°†è¿™éƒ¨åˆ†è®¡ç®—ä»»åŠ¡äº¤ç»™ä¸€ä¸ªå­è¿›ç¨‹å»åšï¼Œè®¡ç®—å®Œæˆåå†æŠŠç»“æœå‘å›ç»™ä¸»è¿›ç¨‹ã€‚</p><h4 id="ä¸»è¿›ç¨‹ä»£ç -main-js" tabindex="-1"><a class="header-anchor" href="#ä¸»è¿›ç¨‹ä»£ç -main-js"><span>ä¸»è¿›ç¨‹ä»£ç  (<code>main.js</code>):</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child_process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> child</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./child.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘å­è¿›ç¨‹å‘é€è®¡ç®—ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">task</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;complexCalculation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬æ¥è‡ªå­è¿›ç¨‹çš„æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Received result from child: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Main process is doing other tasks...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å­è¿›ç¨‹ä»£ç -child-js" tabindex="-1"><a class="header-anchor" href="#å­è¿›ç¨‹ä»£ç -child-js"><span>å­è¿›ç¨‹ä»£ç  (<code>child.js</code>):</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">task</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;complexCalculation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ‰§è¡Œå¤æ‚è®¡ç®—...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 123</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯è®¡ç®—ç»“æœ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å°†ç»“æœå‘é€å›çˆ¶è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Child process is running the task...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸»è¿›ç¨‹ (<code>main.js</code>) å’Œå­è¿›ç¨‹ (<code>child.js</code>) é€šè¿‡å‘é€å’Œæ¥æ”¶æ¶ˆæ¯æ¥äº¤æ¢æ•°æ®ã€‚ä¸»è¿›ç¨‹å‘é€ä¸€ä¸ªåŒ…å«ä»»åŠ¡ä¿¡æ¯çš„æ¶ˆæ¯ç»™å­è¿›ç¨‹ï¼Œå­è¿›ç¨‹æ¥æ”¶è¿™ä¸ªæ¶ˆæ¯ï¼Œæ‰§è¡Œç›¸åº”çš„ä»»åŠ¡ï¼Œç„¶åå°†ç»“æœä»¥æ¶ˆæ¯çš„å½¢å¼å‘é€å›ç»™ä¸»è¿›ç¨‹ã€‚ä¸»è¿›ç¨‹åœ¨æ¥æ”¶åˆ°ç»“æœåï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­å¤„ç†ç»“æœã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥æœ‰æ•ˆåœ°åˆ©ç”¨ Node.js çš„å¤šè¿›ç¨‹ç‰¹æ€§ï¼Œæé«˜åº”ç”¨çš„æ€§èƒ½å’Œå“åº”é€Ÿåº¦ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†éœ€è¦å¤§é‡è®¡ç®—æˆ– I/O æ“ä½œçš„ä»»åŠ¡æ—¶ã€‚</p><h3 id="event-multipleresolves" tabindex="-1"><a class="header-anchor" href="#event-multipleresolves"><span><a href="https://nodejs.org/docs/latest/api/process.html#event-multipleresolves" target="_blank" rel="noopener noreferrer">Event: &#39;multipleResolves&#39;</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚äº†è§£ Node.js çš„äº‹ä»¶å’Œé”™è¯¯å¤„ç†æœºåˆ¶å¯¹äºå¼€å‘ç¨³å®šã€é«˜æ•ˆçš„åº”ç”¨è‡³å…³é‡è¦ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ Node.js v21.7.1 ä¸­çš„ä¸€ä¸ªç‰¹å®šäº‹ä»¶ï¼š<code>&#39;multipleResolves&#39;</code>ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-multipleresolves-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-multipleresolves-äº‹ä»¶"><span>ä»€ä¹ˆæ˜¯ <code>&#39;multipleResolves&#39;</code> äº‹ä»¶ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼ŒPromises æ˜¯å¤„ç†å¼‚æ­¥æ“ä½œçš„ä¸€ç§æ–¹å¼ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ª Promiseï¼Œå®ƒä»£è¡¨ä¸€ä¸ªå°šæœªå®Œæˆä½†é¢„æœŸå°†æ¥ä¼šå®Œæˆçš„æ“ä½œã€‚Promise å¯ä»¥è¾¾åˆ°ä»¥ä¸‹ä¸‰ç§çŠ¶æ€ä¹‹ä¸€ï¼š</p><ul><li>Pendingï¼ˆç­‰å¾…ï¼‰: åˆå§‹çŠ¶æ€ï¼Œæ—¢ä¸æ˜¯æˆåŠŸï¼Œä¹Ÿä¸æ˜¯å¤±è´¥ã€‚</li><li>Fulfilledï¼ˆå·²å®Œæˆï¼‰: æ“ä½œæˆåŠŸå®Œæˆã€‚</li><li>Rejectedï¼ˆå·²æ‹’ç»ï¼‰: æ“ä½œå¤±è´¥ã€‚</li></ul><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ª Promise åº”è¯¥åªèƒ½ä» pending çŠ¶æ€è½¬å˜ä¸º fulfilled æˆ– rejected çŠ¶æ€ï¼Œå¹¶ä¸”ä¸€æ—¦çŠ¶æ€æ”¹å˜ï¼ˆæ— è®ºæ˜¯å˜ä¸º fulfilled è¿˜æ˜¯ rejectedï¼‰ï¼Œå®ƒå°±ä¸èƒ½å†æ¬¡æ”¹å˜çŠ¶æ€äº†ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”±äºç¼–ç¨‹é”™è¯¯æˆ–å…¶ä»–é—®é¢˜ï¼Œä¸€ä¸ª Promise å¯èƒ½ä¼šå°è¯•å¤šæ¬¡è§£å†³ï¼ˆfulfillã€reject æˆ–å†æ¬¡ fulfill/rejectï¼‰ã€‚</p><p>è¿™å°±æ˜¯ <code>&#39;multipleResolves&#39;</code> äº‹ä»¶å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚å½“ä¸€ä¸ª Promise è¢«å¤šæ¬¡è§£å†³æˆ–æ‹’ç»æ—¶ï¼ŒNode.js ä¼šè§¦å‘ <code>&#39;multipleResolves&#39;</code> äº‹ä»¶ã€‚è¿™ä¸ªäº‹ä»¶å…è®¸å¼€å‘è€…æ•è·å¹¶å¤„ç†è¿™ç§æ½œåœ¨çš„é”™è¯¯æƒ…å½¢ã€‚</p><h3 id="å¦‚ä½•ç›‘å¬-multipleresolves-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ç›‘å¬-multipleresolves-äº‹ä»¶"><span>å¦‚ä½•ç›‘å¬ <code>&#39;multipleResolves&#39;</code> äº‹ä»¶ï¼Ÿ</span></a></h3><p>ä½ å¯ä»¥é€šè¿‡ç›‘å¬ process å¯¹è±¡ä¸Šçš„ <code>&#39;multipleResolves&#39;</code> äº‹ä»¶æ¥æ•è·è¿™ç§æƒ…å†µï¼Œä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;multipleResolves&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">reason</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A promise was resolved or rejected multiple times:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    reason</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œ<code>type</code> å‚æ•°æŒ‡ç¤ºè§¦å‘äº‹ä»¶çš„æ“ä½œç±»å‹ï¼ˆä¾‹å¦‚ï¼Œ<code>resolve</code>ã€<code>reject</code> æˆ– <code>resolve</code> åå†æ¬¡ <code>resolve</code>ï¼‰ï¼Œ<code>promise</code> æ˜¯ç›¸å…³çš„ Promise å¯¹è±¡ï¼Œ<code>reason</code> æ˜¯ Promise è¢«è§£å†³æˆ–æ‹’ç»çš„å€¼æˆ–åŸå› ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹ï¼Œå…¶ä¸­ä¸€ä¸ª Promise é”™è¯¯åœ°è¢«å¤šæ¬¡è§£å†³ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> something</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">reject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;First resolve&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Second resolve&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™å°†å¯¼è‡´ &#39;multipleResolves&#39; äº‹ä»¶çš„è§¦å‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;multipleResolves&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">reason</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Promise led to </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> more than once:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">reason</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ„å›¾åªè§£å†³è¿™ä¸ª Promise ä¸€æ¬¡ï¼Œä½†å´è°ƒç”¨äº†ä¸¤æ¬¡ <code>resolve</code>ã€‚ç¬¬äºŒæ¬¡è°ƒç”¨ <code>resolve</code> å°†è§¦å‘ <code>&#39;multipleResolves&#39;</code> äº‹ä»¶ï¼Œå…è®¸æˆ‘ä»¬æ•è·å¹¶å¤„ç†è¿™ç§å¼‚å¸¸æƒ…å†µã€‚</p><h3 id="æ€»ç»“-1" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-1"><span>æ€»ç»“</span></a></h3><p>äº†è§£å’Œæ­£ç¡®å¤„ç† <code>&#39;multipleResolves&#39;</code> äº‹ä»¶å¯ä»¥å¸®åŠ©ä½ å¼€å‘æ›´ç¨³å®šå¯é çš„ Node.js åº”ç”¨ç¨‹åºã€‚å®ƒæ˜¯ Node.js æä¾›çš„ä¼—å¤šå·¥å…·å’Œæœºåˆ¶ä¹‹ä¸€ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…è¯†åˆ«å¹¶ä¿®å¤æ½œåœ¨çš„ç¼–ç¨‹é”™è¯¯ï¼Œç¡®ä¿ä»£ç çš„å¥å£®æ€§å’Œè´¨é‡ã€‚</p><h3 id="event-rejectionhandled" tabindex="-1"><a class="header-anchor" href="#event-rejectionhandled"><span><a href="https://nodejs.org/docs/latest/api/process.html#event-rejectionhandled" target="_blank" rel="noopener noreferrer">Event: &#39;rejectionHandled&#39;</a></span></a></h3><p>ç†è§£ Node.js ä¸­çš„ <code>rejectionHandled</code> äº‹ä»¶ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦æ˜ç™½ JavaScript çš„å¼‚æ­¥ç¼–ç¨‹å’Œ Promiseã€‚Promise æ˜¯å¤„ç†å¼‚æ­¥æ“ä½œçš„ä¸€ç§æ–¹å¼ï¼Œå®ƒæœ‰å‡ ç§çŠ¶æ€ï¼špendingï¼ˆç­‰å¾…ä¸­ï¼‰ã€fulfilledï¼ˆå·²æˆåŠŸï¼‰å’Œ rejectedï¼ˆå·²å¤±è´¥ï¼‰ã€‚å½“ä¸€ä¸ª Promise è¢«æ‹’ç»ï¼ˆrejectedï¼‰ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šç”¨ <code>.catch()</code> æ–¹æ³•æ¥æ•è·è¿™ä¸ªé”™è¯¯ï¼Œé¿å…ç¨‹åºå´©æºƒæˆ–åœæ­¢æ‰§è¡Œã€‚</p><p>åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½æ¼æ‰äº†å¯¹æŸä¸ª Promise æ‹’ç»çŠ¶æ€çš„å¤„ç†ï¼ˆå³æ²¡æœ‰ç«‹å³æ•è·è¿™ä¸ªé”™è¯¯ï¼‰ã€‚Node.js æä¾›äº†ä¸€ä¸ªå…¨å±€è¿›ç¨‹å¯¹è±¡ <code>process</code>ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç›‘å¬æœªè¢«æ•è·çš„ Promise æ‹’ç»ã€‚å…¶ä¸­ä¸¤ä¸ªä¸æ­¤ç›¸å…³çš„äº‹ä»¶æ˜¯ <code>unhandledRejection</code> å’Œ <code>rejectionHandled</code>ã€‚</p><ol><li><strong>unhandledRejection</strong>ï¼šè¿™ä¸ªäº‹ä»¶åœ¨ Promise è¢«æ‹’ç»å¹¶ä¸”æ²¡æœ‰ç«‹å³ä¸ºå…¶æä¾›é”™è¯¯å¤„ç†å™¨æ—¶è§¦å‘ã€‚</li><li><strong>rejectionHandled</strong>ï¼šå¦‚æœ Promise åœ¨å¼€å§‹æ—¶æœªè¢«å¤„ç†ï¼ˆå³æœªæ•è·é”™è¯¯ï¼‰ï¼Œä½†ç¨åæ·»åŠ äº†é”™è¯¯å¤„ç†å™¨ï¼ˆæ¯”å¦‚é€šè¿‡ <code>.catch()</code>ï¼‰ï¼Œè¿™æ—¶ <code>rejectionHandled</code> äº‹ä»¶å°±ä¼šè¢«è§¦å‘ã€‚</li></ol><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-2"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨æ„å»ºä¸€ä¸ªç½‘ç«™çš„åç«¯ï¼Œå¹¶ä¸”ä½¿ç”¨äº† Promise æ¥å¤„ç†æ•°æ®åº“æŸ¥è¯¢ã€‚</p><h4 id="ç¤ºä¾‹ä»£ç " tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç "><span>ç¤ºä¾‹ä»£ç ï¼š</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä¸€ä¸ªè¿”å› Promise çš„æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> queryDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">reject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ¨¡æ‹ŸæŸ¥è¯¢å¤±è´¥</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    reject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Query failed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡ŒæŸ¥è¯¢ä½†å¿˜è®°äº†ç«‹å³æ•è·å¯èƒ½å‡ºç°çš„é”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> promise</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> queryDatabase</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SELECT * FROM users&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç»‘å®š rejectionHandled äº‹ä»¶ç›‘å¬</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;rejectionHandled&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;A previously unhandled rejection has now been handled.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å»¶è¿Ÿä¸€æ®µæ—¶é—´åç»™ Promise æ·»åŠ  catch å¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Caught delayed rejection:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š"><span>è§£é‡Šï¼š</span></a></h3><ol><li>æˆ‘ä»¬æ¨¡æ‹Ÿäº†ä¸€ä¸ªæ•°æ®åº“æŸ¥è¯¢æ“ä½œï¼Œè¯¥æ“ä½œå› ä¸ºæŸäº›åŸå› å¤±è´¥äº†ï¼Œå¹¶è¿”å›äº†ä¸€ä¸ªè¢«æ‹’ç»çš„ Promiseã€‚</li><li>æœ€åˆï¼Œæˆ‘ä»¬æ²¡æœ‰ç«‹å³é€šè¿‡ <code>.catch()</code> å¤„ç†è¿™ä¸ªæ‹’ç»ï¼Œè¿™é€šå¸¸ä¼šå¯¼è‡´ <code>unhandledRejection</code> äº‹ä»¶çš„è§¦å‘ã€‚</li><li>ç„¶è€Œï¼Œåœ¨æˆ‘ä»¬ä»£ç çš„åé¢éƒ¨åˆ†ï¼Œæˆ‘ä»¬é€šè¿‡ <code>setTimeout</code> å»¶è¿Ÿäº†é”™è¯¯å¤„ç†çš„æ·»åŠ ã€‚è¿™æ„å‘³ç€ï¼Œåœ¨é”™è¯¯å¤„ç†è¢«æ·»åŠ ä¹‹å‰ï¼Œè¿™ä¸ª Promise è¢«è§†ä¸ºæœªå¤„ç†ã€‚</li><li>å½“æˆ‘ä»¬æœ€ç»ˆé€šè¿‡ <code>.catch()</code> æ·»åŠ äº†é”™è¯¯å¤„ç†æ—¶ï¼Œ<code>rejectionHandled</code> äº‹ä»¶è¢«è§¦å‘ï¼Œè¡¨æ˜ä¸€ä¸ªä¹‹å‰æœªè¢«å¤„ç†çš„æ‹’ç»ç°åœ¨å·²ç»å¾—åˆ°äº†å¤„ç†ã€‚</li></ol><p>é€šè¿‡è¿™ç§æœºåˆ¶ï¼ŒNode.js å…è®¸å¼€å‘è€…è¡¥æ•‘æ¼æ‰çš„é”™è¯¯å¤„ç†ï¼Œå¢åŠ äº†ä»£ç çš„å¥å£®æ€§ã€‚è¿™å¯¹äºè°ƒè¯•å’Œä¿æŒé«˜è´¨é‡çš„ä»£ç åŸºç¡€ç‰¹åˆ«æœ‰ç”¨ã€‚</p><h3 id="event-uncaughtexception" tabindex="-1"><a class="header-anchor" href="#event-uncaughtexception"><span><a href="https://nodejs.org/docs/latest/api/process.html#event-uncaughtexception" target="_blank" rel="noopener noreferrer">Event: &#39;uncaughtException&#39;</a></span></a></h3><p>å½“ä½ åœ¨ä½¿ç”¨ Node.js å¼€å‘åº”ç”¨ç¨‹åºæ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€ç§æƒ…å†µï¼šç¨‹åºä¸­å‡ºç°äº†ä¸€ä¸ªé”™è¯¯ï¼Œä½†è¿™ä¸ªé”™è¯¯æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«æ•è·ï¼ˆå³ä»£ç ä¸­æ²¡æœ‰ä½¿ç”¨<code>try...catch</code>æ¥å¤„ç†è¿™ä¸ªé”™è¯¯ï¼‰ã€‚è¿™ç§æœªè¢«æ•è·çš„å¼‚å¸¸å¯ä»¥é€šè¿‡ç›‘å¬<code>process</code>å¯¹è±¡çš„<code>&#39;uncaughtException&#39;</code>äº‹ä»¶æ¥å¤„ç†ã€‚</p><h3 id="uncaughtexceptionäº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#uncaughtexceptionäº‹ä»¶"><span><code>uncaughtException</code>äº‹ä»¶</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code>æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›æœ‰å…³å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚å½“ä¸€ä¸ª JavaScript å¼‚å¸¸åœ¨ä»»ä½•åœ°æ–¹æŠ›å‡ºå´æ²¡è¢«æ•è·æ—¶ï¼ˆæ—¢æ²¡æœ‰åœ¨æŠ›å‡ºå¼‚å¸¸çš„é‚£éƒ¨åˆ†ä»£ç å‘¨å›´ä½¿ç”¨<code>try...catch</code>ï¼Œä¹Ÿæ²¡æœ‰é€šè¿‡å…¶ä»–æ–¹å¼å¤„ç†ï¼‰ï¼ŒNode.js ä¼šè§¦å‘<code>process</code>å¯¹è±¡ä¸Šçš„<code>&#39;uncaughtException&#39;</code>äº‹ä»¶ã€‚</p><h4 id="ä¸ºä»€ä¹ˆéœ€è¦å…³æ³¨æ­¤äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦å…³æ³¨æ­¤äº‹ä»¶"><span>ä¸ºä»€ä¹ˆéœ€è¦å…³æ³¨æ­¤äº‹ä»¶ï¼Ÿ</span></a></h4><ol><li><strong>é˜²æ­¢ç¨‹åºå´©æºƒ</strong>: æ­£å¸¸æƒ…å†µä¸‹ï¼Œæœªæ•è·çš„å¼‚å¸¸ä¼šå¯¼è‡´ Node.js è¿›ç¨‹é€€å‡ºï¼Œè¿™æ„å‘³ç€ä½ çš„åº”ç”¨ç¨‹åºä¼šåœæ­¢è¿è¡Œã€‚ç›‘å¬<code>&#39;uncaughtException&#39;</code>äº‹ä»¶ï¼Œç»™äº†ä½ ä¸€ä¸ªæ‹¦æˆªé”™è¯¯çš„æœºä¼šï¼Œå¯ä»¥è¿›è¡Œä¸€äº›æ¸…ç†å·¥ä½œæˆ–å°è¯•æ¢å¤æ“ä½œï¼Œç„¶åè®©ç¨‹åºç»§ç»­è¿è¡Œæˆ–ä¼˜é›…åœ°å…³é—­ã€‚</li><li><strong>è®°å½•é”™è¯¯æ—¥å¿—</strong>: è¿™ä¹Ÿæ˜¯ä¸€ä¸ªè®°å½•é”™è¯¯ä¿¡æ¯çš„å¥½æœºä¼šï¼Œä½ å¯ä»¥åœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­å°†é”™è¯¯ä¿¡æ¯å†™å…¥æ—¥å¿—æ–‡ä»¶ï¼Œå¸®åŠ©å¼€å‘è€…äº†è§£é—®é¢˜æ‰€åœ¨ã€‚</li></ol><h4 id="ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹"><span>ç¤ºä¾‹</span></a></h4><p>ä»¥ä¸‹æ˜¯å¦‚ä½•ç›‘å¬<code>&#39;uncaughtException&#39;</code>äº‹ä»¶çš„åŸºæœ¬ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;uncaughtException&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æœ‰ä¸€ä¸ªæœªæ•è·çš„é”™è¯¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åšä¸€äº›æ¸…ç†å·¥ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨èåœ¨å¤„ç†å®Œåé€€å‡ºè¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®é™…åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h4><p>å‡è®¾ä½ å¼€å‘äº†ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œå®ƒé€šå¸¸ä¼šé•¿æ—¶é—´è¿è¡Œä¸”ä¸èƒ½è½»æ˜“å´©æºƒã€‚æŸå¤©ï¼Œç”±äºä¸€ä¸ªç½•è§çš„ç¼–ç é”™è¯¯ï¼ŒæœåŠ¡å™¨æŠ›å‡ºäº†ä¸€ä¸ªæœªè¢«æ•è·çš„å¼‚å¸¸ã€‚å¦‚æœä½ ç›‘å¬äº†<code>&#39;uncaughtException&#39;</code>äº‹ä»¶ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œè®°å½•é”™è¯¯ä¿¡æ¯ï¼Œå¹¶å°è¯•é‡å¯å—å½±å“çš„æœåŠ¡ç»„ä»¶è€Œä¸æ˜¯æ•´ä¸ªåº”ç”¨ç¨‹åºç›´æ¥å´©æºƒï¼Œä»è€Œæé«˜äº†åº”ç”¨çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</p><h4 id="æ³¨æ„äº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹"><span>æ³¨æ„äº‹é¡¹</span></a></h4><ul><li>ä½¿ç”¨<code>&#39;uncaughtException&#39;</code>äº‹ä»¶è¦å°å¿ƒï¼Œå› ä¸ºåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä¸€æ—¦å‡ºç°äº†æœªæ•è·çš„å¼‚å¸¸ï¼ŒNode.js çš„çŠ¶æ€å¯èƒ½å·²ç»ä¸ç¨³å®šäº†ï¼Œå°¤å…¶æ˜¯å¯¹äº V8 å¼•æ“çš„å †æ ˆå’Œèµ„æºæ¥è¯´ã€‚å› æ­¤ï¼Œåœ¨è¿™ä¸ªäº‹ä»¶çš„å›è°ƒå‡½æ•°ä¸­æ‰§è¡Œå¤ªå¤šé€»è¾‘æˆ–å°è¯•ç»§ç»­æ­£å¸¸è¿è¡Œç¨‹åºæ˜¯æœ‰é£é™©çš„ã€‚</li><li>Node.js æ–‡æ¡£å»ºè®®ï¼Œåœ¨å¤„ç†å®Œå¿…è¦çš„åŒæ­¥æ¸…ç†å·¥ä½œåï¼Œæœ€å¥½æ˜¯é‡æ–°å¯åŠ¨è¿›ç¨‹ã€‚è¿™ç¡®ä¿äº†åº”ç”¨ç¨‹åºçš„çŠ¶æ€æ¸…ç©ºï¼Œä»é•¿è¿œæ¥çœ‹æ›´åŠ å®‰å…¨å¯é ã€‚</li></ul><p>æ€»ä¹‹ï¼Œæ­£ç¡®å¤„ç†<code>&#39;uncaughtException&#39;</code>äº‹ä»¶å¯ä»¥å¸®åŠ©æ„å»ºæ›´åŠ å¥å£¯çš„ Node.js åº”ç”¨ç¨‹åºï¼Œä½†è¿™åº”è¯¥æ˜¯é˜²æ­¢ç¨‹åºå´©æºƒçš„æœ€åä¸€é“é˜²çº¿ï¼Œè€Œä¸æ˜¯è§£å†³æ‰€æœ‰é”™è¯¯çš„é€šç”¨æ–¹æ³•ã€‚å¼€å‘è€…åº”è¯¥å°½é‡åœ¨å¯èƒ½å‡ºç°å¼‚å¸¸çš„åœ°æ–¹ä½¿ç”¨<code>try...catch</code>å¤„ç†å¼‚å¸¸ï¼Œæˆ–è€…ä½¿ç”¨ Promise çš„<code>.catch()</code>æ¥ç®¡ç†å¼‚æ­¥é”™è¯¯ã€‚</p><h4 id="warning-using-uncaughtexception-correctly" tabindex="-1"><a class="header-anchor" href="#warning-using-uncaughtexception-correctly"><span><a href="https://nodejs.org/docs/latest/api/process.html#warning-using-uncaughtexception-correctly" target="_blank" rel="noopener noreferrer">Warning: Using &#39;uncaughtException&#39; correctly</a></span></a></h4><p>ç†è§£ Node.js ä¸­çš„ <code>uncaughtException</code> äº‹ä»¶å¯¹äºç¼–å†™å¥å£¯å’Œå®‰å…¨çš„åº”ç”¨ç¨‹åºéå¸¸å…³é”®ã€‚é¦–å…ˆï¼Œæˆ‘ä¼šå‘ä½ è§£é‡Šä»€ä¹ˆæ˜¯ <code>uncaughtException</code>ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡å‡ ä¸ªå®é™…ä¾‹å­æ¥çœ‹çœ‹å®ƒå¦‚ä½•ä½¿ç”¨ï¼Œä»¥åŠä½¿ç”¨æ—¶éœ€è¦æ³¨æ„çš„ä¸€äº›é‡è¦äº‹é¡¹ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-uncaughtexception" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-uncaughtexception"><span>ä»€ä¹ˆæ˜¯ <code>uncaughtException</code>?</span></a></h3><p>åœ¨ Node.js åº”ç”¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ‰ JavaScript é”™è¯¯æ²¡æœ‰è¢«æ•è·ï¼ˆå³ä»£ç ä¸­æ²¡æœ‰é€šè¿‡ try...catch å¤„ç†è¿™ä¸ªé”™è¯¯ï¼‰ï¼ŒNode.js å°±ä¼šè§¦å‘ <code>process</code> å¯¹è±¡çš„ <code>uncaughtException</code> äº‹ä»¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒNode.js ä¼šæ‰“å°å‡ºé”™è¯¯å †æ ˆä¿¡æ¯åˆ°æ§åˆ¶å°ï¼Œå¹¶ç»“æŸè¿›ç¨‹ã€‚ä½†å¼€å‘è€…å¯ä»¥ç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼Œå¯¹æœªæ•è·çš„å¼‚å¸¸è¿›è¡Œè‡ªå®šä¹‰å¤„ç†ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—ã€æ¸…ç†èµ„æºã€å‘é€æŠ¥è­¦ä¿¡æ¯ç­‰ã€‚</p><h3 id="ä½¿ç”¨-uncaughtexception-çš„ä¸€ä¸ªä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-uncaughtexception-çš„ä¸€ä¸ªä¾‹å­"><span>ä½¿ç”¨ <code>uncaughtException</code> çš„ä¸€ä¸ªä¾‹å­</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;uncaughtException&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ•è·åˆ°æœªå¤„ç†çš„å¼‚å¸¸: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ‰§è¡Œæ¸…ç†æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼‚å¸¸é€€å‡ºç¨‹åº</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ•…æ„å¼•å‘ä¸€ä¸ªæœªè¢«æ•è·çš„å¼‚å¸¸</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å“å‘€ï¼Œå‡ºé”™äº†ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ <code>process.on</code> æ–¹æ³•ç›‘å¬ <code>uncaughtException</code> äº‹ä»¶ã€‚å½“æŠ›å‡ºä¸€ä¸ªæœªè¢«æ•è·çš„å¼‚å¸¸æ—¶ï¼ˆåœ¨ setTimeout ä¸­æ•…æ„æŠ›å‡ºçš„ Errorï¼‰ï¼Œæˆ‘ä»¬çš„ç›‘å¬å™¨ä¼šæ¥æ”¶åˆ°è¿™ä¸ªé”™è¯¯ï¼Œå¹¶æ‰§è¡Œç›¸åº”çš„å¤„ç†é€»è¾‘ï¼Œæ¯”å¦‚æ‰“å°é”™è¯¯ä¿¡æ¯å¹¶é€€å‡ºç¨‹åºã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-1" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-1"><span>æ³¨æ„äº‹é¡¹</span></a></h3><p>å°½ç®¡ç›‘å¬ <code>uncaughtException</code> äº‹ä»¶å¯ä»¥ä½œä¸ºæœ€åçš„ä¿éšœæ¥æ•è·é”™è¯¯ï¼Œé¿å…ç¨‹åºç›´æ¥å´©æºƒï¼Œä½†è¿™ç»ä¸æ„å‘³ç€å®ƒæ˜¯å¤„ç†å¼‚æ­¥ä»£ç é”™è¯¯çš„æœ€ä½³å®è·µã€‚åŸå› å¦‚ä¸‹ï¼š</p><ul><li><strong>ä¸å¯é çš„çŠ¶æ€</strong>: å½“ <code>uncaughtException</code> è¢«è§¦å‘æ—¶ï¼Œç¨‹åºå¯èƒ½å¤„äºä¸€ä¸ªä¸ç¡®å®šã€å¯èƒ½å·²ç»ç ´åçš„çŠ¶æ€ã€‚åœ¨è¿™ç§çŠ¶æ€ä¸‹ç»§ç»­è¿è¡Œç¨‹åºå¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€å†…å­˜æ³„æ¼ç­‰æ›´ä¸¥é‡çš„é—®é¢˜ã€‚</li><li><strong>æ¨èçš„åšæ³•</strong>: å¼‚æ­¥ä»£ç åº”è¯¥ä½¿ç”¨ Promises æˆ– async/awaitï¼Œå¹¶é€šè¿‡ <code>.catch()</code> æˆ– <code>try...catch</code> æ¥å¤„ç†é”™è¯¯ã€‚ä»…åœ¨æ— æ³•é¢„è§çš„æƒ…å†µä¸‹ï¼Œä½œä¸ºæœ€åçš„æ‰‹æ®µï¼Œä½¿ç”¨ <code>uncaughtException</code> è¿›è¡Œå¤„ç†ã€‚</li><li><strong>é€€å‡ºä¸æ¸…ç†</strong>: å¦‚æœä½ å†³å®šç›‘å¬ <code>uncaughtException</code> å¹¶åœ¨å›è°ƒä¸­å¤„ç†é”™è¯¯ï¼Œå»ºè®®åœ¨å®Œæˆå¿…è¦çš„é”™è¯¯è®°å½•å’Œèµ„æºæ¸…ç†åï¼Œä½¿ç”¨ <code>process.exit(1)</code> é€€å‡ºç¨‹åºã€‚è¿™è¡¨æ˜ç¨‹åºç”±äºé‡åˆ°äº†æ— æ³•æ¢å¤çš„é—®é¢˜è€Œä¸»åŠ¨é€€å‡ºã€‚</li></ul><h3 id="ç»“è®º" tabindex="-1"><a class="header-anchor" href="#ç»“è®º"><span>ç»“è®º</span></a></h3><p>è™½ç„¶ <code>uncaughtException</code> æä¾›äº†ä¸€ç§æ•è·å’Œå¤„ç†æœªæ•è·å¼‚å¸¸çš„æ–¹å¼ï¼Œä½†å®ƒåº”è¯¥è¢«è§†ä¸ºä¸€ç§æœ€åçš„é˜²çº¿ï¼Œè€Œä¸æ˜¯ä¸»è¦çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚æ­£ç¡®çš„åšæ³•æ˜¯å°½å¯èƒ½åœ°ä½¿ç”¨ try...catch æˆ– Promise é”™è¯¯å¤„ç†æ¥ç®¡ç†é”™è¯¯ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çš„ Node.js åº”ç”¨ç¨‹åºæ‰èƒ½æ›´åŠ å¥å£®å’Œç¨³å®šã€‚</p><h3 id="event-uncaughtexceptionmonitor" tabindex="-1"><a class="header-anchor" href="#event-uncaughtexceptionmonitor"><span><a href="https://nodejs.org/docs/latest/api/process.html#event-uncaughtexceptionmonitor" target="_blank" rel="noopener noreferrer">Event: &#39;uncaughtExceptionMonitor&#39;</a></span></a></h3><p>è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥äº†è§£ Node.js ä¸­çš„<code>uncaughtExceptionMonitor</code>äº‹ä»¶ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦äº†è§£ Node.js æ˜¯ä»€ä¹ˆã€‚Node.js æ˜¯ä¸€ä¸ªåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript çš„ç¯å¢ƒï¼Œå®ƒä½¿å¾—ä½¿ç”¨ JavaScript å¼€å‘åç«¯åº”ç”¨æˆä¸ºå¯èƒ½ã€‚Node.js å¼ºå¤§ä¹‹å¤„åœ¨äºå…¶éé˜»å¡ I/O å’Œäº‹ä»¶é©±åŠ¨çš„ç‰¹æ€§ï¼Œè¿™ä½¿å¾—å®ƒéå¸¸é€‚åˆæ„å»ºé«˜æ€§èƒ½çš„ç½‘ç»œåº”ç”¨ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬èšç„¦äº<code>uncaughtExceptionMonitor</code>äº‹ä»¶ã€‚åœ¨ Node.js ä¸­ï¼Œå½“æœ‰æœªæ•è·çš„å¼‚å¸¸å‡ºç°æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒNode.js ä¼šæ‰“å°å †æ ˆè¿½è¸ªä¿¡æ¯åˆ° stderrï¼ˆæ ‡å‡†é”™è¯¯è¾“å‡ºï¼‰ï¼Œç„¶åå¹²å‡€åœ°é€€å‡ºã€‚ä½†æœ‰æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³è¦è‡ªå®šä¹‰è¿™ç§è¡Œä¸ºï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—æˆ–è€…åšä¸€äº›æ¸…ç†å·¥ä½œã€‚</p><p>è¿™å°±æ˜¯<code>uncaughtException</code>äº‹ä»¶å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚ä½ å¯ä»¥ç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼Œç„¶åæ‰§è¡Œä¸€äº›å®šåˆ¶åŒ–æ“ä½œã€‚ç„¶è€Œï¼Œä½¿ç”¨<code>uncaughtException</code>å¤„ç†å™¨éœ€è¦è°¨æ…ï¼Œå› ä¸ºåœ¨æœªæ•è·çš„å¼‚å¸¸å‘ç”Ÿåï¼Œä½ çš„åº”ç”¨å¯èƒ½å¤„äºæœªçŸ¥çŠ¶æ€ï¼Œç»§ç»­è¿è¡Œå¯èƒ½ä¼šå¼•å…¥æ›´å¤šé—®é¢˜ã€‚</p><p>è¿›å…¥<code>v21.7.1</code>ç‰ˆæœ¬ï¼ŒNode.js å¼•å…¥äº†ä¸€ä¸ªæ–°çš„äº‹ä»¶ï¼š<code>uncaughtExceptionMonitor</code>ã€‚è¿™ä¸ªäº‹ä»¶æä¾›äº†ä¸€ç§æ›´å®‰å…¨çš„æ–¹å¼æ¥ç›‘è§†æœªæ•è·çš„å¼‚å¸¸ï¼Œè€Œä¸ä¼šå½±å“åŸæ¥<code>uncaughtException</code>äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>è¦ä½¿ç”¨<code>uncaughtExceptionMonitor</code>ï¼Œä½ åªéœ€è¦åœ¨<code>process</code>å¯¹è±¡ä¸Šæ³¨å†Œç›‘å¬å™¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;uncaughtExceptionMonitor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">origin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è‡ªå®šä¹‰çš„é€»è¾‘æ¥å¤„ç†æœªæ•è·çš„å¼‚å¸¸</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Caught exception: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `Exception origin: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">origin</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å°†ä¼šåœ¨æ¯æ¬¡æœ‰æœªæ•è·çš„å¼‚å¸¸å‘ç”Ÿæ—¶è¢«è°ƒç”¨ï¼Œå…è®¸ä½ æ·»åŠ è‡ªå®šä¹‰çš„å¤„ç†é€»è¾‘ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—åˆ°æ–‡ä»¶ç³»ç»Ÿæˆ–å‘é€æŠ¥è­¦åˆ°ä½ çš„ç›‘æ§ç³»ç»Ÿã€‚é‡è¦çš„æ˜¯ï¼Œè¿™å¹¶ä¸ä¼šå½±å“å…¶ä»–<code>uncaughtException</code>äº‹ä»¶å¤„ç†å™¨çš„æ‰§è¡Œæˆ– Node.js çš„é»˜è®¤è¡Œä¸ºã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-1"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œä½ å¸Œæœ›ç¡®ä¿å³ä½¿åœ¨é‡åˆ°æ„å¤–é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ä»¥ä¼˜é›…åœ°è®°å½•é”™è¯¯ä¿¡æ¯ï¼Œå¹¶é€šçŸ¥è¿ç»´å›¢é˜Ÿã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">http</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ•…æ„æŠ›å‡ºä¸€ä¸ªé”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;An unexpected error occurred!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;uncaughtExceptionMonitor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">origin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è®°å½•é”™è¯¯æ—¥å¿—åˆ°æ—¥å¿—æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">appendFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/logfile.log&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‘é€é”™è¯¯è­¦æŠ¥åˆ°ç›‘æ§ç³»ç»Ÿ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾sendAlertæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°æ¥å‘é€è­¦æŠ¥</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  sendAlert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: An uncaught exception occurred!`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Server running on port 3000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤ä»£ç å¯åŠ¨äº†ä¸€ä¸ª HTTP æœåŠ¡å™¨ï¼Œä¸”æ•…æ„åœ¨è¯·æ±‚å¤„ç†ä¸­æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚é€šè¿‡<code>uncaughtExceptionMonitor</code>äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æ•è·è¿™ä¸ªé”™è¯¯ï¼Œå¹¶æ‰§è¡Œå¿…è¦çš„æ—¥å¿—è®°å½•å’Œè­¦æŠ¥é€šçŸ¥ï¼Œè€Œä¸ä¼šé˜»æ­¢é»˜è®¤çš„å¼‚å¸¸å¤„ç†é€»è¾‘ã€‚</p><h3 id="æ€»ç»“-2" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-2"><span>æ€»ç»“</span></a></h3><p><code>uncaughtExceptionMonitor</code>äº‹ä»¶æä¾›äº†ä¸€ç§çµæ´»çš„æ–¹æ³•æ¥ç›‘æ§å’Œå¤„ç†æœªæ•è·çš„å¼‚å¸¸ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥åœ¨ä¸æ”¹å˜åŸæœ‰è¡Œä¸ºçš„åŸºç¡€ä¸Šå¢åŠ é¢å¤–çš„é”™è¯¯å¤„ç†é€»è¾‘ã€‚è¿™å¯¹äºæ„å»ºç¨³å®šå’Œå¯é çš„ Node.js åº”ç”¨è‡³å…³é‡è¦ã€‚</p><h3 id="event-unhandledrejection" tabindex="-1"><a class="header-anchor" href="#event-unhandledrejection"><span><a href="https://nodejs.org/docs/latest/api/process.html#event-unhandledrejection" target="_blank" rel="noopener noreferrer">Event: &#39;unhandledRejection&#39;</a></span></a></h3><p>å½“ä½ åœ¨ä½¿ç”¨ JavaScript è¿›è¡Œç¼–ç¨‹ï¼Œå°¤å…¶æ˜¯åœ¨ Node.js ç¯å¢ƒä¸‹ï¼Œä½ ä¼šç»å¸¸ç”¨åˆ°â€œPromiseâ€ã€‚Promise æ˜¯ä¸€ä¸ªä»£è¡¨äº†å¼‚æ­¥æ“ä½œæœ€ç»ˆå®Œæˆæˆ–å¤±è´¥çš„å¯¹è±¡ã€‚åœ¨å¤„ç†å¼‚æ­¥æ“ä½œæ—¶ï¼Œæœ‰æ—¶ä¼šå‡ºç°é”™è¯¯æˆ–è€…è¢«æ‹’ç»çš„æƒ…å†µï¼Œå¹¶ä¸”è¿™äº›é”™è¯¯å¯èƒ½æ²¡æœ‰è¢«é€‚å½“åœ°æ•è·æˆ–å¤„ç†ã€‚è¿™å°±æ˜¯<code>unhandledRejection</code>äº‹ä»¶å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚</p><h3 id="unhandledrejectionäº‹ä»¶æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#unhandledrejectionäº‹ä»¶æ¦‚è¿°"><span><code>unhandledRejection</code>äº‹ä»¶æ¦‚è¿°</span></a></h3><p><code>unhandledRejection</code>äº‹ä»¶æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªç‰¹æ®Šäº‹ä»¶ï¼Œå®ƒåœ¨ Process å¯¹è±¡ä¸Šè§¦å‘ã€‚è¿™ä¸ªäº‹ä»¶çš„è§¦å‘åœºæ™¯æ˜¯ï¼šå½“ä¸€ä¸ª Promise è¢«æ‹’ç»ï¼Œå¹¶ä¸”å¯¹è¿™ä¸ªæ‹’ç»æ²¡æœ‰é™„åŠ ä»»ä½•å¤„ç†å™¨ï¼ˆå³.catch å¤„ç†å‡½æ•°ï¼‰æ—¶ï¼ŒNode.js ä¼šè§¦å‘<code>unhandledRejection</code>äº‹ä»¶ã€‚è¿™ç›¸å½“äºæ˜¯ Node.js ç»™ä½ çš„ä¸€ä¸ªè­¦å‘Šï¼Œå‘Šè¯‰ä½ æœ‰ä¸€ä¸ª Promise å¤±è´¥äº†ï¼Œä½†æ˜¯ä½ æ²¡æœ‰å¤„ç†è¿™ä¸ªå¤±è´¥ã€‚</p><h3 id="ä¸ºä»€ä¹ˆéœ€è¦å…³æ³¨è¿™ä¸ªäº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦å…³æ³¨è¿™ä¸ªäº‹ä»¶"><span>ä¸ºä»€ä¹ˆéœ€è¦å…³æ³¨è¿™ä¸ªäº‹ä»¶ï¼Ÿ</span></a></h3><p>æœªå¤„ç†çš„æ‹’ç»å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›æ„æƒ³ä¸åˆ°çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼ŒæŸäº›èµ„æºå¯èƒ½æ²¡æœ‰è¢«æ­£ç¡®æ¸…ç†ï¼Œæˆ–è€…ç¨‹åºå¯èƒ½ä»¥ä¸€ç§ä¸å¯é¢„æµ‹çš„æ–¹å¼ç»§ç»­æ‰§è¡Œã€‚é€šè¿‡ç›‘å¬<code>unhandledRejection</code>äº‹ä»¶ï¼Œä½ å¯ä»¥æ•è·è¿™äº›æœªå¤„ç†çš„æ‹’ç»æƒ…å†µï¼Œå¹¶é‡‡å–é€‚å½“çš„æªæ–½ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—ã€å°è¯•æ¢å¤æ“ä½œæˆ–è€…ä¼˜é›…åœ°åœæ­¢åº”ç”¨ç¨‹åºã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-1" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-1"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>åœ¨ Node.js ä»£ç ä¸­ï¼Œä½ å¯ä»¥è¿™æ ·ç›‘å¬<code>unhandledRejection</code>äº‹ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;unhandledRejection&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">reason</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æœªå¤„ç†çš„æ‹’ç»:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åŸå› :&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">reason</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åœ¨è¿™é‡Œå†™ä¸Šä½ çš„å¤„ç†é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¸­ï¼Œ<code>process.on</code>ç”¨äºæ·»åŠ ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œç›‘å¬<code>unhandledRejection</code>äº‹ä»¶ã€‚å½“è¿™ä¸ªäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå›è°ƒå‡½æ•°å°†è¢«è°ƒç”¨ï¼Œå…¶ä¸­<code>reason</code>å‚æ•°è¡¨ç¤ºæ‹’ç»çš„åŸå› ï¼Œè€Œ<code>promise</code>å‚æ•°åˆ™æ˜¯é‚£ä¸ªæœªè¢«å¤„ç†çš„ Promise å¯¹è±¡ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-3"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-è®°å½•æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è®°å½•æ—¥å¿—"><span>ç¤ºä¾‹ 1: è®°å½•æ—¥å¿—</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåº”ç”¨ï¼Œå®ƒä»å¤–éƒ¨ API è·å–æ•°æ®ã€‚å¦‚æœ API è°ƒç”¨å¤±è´¥å¹¶ä¸”è¿™ä¸ªå¤±è´¥æ²¡æœ‰è¢«æ•è·ï¼Œä½ å¯èƒ½å¸Œæœ›è‡³å°‘èƒ½å¤ŸçŸ¥é“è¿™ä¸ªå¤±è´¥çš„åŸå› ï¼Œä»¥ä¾¿äºè°ƒè¯•å’Œè®°å½•é”™è¯¯æ—¥å¿—ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;unhandledRejection&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">reason</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;APIè°ƒç”¨å¤±è´¥ï¼Œæœªå¤„ç†çš„Promise:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¤±è´¥åŸå› :&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">reason</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œå¯ä»¥å°†é”™è¯¯ä¿¡æ¯å†™å…¥æ—¥å¿—æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-å°è¯•é‡æ–°æ‰§è¡Œ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å°è¯•é‡æ–°æ‰§è¡Œ"><span>ç¤ºä¾‹ 2: å°è¯•é‡æ–°æ‰§è¡Œ</span></a></h4><p>å¦‚æœä½ è®¤ä¸º Promise çš„å¤±è´¥æ˜¯æš‚æ—¶æ€§çš„ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œä½ å¯èƒ½æƒ³è¦é‡æ–°å°è¯•æ‰§è¡Œå¤±è´¥çš„æ“ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;unhandledRejection&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">reason</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">warn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ“ä½œå¤±è´¥ï¼Œå°è¯•é‡æ–°æ‰§è¡Œ...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> someOperation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ“ä½œæˆåŠŸ!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;é‡è¯•å¤±è´¥:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç»“è®º-1" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-1"><span>ç»“è®º</span></a></h3><p><code>unhandledRejection</code>äº‹ä»¶æä¾›äº†ä¸€ä¸ªæ•è·å’Œå¤„ç†æœªå¤„ç† Promise æ‹’ç»çš„æœºä¼šï¼Œä½¿å¾—ä½ å¯ä»¥æ›´å¥½åœ°ç®¡ç†å’Œç»´æŠ¤ä½ çš„ Node.js åº”ç”¨ã€‚é€šè¿‡åˆç†åˆ©ç”¨è¿™ä¸ªäº‹ä»¶ï¼Œä½ å¯ä»¥æé«˜åº”ç”¨çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</p><h3 id="event-warning" tabindex="-1"><a class="header-anchor" href="#event-warning"><span><a href="https://nodejs.org/docs/latest/api/process.html#event-warning" target="_blank" rel="noopener noreferrer">Event: &#39;warning&#39;</a></span></a></h3><p>Node.js ä¸­çš„ <code>Event: &#39;warning&#39;</code> äº‹ä»¶æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„äº‹ä»¶ï¼Œå®ƒä¸ Node.js çš„å…¨å±€å¯¹è±¡ <code>process</code> ç›¸å…³ã€‚è¿™ä¸ªäº‹ä»¶æ˜¯å½“ Node.js è¿›ç¨‹é‡åˆ°å¯èƒ½å½±å“åº”ç”¨ç¨‹åºè¿è¡Œçš„æ½œåœ¨é—®é¢˜æ—¶è§¦å‘çš„ã€‚ç†è§£è¿™ä¸€ç‚¹å¯¹äºç¼–å†™æ›´å¥å£®ã€æ›´å¯é çš„ Node.js åº”ç”¨ç¨‹åºéå¸¸é‡è¦ã€‚</p><h3 id="ç†è§£-process-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#ç†è§£-process-å¯¹è±¡"><span>ç†è§£ <code>process</code> å¯¹è±¡</span></a></h3><p>é¦–å…ˆï¼Œäº†è§£ä¸€ä¸‹ <code>process</code> å¯¹è±¡ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>process</code> å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†ä¸å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹ç›¸å…³çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚ä½ å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡è·å–ç¯å¢ƒä¿¡æ¯ã€ç®¡ç†è¿›ç¨‹è¾“å…¥è¾“å‡ºã€ç›‘å¬è¿›ç¨‹äº‹ä»¶ç­‰ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-event-warning" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-event-warning"><span>ä»€ä¹ˆæ˜¯ <code>Event: &#39;warning&#39;</code></span></a></h3><p><code>Event: &#39;warning&#39;</code> æ˜¯ <code>process</code> å¯¹è±¡ä¸Šçš„ä¸€ä¸ªäº‹ä»¶ï¼Œå½“ Node.js æ£€æµ‹åˆ°æŸäº›å¯èƒ½ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºè¿è¡Œä¸ç¨³å®šæˆ–å­˜åœ¨å®‰å…¨é£é™©çš„æƒ…å†µæ—¶ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ã€‚è¿™åŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ul><li>ä½¿ç”¨åºŸå¼ƒï¼ˆdeprecatedï¼‰çš„ç‰¹æ€§</li><li>å†…å­˜ä½¿ç”¨è¿‡é«˜</li><li>æ¨èçš„ API ä½¿ç”¨æ–¹å¼è¢«è¿å</li></ul><h3 id="å¦‚ä½•ä½¿ç”¨-2" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-2"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>è¦ç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>process.on(&#39;warning&#39;, callback)</code> æ–¹æ³•ä¸º <code>warning</code> äº‹ä»¶æ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;warning&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">warning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è­¦å‘Šï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">warning</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> - </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">warning</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">warning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">stack</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“ <code>warning</code> äº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œå›è°ƒå‡½æ•°ä¼šæ¥æ”¶åˆ°ä¸€ä¸ª <code>Warning</code> å¯¹è±¡ï¼Œä½ å¯ä»¥ä»ä¸­è·å–è­¦å‘Šçš„åç§° (<code>name</code>)ã€æ¶ˆæ¯ (<code>message</code>) å’Œå †æ ˆè·Ÿè¸ª (<code>stack</code>)ã€‚ç„¶åï¼Œè¿™ä¸ªä¾‹å­ç®€å•åœ°å°†è­¦å‘Šä¿¡æ¯æ‰“å°åˆ°é”™è¯¯è¾“å‡ºä¸­ã€‚</p><h3 id="å®é™…åº”ç”¨ä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¸¾ä¾‹"><span>å®é™…åº”ç”¨ä¸¾ä¾‹</span></a></h3><ol><li><p><strong>æ£€æµ‹å†…å­˜ä½¿ç”¨æƒ…å†µ</strong>ï¼š<br> å‡è®¾ Node.js æ£€æµ‹åˆ°ä½ çš„åº”ç”¨ç¨‹åºæ­£åœ¨ä½¿ç”¨å¤§é‡å†…å­˜ï¼Œè¿™å¯èƒ½æ˜¯ç”±äºå†…å­˜æ³„æ¼é€ æˆçš„ï¼ŒNode.js å¯ä»¥è§¦å‘ <code>warning</code> äº‹ä»¶æ¥æé†’ä½ ã€‚</p></li><li><p><strong>ä½¿ç”¨å·²åºŸå¼ƒçš„ API æˆ–ç‰¹æ€§</strong>ï¼š<br> å¦‚æœä½ çš„ä»£ç ä¸­ä½¿ç”¨äº† Node.js æ ‡è®°ä¸ºåºŸå¼ƒçš„ API æˆ–ç‰¹æ€§ï¼ŒNode.js å¯ä»¥é€šè¿‡è§¦å‘ <code>warning</code> äº‹ä»¶æ¥é€šçŸ¥ä½ æ›´æ–°ä»£ç ã€‚</p></li><li><p><strong>ä¸æ¨èçš„ä½¿ç”¨æ–¹å¼</strong>ï¼š<br> å½“ä½ ä»¥ä¸€ç§ä¸æ¨èçš„æ–¹å¼ä½¿ç”¨æŸä¸ª API æ—¶ï¼ˆä¾‹å¦‚ï¼ŒæœªæŒ‰ç…§æ–‡æ¡£æ¨èçš„æ–¹å¼å¤„ç†å¼‚æ­¥æ“ä½œï¼‰ï¼ŒNode.js å¯ä»¥é€šè¿‡ <code>warning</code> äº‹ä»¶æ¥æé†’ä½ é‡‡å–æ›´å¥½çš„å®è·µã€‚</p></li></ol><h3 id="æ€»ç»“-3" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-3"><span>æ€»ç»“</span></a></h3><p><code>Event: &#39;warning&#39;</code> äº‹ä»¶æ˜¯ Node.js æä¾›çš„ä¸€ç§æœºåˆ¶ï¼Œç”¨äºåœ¨è¿›ç¨‹å¯èƒ½é‡åˆ°æ½œåœ¨é—®é¢˜æ—¶æé†’å¼€å‘è€…ã€‚é€šè¿‡ç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼Œå¼€å‘è€…å¯ä»¥åŠæ—¶å‘ç°å¹¶è§£å†³é—®é¢˜ï¼Œä½¿å¾—åº”ç”¨æ›´åŠ å¥å£®å’Œå®‰å…¨ã€‚å°½ç®¡è¿™ä¸ªäº‹ä»¶å¯èƒ½ä¸éœ€è¦åœ¨æ¯ä¸ªåº”ç”¨ç¨‹åºä¸­éƒ½è¢«ç›‘å¬ï¼Œä½†äº†è§£å®ƒçš„å­˜åœ¨å’Œä½œç”¨å¯¹äºæ„å»ºé«˜è´¨é‡çš„ Node.js åº”ç”¨è‡³å…³é‡è¦ã€‚</p><h4 id="emitting-custom-warnings" tabindex="-1"><a class="header-anchor" href="#emitting-custom-warnings"><span><a href="https://nodejs.org/docs/latest/api/process.html#emitting-custom-warnings" target="_blank" rel="noopener noreferrer">Emitting custom warnings</a></span></a></h4><p>ç†è§£ Node.js ä¸­çš„è‡ªå®šä¹‰è­¦å‘ŠåŠŸèƒ½ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€ä¸‹èƒŒæ™¯çŸ¥è¯†ã€‚Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“è¿è¡Œçš„ JavaScript ç¯å¢ƒï¼Œå¹¿æ³›åº”ç”¨äºæœåŠ¡å™¨ç«¯å’Œç½‘ç»œåº”ç”¨å¼€å‘ã€‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°éœ€è¦å‘ç”¨æˆ·æç¤ºæŸäº›ä¿¡æ¯ã€è­¦å‘Šæˆ–é”™è¯¯çš„æƒ…å†µã€‚Node.js æä¾›äº†ä¸€å¥—æœºåˆ¶ï¼Œä½¿å¾—å¼€å‘äººå‘˜èƒ½å¤Ÿç”Ÿæˆå¹¶å¤„ç†è¿™äº›ä¿¡æ¯ã€‚</p><h3 id="è‡ªå®šä¹‰è­¦å‘Šçš„æ„ä¹‰" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰è­¦å‘Šçš„æ„ä¹‰"><span>è‡ªå®šä¹‰è­¦å‘Šçš„æ„ä¹‰</span></a></h3><p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œ&quot;è­¦å‘Š&quot;é€šå¸¸æŒ‡çš„æ˜¯é‚£äº›ä¸è¶³ä»¥å¯¼è‡´ç¨‹åºåœæ­¢è¿è¡Œçš„é—®é¢˜ï¼Œä½†æ˜¯å¯èƒ½ä¼šå½±å“ç¨‹åºçš„æ­£ç¡®æ€§ã€æ€§èƒ½æˆ–è€…æœªæ¥çš„å…¼å®¹æ€§ã€‚é€šè¿‡å‘å‡ºè­¦å‘Šï¼Œå¯ä»¥å¼•èµ·å¼€å‘è€…çš„æ³¨æ„ï¼Œä¿ƒä½¿å…¶æ”¹æ­£æˆ–ä¼˜åŒ–ä»£ç ã€‚</p><h3 id="node-js-ä¸­å‘å‡ºè‡ªå®šä¹‰è­¦å‘Šçš„æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#node-js-ä¸­å‘å‡ºè‡ªå®šä¹‰è­¦å‘Šçš„æ–¹æ³•"><span>Node.js ä¸­å‘å‡ºè‡ªå®šä¹‰è­¦å‘Šçš„æ–¹æ³•</span></a></h3><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œå‘å‡ºè‡ªå®šä¹‰è­¦å‘Šä¸»è¦æ˜¯é€šè¿‡<code>process.emitWarning()</code>å‡½æ•°å®ç°çš„ã€‚è¿™ä¸ªå‡½æ•°å…è®¸ä½ æŒ‡å®šä¸€ä¸ªè­¦å‘Šä¿¡æ¯ï¼Œå¹¶ä¸”è¿˜å¯ä»¥æŒ‡å®šè­¦å‘Šçš„ç±»å‹å’Œä»£ç ç­‰è¯¦ç»†ä¿¡æ¯ã€‚</p><h3 id="å®é™…ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œè¯¥ç¨‹åºä¾èµ–äºä¸€ä¸ªå³å°†è¢«åºŸå¼ƒçš„ APIã€‚æˆ‘ä»¬å¸Œæœ›åœ¨ä»£ç ä¸­æ˜ç¡®æ ‡è®°å‡ºä½¿ç”¨è¯¥ API çš„åœ°æ–¹ï¼Œå¹¶ç»™å‡ºè­¦å‘Šï¼Œä»¥ä¾¿æœªæ¥è¿›è¡Œæ›¿æ¢æˆ–ç§»é™¤ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">deprecatedApi</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isUsed</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emitWarning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;DeprecatedAPI is used, please migrate to the new API.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    code</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;DeprecatedApiWarning&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    detail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      &quot;The DeprecatedAPI will be removed in future versions, it is recommended to use NewAPI instead.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ£€æŸ¥äº†<code>deprecatedApi.isUsed()</code>ï¼Œå¦‚æœè¿”å›<code>true</code>ï¼Œåˆ™è¯´æ˜æ—§çš„ API æ­£åœ¨è¢«ä½¿ç”¨ã€‚æ¥ç€ï¼Œæˆ‘ä»¬è°ƒç”¨<code>process.emitWarning()</code>å‡½æ•°ï¼Œä¼ å…¥è­¦å‘Šä¿¡æ¯ã€è­¦å‘Šä»£ç (<code>code</code>)å’Œè¯¦ç»†è¯´æ˜(<code>detail</code>)ã€‚è¿™æ ·ï¼Œå½“æ­¤æ®µä»£ç è¢«æ‰§è¡Œæ—¶ï¼Œå®ƒä¼šåœ¨æ§åˆ¶å°è¾“å‡ºä¸€ä¸ªæ ¼å¼åŒ–çš„è­¦å‘Šä¿¡æ¯ï¼Œæé†’å¼€å‘è€…æ³¨æ„åˆ°è¿™ä¸ªå³å°†è¢«åºŸå¼ƒçš„ API çš„ä½¿ç”¨æƒ…å†µã€‚</p><h3 id="æ›´å¤šåº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#æ›´å¤šåº”ç”¨åœºæ™¯"><span>æ›´å¤šåº”ç”¨åœºæ™¯</span></a></h3><ul><li><p><strong>é…ç½®æ–‡ä»¶æ ¼å¼å˜åŠ¨</strong>ï¼šå¦‚æœä½ çš„åº”ç”¨ç¨‹åºè¯»å–é…ç½®æ–‡ä»¶ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶çš„æ ¼å¼åœ¨æ–°ç‰ˆæœ¬ä¸­æœ‰æ‰€å˜åŠ¨ï¼Œä½ å¯ä»¥åœ¨è¯»å–æ—§æ ¼å¼æ—¶å‘å‡ºè­¦å‘Šã€‚</p></li><li><p><strong>æ€§èƒ½é—®é¢˜æç¤º</strong>ï¼šå½“æŸä¸ªæ“ä½œå› ä¸ºä¸æ¨èçš„ä½¿ç”¨æ–¹å¼å¯¼è‡´æ½œåœ¨çš„æ€§èƒ½é—®é¢˜æ—¶ï¼Œå‘å‡ºè­¦å‘Šã€‚</p></li><li><p><strong>å®‰å…¨æ¼æ´è­¦æŠ¥</strong>ï¼šåœ¨æ£€æµ‹åˆ°å¯èƒ½çš„å®‰å…¨é£é™©æˆ–ä¸å®‰å…¨çš„æ“ä½œæ—¶ï¼Œå‘å‡ºè­¦å‘Šã€‚</p></li></ul><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒNode.js ä¸ºå¼€å‘è€…æä¾›äº†ä¸€ç§çµæ´»ä¸”æœ‰æ•ˆçš„æ‰‹æ®µæ¥ç®¡ç†ä»£ç ä¸­çš„æ½œåœ¨é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿæœ‰åŠ©äºæå‡ä»£ç è´¨é‡å’Œç»´æŠ¤æ€§ã€‚</p><h4 id="node-js-warning-names" tabindex="-1"><a class="header-anchor" href="#node-js-warning-names"><span><a href="https://nodejs.org/docs/latest/api/process.html#nodejs-warning-names" target="_blank" rel="noopener noreferrer">Node.js warning names</a></span></a></h4><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å—æ¬¢è¿çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„è½¯ä»¶ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰å¾ˆå¤šå†…ç½®çš„è­¦å‘Šä¿¡æ¯ï¼Œç”¨æ¥é€šçŸ¥å¼€å‘è€…å¯èƒ½å­˜åœ¨çš„é—®é¢˜æˆ–ä¸å½“çš„ä½¿ç”¨æ–¹å¼ã€‚ä¸‹é¢æˆ‘å°†ä¼šè§£é‡Šä¸€ä¸‹ Node.js v21.7.1 ä¸­çš„â€œNode.js warning namesâ€ï¼Œå¹¶ç»™å‡ºä¸€äº›å®é™…çš„ä¾‹å­ã€‚</p><h3 id="node-js-warning-names-1" tabindex="-1"><a class="header-anchor" href="#node-js-warning-names-1"><span>Node.js Warning Names</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œè­¦å‘Šæ˜¯é€šè¿‡<code>process.on(&#39;warning&#39;, (warning) =&gt; {})</code>è¿™æ ·çš„äº‹ä»¶ç›‘å¬å™¨æ¥å¤„ç†çš„ã€‚è¿™é‡Œçš„<code>warning</code>å¯¹è±¡åŒ…å«äº†å‡ ä¸ªé‡è¦çš„å±æ€§ï¼š<code>name</code>, <code>message</code>, <code>code</code>, <code>stack</code>ç­‰ï¼Œå…¶ä¸­<code>name</code>å°±æ˜¯æ‰€è°“çš„&quot;Node.js warning names&quot;ã€‚è¿™äº›åå­—å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿåœ°è¯†åˆ«å‡ºè­¦å‘Šçš„ç±»å‹ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ Node.js è­¦å‘Šåå­—ä»¥åŠå®ƒä»¬çš„æ„ä¹‰ï¼š</p><ol><li><p><strong>DeprecationWarning</strong>: è¿™è¡¨æ˜æŸäº›æ­£åœ¨ä½¿ç”¨çš„åŠŸèƒ½å·²ç»è¢«åºŸå¼ƒï¼Œå¹¶å¯èƒ½åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­è¢«ç§»é™¤ã€‚ä½¿ç”¨åºŸå¼ƒçš„ç‰¹æ€§å¯èƒ½å¯¼è‡´ä»£ç åœ¨å°†æ¥çš„ Node.js ç‰ˆæœ¬ä¸­æ— æ³•æ­£å¸¸å·¥ä½œã€‚</p></li><li><p><strong>ExperimentalWarning</strong>: æ­¤è­¦å‘Šè¡¨æ˜ä½ æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªå®éªŒæ€§çš„åŠŸèƒ½ï¼Œè¿™æ„å‘³ç€è¯¥åŠŸèƒ½å¯èƒ½åœ¨æœªæ¥æ”¹å˜æˆ–å®Œå…¨ç§»é™¤ï¼Œå› æ­¤åº”è¯¥å°å¿ƒä½¿ç”¨ã€‚</p></li><li><p><strong>Warning</strong>: é™¤äº†ç‰¹å®šçš„è­¦å‘Šç±»å‹ï¼ˆå¦‚<code>DeprecationWarning</code>æˆ–<code>ExperimentalWarning</code>ï¼‰ä¹‹å¤–ï¼Œä¸€äº›å…¶ä»–ç±»å‹çš„é€šç”¨è­¦å‘Šä¹Ÿä¼šä½¿ç”¨ç®€å•çš„<code>Warning</code>åç§°ã€‚</p></li></ol><h3 id="å®é™…ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-1"><span>å®é™…ä¾‹å­</span></a></h3><h4 id="ä½¿ç”¨åºŸå¼ƒçš„åŠŸèƒ½-deprecationwarning" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åºŸå¼ƒçš„åŠŸèƒ½-deprecationwarning"><span>ä½¿ç”¨åºŸå¼ƒçš„åŠŸèƒ½ï¼ˆDeprecationWarningï¼‰</span></a></h4><p>å‡è®¾ Node.js å†³å®šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­ç§»é™¤æŸä¸ª APIï¼Œæ¯”å¦‚<code>url.parse()</code>å‡½æ•°ï¼ˆæ³¨æ„ï¼šè¿™åªæ˜¯ä¸€ä¸ªå‡æƒ³çš„ä¾‹å­ï¼‰ï¼Œå¦‚æœä½ çš„ä»£ç ä¸­ä»ç„¶ä½¿ç”¨äº†è¿™ä¸ªå‡½æ•°ï¼ŒNode.js å¯èƒ½ä¼šæ˜¾ç¤ºå¦‚ä¸‹çš„è­¦å‘Šä¿¡æ¯ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>(node:12345) [DEPXXXX] DeprecationWarning: url.parse() is deprecated.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™å‘Šè¯‰ä½ <code>url.parse()</code>æ–¹æ³•å·²è¢«åºŸå¼ƒï¼Œä½ åº”è¯¥å¯»æ‰¾æ›¿ä»£æ–¹æ¡ˆï¼Œæ¯”å¦‚ä½¿ç”¨æ–°çš„<code>URL</code>æ„é€ å‡½æ•°ã€‚</p><h4 id="ä½¿ç”¨å®éªŒæ€§åŠŸèƒ½-experimentalwarning" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨å®éªŒæ€§åŠŸèƒ½-experimentalwarning"><span>ä½¿ç”¨å®éªŒæ€§åŠŸèƒ½ï¼ˆExperimentalWarningï¼‰</span></a></h4><p>è€ƒè™‘åˆ° Node.js å¼•å…¥äº†ä¸€ä¸ªæ–°çš„å®éªŒæ€§ APIï¼Œåä¸º<code>experimentalFeature</code>ã€‚å¦‚æœä½ å°è¯•ä½¿ç”¨è¿™ä¸ªç‰¹æ€§ï¼ŒNode.js ä¼šäº§ç”Ÿç±»ä¼¼å¦‚ä¸‹çš„è­¦å‘Šï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>(node:12345) ExperimentalWarning: The experimentalFeature is an experimental feature. This feature could change at any time</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™ä¸ªè­¦å‘Šæé†’ä½ ï¼Œè¿™ä¸ªåŠŸèƒ½è¿˜åœ¨è¯•éªŒé˜¶æ®µï¼Œå°†æ¥å¯èƒ½ä¼šæœ‰æ”¹åŠ¨ã€‚</p><h3 id="å¤„ç†è­¦å‘Š" tabindex="-1"><a class="header-anchor" href="#å¤„ç†è­¦å‘Š"><span>å¤„ç†è­¦å‘Š</span></a></h3><p>å¤„ç† Node.js ä¸­çš„è­¦å‘Šé€šå¸¸æ¶‰åŠç›‘å¬<code>warning</code>äº‹ä»¶å¹¶å¯¹å…¶è¿›è¡Œé€‚å½“çš„å“åº”ã€‚ä¾‹å¦‚ï¼Œè®°å½•è­¦å‘Šè¯¦æƒ…æˆ–è€…æ ¹æ®è­¦å‘Šç±»å‹é‡‡å–ä¸åŒçš„è¡ŒåŠ¨ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•æ•è·å¹¶å¤„ç†è­¦å‘Šï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;warning&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">warning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">warn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è­¦å‘Šåç§°: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">warning</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">warn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è­¦å‘Šä¿¡æ¯: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">warning</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ•…æ„è§¦å‘ä¸€ä¸ªåºŸå¼ƒè­¦å‘Šï¼Œä»…ä½œä¸ºç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asyncReadFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç æ¼”ç¤ºäº†å¦‚ä½•ç›‘å¬å¹¶æ‰“å°å‡ºè­¦å‘Šçš„åç§°å’Œä¿¡æ¯ï¼Œä»è€Œè®©å¼€å‘è€…èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å’Œå¤„ç†ç¨‹åºä¸­å‡ºç°çš„è­¦å‘Šã€‚</p><h3 id="event-worker" tabindex="-1"><a class="header-anchor" href="#event-worker"><span><a href="https://nodejs.org/docs/latest/api/process.html#event-worker" target="_blank" rel="noopener noreferrer">Event: &#39;worker&#39;</a></span></a></h3><p>Node.js çš„<code>Event: &#39;worker&#39;</code>æ˜¯ä¸€ä¸ªåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œç‰¹åˆ«æ˜¯å½“ä½¿ç”¨ Worker Threads æ¨¡å—æ—¶è§¦å‘çš„äº‹ä»¶ã€‚å®ƒæ˜¯ Node.js ä¸ºäº†æ›´å¥½åœ°æ”¯æŒå¤šçº¿ç¨‹è€Œæä¾›çš„ä¸€ç§æœºåˆ¶ã€‚åœ¨è§£é‡Šè¿™ä¸ªæ¦‚å¿µä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç®€è¦äº†è§£ä¸€äº›èƒŒæ™¯çŸ¥è¯†ã€‚</p><h3 id="èƒŒæ™¯çŸ¥è¯†" tabindex="-1"><a class="header-anchor" href="#èƒŒæ™¯çŸ¥è¯†"><span>èƒŒæ™¯çŸ¥è¯†</span></a></h3><ol><li><p><strong>Node.js æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p>Node.js æ˜¯ä¸€ä¸ªå¼€æºã€è·¨å¹³å°çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå¯ä»¥è®©ä½ ä½¿ç”¨ JavaScript ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚å®ƒæ˜¯å»ºç«‹åœ¨ Chrome çš„ V8 JavaScript å¼•æ“ä¸Šçš„ï¼Œå› æ­¤å®ƒéå¸¸å¿«ã€‚Node.js é‡‡ç”¨äº‹ä»¶é©±åŠ¨ã€éé˜»å¡ I/O æ¨¡å‹ï¼Œä½¿å…¶è½»é‡åˆé«˜æ•ˆã€‚</p></li><li><p><strong>å¤šçº¿ç¨‹å’Œ Worker Threadsï¼š</strong></p><p>åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œå¤šçº¿ç¨‹æ˜¯å¹¶å‘æ‰§è¡Œçš„æ¦‚å¿µï¼Œå³åœ¨åŒä¸€æ—¶åˆ»å¯ä»¥æœ‰å¤šä¸ªä¸åŒçš„çº¿ç¨‹æ‰§è¡Œï¼Œè¿™å¯ä»¥æ˜¾è‘—æé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œå“åº”é€Ÿåº¦ã€‚Node.js ä¸»è¦æ˜¯å•çº¿ç¨‹çš„ï¼Œä½†å®ƒé€šè¿‡<code>Worker Threads</code>æ¨¡å—æ”¯æŒå¤šçº¿ç¨‹ã€‚<code>Worker Threads</code>å…è®¸ Node.js åœ¨åå°è¿è¡Œ JavaScript æ“ä½œè€Œä¸å½±å“ä¸»çº¿ç¨‹ã€‚</p></li></ol><h3 id="event-worker-è¯¦ç»†è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#event-worker-è¯¦ç»†è¯´æ˜"><span><code>Event: &#39;worker&#39;</code> è¯¦ç»†è¯´æ˜</span></a></h3><p><code>Event: &#39;worker&#39;</code>æ˜¯ process å¯¹è±¡çš„ä¸€ä¸ªäº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶åœ¨ä¸€ä¸ªæ–°çš„ Worker çº¿ç¨‹è¢«åˆ›å»ºæ—¶è§¦å‘ã€‚è¿™é‡Œçš„â€œWorkerâ€æŒ‡çš„å°±æ˜¯é€šè¿‡<code>Worker Threads</code>æ¨¡å—åˆ›å»ºçš„ä¸€ä¸ªåå°çº¿ç¨‹ã€‚é€šè¿‡ç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼Œå¼€å‘è€…å¯ä»¥çŸ¥é“ä½•æ—¶æœ‰æ–°çš„ Worker çº¿ç¨‹è¢«åˆ›å»ºï¼Œå¹¶æ‰§è¡Œä¸€äº›é€»è¾‘ï¼Œæ¯”å¦‚è¿›è¡Œæ—¥å¿—è®°å½•æˆ–èµ„æºåˆ†é…ç­‰ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-2"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨éœ€è¦å¤„ç†å¤§é‡çš„æ•°æ®å¤„ç†ä»»åŠ¡ï¼Œè€Œè¿™äº›ä»»åŠ¡æ˜¯è®¡ç®—å¯†é›†å‹çš„ï¼Œå¯èƒ½ä¼šé˜»å¡ä½ çš„ä¸»çº¿ç¨‹ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œä½ å†³å®šä½¿ç”¨<code>Worker Threads</code>æ¥å°†è¿™äº›ä»»åŠ¡ç§»åˆ°åå°çº¿ç¨‹æ‰§è¡Œã€‚åŒæ—¶ï¼Œä½ å¸Œæœ›æ¯å½“æœ‰æ–°çš„å·¥ä½œçº¿ç¨‹å¯åŠ¨æ—¶ï¼Œéƒ½è®°å½•ä¸€ä¸‹æ—¥å¿—ã€‚</p><p><strong>æ­¥éª¤ 1:</strong> å¼•å…¥å¿…è¦çš„æ¨¡å—</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">Worker</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">isMainThread</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;worker_threads&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 2:</strong> ç›‘å¬<code>&#39;worker&#39;</code>äº‹ä»¶</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isMainThread</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;worker&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–°çš„Workerçº¿ç¨‹è¢«åˆ›å»ºäº†ã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åˆ›å»ºä¸€ä¸ªæ–°çš„Workerçº¿ç¨‹å»å¤„ç†ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> worker</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Worker</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./path/to/your/worker/script.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // Workerçº¿ç¨‹çš„ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œæ”¾ç½®ä½ æƒ³åœ¨çº¿ç¨‹ä¸­æ‰§è¡Œçš„ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•ç›‘å¬<code>&#39;worker&#39;</code>äº‹ä»¶å¹¶åœ¨æ§åˆ¶å°æ‰“å°ä¿¡æ¯ã€‚è¯·æ³¨æ„ï¼Œè¿™ä¸ªä¾‹å­æ˜¯ç”¨æ¥è¯´æ˜æ¦‚å¿µçš„ï¼›æˆªè‡³æˆ‘æ‰€çŸ¥çš„æœ€æ–° Node.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åœ¨<code>process</code>å¯¹è±¡ä¸Šæš´éœ²åä¸º<code>&#39;worker&#39;</code>çš„äº‹ä»¶ã€‚è¿™æ„å‘³ç€å®é™…çš„ API æˆ–å®ç°æ–¹å¼å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œå–å†³äº Node.js çš„ç‰ˆæœ¬å’Œç›¸å…³æ–‡æ¡£ã€‚å› æ­¤ï¼Œå½“ä½ åœ¨å®é™…é¡¹ç›®ä¸­å°è¯•ä½¿ç”¨ç±»ä¼¼åŠŸèƒ½æ—¶ï¼Œå¼ºçƒˆå»ºè®®æŸ¥é˜…æœ€æ–°çš„ Node.js å®˜æ–¹æ–‡æ¡£æ¥è·å–å‡†ç¡®çš„ä¿¡æ¯å’ŒæŒ‡å¯¼ã€‚</p><h3 id="signal-events" tabindex="-1"><a class="header-anchor" href="#signal-events"><span><a href="https://nodejs.org/docs/latest/api/process.html#signal-events" target="_blank" rel="noopener noreferrer">Signal events</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©ä½ èƒ½åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªå…¨å±€å¯¹è±¡å« <code>process</code>ï¼Œå®ƒæä¾›äº†ä¸å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹äº’åŠ¨çš„æ¥å£ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†åŠŸèƒ½æ˜¯å¤„ç†æ“ä½œç³»ç»Ÿä¿¡å·ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯ä¿¡å·" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯ä¿¡å·"><span>ä»€ä¹ˆæ˜¯ä¿¡å·ï¼Ÿ</span></a></h3><p>åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œä¿¡å·æ˜¯ä¸€ç§é€šçŸ¥æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æŸä¸ªäº‹ä»¶å·²ç»å‘ç”Ÿçš„æœºåˆ¶ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å‘é€ä¸€ä¸ªä¿¡å·å‘Šè¯‰è¿›ç¨‹ä¼˜é›…åœ°åœæ­¢è¿è¡Œï¼ˆå¦‚ï¼šSIGTERMï¼‰ï¼Œæˆ–è€…å‘Šè¯‰å®ƒç«‹å³åœæ­¢ï¼ˆå¦‚ï¼šSIGKILLï¼‰ã€‚</p><h3 id="signal-events-in-node-js" tabindex="-1"><a class="header-anchor" href="#signal-events-in-node-js"><span>Signal Events in Node.js</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code> å¯¹è±¡å¯ä»¥ç”¨æ¥æ•è·å’Œå¤„ç†è¿™äº›ä¿¡å·ã€‚Node.js æ”¯æŒå¤šç§ä¿¡å·ï¼Œæ¯ç§ä¿¡å·éƒ½å¯¹åº”ä¸åŒçš„äº‹ä»¶ã€‚å½“ Node.js è¿›ç¨‹æ¥æ”¶åˆ°ç‰¹å®šçš„ä¿¡å·æ—¶ï¼Œå®ƒä¼šè§¦å‘ç›¸åº”çš„äº‹ä»¶ã€‚</p><p>è¿™æ„å‘³ç€ä½ å¯ä»¥ä¸ºè¿™äº›ä¿¡å·äº‹ä»¶æ³¨å†Œç›‘å¬å™¨ï¼ˆå³å›è°ƒå‡½æ•°ï¼‰ï¼Œå½“ä¿¡å·è¢«æ¥æ”¶æ—¶ï¼Œæ‰§è¡Œç›¸å…³çš„ä»£ç é€»è¾‘ã€‚è¿™åœ¨ä½ éœ€è¦æ¸…ç†èµ„æºã€ä¿å­˜çŠ¶æ€æˆ–è€…æ‰§è¡Œå…¶ä»–åœ¨è¿›ç¨‹ç»“æŸå‰éœ€è¦å®Œæˆçš„ä»»åŠ¡æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-1"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-ä¼˜é›…åœ°åœæ­¢æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ä¼˜é›…åœ°åœæ­¢æœåŠ¡"><span>ç¤ºä¾‹ 1ï¼šä¼˜é›…åœ°åœæ­¢æœåŠ¡</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªè¿è¡Œç€ Web æœåŠ¡å™¨çš„ Node.js åº”ç”¨ã€‚å¦‚æœä½ æƒ³åœ¨åœæ­¢æœåŠ¡å™¨ä¹‹å‰ä¿å­˜æ—¥å¿—æˆ–è€…å…³é—­æ•°æ®åº“è¿æ¥ï¼Œä½ å¯ä»¥ç›‘å¬ SIGTERM ä¿¡å·ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SIGTERM&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Received SIGTERM, shutting down gracefully...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">close</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Server closed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // åœ¨è¿™é‡Œå¯ä»¥æ‰§è¡Œå…¶ä»–æ¸…ç†å·¥ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šåœ¨æ”¶åˆ° SIGTERM ä¿¡å·æ—¶å¼€å§‹æ‰§è¡Œã€‚é¦–å…ˆï¼Œå®ƒå°è¯•ä¼˜é›…åœ°å…³é—­æœåŠ¡å™¨ã€‚æœåŠ¡å™¨å…³é—­åï¼Œå®ƒä¼šæ‰“å°æ¶ˆæ¯ï¼Œå¹¶è¿›è¡Œè¿›ç¨‹é€€å‡ºå‰çš„æ¸…ç†å·¥ä½œã€‚</p><h4 id="ç¤ºä¾‹-2-å¤„ç†æœªé¢„æœŸçš„é€€å‡º" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å¤„ç†æœªé¢„æœŸçš„é€€å‡º"><span>ç¤ºä¾‹ 2ï¼šå¤„ç†æœªé¢„æœŸçš„é€€å‡º</span></a></h4><p>æœ‰æ—¶å€™ï¼Œä½ å¯èƒ½æƒ³è¦åœ¨è¿›ç¨‹å› æ¥æ”¶åˆ°æŸäº›ä¿¡å·è€Œé€€å‡ºå‰ï¼Œæ‰§è¡Œä¸€äº›é€»è¾‘ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½æƒ³è®°å½•ä¸€æ¡æ—¥å¿—ï¼ŒæŒ‡å‡ºè¿›ç¨‹æ˜¯ç”±äºæ¥æ”¶åˆ°å“ªä¸ªä¿¡å·è€Œç»ˆæ­¢çš„ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SIGINT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Received SIGINT. Process terminated.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ‰§è¡Œä»»ä½•æ¸…ç†å·¥ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SIGUSR1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Received SIGUSR1. Perform specific tasks.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ ¹æ®SIGUSR1ä¿¡å·æ‰§è¡Œç‰¹å®šä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¬¬ä¸€æ®µä»£ç ç›‘å¬ SIGINT ä¿¡å·ï¼Œé€šå¸¸æ˜¯é€šè¿‡ Ctrl+C åœ¨å‘½ä»¤è¡Œä¸­å‘å‡ºçš„ã€‚ç¬¬äºŒæ®µä»£ç ç›‘å¬ SIGUSR1 ä¿¡å·ï¼Œè¿™é€šå¸¸æ˜¯è‡ªå®šä¹‰ä¿¡å·ï¼Œç”¨äºç‰¹å®šç›®çš„ã€‚</p><h3 id="æ€»ç»“-4" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-4"><span>æ€»ç»“</span></a></h3><p>Node.js é€šè¿‡ <code>process</code> å¯¹è±¡æä¾›äº†ä¸€ç§å¤„ç†æ“ä½œç³»ç»Ÿä¿¡å·çš„æ–¹å¼ã€‚åˆ©ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œä½ å¯ä»¥ç¼–å†™ä»£ç ä»¥ä¼˜é›…åœ°å“åº”å¤–éƒ¨ä¸­æ–­è¯·æ±‚ï¼Œæˆ–åœ¨è¿›ç¨‹ç»“æŸå‰æ‰§è¡Œå¿…è¦çš„æ¸…ç†å·¥ä½œã€‚æ­£ç¡®ç®¡ç†ä¿¡å·å¯ä»¥ä½¿ä½ çš„åº”ç”¨æ›´åŠ å¥å£®å’Œå¯é ã€‚</p><h2 id="process-abort" tabindex="-1"><a class="header-anchor" href="#process-abort"><span><a href="https://nodejs.org/docs/latest/api/process.html#processabort" target="_blank" rel="noopener noreferrer">process.abort()</a></span></a></h2><p>å¥½çš„ï¼Œæ¥è®²è§£ä¸€ä¸‹ <code>process.abort()</code> è¿™ä¸ªæ–¹æ³•åœ¨ Node.js ä¸­çš„ä½¿ç”¨ä»¥åŠæ„ä¹‰ï¼Œè¿™ä¼šå¸®åŠ©ä½ ç†è§£å…¶åœ¨å®é™…å¼€å‘ä¸­çš„åº”ç”¨ã€‚</p><h3 id="process-abort-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#process-abort-ç®€ä»‹"><span><code>process.abort()</code> ç®€ä»‹</span></a></h3><p>é¦–å…ˆï¼Œ<code>process</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å…è®¸ä½ ä¸è¯¥è¿›ç¨‹äº’åŠ¨ã€‚<code>process.abort()</code> æ˜¯ <code>process</code> å¯¹è±¡æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨éå¸¸ç›´æ¥â€”â€”ç«‹å³ç»ˆæ­¢å½“å‰ Node.js è¿›ç¨‹ã€‚</p><p>è°ƒç”¨ <code>process.abort()</code> åï¼ŒNode.js è¿›ç¨‹ä¼šç«‹åˆ»åœæ­¢æ‰§è¡Œï¼Œä¸ä¼šæ‰§è¡Œä»»ä½•å°šæœªå®Œæˆçš„å¼‚æ­¥æ“ä½œã€å®šæ—¶å™¨æˆ–ä»»ä½•å…¶ä»–å›è°ƒå‡½æ•°ã€‚æ­¤å¤–ï¼Œè¿™ä¹Ÿä¼šå¯¼è‡´ Node.js è¿›ç¨‹é€€å‡ºå¹¶ç”Ÿæˆä¸€ä¸ªæ ¸å¿ƒè½¬å‚¨æ–‡ä»¶ï¼ˆcore dumpï¼‰ï¼Œè¿™ä¸ªæ–‡ä»¶å¯¹äºåç»­çš„è°ƒè¯•éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒåŒ…å«äº†è¿›ç¨‹ç»ˆæ­¢æ—¶çš„å†…å­˜å¿«ç…§ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-4"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><ul><li><p><strong>è°ƒè¯•å’Œé”™è¯¯åˆ†æ</strong></p><p>å‡å¦‚ä½ åœ¨å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜ï¼Œç¨‹åºåœ¨æŸäº›æ¡ä»¶ä¸‹å¼‚å¸¸å´©æºƒï¼Œä½†æ˜¯ä½ å¾ˆéš¾å‡†ç¡®åœ°æ‰¾å‡ºæ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜ã€‚ä½¿ç”¨ <code>process.abort()</code> å¯ä»¥åœ¨ä½ é¢„è®¾çš„æ¡ä»¶æ»¡è¶³æ—¶ä¸»åŠ¨ç»ˆæ­¢è¿›ç¨‹ï¼Œå¹¶ç”Ÿæˆæ ¸å¿ƒè½¬å‚¨æ–‡ä»¶ã€‚é€šè¿‡åˆ†æè¿™ä¸ªæ–‡ä»¶ï¼Œä½ å¯èƒ½ä¼šæ›´å®¹æ˜“æ‰¾åˆ°é—®é¢˜æ ¹æºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">someUnexpectedCondition</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">abort</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸»åŠ¨ç»ˆæ­¢è¿›ç¨‹ï¼Œç”Ÿæˆæ ¸å¿ƒè½¬å‚¨æ–‡ä»¶è¿›è¡Œè°ƒè¯•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ç³»ç»Ÿèµ„æºä¿æŠ¤</strong></p><p>åœ¨ä¸€äº›é«˜å¯ç”¨æ€§è¦æ±‚çš„åº”ç”¨ä¸­ï¼Œå¦‚æœæ£€æµ‹åˆ°å†…å­˜æ³„æ¼æˆ–è€…æŸäº›å…³é”®èµ„æºçš„å¼‚å¸¸å ç”¨ï¼Œå¯èƒ½éœ€è¦ç«‹å³åœæ­¢æœåŠ¡ï¼Œä»¥é˜²æ­¢é”™è¯¯ç´¯ç§¯å¯¼è‡´æ•´ä¸ªç³»ç»Ÿå´©æºƒã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥åœ¨æ£€æµ‹åˆ°å¼‚å¸¸æŒ‡æ ‡æ—¶ä½¿ç”¨ <code>process.abort()</code> æ¥å¿«é€Ÿå“åº”ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">checkSystemHealth</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">health</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">health</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ok</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç³»ç»Ÿèµ„æºå¼‚å¸¸ï¼Œç«‹å³ç»ˆæ­¢è¿›ç¨‹&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">abort</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="æ€»ç»“-5" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-5"><span>æ€»ç»“</span></a></h3><p>è™½ç„¶ <code>process.abort()</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬åœ¨ç‰¹å®šæ¡ä»¶ä¸‹å¿«é€Ÿâ€œè‡ªæ€â€è¿›ç¨‹ä»¥ä¾¿äºè°ƒè¯•æˆ–é˜²æ­¢æ›´å¤§çš„æŸå¤±ï¼Œä½†å®ƒä¹Ÿæ˜¯ä¸€ä¸ªâ€œå±é™©â€çš„æ“ä½œã€‚å› ä¸ºå®ƒä¼šç«‹å³åœæ­¢æ‰€æœ‰æ­£åœ¨è¿›è¡Œçš„æ“ä½œï¼Œä¸ä¿è¯è¿›ç¨‹çš„ä¼˜é›…é€€å‡ºã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨æ—¶ï¼Œéœ€è¦éå¸¸è°¨æ…ï¼Œé€šå¸¸åªåœ¨æ— æ³•æ¢å¤çš„é”™è¯¯æˆ–èµ„æºå¼‚å¸¸æ—¶ä½œä¸ºæœ€åçš„æ‰‹æ®µã€‚</p><p>å¸Œæœ›ä»¥ä¸Šè§£é‡Šå’Œç¤ºä¾‹å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚</p><h2 id="process-allowednodeenvironmentflags" tabindex="-1"><a class="header-anchor" href="#process-allowednodeenvironmentflags"><span><a href="https://nodejs.org/docs/latest/api/process.html#processallowednodeenvironmentflags" target="_blank" rel="noopener noreferrer">process.allowedNodeEnvironmentFlags</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªèƒ½è®©å¼€å‘è€…ä½¿ç”¨ JavaScript è¯­è¨€è¿›è¡ŒæœåŠ¡å™¨ç«¯ç¼–ç¨‹çš„ç¯å¢ƒã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªå…¨å±€å¯¹è±¡å« <code>process</code>ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—å±æ€§å’Œæ–¹æ³•ï¼Œç”¨äºä¸å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹äº’åŠ¨ã€‚</p><h3 id="process-allowednodeenvironmentflags-1" tabindex="-1"><a class="header-anchor" href="#process-allowednodeenvironmentflags-1"><span>process.allowedNodeEnvironmentFlags</span></a></h3><p>åœ¨ Node.js çš„æŸäº›ç‰ˆæœ¬ä¸­ï¼ŒåŒ…æ‹¬ v21.7.1ï¼Œ<code>process.allowedNodeEnvironmentFlags</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§ã€‚è¿™ä¸ªå±æ€§è¿”å›ä¸€ä¸ªé›†åˆï¼ˆå®é™…ä¸Šæ˜¯ä¸€ä¸ª <code>Set</code> å¯¹è±¡ï¼‰ï¼Œè¿™ä¸ªé›†åˆé‡ŒåŒ…å«äº†æ‰€æœ‰è¢« Node.js è®¤å¯å¹¶æ¥å—çš„ç¯å¢ƒæ ‡å¿—ï¼ˆenvironment flagsï¼‰ã€‚</p><p>ç¯å¢ƒæ ‡å¿—æ˜¯åœ¨å¯åŠ¨ Node.js è¿›ç¨‹æ—¶é€šè¿‡å‘½ä»¤è¡Œä¼ é€’ç»™ Node.js çš„ç‰¹æ®Šå‚æ•°ã€‚è¿™äº›å‚æ•°é€šå¸¸ç”¨äºè°ƒæ•´ Node.js è¿è¡Œæ—¶çš„è¡Œä¸ºæˆ–æ¨¡å¼ï¼Œä¾‹å¦‚å¼€å¯æ›´è¯¦ç»†çš„æ—¥å¿—ã€é€‰æ‹©ä¸åŒçš„åƒåœ¾å›æ”¶ç­–ç•¥ç­‰ã€‚</p><h4 id="å®é™…è¿ç”¨ç¤ºä¾‹-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-5"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h4><ol><li><p><strong>æ£€æŸ¥ç‰¹å®šçš„ç¯å¢ƒæ ‡å¿—æ˜¯å¦è¢«å…è®¸</strong></p><p>å‡è®¾ä½ æƒ³çŸ¥é“ <code>--inspect</code> æ ‡å¿—ï¼ˆä¸€ç§ä½¿å¾— Node.js è¿›ç¨‹å¯è¢«è°ƒè¯•å™¨è¿æ¥çš„æ ‡å¿—ï¼‰æ˜¯å¦è¢« Node.js ç‰ˆæœ¬æ”¯æŒã€‚ä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">allowedNodeEnvironmentFlags</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">has</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;--inspect&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯¥ Node.js ç‰ˆæœ¬æ”¯æŒ --inspect æ ‡å¿—ã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯¥ Node.js ç‰ˆæœ¬ä¸æ”¯æŒ --inspect æ ‡å¿—ã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æšä¸¾æ‰€æœ‰è¢«æ”¯æŒçš„ç¯å¢ƒæ ‡å¿—</strong></p><p>å¦‚æœä½ å¯¹å“ªäº›ç¯å¢ƒæ ‡å¿—è¢«å½“å‰çš„ Node.js ç‰ˆæœ¬æ”¯æŒæ„Ÿåˆ°å¥½å¥‡ï¼Œå¯ä»¥é‡‡ç”¨å¦‚ä¸‹ä»£ç æ¥åˆ—å‡ºæ‰€æœ‰è¢«æ”¯æŒçš„æ ‡å¿—ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ”¯æŒçš„ç¯å¢ƒæ ‡å¿—åŒ…æ‹¬:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">allowedNodeEnvironmentFlags</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">flag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">flag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>åœ¨è„šæœ¬ä¸­åŸºäºæ”¯æŒçš„ç¯å¢ƒæ ‡å¿—è¿›è¡Œæ¡ä»¶æ“ä½œ</strong></p><p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œä½ å¯èƒ½éœ€è¦æ ¹æ®æ˜¯å¦æ”¯æŒæŸä¸ªç¯å¢ƒæ ‡å¿—æ¥å†³å®šè„šæœ¬çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„ç¨‹åºä¾èµ–äºæŸä¸ªç‰¹å®šçš„åƒåœ¾å›æ”¶ç­–ç•¥ï¼Œä½†è¿™ä¸ªç­–ç•¥é€šè¿‡ä¸€ä¸ªç¯å¢ƒæ ‡å¿—æ¥å¯ç”¨ï¼Œå¹¶ä¸”ä¸æ˜¯æ‰€æœ‰çš„ Node.js ç‰ˆæœ¬éƒ½æ”¯æŒè¿™ä¸ªæ ‡å¿—ï¼Œä½ å°±å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">allowedNodeEnvironmentFlags</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">has</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;--some-gc-flag&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¯åŠ¨å¸¦æœ‰ç‰¹å®šåƒåœ¾å›æ”¶ç­–ç•¥çš„ Node.js ç¨‹åº</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¯åŠ¨å¸¦ç‰¹æ®Šåƒåœ¾å›æ”¶ç­–ç•¥...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä¸æ”¯æŒæ—¶çš„å¤‡é€‰æ–¹æ¡ˆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å½“å‰ Node.js ç‰ˆæœ¬ä¸æ”¯æŒç‰¹å®šçš„åƒåœ¾å›æ”¶ç­–ç•¥ã€‚ä½¿ç”¨é»˜è®¤ç­–ç•¥...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>æ€»è€Œè¨€ä¹‹ï¼Œ<code>process.allowedNodeEnvironmentFlags</code> æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿåœ¨ä»£ç ä¸­æŸ¥è¯¢å’Œåˆ©ç”¨é‚£äº›è¢«å½“å‰ Node.js ç¯å¢ƒæ”¯æŒçš„ç¯å¢ƒæ ‡å¿—ï¼Œä»è€Œç¼–å†™æ›´åŠ çµæ´»å’Œé€‚åº”æ€§å¼ºçš„ä»£ç ã€‚</p><h2 id="process-arch" tabindex="-1"><a class="header-anchor" href="#process-arch"><span><a href="https://nodejs.org/docs/latest/api/process.html#processarch" target="_blank" rel="noopener noreferrer">process.arch</a></span></a></h2><p>Node.js ä¸­çš„<code>process.arch</code>å±æ€§ç”¨äºè·å–æ­£åœ¨è¿è¡Œ Node.js è¿›ç¨‹çš„æ“ä½œç³»ç»Ÿæ¶æ„ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå®ƒå¯ä»¥å‘Šè¯‰ä½ å½“å‰ Node.js ä»£ç æ˜¯åœ¨å“ªç§ç±»å‹çš„ CPU ä¸Šæ‰§è¡Œçš„ã€‚è¿™ä¸ªä¿¡æ¯å¯¹äºæŸäº›ç‰¹å®šæƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚å½“ä½ éœ€è¦æ ¹æ®ä¸åŒçš„æ¶æ„åŠ è½½ä¸åŒçš„äºŒè¿›åˆ¶æ¨¡å—æˆ–è€…è¿›è¡Œç‰¹å®šçš„ä¼˜åŒ–æ—¶ã€‚</p><h3 id="å¸¸è§çš„æ¶æ„å€¼" tabindex="-1"><a class="header-anchor" href="#å¸¸è§çš„æ¶æ„å€¼"><span>å¸¸è§çš„æ¶æ„å€¼</span></a></h3><ul><li><code>x64</code>ï¼šè¡¨ç¤º 64 ä½çš„ x86 æ¶æ„ï¼ˆå¤§å¤šæ•°ç°ä»£ç”µè„‘å’ŒæœåŠ¡å™¨ï¼‰</li><li><code>arm</code>ï¼šè¡¨ç¤º ARM æ¶æ„ï¼ˆè®¸å¤šç§»åŠ¨è®¾å¤‡å’Œä¸€äº›è½»é‡çº§æˆ–ä¸“ç”¨ç¡¬ä»¶ï¼‰</li><li><code>ia32</code>ï¼šè¡¨ç¤º 32 ä½çš„ x86 æ¶æ„</li></ul><h3 id="å¦‚ä½•ä½¿ç”¨process-arch" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨process-arch"><span>å¦‚ä½•ä½¿ç”¨<code>process.arch</code></span></a></h3><p>åœ¨ Node.js ä»£ç ä¸­ä½¿ç”¨<code>process.arch</code>éå¸¸ç®€å•ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŸºæœ¬ç¤ºä¾‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™è¡Œä»£ç ä¼šè¾“å‡ºå½“å‰è¿è¡Œ Node.js ç¨‹åºçš„ CPU æ¶æ„ï¼Œä¾‹å¦‚<code>x64</code>ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-6" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-6"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="_1-åŠ è½½ç‰¹å®šæ¶æ„çš„äºŒè¿›åˆ¶æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_1-åŠ è½½ç‰¹å®šæ¶æ„çš„äºŒè¿›åˆ¶æ¨¡å—"><span>1. åŠ è½½ç‰¹å®šæ¶æ„çš„äºŒè¿›åˆ¶æ¨¡å—</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦ä¸ C++åº“äº¤äº’çš„åº”ç”¨ã€‚ç”±äºä¸åŒæ¶æ„çš„äºŒè¿›åˆ¶å…¼å®¹æ€§é—®é¢˜ï¼Œä½ å¯èƒ½éœ€è¦ä¸ºæ¯ç§æ¶æ„ç¼–è¯‘ä¸€ä¸ªä¸åŒçš„ç‰ˆæœ¬ã€‚é‚£ä¹ˆï¼Œä½ å°±å¯ä»¥ä½¿ç”¨<code>process.arch</code>æ¥å†³å®šåŠ è½½å“ªä¸ªç‰ˆæœ¬çš„åº“ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> nativeAddon</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arch</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;x64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  nativeAddon</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./build/x64/myaddon.node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arch</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;arm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  nativeAddon</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./build/arm/myaddon.node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Unsupported architecture: &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç„¶åä½¿ç”¨nativeAddonè¿›è¡Œåç»­æ“ä½œ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-æ€§èƒ½ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_2-æ€§èƒ½ä¼˜åŒ–"><span>2. æ€§èƒ½ä¼˜åŒ–</span></a></h4><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¼šé’ˆå¯¹ä¸åŒçš„æ¶æ„é‡‡å–ä¸åŒçš„æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ã€‚ä¾‹å¦‚ï¼Œåœ¨å¤„ç†å¤§é‡æ•°æ®æˆ–é«˜æ€§èƒ½è®¡ç®—æ—¶ï¼Œä¸åŒæ¶æ„çš„ CPU å¯èƒ½æœ‰ç€ä¸åŒçš„æœ€ä¼˜è§£ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> performCalculation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arch</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;x64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ä½¿ç”¨é’ˆå¯¹x64æ¶æ„ä¼˜åŒ–çš„ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arch</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;arm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ä½¿ç”¨é’ˆå¯¹ARMæ¶æ„ä¼˜åŒ–çš„ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // é»˜è®¤ç®—æ³•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">performCalculation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-åŠ¨æ€åŠŸèƒ½æ”¯æŒ" tabindex="-1"><a class="header-anchor" href="#_3-åŠ¨æ€åŠŸèƒ½æ”¯æŒ"><span>3. åŠ¨æ€åŠŸèƒ½æ”¯æŒ</span></a></h4><p>å¯èƒ½æœ‰äº›åŠŸèƒ½ä»…åœ¨ç‰¹å®šæ¶æ„ä¸Šå¯ç”¨æˆ–è¡¨ç°æ›´å¥½ã€‚åˆ©ç”¨<code>process.arch</code>å¯ä»¥ä½¿ä½ çš„åº”ç”¨åªåœ¨æ”¯æŒè¿™äº›åŠŸèƒ½çš„æ¶æ„ä¸Šå¯ç”¨è¿™äº›åŠŸèƒ½ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">arch</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;x64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¯ç”¨ä»…åœ¨x64æ¶æ„ä¸Šæœ‰æ•ˆæˆ–æ€§èƒ½æ›´ä½³çš„ç‰¹å®šåŠŸèƒ½</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ€»ç»“-6" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-6"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡<code>process.arch</code>ï¼ŒNode.js æä¾›äº†ä¸€ç§çµæ´»ä¸”å¼ºå¤§çš„æ–¹å¼æ¥è¯†åˆ«å’Œé€‚åº”ä¸åŒçš„ CPU æ¶æ„ã€‚è¿™ä½¿å¾—å¼€å‘äººå‘˜å¯ä»¥é’ˆå¯¹ä¸åŒç¯å¢ƒå’Œéœ€æ±‚ï¼Œè®¾è®¡æ›´åŠ æ™ºèƒ½å’Œé«˜æ•ˆçš„ä»£ç ã€‚</p><h2 id="process-argv" tabindex="-1"><a class="header-anchor" href="#process-argv"><span><a href="https://nodejs.org/docs/latest/api/process.html#processargv" target="_blank" rel="noopener noreferrer">process.argv</a></span></a></h2><p><code>process.argv</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„å…¨å±€å¯¹è±¡å±æ€§ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†å¯åŠ¨ Node.js è¿›ç¨‹æ—¶çš„å‘½ä»¤è¡Œå‚æ•°ã€‚è¿™ä¸ªç‰¹æ€§åœ¨æ„å»ºå‘½ä»¤è¡Œåº”ç”¨ç¨‹åºï¼ˆCLIï¼‰ä¸­å°¤å…¶æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸ä½ æ¥æ”¶å’Œå¤„ç†å¤–éƒ¨è¾“å…¥ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ <code>process.argv</code> çš„åŸºæœ¬ç»“æ„ï¼š</p><ol><li>æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ node çš„å®Œæ•´è·¯å¾„ã€‚</li><li>ç¬¬äºŒä¸ªå…ƒç´ æ˜¯æ­£è¢«æ‰§è¡Œçš„æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li>ä»ç¬¬ä¸‰ä¸ªå…ƒç´ å¼€å§‹ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªä¼ é€’ç»™è¯¥è„šæœ¬çš„å‘½ä»¤è¡Œå‚æ•°ã€‚</li></ol><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-7" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-7"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-ç®€å•æ‰“å°-process-argv" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ç®€å•æ‰“å°-process-argv"><span>ç¤ºä¾‹ 1: ç®€å•æ‰“å° <code>process.argv</code></span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º <code>example.js</code> çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// example.js</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">argv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæˆ‘ä»¬é€šè¿‡å‘½ä»¤è¡Œè¿è¡Œ <code>node example.js arg1 arg2 arg3</code>ï¼Œè¾“å‡ºå°†ä¼šæ˜¯ç±»ä¼¼è¿™æ ·çš„æ•°ç»„ï¼š</p><div class="language-plaintext line-numbers-mode" data-highlighter="shiki" data-ext="plaintext" data-title="plaintext" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>[</span></span>
<span class="line"><span>  &#39;/path/to/node&#39;,    // Node.js è·¯å¾„</span></span>
<span class="line"><span>  &#39;/path/to/example.js&#39;, // è„šæœ¬æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span>  &#39;arg1&#39;,              // è‡ªå®šä¹‰å‚æ•°</span></span>
<span class="line"><span>  &#39;arg2&#39;,              // è‡ªå®šä¹‰å‚æ•°</span></span>
<span class="line"><span>  &#39;arg3&#39;               // è‡ªå®šä¹‰å‚æ•°</span></span>
<span class="line"><span>]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°è¿›è¡Œç®€å•è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°è¿›è¡Œç®€å•è®¡ç®—"><span>ç¤ºä¾‹ 2: ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°è¿›è¡Œç®€å•è®¡ç®—</span></a></h4><p>å‡è®¾æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªè„šæœ¬ï¼Œè¯¥è„šæœ¬èƒ½å¤Ÿæ¥æ”¶ä¸¤ä¸ªæ•°å­—ä½œä¸ºå‚æ•°ï¼Œå¹¶æ‰“å°å‡ºå®ƒä»¬çš„å’Œã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·å®ç°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// sum.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> args</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">argv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç§»é™¤å‰ä¸¤ä¸ªä¸å…³å¿ƒçš„å…ƒç´ </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Please provide two numbers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> parseInt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> num2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> parseInt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num1</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> + </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num2</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> = </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">num1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> num2</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨è¿™ä¸ªè„šæœ¬ï¼š<code>node sum.js 5 7</code>ï¼Œå°†è¾“å‡ºï¼š</p><div class="language-plaintext line-numbers-mode" data-highlighter="shiki" data-ext="plaintext" data-title="plaintext" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>5 + 7 = 12</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-3-åˆ›å»ºç®€æ˜“çš„-cli-åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-åˆ›å»ºç®€æ˜“çš„-cli-åº”ç”¨"><span>ç¤ºä¾‹ 3: åˆ›å»ºç®€æ˜“çš„ CLI åº”ç”¨</span></a></h4><p>è€ƒè™‘ä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œä»»åŠ¡ç®¡ç†å™¨ï¼Œå…è®¸ä½ æ·»åŠ å’Œåˆ—å‡ºä»»åŠ¡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// tasks.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> filename</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;tasks.json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> args</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">argv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">switch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  case</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;add&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> task</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> args</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> currentTasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">filename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">flag</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;a+&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;[]&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    currentTasks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">task</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">filename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">currentTasks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Added task: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">task</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    break</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  case</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;list&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Listing tasks:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">filename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">encoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;[]&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    tasks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">task</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">index</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">. </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">task</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    break</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  default</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Usage: node tasks.js [add|list] [taskName]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>To add a task: <code>node tasks.js add &quot;Learn Node.js&quot;</code></li><li>To list all tasks: <code>node tasks.js list</code></li></ul><p>è¿™äº›ä¾‹å­å±•ç¤ºäº† <code>process.argv</code> å¦‚ä½•ä½¿å¾—æ¥æ”¶å’Œå¤„ç†å‘½ä»¤è¡Œå‚æ•°å˜å¾—ç®€å•ç›´æ¥ï¼Œä»è€Œå¢å¼ºäº† Node.js è„šæœ¬ä¸ç”¨æˆ·é—´çš„äº¤äº’èƒ½åŠ›ã€‚</p><h2 id="process-argv0" tabindex="-1"><a class="header-anchor" href="#process-argv0"><span><a href="https://nodejs.org/docs/latest/api/process.html#processargv0" target="_blank" rel="noopener noreferrer">process.argv0</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ JavaScript ä»£ç ã€‚äº†è§£ Node.js ä¸­çš„ <code>process.argv0</code> å±æ€§æ˜¯å­¦ä¹  Node.js çš„ä¸€ä¸ªé‡è¦æ­¥éª¤ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-process-argv0" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-process-argv0"><span>ä»€ä¹ˆæ˜¯ <code>process.argv0</code>ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code> å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„æœ‰å…³ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚<code>process.argv0</code> æ˜¯ <code>process</code> å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒè¿”å›å¯åŠ¨ Node.js è¿›ç¨‹æ—¶çš„ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°å€¼ï¼Œé€šå¸¸æ˜¯ Node.js å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚</p><h3 id="process-argv-vs-process-argv0" tabindex="-1"><a class="header-anchor" href="#process-argv-vs-process-argv0"><span><code>process.argv</code> vs <code>process.argv0</code></span></a></h3><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£ <code>process.argv0</code>ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ <code>process.argv</code>ã€‚<code>process.argv</code> æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†å¯åŠ¨ Node.js è¿›ç¨‹æ—¶çš„å‘½ä»¤è¡Œå‚æ•°ã€‚æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ Node.js å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯æ­£åœ¨æ‰§è¡Œçš„ JavaScript æ–‡ä»¶çš„è·¯å¾„ï¼Œä»ç¬¬ä¸‰ä¸ªå…ƒç´ å¼€å§‹æ‰æ˜¯å®é™…ä¼ ç»™è„šæœ¬çš„å‘½ä»¤è¡Œå‚æ•°ã€‚</p><p>å› æ­¤ï¼Œ<code>process.argv0</code> å®é™…ä¸Šå°±æä¾›äº† <code>process.argv</code> æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ï¼Œä½†æ˜¯å®ƒçš„ä¼˜ç‚¹æ˜¯å³ä½¿ç”¨æˆ·ä¿®æ”¹äº† <code>process.argv</code> æ•°ç»„ï¼Œ<code>process.argv0</code> ä¾ç„¶ä¿æŒä¸å˜ï¼Œæä¾›äº†ä¸€ç§è·å–åŸå§‹ Node.js å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„çš„å¯é æ–¹å¼ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦åœ¨æ—¥å¿—æ–‡ä»¶ä¸­è®°å½•å¯åŠ¨åº”ç”¨çš„å…·ä½“ Node.js ç‰ˆæœ¬å’Œè·¯å¾„ä¿¡æ¯ï¼Œæˆ–è€…ä½ çš„åº”ç”¨éœ€è¦æ ¹æ® Node.js å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®æ¥å†³å®šåç»­æ“ä½œã€‚</p><h4 id="ç¤ºä¾‹-1-æ‰“å°-node-js-å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ‰“å°-node-js-å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„"><span>ç¤ºä¾‹ 1ï¼šæ‰“å° Node.js å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// logNodePath.js</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">argv0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘½ä»¤è¡Œæ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// node logNodePath.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µç®€å•çš„ä»£ç ä¼šæ‰“å°å‡ºå¯åŠ¨è¿™ä¸ª Node.js è„šæœ¬çš„ Node.js å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ã€‚å¦‚æœä½ åœ¨ä¸åŒç¯å¢ƒæˆ–ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„ Node.js è¿è¡Œå®ƒï¼Œè¾“å‡ºå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚</p><h4 id="ç¤ºä¾‹-2-åŸºäº-node-js-å¯æ‰§è¡Œæ–‡ä»¶ä½ç½®åšå†³ç­–" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-åŸºäº-node-js-å¯æ‰§è¡Œæ–‡ä»¶ä½ç½®åšå†³ç­–"><span>ç¤ºä¾‹ 2ï¼šåŸºäº Node.js å¯æ‰§è¡Œæ–‡ä»¶ä½ç½®åšå†³ç­–</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// decisionBasedOnNodePath.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">argv0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/usr/local/bin/node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Using Node.js from /usr/local/bin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Node.js is not in the expected directory&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘½ä»¤è¡Œæ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// node decisionBasedOnNodePath.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•æ£€æŸ¥ Node.js å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ï¼Œå¹¶æ ¹æ®å…¶ä½ç½®åšå‡ºä¸åŒçš„å†³ç­–ã€‚</p><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œä½ åº”è¯¥å¯ä»¥çœ‹åˆ° <code>process.argv0</code> åœ¨ Node.js åº”ç”¨ä¸­çš„å®é™…åº”ç”¨åœºæ™¯ã€‚å®ƒæä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹å¼æ¥è·å–å¹¶ä½¿ç”¨ Node.js å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ä¿¡æ¯ã€‚</p><h2 id="process-channel" tabindex="-1"><a class="header-anchor" href="#process-channel"><span><a href="https://nodejs.org/docs/latest/api/process.html#processchannel" target="_blank" rel="noopener noreferrer">process.channel</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©ä½ å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚ä¸åŒäºä»…åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ JavaScriptï¼ŒNode.js ä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿæ„å»ºæ•´ä¸ªç½‘ç«™æˆ–åç«¯æœåŠ¡ï¼ˆä¹Ÿå°±æ˜¯é€šå¸¸æ‰€è¯´çš„â€œæœåŠ¡å™¨â€ï¼‰ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code>å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯ï¼Œå¹¶æ§åˆ¶å½“å‰ Node.js è¿›ç¨‹ã€‚å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨å®ƒï¼Œè€Œä¸éœ€è¦ç”¨<code>require</code>å‘½ä»¤å¼•å…¥ã€‚</p><h3 id="process-channel-1" tabindex="-1"><a class="header-anchor" href="#process-channel-1"><span><code>process.channel</code></span></a></h3><p>ä» Node.js v21.7.1 çš„æ–‡æ¡£æ¥çœ‹ï¼Œ<code>process.channel</code>æ˜¯ä¸<code>process</code>å¯¹è±¡ç›¸å…³è”çš„å±æ€§ä¹‹ä¸€ã€‚å½“ Node.js è¿›ç¨‹é€šè¿‡ IPCï¼ˆInter-Process Communicationï¼Œè¿›ç¨‹é—´é€šä¿¡ï¼‰æ–¹å¼è¢«åˆ›å»ºæ—¶ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ª Node.js è¿›ç¨‹ä½¿ç”¨<code>child_process.fork()</code>æ–¹æ³•åˆ›å»ºå¦ä¸€ä¸ª Node.js å­è¿›ç¨‹ï¼‰ï¼Œ<code>process.channel</code>å°†ä¼šæ˜¯ä¸€ä¸ªæŒ‡å‘ IPC é€šé“çš„å¼•ç”¨ã€‚å¦‚æœå½“å‰è¿›ç¨‹ä¸æ˜¯é€šè¿‡ IPC åˆ›å»ºçš„ï¼Œé‚£ä¹ˆ<code>process.channel</code>çš„å€¼å°†ä¼šæ˜¯<code>undefined</code>ã€‚</p><p>IPC å…è®¸åœ¨ä¸åŒçš„ Node.js è¿›ç¨‹ä¹‹é—´å‘é€æ¶ˆæ¯ã€‚è¿™å¯¹äºå®ç°ä¸€äº›å¹¶è¡Œå¤„ç†å’Œè´Ÿè½½åˆ†æ‹…éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨åˆ©ç”¨å¤šæ ¸ CPU çš„æƒ…å†µä¸‹ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-3"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜<code>process.channel</code>çš„åº”ç”¨ï¼š</p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºéœ€è¦æ‰§è¡Œä¸€äº›å¤æ‚çš„æ•°æ®å¤„ç†ä»»åŠ¡ã€‚ä¸ºäº†ä¸é˜»å¡ä¸» Node.js çº¿ç¨‹ï¼ˆå› ä¸º JavaScript æ˜¯å•çº¿ç¨‹çš„ï¼‰ï¼Œå¹¶ä¸”æ›´æœ‰æ•ˆåœ°åˆ©ç”¨å¤šæ ¸ CPUï¼Œä½ å¯èƒ½ä¼šé€‰æ‹©åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªå­è¿›ç¨‹æ¥å¤„ç†è¿™äº›ä»»åŠ¡ã€‚</p><ol><li><strong>ä¸»è¿›ç¨‹ä»£ç </strong> (<code>main.js</code>)ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child_process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> child</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./child.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘å­è¿›ç¨‹å‘é€æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hello</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬å­è¿›ç¨‹å‘é€è¿‡æ¥çš„æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ”¶åˆ°æ¥è‡ªå­è¿›ç¨‹çš„æ¶ˆæ¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>å­è¿›ç¨‹ä»£ç </strong> (<code>child.js</code>)ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å­è¿›ç¨‹æ”¶åˆ°æ¶ˆæ¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¤„ç†å®Œæ¶ˆæ¯åï¼Œå›å¤ä¸»è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">received</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥process.channelæ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">channel</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™ä¸ªå­è¿›ç¨‹æ˜¯é€šè¿‡IPC channelåˆ›å»ºçš„ã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ²¡æœ‰IPC channelã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>child_process.fork()</code>åˆ›å»ºå­è¿›ç¨‹ï¼Œå¹¶é€šè¿‡ IPC é€šä¿¡ã€‚åœ¨å­è¿›ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ£€æŸ¥<code>process.channel</code>æ¥ç¡®è®¤è¿™ä¸ªè¿›ç¨‹æ˜¯å¦æ˜¯é€šè¿‡ IPC æ–¹å¼åˆ›å»ºçš„ã€‚å¦‚æœæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>process.send()</code>å’Œ<code>process.on(&#39;message&#39;, ...)</code>æ¥è¿›è¡Œçˆ¶å­è¿›ç¨‹é—´çš„æ¶ˆæ¯ä¼ é€’ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œ<code>process.channel</code>æ˜¯ Node.js ä¸­è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿæ„å»ºæ›´åŠ é«˜æ•ˆå’Œçµæ´»çš„åº”ç”¨ç¨‹åºæ¶æ„ã€‚</p><h3 id="process-channel-ref" tabindex="-1"><a class="header-anchor" href="#process-channel-ref"><span><a href="https://nodejs.org/docs/latest/api/process.html#processchannelref" target="_blank" rel="noopener noreferrer">process.channel.ref()</a></span></a></h3><p><code>process.channel.ref()</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒä¸è¿›ç¨‹é—´é€šä¿¡(IPC)æœ‰å…³ã€‚è¦ç†è§£è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€äº›åŸºç¡€æ¦‚å¿µã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code>å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚å½“ä½¿ç”¨ Node.js è¿›è¡Œå¤šè¿›ç¨‹ç¼–ç¨‹æ—¶ï¼ˆå¦‚ä½¿ç”¨<code>child_process.fork()</code>åˆ›å»ºå­è¿›ç¨‹ï¼‰ï¼ŒIPCï¼ˆInter-Process Communicationï¼Œè¿›ç¨‹é—´é€šä¿¡ï¼‰æˆä¸ºäº†çˆ¶å­è¿›ç¨‹é—´é€šä¿¡çš„ä¸€ç§æ–¹å¼ã€‚</p><h3 id="ipc-å’Œprocess-channel" tabindex="-1"><a class="header-anchor" href="#ipc-å’Œprocess-channel"><span>IPC å’Œ<code>process.channel</code></span></a></h3><p>IPC å…è®¸è¿è¡Œåœ¨ä¸åŒè¿›ç¨‹çš„åº”ç”¨ç¨‹åºä¹‹é—´è¿›è¡Œæ•°æ®äº¤æ¢ã€‚åœ¨ Node.js ä¸­ï¼Œå½“ä½ é€šè¿‡<code>child_process.fork()</code>æ–¹æ³•åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹æ—¶ï¼Œè¿™ä¸ªå­è¿›ç¨‹ä¼šè‡ªåŠ¨åˆ›å»ºå¹¶ç»´æŠ¤ä¸€ä¸ªä¸çˆ¶è¿›ç¨‹çš„ IPC é€šé“ï¼ˆå¦‚æœåœ¨<code>fork()</code>è°ƒç”¨ä¸­æ˜ç¡®å¯ç”¨çš„è¯ï¼‰ã€‚è¿™ä¸ª IPC é€šé“å…è®¸çˆ¶å­è¿›ç¨‹ä¹‹é—´äº’ç›¸å‘é€æ¶ˆæ¯ã€‚</p><p><code>process.channel</code>å°±æ˜¯æŒ‡å‘è¿™ä¸ª IPC é€šé“çš„å¼•ç”¨ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰ã€‚å¦‚æœå½“å‰è¿›ç¨‹æ˜¯é€šè¿‡ IPC é€šé“åˆ›å»ºçš„ï¼Œåˆ™<code>process.channel</code>å°†ä¸ä¸º<code>null</code>ã€‚</p><h3 id="process-channel-ref-1" tabindex="-1"><a class="header-anchor" href="#process-channel-ref-1"><span><code>process.channel.ref()</code></span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ª Node.js è¿›ç¨‹è¿˜ä¿æŒç€æ´»è·ƒçš„ IPC é€šé“ï¼Œå®ƒä¼šä¿æŒè¿›ç¨‹æ´»è·ƒçŠ¶æ€ï¼Œå³ä½¿æ²¡æœ‰å…¶ä»–ä»»ä½•æ´»åŠ¨å‘ç”Ÿã€‚è¿™æ„å‘³ç€å³ä½¿åº”ç”¨ç¨‹åºä»£ç å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œä½†å› ä¸º IPC é€šé“ä»ç„¶æ‰“å¼€ï¼ŒNode.js è¿›ç¨‹ä¹Ÿä¸ä¼šé€€å‡ºã€‚</p><p><code>process.channel.ref()</code>æ–¹æ³•çš„ä½œç”¨å°±æ˜¯å‚è€ƒï¼ˆ&quot;ref&quot;ï¼‰è¿™ä¸ª IPC é€šé“ï¼Œç¡®ä¿èŠ‚ç‚¹è¿›ç¨‹ä¸ä¼šå› ä¸º IPC é€šé“ä»ç„¶æ´»è·ƒè€Œä¿æŒæ´»åŠ¨çŠ¶æ€ã€‚ç®€å•æ¥è¯´ï¼Œè°ƒç”¨äº†<code>process.channel.ref()</code>ä¹‹åï¼Œå³ä¾¿ IPC é€šé“è¿˜å¼€ç€ï¼ŒNode.js è¿›ç¨‹ä¹Ÿå¯ä»¥åœ¨æ²¡æœ‰å…¶ä»–æ´»åŠ¨æ—¶æ­£å¸¸é€€å‡ºã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-2"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªç”±å¤šä¸ªæœåŠ¡ç»„æˆçš„å¤§å‹åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¿™äº›æœåŠ¡é€šè¿‡æ¶ˆæ¯ä¼ é€’è¿›è¡Œé€šä¿¡ï¼ˆå³ä½¿ç”¨ IPCï¼‰ã€‚ä½ å¯èƒ½ä¼šæœ‰ä¸€ä¸ªä¸­å¤®æ—¥å¿—è®°å½•æœåŠ¡ï¼Œæ‰€æœ‰å…¶ä»–æœåŠ¡éƒ½é€šè¿‡ IPC å‘å…¶å‘é€æ—¥å¿—ä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å­è¿›ç¨‹ä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Logging message:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¤„ç†æ¥æ”¶åˆ°çš„æ¶ˆæ¯...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®©è¿™ä¸ªæ—¥å¿—æœåŠ¡åœ¨å¤„ç†å®Œæ‰€æœ‰å¾…å¤„ç†çš„æ¶ˆæ¯åèƒ½å¤Ÿä¼˜é›…åœ°å…³é—­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">channel</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ref</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³ä½¿æœ‰ IPC é€šé“è¿æ¥ç€ï¼Œæ—¥å¿—æœåŠ¡ä¹Ÿèƒ½åœ¨å®Œæˆä»»åŠ¡åä¼˜é›…åœ°é€€å‡ºï¼Œå› ä¸º<code>process.channel.ref()</code>çš„è°ƒç”¨å‘Šè¯‰ Node.js è¿›ç¨‹ï¼šä¸éœ€è¦å› ä¸ºè¿™ä¸ª IPC é€šé“çš„å­˜åœ¨è€Œä¿æŒè¿è¡ŒçŠ¶æ€ã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>process.channel.ref()</code>æ˜¯ Node.js å¤šè¿›ç¨‹ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé«˜çº§ç‰¹æ€§ï¼Œå®ƒå…è®¸æ›´ç²¾ç»†åœ°æ§åˆ¶ Node.js è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œç‰¹åˆ«æ˜¯åœ¨æ¶‰åŠ IPC é€šä¿¡æ—¶ã€‚</p><h3 id="process-channel-unref" tabindex="-1"><a class="header-anchor" href="#process-channel-unref"><span><a href="https://nodejs.org/docs/latest/api/process.html#processchannelunref" target="_blank" rel="noopener noreferrer">process.channel.unref()</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„è½¯ä»¶ã€‚åœ¨è¿™ä¸ªç¯å¢ƒä¸­ï¼Œprocess å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„æœ‰å…³ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚å…¶ä¸­ï¼Œ<code>process.channel</code> æ˜¯ä¸€ä¸ªè¾ƒä¸ºç‰¹æ®Šçš„å±æ€§ï¼Œå®ƒåªæœ‰åœ¨ Node.js è¿›ç¨‹æ˜¯é€šè¿‡ IPCï¼ˆInter-Process Communicationï¼Œè¿›ç¨‹é—´é€šä¿¡ï¼‰æ–¹å¼åˆ›å»ºæ—¶æ‰å­˜åœ¨ã€‚</p><p>IPC é€šå¸¸ç”¨äºçˆ¶è¿›ç¨‹ä¸å­è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚å½“ä½ ä½¿ç”¨ <code>child_process.fork()</code> æ–¹æ³•åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹æ—¶ï¼Œçˆ¶è¿›ç¨‹ä¸å­è¿›ç¨‹ä¹‹é—´ä¼šè‡ªåŠ¨å»ºç«‹ä¸€ä¸ª IPC é€šé“ï¼Œä»¥ä¾¿å®ƒä»¬ä¹‹é—´ç›¸äº’å‘é€ä¿¡æ¯ã€‚</p><h3 id="process-channel-unref-1" tabindex="-1"><a class="header-anchor" href="#process-channel-unref-1"><span>process.channel.unref()</span></a></h3><p>ç°åœ¨è®©æˆ‘ä»¬æ·±å…¥äº†è§£ <code>process.channel.unref()</code> è¿™ä¸ªæ–¹æ³•ã€‚é¦–å…ˆï¼Œâ€œunrefâ€è¿™ä¸ªè¯æ¥è‡ªâ€œunreferenceâ€çš„ç¼©å†™ï¼Œè¡¨ç¤ºâ€œå–æ¶ˆå¼•ç”¨â€ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>unref()</code> æ–¹æ³•çš„ä½œç”¨æ˜¯å‘Šè¯‰ Node.js çš„äº‹ä»¶å¾ªç¯ï¼Œå¦‚æœè¿™ä¸ªå·²ç»å–æ¶ˆå¼•ç”¨çš„å¯¹è±¡æ˜¯å”¯ä¸€å‰©ä¸‹çš„æ´»åŠ¨ï¼Œåˆ™å¯ä»¥å®‰å…¨åœ°åœæ­¢äº‹ä»¶å¾ªç¯ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–å·¥ä½œç•™ç»™äº‹ä»¶å¾ªç¯å»å¤„ç†ï¼ŒNode.js è¿›ç¨‹å¯ä»¥é€€å‡ºã€‚</p><p>è¿™å¯¹äº <code>process.channel</code> æ¥è¯´æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å½“ä½ è°ƒç”¨ <code>process.channel.unref()</code> åï¼Œä½ å®é™…ä¸Šæ˜¯å‘Šè¯‰ Node.jsï¼šâ€œå¦‚æœè¿™ä¸ª IPC é€šé“æ˜¯ä¿æŒè¿›ç¨‹æ´»è·ƒçš„å”¯ä¸€åŸå› ï¼Œè¯·å¿½ç•¥å®ƒå¹¶å…è®¸è¿›ç¨‹é€€å‡ºâ€ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œä½ å¯ä»¥è®©çˆ¶è¿›ç¨‹æˆ–å­è¿›ç¨‹åœ¨å®Œæˆå…¶å·¥ä½œåè‡ªç„¶é€€å‡ºï¼Œè€Œä¸æ˜¯å¼ºåˆ¶å®ƒä»¬ä¿æŒæ´»è·ƒä»…ä»…å› ä¸º IPC é€šé“è¿˜åœ¨é‚£é‡Œã€‚</p><h4 id="å®é™…è¿ç”¨çš„ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-1"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h4><p>æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼Œä½ æœ‰ä¸€ä¸ªä¸»åº”ç”¨ç¨‹åºï¼ˆçˆ¶è¿›ç¨‹ï¼‰å’Œä¸€ä¸ªæˆ–å¤šä¸ªæ‰§è¡Œç‰¹å®šä»»åŠ¡çš„å­è¿›ç¨‹ã€‚å­è¿›ç¨‹çš„ä»»åŠ¡å¯èƒ½æ˜¯çŸ­æš‚çš„ï¼Œæ¯”å¦‚æ ¹æ®ç”¨æˆ·çš„è¯·æ±‚å»è®¡ç®—ä¸€äº›æ•°æ®ã€‚ä¸€æ—¦ä»»åŠ¡å®Œæˆï¼Œç†è®ºä¸Šï¼Œå­è¿›ç¨‹å°±å¯ä»¥é€€å‡ºäº†ã€‚ä½†æ˜¯ï¼Œç”±äº IPC é€šé“é»˜è®¤ä¼šä¿æŒæ‰“å¼€çŠ¶æ€ï¼Œå­è¿›ç¨‹ä¸ä¼šè‡ªåŠ¨é€€å‡ºï¼Œé™¤éæ˜¾å¼åœ°å…³é—­ IPC é€šé“æˆ–è€…è°ƒç”¨ <code>process.channel.unref()</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child_process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> child</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./child.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨æŸä¸ªæ—¶é—´ç‚¹ï¼Œå†³å®šä¸å†éœ€è¦å­è¿›ç¨‹ç»´æŒæ´»è·ƒçŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">readyToClose</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è®©äº‹ä»¶å¾ªç¯å¿½ç•¥å­è¿›ç¨‹çš„ IPC é€šé“ï¼Œå¦‚æœè¿™æ˜¯é˜»æ­¢è¿›ç¨‹é€€å‡ºçš„å”¯ä¸€åŸå› </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">channel</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">unref</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡è®¾å­è¿›ç¨‹é€šè¿‡ IPC å‘é€äº†ä¸€ä¸ª <code>readyToClose</code> æ¶ˆæ¯ç»™çˆ¶è¿›ç¨‹ã€‚æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯åï¼Œçˆ¶è¿›ç¨‹è°ƒç”¨ <code>process.channel.unref()</code>ï¼Œå…è®¸å…¶è‡ªå·±ï¼ˆå¦‚æœæ²¡æœ‰å…¶ä»–ä»»åŠ¡éœ€è¦å¤„ç†ï¼‰æˆ–å­è¿›ç¨‹ï¼ˆå¦‚æœæ˜¯åœ¨å­è¿›ç¨‹ä¸­è°ƒç”¨ï¼‰æ­£å¸¸é€€å‡ºï¼Œå³ä¾¿ IPC é€šé“ä»ç„¶æ‰“å¼€ã€‚</p><p>è¿™ç§æœºåˆ¶éå¸¸é€‚åˆç®¡ç†é‚£äº›åªéœ€è¦è¿è¡ŒçŸ­æš‚ä»»åŠ¡çš„å­è¿›ç¨‹çš„åœºæ™¯ï¼Œå¹¶ä¸”å¯ä»¥ä¼˜é›…åœ°ç»“æŸè¿™äº›å­è¿›ç¨‹ï¼Œè€Œæ— éœ€æ‰‹åŠ¨å…³é—­ IPC é€šé“æˆ–ç­‰å¾…å…¶å®ƒç±»å‹çš„æ¸…ç†æ“ä½œã€‚</p><h2 id="process-chdir-directory" tabindex="-1"><a class="header-anchor" href="#process-chdir-directory"><span><a href="https://nodejs.org/docs/latest/api/process.html#processchdirdirectory" target="_blank" rel="noopener noreferrer">process.chdir(directory)</a></span></a></h2><p>å½“ç„¶ï¼Œæˆ‘å¾ˆä¹æ„å¸®ä½ ç†è§£<code>process.chdir(directory)</code>è¿™ä¸ªæ–¹æ³•ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code>å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒæä¾›äº†å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚ä½ å¯ä»¥é€šè¿‡<code>process</code>å¯¹è±¡è®¿é—®ç¯å¢ƒä¿¡æ¯ã€è¯»å–ç¯å¢ƒå˜é‡ã€ç®¡ç†è¾“å…¥è¾“å‡ºæµç­‰ã€‚è€Œ<code>process.chdir(directory)</code>è¿™ä¸ªæ–¹æ³•å…è®¸ä½ åœ¨ Node.js çš„ç¨‹åºä¸­æ”¹å˜å½“å‰å·¥ä½œç›®å½•ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯å·¥ä½œç›®å½•" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯å·¥ä½œç›®å½•"><span>ä»€ä¹ˆæ˜¯å·¥ä½œç›®å½•ï¼Ÿ</span></a></h3><p>ç®€å•æ¥è¯´ï¼Œå·¥ä½œç›®å½•å°±æ˜¯å½“å‰æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹æ‰€åœ¨çš„ç›®å½•ã€‚å®ƒæ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªä½ç½®ï¼Œç”¨äºç¡®å®šç›¸å¯¹è·¯å¾„çš„èµ·ç‚¹ã€‚ä¾‹å¦‚ï¼Œå½“ä½ åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œä¸€ä¸ªè„šæœ¬æˆ–åº”ç”¨ç¨‹åºæ—¶ï¼Œä½ é€šå¸¸åœ¨æŸä¸ªç‰¹å®šçš„ç›®å½•ä¸‹æ‰§è¡Œè¿™ä¸ªæ“ä½œï¼Œé‚£ä¹ˆè¯¥ç›®å½•å°±æ˜¯ä½ çš„å·¥ä½œç›®å½•ã€‚</p><h3 id="process-chdir-directory-çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#process-chdir-directory-çš„ä½œç”¨"><span><code>process.chdir(directory)</code>çš„ä½œç”¨</span></a></h3><p><code>process.chdir(directory)</code>æ–¹æ³•çš„ä½œç”¨æ˜¯æ”¹å˜ Node.js è¿›ç¨‹çš„å½“å‰å·¥ä½œç›®å½•ã€‚è¿™ä¸ªæ–¹æ³•æ¥å—ä¸€ä¸ªå‚æ•°<code>directory</code>ï¼Œå³ä½ æƒ³è¦åˆ‡æ¢åˆ°çš„ç›®æ ‡ç›®å½•è·¯å¾„ã€‚</p><p>è¿™ä¸ªåŠŸèƒ½åœ¨æŸäº›æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚ï¼š</p><ul><li>å½“ä½ çš„ Node.js åº”ç”¨éœ€è¦æ ¹æ®ä¸åŒçš„è¿è¡Œç¯å¢ƒï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰è®¿é—®ä¸åŒç›®å½•ä¸­çš„æ–‡ä»¶æ—¶ã€‚</li><li>å½“ä½ çš„åº”ç”¨éœ€è¦æ“ä½œå¤§é‡æ–‡ä»¶ï¼Œè€Œè¿™äº›æ–‡ä»¶åˆ†æ•£åœ¨ä¸åŒçš„ç›®å½•ä¸­ï¼Œå¹¶ä¸”å¸Œæœ›é€šè¿‡ä½¿ç”¨ç›¸å¯¹è·¯å¾„æ¥ç®€åŒ–æ–‡ä»¶è®¿é—®é€»è¾‘æ—¶ã€‚</li></ul><h3 id="ä½¿ç”¨å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨å®ä¾‹"><span>ä½¿ç”¨å®ä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªé¡¹ç›®ï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>myproject/</span></span>
<span class="line"><span>â”‚</span></span>
<span class="line"><span>â”œâ”€â”€ data/</span></span>
<span class="line"><span>â”‚   â””â”€â”€ mydata.txt</span></span>
<span class="line"><span>â”‚</span></span>
<span class="line"><span>â””â”€â”€ app.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬å¸Œæœ›åœ¨<code>app.js</code>æ–‡ä»¶ä¸­è¯»å–<code>data/mydata.txt</code>æ–‡ä»¶çš„å†…å®¹ã€‚å¦‚æœä¸æ”¹å˜å·¥ä½œç›®å½•ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä½¿ç”¨ç›¸å¯¹äº<code>app.js</code>çš„è·¯å¾„å»è®¿é—®<code>mydata.txt</code>ï¼Œå¦‚<code>./data/mydata.txt</code>ã€‚ä½†å¦‚æœæˆ‘ä»¬å°†å·¥ä½œç›®å½•æ”¹å˜åˆ°<code>data/</code>ç›®å½•ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨æ–‡ä»¶åè®¿é—®ã€‚</p><p>åœ¨<code>app.js</code>ä¸­ï¼Œä½¿ç”¨<code>process.chdir(directory)</code>æ›´æ”¹å·¥ä½œç›®å½•çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> path</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ”¹å˜å½“å‰å·¥ä½œç›®å½•åˆ°&quot;data&quot;ç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">chdir</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">__dirname</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ–°çš„å·¥ä½œç›®å½•: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cwd</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨æ–‡ä»¶åè®¿é—®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;mydata.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ”¹å˜å·¥ä½œç›®å½•å¤±è´¥: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨<code>path.join(__dirname, &#39;data&#39;)</code>æ„é€ äº†ä¸€ä¸ªæŒ‡å‘<code>data</code>ç›®å½•çš„ç»å¯¹è·¯å¾„ã€‚<code>__dirname</code>æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªç‰¹æ®Šå˜é‡ï¼Œä»£è¡¨å½“å‰æ‰§è¡Œè„šæœ¬æ‰€åœ¨çš„ç›®å½•ã€‚ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨<code>process.chdir()</code>ä»¥è¯¥è·¯å¾„ä¸ºå‚æ•°ï¼Œæ›´æ”¹å½“å‰å·¥ä½œç›®å½•ã€‚ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥é€šè¿‡æ–‡ä»¶åè®¿é—®<code>mydata.txt</code>äº†ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-2" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-2"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>åœ¨ä½¿ç”¨<code>process.chdir()</code>æ—¶ï¼Œå¦‚æœæä¾›çš„ç›®å½•ä¸å­˜åœ¨ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å› æ­¤ï¼Œæœ€å¥½åœ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•å‰æ£€æŸ¥ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚</li><li>æ›´æ”¹å·¥ä½œç›®å½•æ˜¯ä¸€ä¸ªæœ‰å‰¯ä½œç”¨çš„æ“ä½œï¼Œå®ƒä¼šå½±å“åˆ°è¿›ç¨‹ä¸­æ‰€æœ‰ç›¸å…³çš„è·¯å¾„è§£æã€‚å› æ­¤ï¼ŒåŠ¡å¿…è°¨æ…ä½¿ç”¨ï¼Œç¡®ä¿å®ƒä¸ä¼šå¯¼è‡´å…¶ä»–éƒ¨åˆ†çš„ç›¸å¯¹è·¯å¾„å‡ºé”™ã€‚</li></ul><p>å¸Œæœ›è¿™ä¸ªè§£é‡Šå’Œä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£<code>process.chdir(directory)</code>çš„ä½œç”¨å’Œå¦‚ä½•ä½¿ç”¨å®ƒï¼</p><h2 id="process-config" tabindex="-1"><a class="header-anchor" href="#process-config"><span><a href="https://nodejs.org/docs/latest/api/process.html#processconfig" target="_blank" rel="noopener noreferrer">process.config</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 JavaScript å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰å¾ˆå¤šå†…ç½®çš„å¯¹è±¡å’Œæ¨¡å—è®©å¼€å‘æ›´åŠ é«˜æ•ˆå’Œæ–¹ä¾¿ã€‚<code>process</code> å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„æœ‰å…³ä¿¡æ¯ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ§åˆ¶ã€‚è€Œ <code>process.config</code> æ˜¯ <code>process</code> å¯¹è±¡ä¸‹çš„ä¸€ä¸ªå±æ€§ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-process-config" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-process-config"><span>ä»€ä¹ˆæ˜¯ <code>process.config</code></span></a></h3><ul><li><code>process.config</code> åŒ…å«äº†ç¼–è¯‘å½“å‰ Node.js äºŒè¿›åˆ¶æ–‡ä»¶æ—¶æ‰€ç”¨çš„é…ç½®ä¿¡æ¯ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªåæ˜ äº† Node.js ç¼–è¯‘é˜¶æ®µé€‰æ‹©çš„é…ç½®é€‰é¡¹çš„å¯¹è±¡ã€‚</li><li>è¿™ä¸ªå¯¹è±¡åŒ…æ‹¬äº† Node.js å’Œå…¶ä¾èµ–ï¼ˆæ¯”å¦‚ V8 å¼•æ“å’Œ libuvï¼‰çš„ç¼–è¯‘é…ç½®ã€‚</li></ul><p>è¿™æ„å‘³ç€é€šè¿‡æŸ¥çœ‹ <code>process.config</code> çš„å†…å®¹ï¼Œä½ å¯ä»¥è·å¾—å…³äº Node.js ç¯å¢ƒæ„å»ºæ—¶çš„ä¸€äº›å…·ä½“ç»†èŠ‚ï¼Œæ¯”å¦‚ä½¿ç”¨çš„ç¼–è¯‘å™¨ç‰ˆæœ¬ã€ç¼–è¯‘æ—¶å¯ç”¨çš„åŠŸèƒ½ç­‰ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-process-config" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-process-config"><span>å¦‚ä½•ä½¿ç”¨ <code>process.config</code></span></a></h3><p>å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥æœ€ç®€å•çš„è·å–æ–¹å¼å°±æ˜¯ç›´æ¥åœ¨ä½ çš„ Node.js ä»£ç ä¸­è¾“å‡ºå®ƒï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">config</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œç±»ä¼¼äºè¿™æ ·ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;target_defaults&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;cflags&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;default_configuration&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Release&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;defines&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;include_dirs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;libraries&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: []</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;variables&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;asan&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;build_v8_with_gn&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;coverage&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;debug_nghttp2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;force_dynamic_crt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">    &quot;host_arch&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;x64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨"><span>å®é™…è¿ç”¨</span></a></h3><p>è™½ç„¶æ™®é€šçš„ Node.js åº”ç”¨å¼€å‘å¯èƒ½ä¸ä¼šç›´æ¥ä½¿ç”¨ <code>process.config</code>ï¼Œä½†äº†è§£å®ƒå¯ä»¥æä¾›ç¼–è¯‘çº§åˆ«çš„ insightsï¼Œç‰¹åˆ«æ˜¯å¯¹äºä»¥ä¸‹å‡ ç§æƒ…å†µå¾ˆæœ‰å¸®åŠ©ï¼š</p><ol><li><p><strong>åŸç”Ÿæ¨¡å—å¼€å‘è€…</strong>ï¼šå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªä¾èµ–äº Node.js C++ API çš„åŸç”Ÿæ¨¡å—ï¼Œäº†è§£ç¼–è¯‘é…ç½®æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºè¿™ç›´æ¥å½±å“åˆ°ä½ çš„æ¨¡å—ç¼–è¯‘è¿‡ç¨‹å’Œå…¼å®¹æ€§é—®é¢˜ã€‚ä¾‹å¦‚ï¼ŒçŸ¥é“ Node.js æ˜¯å¦‚ä½•ç¼–è¯‘çš„ï¼Œå¯ä»¥å¸®åŠ©ä½ å†³å®šå¦‚ä½•ä¸ºä½ çš„æ¨¡å—è®¾ç½®ç¼–è¯‘é…ç½®ã€‚</p></li><li><p><strong>åŒºåˆ†å¼€å‘ç¯å¢ƒ</strong>ï¼šåœ¨ä¸€äº›å¤æ‚çš„åº”ç”¨éƒ¨ç½²åœºæ™¯ä¸­ï¼Œå¯èƒ½éœ€è¦æ ¹æ® Node.js çš„ç¼–è¯‘é…ç½®æ¥è°ƒæ•´åº”ç”¨çš„è¡Œä¸ºæˆ–ä¼˜åŒ–æ€§èƒ½ã€‚æ¯”å¦‚ï¼Œåˆ¤æ–­æ˜¯å¦å¼€å¯äº†æŸä¸ªç‰¹å®šçš„ V8 flag å¯èƒ½ä¼šå¯¹æ€§èƒ½è°ƒä¼˜æœ‰æ‰€å¸®åŠ©ã€‚</p></li><li><p><strong>Debugging</strong>ï¼šåœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œ<code>process.config</code> å¯ä»¥æä¾›ä¸€äº›çº¿ç´¢ï¼Œå°¤å…¶æ˜¯å½“é‡åˆ°ä¸ Node.js ç¼–è¯‘é…ç½®ç›¸å…³çš„é—®é¢˜æ—¶ã€‚</p></li></ol><h3 id="æ€»ç»“-7" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-7"><span>æ€»ç»“</span></a></h3><p><code>process.config</code> æä¾›äº†ä¸€ä¸ªçª—å£ï¼Œè®©æˆ‘ä»¬èƒ½å¤ŸæŸ¥çœ‹ Node.js è¿›ç¨‹çš„ç¼–è¯‘é…ç½®è¯¦æƒ…ã€‚è™½ç„¶å®ƒåœ¨æ—¥å¸¸çš„ Node.js å¼€å‘ä¸­å¯èƒ½ä¸æ˜¯ç»å¸¸è¢«ç›´æ¥ç”¨åˆ°ï¼Œäº†è§£å®ƒå­˜åœ¨ä»¥åŠå¦‚ä½•æŸ¥çœ‹è¿™äº›ä¿¡æ¯ï¼Œå¯¹äºæ·±å…¥ç†è§£ Node.js è¿è¡Œæ—¶ç¯å¢ƒå’Œè¿›è¡Œåº•å±‚è°ƒä¼˜æœ‰ç€é‡è¦ä»·å€¼ã€‚</p><h2 id="process-connected" tabindex="-1"><a class="header-anchor" href="#process-connected"><span><a href="https://nodejs.org/docs/latest/api/process.html#processconnected" target="_blank" rel="noopener noreferrer">process.connected</a></span></a></h2><p>ç†è§£ <code>process.connected</code> å±æ€§ä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦äº†è§£å‡ ä¸ªå…³é”®æ¦‚å¿µï¼š</p><ol><li><strong>Node.js:</strong> ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚</li><li><strong>è¿›ç¨‹ï¼ˆProcessï¼‰:</strong> åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œä¸€ä¸ªè¿›ç¨‹å°±æ˜¯ä¸€ä¸ªè¿è¡Œä¸­çš„ç¨‹åºå®ä¾‹ã€‚å®ƒæœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œé‡Œé¢åŒ…å«äº†ä»£ç å’Œæ•°æ®ã€‚</li><li><strong>Child Processï¼ˆå­è¿›ç¨‹ï¼‰:</strong> Node.js æä¾›äº†åˆ›å»ºä»ä¸»è¿›ç¨‹åˆ†ç¦»çš„å­è¿›ç¨‹çš„èƒ½åŠ›ï¼Œè¿™äº›å­è¿›ç¨‹å¯ä»¥å¹¶è¡Œæ‰§è¡Œä»»åŠ¡ï¼Œæé«˜åº”ç”¨æ€§èƒ½ã€‚å­è¿›ç¨‹å¯ä»¥é€šè¿‡ IPCï¼ˆè¿›ç¨‹é—´é€šä¿¡ï¼‰ä¸çˆ¶è¿›ç¨‹é€šä¿¡ã€‚</li></ol><p>å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬ä»‹ç» <code>process.connected</code> è¿™ä¸ªå±æ€§ï¼š</p><p><code>process.connected</code> æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼å±æ€§ï¼Œè¡¨ç¤ºå­è¿›ç¨‹æ˜¯å¦ä»ç„¶è¿æ¥åˆ°å…¶çˆ¶è¿›ç¨‹ã€‚è¿™ä¸ªå±æ€§åªæœ‰åœ¨ä½¿ç”¨<code>child_process.fork()</code>æ–¹æ³•åˆ›å»ºå­è¿›ç¨‹ï¼Œå¹¶å¼€å¯äº† IPC é€šé“æ—¶æ‰æœ‰æ„ä¹‰ã€‚å¦‚æœçˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ä¹‹é—´çš„ IPC é€šé“å…³é—­äº†ï¼Œ<code>process.connected</code> å°†ä¼šå˜ä¸º<code>false</code>ã€‚</p><h3 id="å®é™…åº”ç”¨åœºæ™¯-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯-1"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><p>è€ƒè™‘ä¸€ä¸ªç½‘ç«™åå°æœåŠ¡çš„æƒ…å†µï¼Œå‡è®¾æˆ‘ä»¬è¦å¯¹å¤§é‡æ•°æ®è¿›è¡Œå¤æ‚è®¡ç®—ï¼Œè€Œè¿™è®¡ç®—å¯èƒ½ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œå½±å“ç”¨æˆ·ä½“éªŒã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ä¸“é—¨è´Ÿè´£è¿™éƒ¨åˆ†è®¡ç®—ã€‚</p><h4 id="ç¤ºä¾‹ä»£ç å¦‚ä¸‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç å¦‚ä¸‹"><span>ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</span></a></h4><p><strong>ä¸»è¿›ç¨‹æ–‡ä»¶ï¼šmain.js</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child_process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºå­è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> child</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ¥è‡ªå­è¿›ç¨‹çš„æ¶ˆæ¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hello</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥è¿æ¥çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">connected</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å­è¿›ç¨‹ä¾ç„¶è¿æ¥ç€&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å­è¿›ç¨‹å·²æ–­å¼€&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å…³é—­IPCé€šé“ï¼Œå¯¼è‡´process.connectedå˜ä¸ºfalse</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">disconnect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å­è¿›ç¨‹æ–‡ä»¶ï¼šchild.js</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ”¶åˆ°çˆ¶è¿›ç¨‹çš„æ¶ˆæ¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å›åº”çˆ¶è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hello</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;parent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›‘å¬æ–­å¼€äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;disconnect&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä¸çˆ¶è¿›ç¨‹çš„è¿æ¥å·²ç»æ–­å¼€&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œçˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹é€šè¿‡<code>child_process.fork()</code>å’Œ IPC é€šé“è¿›è¡ŒåŒå‘é€šä¿¡ã€‚çˆ¶è¿›ç¨‹å‘é€ä¸€ä¸ªåŒ…å« <code>{ hello: &#39;world&#39; }</code> çš„ç®€å•æ¶ˆæ¯ç»™å­è¿›ç¨‹ï¼Œå­è¿›ç¨‹æ¥æ”¶åå›å¤çˆ¶è¿›ç¨‹ä¸€æ¡æ¶ˆæ¯ã€‚å½“è°ƒç”¨<code>child.disconnect()</code>åï¼ŒIPC é€šé“å…³é—­ï¼Œ<code>process.connected</code> å˜ä¸º<code>false</code>ï¼Œè¡¨æ˜çˆ¶å­è¿›ç¨‹é—´çš„ç›´æ¥é€šä¿¡è·¯å¾„ä¸å†å­˜åœ¨ã€‚</p><h3 id="æ€»ç»“-8" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-8"><span>æ€»ç»“</span></a></h3><ul><li><code>process.connected</code> å±æ€§ç”¨äºåˆ¤æ–­å­è¿›ç¨‹æ˜¯å¦è¿˜åœ¨ä¸çˆ¶è¿›ç¨‹é€šè¿‡ IPC é€šé“è¿æ¥ã€‚</li><li>åœ¨å¤„ç†å¤æ‚æˆ–è€—æ—¶ä»»åŠ¡æ—¶ï¼Œä½¿ç”¨å­è¿›ç¨‹å¯ä»¥é¿å…é˜»å¡ä¸»è¿›ç¨‹ã€‚</li><li>å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æ˜¯é€šè¿‡ IPC å®ç°çš„ï¼Œä¸€æ—¦é€šé“å…³é—­ï¼Œ<code>process.connected</code> å˜ä¸º<code>false</code>ã€‚</li></ul><h2 id="process-constrainedmemory" tabindex="-1"><a class="header-anchor" href="#process-constrainedmemory"><span><a href="https://nodejs.org/docs/latest/api/process.html#processconstrainedmemory" target="_blank" rel="noopener noreferrer">process.constrainedMemory()</a></span></a></h2><p>Node.js v21.7.1 å¼•å…¥äº†<code>process.constrainedMemory()</code>è¿™ä¸ªåŠŸèƒ½ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„ APIï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å†…å­˜ç®¡ç†å’Œä¼˜åŒ–åº”ç”¨æ€§èƒ½æ—¶ã€‚è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥åœ°æ·±å…¥ç†è§£å®ƒã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>é¦–å…ˆï¼Œ<code>process</code>å¯¹è±¡æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œå®ƒæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å…è®¸ä½ ä¸è¯¥è¿›ç¨‹äº’åŠ¨ã€‚é€šè¿‡è¿™ä¸ªå¯¹è±¡ï¼Œä½ å¯ä»¥è·å–ç¯å¢ƒä¿¡æ¯ã€ç”¨æˆ·å‡­æ®ã€è¿è¡Œå‚æ•°ç­‰ç­‰ã€‚</p><p>åœ¨è¿™ä¸ªèƒŒæ™¯ä¸‹ï¼Œ<code>process.constrainedMemory()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤º Node.js è¿›ç¨‹å¯ç”¨çš„å—é™å†…å­˜é‡ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚è¿™å¯¹äºç†è§£å’Œç®¡ç† Node.js åº”ç”¨ç¨‹åºå¦‚ä½•ä½¿ç”¨å†…å­˜éå¸¸æœ‰ç”¨ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦å¤§é‡å†…å­˜çš„åº”ç”¨ç¨‹åºï¼Œæ¯”å¦‚ä¸€ä¸ªå›¾åƒå¤„ç†å™¨æˆ–è€…å¤§æ•°æ®åˆ†æå·¥å…·ã€‚é€šè¿‡ä½¿ç”¨<code>process.constrainedMemory()</code>ï¼Œä½ å¯ä»¥:</p><ol><li><p><strong>åŠ¨æ€è°ƒæ•´æ€§èƒ½</strong>: æ ¹æ®å¯ç”¨çš„å†…å­˜é‡è‡ªåŠ¨è°ƒæ•´åº”ç”¨ç¨‹åºçš„æ€§èƒ½æˆ–è€…è´¨é‡è®¾ç½®ï¼Œç¡®ä¿åº”ç”¨å³ä½¿åœ¨å†…å­˜å—é™çš„ç¯å¢ƒä¸­ä¹Ÿèƒ½é¡ºç•…è¿è¡Œã€‚</p></li><li><p><strong>é¿å…å†…å­˜æº¢å‡º</strong>: åœ¨æ‰§è¡Œå†…å­˜å¯†é›†å‹æ“ä½œå‰æ£€æŸ¥å¯ç”¨çš„å—é™å†…å­˜é‡ï¼Œé¢„é˜²å› è¶…å‡ºå†…å­˜é™åˆ¶è€Œå¯¼è‡´çš„åº”ç”¨å´©æºƒã€‚</p></li><li><p><strong>æ—¥å¿—å’Œç›‘æ§</strong>: è®°å½•åº”ç”¨çš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå¸®åŠ©å¼€å‘è€…è¯†åˆ«å¹¶è§£å†³å†…å­˜æ³„éœ²æˆ–å…¶ä»–å†…å­˜ç›¸å…³é—®é¢˜ã€‚</p></li></ol><h3 id="å®é™…ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-2"><span>å®é™…ä¾‹å­</span></a></h3><h4 id="åŠ¨æ€å›¾ç‰‡è´¨é‡è°ƒæ•´" tabindex="-1"><a class="header-anchor" href="#åŠ¨æ€å›¾ç‰‡è´¨é‡è°ƒæ•´"><span>åŠ¨æ€å›¾ç‰‡è´¨é‡è°ƒæ•´</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåœ¨çº¿å›¾ç‰‡ç¼–è¾‘å™¨ï¼Œç”¨æˆ·å¯ä»¥ä¸Šä¼ å›¾ç‰‡è¿›è¡Œç¼–è¾‘ã€‚åœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œä½¿ç”¨é«˜è´¨é‡çš„å›¾ç‰‡éœ€è¦æ›´å¤šçš„å†…å­˜ã€‚ä½†å¦‚æœæœåŠ¡å™¨çš„å¯ç”¨å†…å­˜è¾ƒä½ï¼Œå¤„ç†é«˜è´¨é‡å›¾ç‰‡å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ç”šè‡³å´©æºƒã€‚</p><p>é€šè¿‡<code>process.constrainedMemory()</code>ï¼Œä½ çš„åº”ç”¨å¯ä»¥æ£€æµ‹åˆ°å½“å‰çš„å†…å­˜é™åˆ¶ï¼Œå¹¶æ®æ­¤å†³å®šæ˜¯å¦é™ä½å›¾ç‰‡çš„å¤„ç†è´¨é‡ï¼Œæˆ–è€…æé†’ç”¨æˆ·ç°åœ¨å¯èƒ½ä¸æ˜¯è¿›è¡Œé«˜è´¨é‡ç¼–è¾‘çš„æœ€ä½³æ—¶æœºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> express</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;express&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> app</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> express</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> port</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">post</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;/upload&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">constrainedMemory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) { </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯”å¦‚ï¼Œå°‘äº100MB</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // æç¤ºç”¨æˆ·å†…å­˜ä¸è¶³ï¼Œå»ºè®®é™ä½å›¾ç‰‡è´¨é‡æˆ–å°è¯•ç¨åå†ä¸Šä¼ </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">status</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">503</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;æœåŠ¡å™¨å†…å­˜ä¸è¶³ï¼Œè¯·é™ä½å›¾ç‰‡è´¨é‡æˆ–ç¨åå†è¯•ã€‚&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¤„ç†ä¸Šä¼ çš„å›¾ç‰‡é€»è¾‘...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`App listening at http://localhost:</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœå¯ç”¨çš„å—é™å†…å­˜å°‘äº 100MBï¼Œåº”ç”¨ä¼šå»ºè®®ç”¨æˆ·é™ä½å›¾ç‰‡è´¨é‡æˆ–ç¨åå†è¯•ï¼Œä»è€Œé¿å…å¯èƒ½çš„æ€§èƒ½é—®é¢˜ã€‚</p><h4 id="æ€»ç»“-9" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-9"><span>æ€»ç»“</span></a></h4><p><code>process.constrainedMemory()</code>æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ APIï¼Œå®ƒä½¿å¾— Node.js åº”ç”¨èƒ½å¤Ÿæ›´æ™ºèƒ½åœ°ç®¡ç†å’Œä¼˜åŒ–å†…å­˜ä½¿ç”¨ã€‚é€šè¿‡åŠ¨æ€è°ƒæ•´åº”ç”¨è¡Œä¸ºä»¥é€‚åº”ä¸åŒçš„å†…å­˜æ¡ä»¶ï¼Œå¼€å‘è€…å¯ä»¥æå‡åº”ç”¨çš„ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒã€‚</p><h2 id="process-cpuusage-previousvalue" tabindex="-1"><a class="header-anchor" href="#process-cpuusage-previousvalue"><span><a href="https://nodejs.org/docs/latest/api/process.html#processcpuusagepreviousvalue" target="_blank" rel="noopener noreferrer">process.cpuUsage([previousValue])</a></span></a></h2><p>Node.js çš„<code>process.cpuUsage([previousValue])</code>æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨äºè®¡ç®—å¹¶è·å–å½“å‰ Node.js è¿›ç¨‹è‡ªå¯åŠ¨ä»¥æ¥æ‰€ä½¿ç”¨çš„ CPU æ—¶é—´çš„å·¥å…·ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†ç”¨æˆ· CPU æ—¶é—´ï¼ˆuserï¼‰å’Œç³»ç»Ÿ CPU æ—¶é—´ï¼ˆsystemï¼‰ï¼Œå•ä½æ˜¯å¾®ç§’ã€‚</p><h3 id="å‚æ•°è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š"><span>å‚æ•°è§£é‡Š</span></a></h3><ul><li><code>previousValue</code>ï¼ˆå¯é€‰ï¼‰: è¿™æ˜¯ä¸€ä¸ªä¹‹å‰ä»<code>process.cpuUsage()</code>å¾—åˆ°çš„ç»“æœå¯¹è±¡ã€‚å¦‚æœä¼ å…¥è¿™ä¸ªå‚æ•°ï¼Œæ–¹æ³•å°†è¿”å›è‡ªé‚£æ¬¡è°ƒç”¨ä»¥æ¥çš„ CPU ä½¿ç”¨æƒ…å†µå·®å¼‚ã€‚</li></ul><h3 id="è¿”å›å€¼" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼"><span>è¿”å›å€¼</span></a></h3><p>è¿”å›çš„å¯¹è±¡æœ‰ä¸¤ä¸ªå±æ€§ï¼š</p><ul><li><code>user</code>: è¡¨ç¤ºæ‰§è¡Œç”¨æˆ·ç¨‹åºèŠ±è´¹çš„ CPU æ—¶é—´ã€‚</li><li><code>system</code>: è¡¨ç¤ºæ‰§è¡Œç³»ç»Ÿç¨‹åºèŠ±è´¹çš„ CPU æ—¶é—´ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-4"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><strong>æµ‹é‡ä»£ç ç‰‡æ®µçš„ CPU ä½¿ç”¨é‡</strong>ï¼šå‡è®¾ä½ æƒ³æµ‹é‡æŸä¸ªç‰¹å®šæ“ä½œæˆ–å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ CPU ä½¿ç”¨æƒ…å†µï¼Œå¯ä»¥åœ¨æ“ä½œå‰ååˆ†åˆ«è°ƒç”¨<code>process.cpuUsage()</code>ï¼Œç„¶åæ¯”è¾ƒä¸¤æ¬¡ç»“æœã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨æ“ä½œå‰è·å–CPUä½¿ç”¨æƒ…å†µ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> startUsage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cpuUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡Œä¸€äº›ä»»åŠ¡...æ¯”å¦‚å¾ªç¯æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  Math</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sqrt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨æ“ä½œåå†æ¬¡è·å–CPUä½¿ç”¨æƒ…å†µ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> endUsage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cpuUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">startUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¡ç®—å‡ºåœ¨æ­¤æœŸé—´çš„CPUä½¿ç”¨å·®å¼‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`CPU Used - User: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">endUsage</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">user</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ms, System: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">endUsage</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">system</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ms`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>ç›‘æ§æœåŠ¡çš„ CPU æ¶ˆè€—</strong>ï¼šå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦é•¿æ—¶é—´è¿è¡Œçš„ Node.js åº”ç”¨ï¼ˆå¦‚ Web æœåŠ¡å™¨ï¼‰ï¼Œå¯èƒ½ä¼šæƒ³å®šæœŸæ£€æŸ¥å…¶ CPU ä½¿ç”¨æƒ…å†µï¼Œä»¥ç¡®ä¿æ²¡æœ‰å‡ºç°æ€§èƒ½é—®é¢˜ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> usage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cpuUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    `CPU Usage - User: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">usage</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">user</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ms, System: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">usage</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">system</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ms`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯5ç§’æ‰“å°ä¸€æ¬¡CPUä½¿ç”¨æƒ…å†µ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œä½ å¯ä»¥å®æ—¶ç›‘æ§ä½ çš„ Node.js åº”ç”¨çš„æ€§èƒ½çŠ¶å†µï¼Œå¹¶åœ¨æ£€æµ‹åˆ°å¼‚å¸¸é«˜çš„ CPU ä½¿ç”¨æ—¶è¿›è¡Œç›¸åº”çš„ä¼˜åŒ–æˆ–å¤„ç†æªæ–½ã€‚</p><h3 id="æ€»ç»“-10" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-10"><span>æ€»ç»“</span></a></h3><p><code>process.cpuUsage([previousValue])</code>æä¾›äº†ä¸€ä¸ªç®€å•è€Œå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…ç†è§£å’Œä¼˜åŒ–ä»–ä»¬çš„ Node.js åº”ç”¨çš„æ€§èƒ½ã€‚é€šè¿‡æµ‹é‡ç‰¹å®šä»£ç æ®µæˆ–æ•´ä¸ªåº”ç”¨çš„ CPU ä½¿ç”¨æƒ…å†µï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°å‘ç°å’Œè§£å†³æ€§èƒ½ç“¶é¢ˆã€‚</p><h2 id="process-cwd" tabindex="-1"><a class="header-anchor" href="#process-cwd"><span><a href="https://nodejs.org/docs/latest/api/process.html#processcwd" target="_blank" rel="noopener noreferrer">process.cwd()</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚ç†è§£ Node.js ä¸­çš„ <code>process.cwd()</code> å¯¹äºæŒæ¡ Node.js ç¼–ç¨‹è‡³å…³é‡è¦ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-process-cwd" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-process-cwd"><span>ä»€ä¹ˆæ˜¯ <code>process.cwd()</code>ï¼Ÿ</span></a></h3><p><code>process.cwd()</code> æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œå±äº Node.js çš„ <code>process</code> å¯¹è±¡ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›å½“å‰å·¥ä½œç›®å½•çš„å­—ç¬¦ä¸²è·¯å¾„ã€‚æ‰€è°“â€œå½“å‰å·¥ä½œç›®å½•â€ï¼ˆCurrent Working Directoryï¼‰ï¼ŒæŒ‡çš„æ˜¯è¿è¡Œä½ çš„ Node.js ç¨‹åºæ—¶ï¼Œç»ˆç«¯æˆ–å‘½ä»¤è¡Œæ‰€å¤„çš„ç›®å½•ã€‚è¿™ä¸ªæ¦‚å¿µå¯¹äºæ–‡ä»¶æ“ä½œéå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå½±å“ç›¸å¯¹è·¯å¾„çš„è§£æã€‚</p><h3 id="ä¸ºä»€ä¹ˆ-process-cwd-é‡è¦" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆ-process-cwd-é‡è¦"><span>ä¸ºä»€ä¹ˆ <code>process.cwd()</code> é‡è¦ï¼Ÿ</span></a></h3><p>å½“ä½ åœ¨ Node.js ä¸­æ“ä½œæ–‡ä»¶ï¼ˆæ¯”å¦‚è¯»å–ã€å†™å…¥æ–‡ä»¶ï¼‰æˆ–è€…éœ€è¦ä½¿ç”¨åˆ°æ–‡ä»¶è·¯å¾„æ—¶ï¼Œäº†è§£å½“å‰çš„å·¥ä½œç›®å½•å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚å¦‚æœä½ å‡è®¾äº†é”™è¯¯çš„å·¥ä½œç›®å½•ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ–‡ä»¶æ‰¾ä¸åˆ°æˆ–è€…é”™è¯¯åœ°åˆ›å»ºäº†æ–‡ä»¶ã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-3"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><ol><li><p><strong>è¯»å–å½“å‰å·¥ä½œç›®å½•ä¸‹çš„æ–‡ä»¶</strong></p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ <code>config.json</code> å­˜æ”¾åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>process.cwd()</code> ç»“åˆæ–‡ä»¶ç³»ç»Ÿæ¨¡å— (<code>fs</code>) æ¥è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> path</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–å½“å‰å·¥ä½œç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> currentWorkingDirectory</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cwd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ„å»ºconfig.jsonæ–‡ä»¶çš„å®Œæ•´è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> configFile</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">currentWorkingDirectory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;config.json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åŒæ­¥è¯»å–é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> config</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">configFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">config</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>åŠ¨æ€ç”Ÿæˆæ—¥å¿—æ–‡ä»¶</strong></p><p>å¦‚æœä½ çš„åº”ç”¨éœ€è¦è®°å½•æ—¥å¿—ï¼Œå¹¶ä¸”å¸Œæœ›è¿™äº›æ—¥å¿—æ–‡ä»¶è¢«ä¿å­˜åœ¨æ‰§è¡Œç¨‹åºçš„åŒä¸€ç›®å½•ä¸‹ï¼Œ<code>process.cwd()</code> å°±èƒ½æ´¾ä¸Šç”¨åœºï¼š</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> path</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> logsDirectory</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cwd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;logs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¡®ä¿logsç›®å½•å­˜åœ¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">existsSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">logsDirectory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mkdirSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">logsDirectory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> logFile</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">logsDirectory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;app.log&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘æ—¥å¿—æ–‡ä»¶å†™å…¥å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">appendFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">logFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åº”ç”¨å¯åŠ¨äº†</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>å¤„ç†ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶</strong></p><p>å½“ä½ å¼€å‘ä¸€ä¸ªç½‘ç«™æˆ–åº”ç”¨ï¼Œå…è®¸ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œä½ å¯èƒ½éœ€è¦å°†ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åˆ°æœåŠ¡è¿è¡Œçš„ç‰¹å®šç›®å½•ã€‚é€šè¿‡ <code>process.cwd()</code>ï¼Œä½ å¯ä»¥ç¡®ä¿æ— è®ºä½ çš„æœåŠ¡éƒ¨ç½²åœ¨å“ªé‡Œï¼Œæ–‡ä»¶éƒ½ä¼šè¢«ä¿å­˜åœ¨æ­£ç¡®çš„ä½ç½®ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> express</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;express&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fileUpload</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;express-fileupload&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> app</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> express</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> port</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fileUpload</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">post</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/upload&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">files</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ||</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Object</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">keys</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">files</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">status</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">400</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;No files were uploaded.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ–‡ä»¶å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> uploadedFile</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">files</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">myFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä¿å­˜æ–‡ä»¶åˆ°å½“å‰å·¥ä½œç›®å½•ä¸‹çš„uploadsæ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> uploadPath</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cwd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;uploads&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">uploadedFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  uploadedFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">uploadPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">status</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;File uploaded!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`App listening at http://localhost:</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>è¿™äº›ä¾‹å­å±•ç¤ºäº† <code>process.cwd()</code> åœ¨ä¸åŒåœºæ™¯ä¸‹çš„å®é™…åº”ç”¨ï¼Œä»åŸºæœ¬æ–‡ä»¶æ“ä½œåˆ°æ›´å¤æ‚çš„åº”ç”¨é€»è¾‘ã€‚æŒæ¡å®ƒå¯ä»¥è®©ä½ åœ¨ Node.js å¼€å‘ä¸­æ›´çµæ´»åœ°å¤„ç†è·¯å¾„å’Œæ–‡ä»¶ç›¸å…³çš„ä»»åŠ¡ã€‚</p><h2 id="process-debugport" tabindex="-1"><a class="header-anchor" href="#process-debugport"><span><a href="https://nodejs.org/docs/latest/api/process.html#processdebugport" target="_blank" rel="noopener noreferrer">process.debugPort</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ª JavaScript è¿è¡Œæ—¶ï¼Œå®ƒè®©ä½ èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ JavaScript ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>process</code> æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œå®ƒæä¾›æœ‰å…³å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯ï¼Œå¹¶æ§åˆ¶å…¶è¡Œä¸ºã€‚å…¶ä¸­ï¼Œ<code>process.debugPort</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒå…³ç³»åˆ°è°ƒè¯•è¿™ä¸ªè¿›ç¨‹æ—¶ä½¿ç”¨çš„ç«¯å£ã€‚</p><h3 id="è§£é‡Š-process-debugport" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-process-debugport"><span>è§£é‡Š <code>process.debugPort</code></span></a></h3><p>å½“ä½ å¯åŠ¨ Node.js åº”ç”¨ç¨‹åºæ—¶ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªè°ƒè¯•ç«¯å£ï¼Œè¿™æ ·è°ƒè¯•å·¥å…·å°±å¯ä»¥è¿æ¥åˆ°è¿™ä¸ªç«¯å£å¹¶ä¸ä½ çš„åº”ç”¨äº¤äº’ï¼Œå¸®åŠ©ä½ æ‰¾åˆ°é”™è¯¯å’Œæ€§èƒ½é—®é¢˜ç­‰ã€‚å¦‚æœä½ æ²¡æœ‰æ‰‹åŠ¨æŒ‡å®šä¸€ä¸ªç«¯å£ï¼ŒNode.js å°†ä¼šä½¿ç”¨é»˜è®¤çš„è°ƒè¯•ç«¯å£ï¼Œè¿™ä¸ªé»˜è®¤å€¼æ˜¯ 9229ã€‚</p><p><code>process.debugPort</code> å°±æ˜¯ç”¨æ¥è·å–æˆ–è®¾ç½®å½“å‰è¿›ç¨‹å°†è¦ä½¿ç”¨çš„è°ƒè¯•ç«¯å£å·çš„ã€‚å®ƒçš„å€¼é»˜è®¤æ˜¯ 9229ï¼Œä½†ä¹Ÿå¯ä»¥é€šè¿‡å¯åŠ¨åº”ç”¨ç¨‹åºæ—¶ä¼ é€’å‚æ•°æ¥ä¿®æ”¹ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-5"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="_1-æŸ¥çœ‹é»˜è®¤çš„è°ƒè¯•ç«¯å£" tabindex="-1"><a class="header-anchor" href="#_1-æŸ¥çœ‹é»˜è®¤çš„è°ƒè¯•ç«¯å£"><span>1. æŸ¥çœ‹é»˜è®¤çš„è°ƒè¯•ç«¯å£</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™æˆ–è°ƒè¯•ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œä½ å¯ä»¥ç®€å•åœ°æ‰“å°å‡º <code>process.debugPort</code> çš„å€¼æ¥ç¡®è®¤å½“å‰è¿›ç¨‹ä½¿ç”¨çš„æ˜¯å“ªä¸ªè°ƒè¯•ç«¯å£ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">debugPort</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½æ˜¯ 9229ï¼Œé™¤éä½ åœ¨å¯åŠ¨æ—¶æŒ‡å®šäº†ä¸åŒçš„ç«¯å£</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-å¯åŠ¨åº”ç”¨æ—¶æŒ‡å®šè°ƒè¯•ç«¯å£" tabindex="-1"><a class="header-anchor" href="#_2-å¯åŠ¨åº”ç”¨æ—¶æŒ‡å®šè°ƒè¯•ç«¯å£"><span>2. å¯åŠ¨åº”ç”¨æ—¶æŒ‡å®šè°ƒè¯•ç«¯å£</span></a></h4><p>å¦‚æœä½ æƒ³åœ¨å¯åŠ¨åº”ç”¨æ—¶æŒ‡å®šä¸€ä¸ªä¸åŒçš„è°ƒè¯•ç«¯å£ï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ <code>--inspect</code> æˆ– <code>--inspect-brk</code> æ ‡å¿—ï¼Œå¹¶æŒ‡å®šä½ æƒ³è¦çš„ç«¯å£å·ã€‚</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">node</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --inspect=9230</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> your_script.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬æŒ‡å®šäº† 9230 ä½œä¸ºè°ƒè¯•ç«¯å£ï¼Œè€Œä¸æ˜¯é»˜è®¤çš„ 9229ã€‚åœ¨ä½ çš„è„šæœ¬ä¸­ï¼Œå¦‚æœæ‰“å° <code>process.debugPort</code>ï¼Œå®ƒä¼šæ˜¾ç¤º 9230ã€‚</p><h4 id="_3-åŠ¨æ€ä¿®æ”¹è°ƒè¯•ç«¯å£" tabindex="-1"><a class="header-anchor" href="#_3-åŠ¨æ€ä¿®æ”¹è°ƒè¯•ç«¯å£"><span>3. åŠ¨æ€ä¿®æ”¹è°ƒè¯•ç«¯å£</span></a></h4><p>è™½ç„¶æ›´å¸¸è§çš„æƒ…å†µæ˜¯åœ¨å¯åŠ¨åº”ç”¨ç¨‹åºæ—¶å°±è®¾ç½®å¥½è°ƒè¯•ç«¯å£ï¼Œä½†ç†è®ºä¸Šï¼Œä½ ä¹Ÿå¯ä»¥åœ¨åº”ç”¨è¿è¡Œæ—¶åŠ¨æ€åœ°ä¿®æ”¹ <code>process.debugPort</code>ã€‚ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªæ”¹å˜ <code>process.debugPort</code> çš„å€¼å¹¶ä¸ä¼šæ”¹å˜å·²ç»åœ¨ç›‘å¬çš„è°ƒè¯•å™¨ç«¯å£ï¼Œè¿™æ ·çš„æ“ä½œä¸€èˆ¬ä¸æ¨èï¼Œå› ä¸ºå®ƒå¯èƒ½å¯¼è‡´æ··ä¹±å’Œä¸ä¸€è‡´çš„è¡Œä¸ºã€‚</p><h3 id="æ€»ç»“-11" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-11"><span>æ€»ç»“</span></a></h3><p><code>process.debugPort</code> æä¾›äº†ä¸€ç§æ–¹å¼æ¥æŸ¥çœ‹æˆ–è®¾ç½® Node.js åº”ç”¨çš„è°ƒè¯•ç«¯å£ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ä¼šåœ¨å¯åŠ¨åº”ç”¨æ—¶é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æ¥è®¾ç½®è¿™ä¸ªç«¯å£ï¼Œä»è€Œå…è®¸è°ƒè¯•å·¥å…·è¿æ¥åˆ°ä½ çš„åº”ç”¨è¿›è¡Œè°ƒè¯•ã€‚è¿™æ˜¯ Node.js å¼€å‘ä¸­è§£å†³é—®é¢˜å’Œä¼˜åŒ–æ€§èƒ½çš„é‡è¦ç¯èŠ‚ã€‚</p><h2 id="process-disconnect" tabindex="-1"><a class="header-anchor" href="#process-disconnect"><span><a href="https://nodejs.org/docs/latest/api/process.html#processdisconnect" target="_blank" rel="noopener noreferrer">process.disconnect()</a></span></a></h2><p>Node.js ä¸­çš„ <code>process.disconnect()</code> æ–¹æ³•ç”¨äºæ–­å¼€çˆ¶å­è¿›ç¨‹ä¹‹é—´çš„ IPCï¼ˆInter-Process Communicationï¼Œè¿›ç¨‹é—´é€šä¿¡ï¼‰é€šé“ã€‚è¿™ä¸ªæ–¹æ³•ä»…åœ¨ä½¿ç”¨ IPC é€šé“çš„åœºæ™¯ä¸­æœ‰æ•ˆï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸€ä¸ªé€šè¿‡ <code>child_process.fork()</code> æ–¹æ³•åˆ›å»ºçš„å­è¿›ç¨‹ä¸­æ‰èƒ½ä½¿ç”¨ã€‚ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å¯ä»¥æ‰‹åŠ¨å…³é—­å­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹ä¹‹é—´çš„è¿æ¥ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹èƒŒæ™¯çŸ¥è¯†ï¼š</p><h3 id="è¿›ç¨‹é—´é€šä¿¡-ipc" tabindex="-1"><a class="header-anchor" href="#è¿›ç¨‹é—´é€šä¿¡-ipc"><span>è¿›ç¨‹é—´é€šä¿¡ (IPC)</span></a></h3><p>å½“ä½ åœ¨ Node.js ä¸­å¯åŠ¨ä¸€ä¸ªæ–°çš„è¿›ç¨‹æ—¶ï¼Œæ¯”å¦‚ä½¿ç”¨ <code>child_process.fork()</code> æ¥åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼ŒNode.js ä¼šå»ºç«‹ä¸€ä¸ª IPC é€šé“æ¥è®©çˆ¶è¿›ç¨‹ä¸å­è¿›ç¨‹ä¹‹é—´è¿›è¡Œæ¶ˆæ¯ä¼ é€’ã€‚è¿™æ˜¯ä¸€ç§è¿›ç¨‹é—´é€šä¿¡çš„æœºåˆ¶ã€‚</p><h3 id="ä½•æ—¶ä½¿ç”¨-process-disconnect" tabindex="-1"><a class="header-anchor" href="#ä½•æ—¶ä½¿ç”¨-process-disconnect"><span>ä½•æ—¶ä½¿ç”¨ <code>process.disconnect()</code></span></a></h3><p>å½“ä½ ä¸å†éœ€è¦çˆ¶å­è¿›ç¨‹ä¹‹é—´é€šä¿¡æ—¶ï¼Œå¯ä»¥è°ƒç”¨ <code>process.disconnect()</code> æ¥æ–­å¼€å®ƒä»¬ä¹‹é—´çš„è¿æ¥ã€‚è¿™å¯ä»¥å¸®åŠ©é‡Šæ”¾ç³»ç»Ÿèµ„æºã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-8" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-8"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨éœ€è¦æ‰§è¡Œä¸€äº›è€—æ—¶çš„è®¡ç®—æ“ä½œã€‚ä¸ºäº†ä¸é˜»å¡ä¸»çº¿ç¨‹ï¼Œä½ å†³å®šå°†è¿™äº›æ“ä½œæ”¾åˆ°ä¸€ä¸ªå­è¿›ç¨‹ä¸­æ‰§è¡Œã€‚ä¸€æ—¦å­è¿›ç¨‹å®Œæˆäº†ä»»åŠ¡ï¼Œä½ å°±æ²¡æœ‰ç»§ç»­ä¿æŒè¿æ¥çš„å¿…è¦äº†ï¼Œå¯ä»¥æ–­å¼€è¿æ¥ä»¥èŠ‚çº¦èµ„æºã€‚</p><h4 id="ç¤ºä¾‹ä»£ç -1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -1"><span>ç¤ºä¾‹ä»£ç </span></a></h4><ol><li><strong>åˆ›å»ºå­è¿›ç¨‹å¹¶é€šä¿¡</strong></li></ol><p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„çˆ¶è¿›ç¨‹ (<code>parent.js</code>)ï¼Œå®ƒä¼šç”¨ <code>fork()</code> åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œå¹¶é€šè¿‡ IPC å‘é€ä¸€æ¡æ¶ˆæ¯ç»™å­è¿›ç¨‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// parent.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child_process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> child</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./child.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ¥è‡ªå­è¿›ç¨‹çš„æ¶ˆæ¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ–­å¼€ä¸å­è¿›ç¨‹çš„è¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">disconnect</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">hello</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºå­è¿›ç¨‹çš„è„šæœ¬ (<code>child.js</code>)ï¼Œå®ƒä¼šæ¥æ”¶çˆ¶è¿›ç¨‹å‘é€çš„æ¶ˆæ¯ï¼Œå¹¶å›å¤ä¸€æ¡æ¶ˆæ¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// child.js</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ”¶åˆ°çˆ¶è¿›ç¨‹çš„æ¶ˆæ¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™æ˜¯å­è¿›ç¨‹çš„å›å¤&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>æ‰§è¡Œå’Œè§‚å¯Ÿ</strong></li></ol><p>å½“ä½ è¿è¡Œçˆ¶è¿›ç¨‹ (<code>node parent.js</code>)ï¼Œå®ƒä¼šä¸å­è¿›ç¨‹è¿›è¡Œç®€çŸ­çš„é€šä¿¡ï¼Œç„¶åæ–­å¼€è¿æ¥ã€‚è¿™ä¸ªè¿‡ç¨‹å±•ç¤ºäº†å¦‚ä½•åœ¨å®Œæˆå¿…è¦çš„é€šä¿¡åä¸»åŠ¨æ–­å¼€çˆ¶å­è¿›ç¨‹ä¹‹é—´çš„ IPC é€šé“ã€‚</p><h3 id="ç»“è®º-2" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-2"><span>ç»“è®º</span></a></h3><p>ä½¿ç”¨ <code>process.disconnect()</code> å¯ä»¥ä¼˜åŒ–èµ„æºä½¿ç”¨å’Œç®¡ç†ï¼Œåœ¨ç¡®ä¿æ‰€æœ‰å¿…è¦çš„äº¤äº’å®Œæˆåï¼Œé€šè¿‡æ–­å¼€ä¸å†éœ€è¦çš„ IPC é€šé“ï¼Œå‡å°‘èµ„æºå ç”¨ã€‚è¿™å¯¹äºå¼€å‘é«˜æ•ˆç‡ã€é«˜æ€§èƒ½çš„ Node.js åº”ç”¨å°¤å…¶é‡è¦ã€‚</p><h2 id="process-dlopen-module-filename-flags" tabindex="-1"><a class="header-anchor" href="#process-dlopen-module-filename-flags"><span><a href="https://nodejs.org/docs/latest/api/process.html#processdlopenmodule-filename-flags" target="_blank" rel="noopener noreferrer">process.dlopen(module, filename[, flags])</a></span></a></h2><p>åœ¨ Node.js ä¸­ï¼Œ<code>process.dlopen(module, filename[, flags])</code>æ˜¯ä¸€ä¸ªç›¸å¯¹åº•å±‚çš„ APIï¼Œå®ƒå…è®¸ä½ ç›´æ¥æ‰“å¼€ï¼ˆæˆ–åŠ è½½ï¼‰ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“ï¼ˆDynamic-Link Library, DLLï¼Œåœ¨ Windows ä¸Šï¼‰æˆ–å…±äº«å¯¹è±¡æ–‡ä»¶ï¼ˆShared Object, SOï¼Œåœ¨ Unix-like ç³»ç»Ÿæ¯”å¦‚ Linux å’Œ macOS ä¸Šï¼‰ã€‚è¿™ä¸ªå‡½æ•°ä¸»è¦ç”¨äºæ‰©å±• Node.js çš„èƒ½åŠ›ï¼Œé€šè¿‡åŠ è½½ C/C++ç¼–å†™çš„ä»£ç åº“æ¥å®ç°ç‰¹å®šåŠŸèƒ½ï¼Œè¿™å¯¹äºéœ€è¦æ‰§è¡Œé«˜æ€§èƒ½è®¡ç®—æˆ–éœ€è¦ç›´æ¥ä¸æ“ä½œç³»ç»Ÿåº•å±‚äº¤äº’çš„åœºæ™¯ç‰¹åˆ«æœ‰ç”¨ã€‚</p><h3 id="å‚æ•°è§£é‡Š-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è§£é‡Š-1"><span>å‚æ•°è§£é‡Šï¼š</span></a></h3><ul><li><code>module</code>: è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé€šå¸¸æ˜¯æŒ‡<code>exports</code>å¯¹è±¡ã€‚å½“åŠ¨æ€åº“è¢«æˆåŠŸåŠ è½½åï¼Œå®ƒçš„å¯¼å‡ºä¼šè¢«æ·»åŠ åˆ°è¿™ä¸ªå¯¹è±¡ä¸Šã€‚</li><li><code>filename</code>: è¿™æ˜¯è¦åŠ è½½çš„åŠ¨æ€é“¾æ¥åº“çš„è·¯å¾„ã€‚å®ƒå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ã€‚</li><li><code>flags</code> (å¯é€‰): è¿™ä¸ªå‚æ•°å…è®¸ä½ æŒ‡å®šä¸€äº›æ ‡å¿—æ¥æ§åˆ¶å¦‚ä½•åŠ è½½è¿™ä¸ªåº“ã€‚å®ƒæ˜¯å¯é€‰çš„ï¼Œä¸”å–å†³äºå…·ä½“å¹³å°çš„æ”¯æŒã€‚</li></ul><h3 id="å¦‚ä½•ä½¿ç”¨-3" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-3"><span>å¦‚ä½•ä½¿ç”¨ï¼Ÿ</span></a></h3><p>ç”±äºè¿™æ˜¯ä¸€ä¸ªè¾ƒä½çº§åˆ«çš„ APIï¼Œå¹³æ—¶æˆ‘ä»¬å¼€å‘ Node.js åº”ç”¨æ—¶å¯èƒ½å¹¶ä¸å¸¸ç›´æ¥ä½¿ç”¨å®ƒã€‚ä½†äº†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£ Node.js çš„è¿è¡Œæœºåˆ¶ä»¥åŠå…¶ä¸æ“ä½œç³»ç»Ÿé—´çš„äº¤äº’ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªç”¨ C è¯­è¨€ç¼–å†™çš„åº“ï¼Œæä¾›äº†ä¸€äº›æ•°å­¦è®¡ç®—çš„å‡½æ•°ï¼Œä½ æƒ³åœ¨ä½ çš„ Node.js åº”ç”¨ä¸­ä½¿ç”¨è¿™äº›å‡½æ•°ã€‚é¦–å…ˆï¼Œä½ éœ€è¦ç¡®ä¿è¿™ä¸ªåº“è¢«ç¼–è¯‘æˆäº†é€‚åˆä½ æ“ä½œç³»ç»Ÿçš„åŠ¨æ€é“¾æ¥åº“ï¼Œæ¯”å¦‚<code>libmath.so</code>(Linux/macOS)æˆ–<code>math.dll</code>(Windows)ã€‚</p><p>ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨<code>process.dlopen()</code>æ¥åŠ è½½è¿™ä¸ªåº“ï¼Œå¹¶ä½¿å¾—å…¶å‡½æ•°å¯¹ä½ çš„ Node.js ä»£ç å¯ç”¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬çš„åŠ¨æ€é“¾æ¥åº“åä¸º libmath.so æˆ– math.dll</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> pathToLib</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;./lib/libmath.so&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œå‡è®¾åº“æ–‡ä»¶åœ¨é¡¹ç›®çš„ lib ç›®å½•ä¸‹</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°è¯•åŠ è½½åŠ¨æ€é“¾æ¥åº“</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">dlopen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pathToLib</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾åº“ä¸­æœ‰ä¸€ä¸ªåä¸º add çš„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ç°åœ¨ä½ å¯ä»¥åƒè°ƒç”¨æ™®é€šJavaScriptå‡½æ•°ä¸€æ ·è°ƒç”¨å®ƒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™ä¼šè¾“å‡º 8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ— æ³•åŠ è½½åº“:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ³¨æ„äº‹é¡¹-3" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-3"><span>æ³¨æ„äº‹é¡¹ï¼š</span></a></h3><ol><li><strong>å®‰å…¨æ€§</strong>ï¼šåŠ è½½å¤–éƒ¨åŠ¨æ€é“¾æ¥åº“æ—¶è¦éå¸¸å°å¿ƒï¼Œå› ä¸ºè¿™å¯èƒ½å¼•å…¥å®‰å…¨é£é™©ã€‚ç¡®ä¿åªåŠ è½½å¯ä¿¡æ¥æºçš„åº“ã€‚</li><li><strong>è·¨å¹³å°å…¼å®¹æ€§</strong>ï¼šå¦‚æœä½ çš„åº”ç”¨éœ€è¦åœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼Œä½ éœ€è¦ä¸ºæ¯ä¸ªç›®æ ‡å¹³å°æä¾›ç›¸åº”çš„åŠ¨æ€é“¾æ¥åº“ç‰ˆæœ¬ã€‚</li><li><strong>äºŒè¿›åˆ¶å…¼å®¹æ€§</strong>ï¼šåŠ¨æ€é“¾æ¥åº“éœ€è¦ä¸ Node.js è¿è¡Œæ—¶ç¯å¢ƒçš„äºŒè¿›åˆ¶æ¥å£ï¼ˆABIï¼‰å…¼å®¹ã€‚è¿™æ„å‘³ç€åœ¨ Node.js æˆ–æ“ä½œç³»ç»Ÿå‡çº§åï¼Œå¯èƒ½éœ€è¦é‡æ–°ç¼–è¯‘è¿™äº›åº“ã€‚</li></ol><p>æ€»ä¹‹ï¼Œ<code>process.dlopen()</code>æä¾›äº†ä¸€ç§å¼ºå¤§çš„æ–¹å¼æ¥æ‰©å±• Node.js çš„åŠŸèƒ½ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥åˆ©ç”¨å·²æœ‰çš„ C/C++åº“æ¥å¢å¼ºåº”ç”¨çš„èƒ½åŠ›ã€‚ç„¶è€Œï¼Œè€ƒè™‘åˆ°å…¶å¤æ‚æ€§å’Œæ½œåœ¨çš„é£é™©ï¼Œä¸€èˆ¬å»ºè®®ä»…åœ¨ç¡®æœ‰å¿…è¦æ—¶ä½¿ç”¨ï¼Œå¹¶ä¸”ç”±æœ‰ç»éªŒçš„å¼€å‘è€…æ“ä½œã€‚</p><h2 id="process-emitwarning-warning-options" tabindex="-1"><a class="header-anchor" href="#process-emitwarning-warning-options"><span><a href="https://nodejs.org/docs/latest/api/process.html#processemitwarningwarning-options" target="_blank" rel="noopener noreferrer">process.emitWarning(warning[, options])</a></span></a></h2><p>äº†è§£<code>process.emitWarning(warning[, options])</code>è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å…ˆå¾—æ˜ç™½ Node.js ä¸­çš„<code>process</code>å¯¹è±¡å’Œè­¦å‘Šç³»ç»Ÿçš„ä½œç”¨ã€‚</p><h3 id="process-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#process-å¯¹è±¡"><span>Process å¯¹è±¡</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code>å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†å…³äºå½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚å¯ä»¥é€šè¿‡å®ƒæ¥è·å–ç¯å¢ƒä¿¡æ¯ã€è¯»å†™æ ‡å‡†è¾“å…¥è¾“å‡ºã€ç›‘å¬æœªæ•è·çš„å¼‚å¸¸ç­‰ã€‚</p><h3 id="è­¦å‘Šç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#è­¦å‘Šç³»ç»Ÿ"><span>è­¦å‘Šç³»ç»Ÿ</span></a></h3><p>Node.js çš„è­¦å‘Šç³»ç»Ÿå…è®¸åº”ç”¨åœ¨è¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€åœ°å‘å‡ºè­¦å‘Šä¿¡æ¯ï¼Œè¿™äº›è­¦å‘Šå¯èƒ½æŒ‡ç¤ºæ½œåœ¨çš„é—®é¢˜æˆ–ä¸æ¨èä½¿ç”¨çš„ API è°ƒç”¨ç­‰ã€‚å®ƒå¸®åŠ©å¼€å‘è€…åŠæ—¶å‘ç°å’Œå¤„ç†æ½œåœ¨é—®é¢˜ã€‚</p><h3 id="process-emitwarning-warning-options-1" tabindex="-1"><a class="header-anchor" href="#process-emitwarning-warning-options-1"><span><code>process.emitWarning(warning[, options])</code></span></a></h3><p>è¿™ä¸ªå‡½æ•°å°±æ˜¯ç”¨æ¥è§¦å‘è‡ªå®šä¹‰è­¦å‘Šçš„ã€‚å½“ä½ è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼ŒNode.js ä¼šäº§ç”Ÿä¸€ä¸ªè­¦å‘Šï¼Œè¿™ä¸ªè­¦å‘Šä¼šè¢«å‘é€åˆ°<code>process.on(&#39;warning&#39;, handler)</code>æ³¨å†Œçš„å¤„ç†å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰æ³¨å†Œä»»ä½•å¤„ç†å‡½æ•°ï¼Œå®ƒé»˜è®¤æ‰“å°åˆ° stderrã€‚</p><h4 id="å‚æ•°è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯¦è§£"><span>å‚æ•°è¯¦è§£ï¼š</span></a></h4><ul><li><strong>warning</strong>: è¿™ä¸ªå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ¶ˆæ¯æˆ–è€…ä¸€ä¸ª<code>Error</code>å¯¹è±¡ã€‚å®ƒè¡¨ç¤ºè­¦å‘Šçš„å†…å®¹ã€‚</li><li><strong>options</strong> (å¯é€‰): ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå¯ä»¥åŒ…å«ä»¥ä¸‹å±æ€§ï¼š <ul><li><strong>type</strong>: è‡ªå®šä¹‰è­¦å‘Šçš„ç±»å‹ã€‚</li><li><strong>code</strong>: è­¦å‘Šçš„é”™è¯¯ç æˆ–å­—ç¬¦ä¸²æ ‡è¯†ã€‚</li><li><strong>detail</strong>: å¯¹è­¦å‘Šä¿¡æ¯çš„è¡¥å……æè¿°ã€‚</li></ul></li></ul><h4 id="ä½¿ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­"><span>ä½¿ç”¨ä¾‹å­ï¼š</span></a></h4><h5 id="_1-å‘å‡ºç®€å•çš„å­—ç¬¦ä¸²è­¦å‘Š" tabindex="-1"><a class="header-anchor" href="#_1-å‘å‡ºç®€å•çš„å­—ç¬¦ä¸²è­¦å‘Š"><span>1. å‘å‡ºç®€å•çš„å­—ç¬¦ä¸²è­¦å‘Šï¼š</span></a></h5><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emitWarning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Something is not right!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™å°†è¾“å‡ºä¸€ä¸ªè­¦å‘Šä¿¡æ¯åˆ° stderrï¼Œå†…å®¹æ˜¯&quot;Something is not right!&quot;ã€‚</p><h5 id="_2-ä½¿ç”¨-error-å¯¹è±¡å’Œé€‰é¡¹" tabindex="-1"><a class="header-anchor" href="#_2-ä½¿ç”¨-error-å¯¹è±¡å’Œé€‰é¡¹"><span>2. ä½¿ç”¨ Error å¯¹è±¡å’Œé€‰é¡¹ï¼š</span></a></h5><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> warning</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This is a more detailed warning.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emitWarning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">warning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;CustomWarning&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  code</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;MY_WARNING_CODE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  detail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This is additional information about the warning.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­åˆ›å»ºäº†ä¸€ä¸ªå…·æœ‰é¢å¤–ä¿¡æ¯çš„è­¦å‘Šã€‚å®ƒæ›´è¯¦ç»†ï¼ŒåŒ…å«äº†ç±»å‹ã€ä»£ç å’Œè¯¦æƒ…ã€‚å¦‚æœä½ åœ¨åº”ç”¨ä¸­è®¾ç½®äº†å¯¹åº”çš„è­¦å‘Šå¤„ç†ï¼Œé‚£ä¹ˆå¯ä»¥æ ¹æ®è¿™äº›ä¿¡æ¯åšå‡ºæ›´ç²¾ç¡®çš„ååº”ã€‚</p><h3 id="å®é™…åº”ç”¨åœºæ™¯-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯-2"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ª Web åº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨ä¾èµ–äºæŸä¸ªå³å°†åºŸå¼ƒçš„ APIã€‚</p><ul><li><p><strong>æ£€æµ‹æ—§ API ä½¿ç”¨æƒ…å†µ</strong>ï¼šæ¯å½“åº”ç”¨å°è¯•è°ƒç”¨è¿™ä¸ªæ—§ APIï¼Œä½ å¯ä»¥é€šè¿‡<code>process.emitWarning()</code>å‘å‡ºè­¦å‘Šï¼Œæç¤ºè¿™ä¸ª API å³å°†åºŸå¼ƒï¼Œå¹¶æ¨èä½¿ç”¨æ–°çš„ APIã€‚</p></li><li><p><strong>æ€§èƒ½é—®é¢˜è­¦å‘Š</strong>ï¼šå¦‚æœä½ çš„åº”ç”¨ç›‘æµ‹åˆ°æŸä¸ªæ“ä½œè€—æ—¶å¼‚å¸¸ï¼Œå¯ä»¥å‘å‡ºè­¦å‘Šï¼Œæç¤ºå¯èƒ½å­˜åœ¨æ€§èƒ½é—®é¢˜ã€‚</p></li></ul><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ<code>process.emitWarning()</code>æˆä¸ºäº†ä¸€ç§æœ‰æ•ˆçš„å·¥å…·ï¼Œå¸®åŠ©ä½ åœ¨å¼€å‘è¿‡ç¨‹ä¸­åŠæ—¶å‘ç°å¹¶å¤„ç†æ½œåœ¨é—®é¢˜ã€‚</p><h2 id="process-emitwarning-warning-type-code-ctor" tabindex="-1"><a class="header-anchor" href="#process-emitwarning-warning-type-code-ctor"><span><a href="https://nodejs.org/docs/latest/api/process.html#processemitwarningwarning-type-code-ctor" target="_blank" rel="noopener noreferrer">process.emitWarning(warning[, type[, code]][, ctor])</a></span></a></h2><p><code>process.emitWarning(warning[, type[, code]][, ctor])</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ åœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€åœ°å‘å‡ºè‡ªå®šä¹‰æˆ–ç³»ç»Ÿçº§è­¦å‘Šä¿¡æ¯ã€‚è¿™ä¸ªæœºåˆ¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜äº†è§£ä»–ä»¬çš„åº”ç”¨å¯èƒ½å­˜åœ¨çš„é—®é¢˜ï¼Œè€Œä¸ä¼šä½¿ç¨‹åºåœæ­¢è¿è¡Œã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šåˆ†æ­¥éª¤è¯¦ç»†è§£é‡Šæ¯ä¸ªéƒ¨åˆ†ï¼Œå¹¶æä¾›ä¸€äº›å®é™…ä¾‹å­ã€‚</p><h3 id="è§£æå‡½æ•°å‚æ•°" tabindex="-1"><a class="header-anchor" href="#è§£æå‡½æ•°å‚æ•°"><span>è§£æå‡½æ•°å‚æ•°</span></a></h3><ul><li><code>warning</code>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–ä¸€ä¸ª <code>Error</code> å¯¹è±¡ï¼Œè¡¨ç¤ºè¦å‘å‡ºçš„è­¦å‘Šæ¶ˆæ¯ã€‚</li><li><code>type</code> (å¯é€‰): è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæŒ‡å®šè­¦å‘Šçš„ç±»å‹ã€‚å¦‚æœæœªæä¾›ï¼Œé»˜è®¤ä¸º <code>&#39;Warning&#39;</code>ã€‚</li><li><code>code</code> (å¯é€‰): è¿™æ˜¯ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆé€šå¸¸æ˜¯å¤§å†™çš„å­—ç¬¦ä¸²ï¼‰ï¼Œç”¨äºåŒºåˆ†ä¸åŒçš„è­¦å‘Šã€‚</li><li><code>ctor</code> (å¯é€‰): è¿™ä¸ªå‚æ•°æ˜¯ç”¨æ¥å®šåˆ¶æ ˆè·Ÿè¸ªä¸­å¿½ç•¥çš„å‡½æ•°çš„ã€‚å¦‚æœæä¾›æ­¤å‚æ•°ï¼ŒNode.js å°†ä»æ–°çš„è­¦å‘Šå¯¹è±¡çš„æ ˆè·Ÿè¸ªä¸­æ’é™¤æ‰é‚£äº›ä¸ <code>ctor</code> å‚æ•°ç›¸å…³çš„å‡½æ•°ã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯åŠä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯åŠä¾‹å­"><span>ä½¿ç”¨åœºæ™¯åŠä¾‹å­</span></a></h3><h4 id="_1-æç¤ºå³å°†å¼ƒç”¨çš„åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_1-æç¤ºå³å°†å¼ƒç”¨çš„åŠŸèƒ½"><span>1. æç¤ºå³å°†å¼ƒç”¨çš„åŠŸèƒ½</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº“ï¼Œè€Œå…¶ä¸­çš„æŸä¸ªå‡½æ•°å³å°†åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­è¢«å¼ƒç”¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>process.emitWarning</code> æ¥æé†’ä½¿ç”¨ä½ åº“çš„å¼€å‘è€…å…³äºå³å°†å‘ç”Ÿçš„å˜åŒ–ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> oldFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emitWarning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;oldFunction() will be deprecated in the next major release. Use newFunction() instead.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;DeprecationWarning&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡½æ•°çš„å…¶ä½™éƒ¨åˆ†...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">oldFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœæœ‰äººè°ƒç”¨ <code>oldFunction()</code>ï¼Œä»–ä»¬å°†çœ‹åˆ°ä¸€ä¸ªè­¦å‘Šï¼Œæç¤ºè¿™ä¸ªå‡½æ•°å°†è¢«å¼ƒç”¨ï¼Œå¹¶å»ºè®®ä½¿ç”¨ <code>newFunction()</code> ä½œä¸ºæ›¿ä»£ã€‚</p><h4 id="_2-æŒ‡ç¤ºä¸æ¨èä½¿ç”¨çš„é…ç½®é€‰é¡¹" tabindex="-1"><a class="header-anchor" href="#_2-æŒ‡ç¤ºä¸æ¨èä½¿ç”¨çš„é…ç½®é€‰é¡¹"><span>2. æŒ‡ç¤ºä¸æ¨èä½¿ç”¨çš„é…ç½®é€‰é¡¹</span></a></h4><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œç”¨æˆ·éœ€è¦é€šè¿‡é…ç½®æ–‡ä»¶æ¥è®¾ç½®é€‰é¡¹ã€‚å¦‚æœç”¨æˆ·è®¾ç½®äº†ä¸€ä¸ªä¸å†æ¨èä½¿ç”¨çš„é€‰é¡¹ï¼Œä½ å¯ä»¥å‘å‡ºè­¦å‘Šã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ç”¨æˆ·çš„é…ç½®ä¸ºï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> userConfig</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  useLegacyFeature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ­¤åŠŸèƒ½å³å°†è¢«åºŸå¼ƒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">userConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">useLegacyFeature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emitWarning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;The useLegacyFeature option is deprecated and will be removed in a future version.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;DeprecationWarning&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œå½“ç”¨æˆ·è¿è¡Œç¨‹åºå¹¶æŸ¥çœ‹æ—¥å¿—æ—¶ï¼Œä»–ä»¬å°±ä¼šäº†è§£åˆ°ä½¿ç”¨ <code>useLegacyFeature</code> é€‰é¡¹ä¸å†æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚</p><h4 id="_3-å¼€å‘é˜¶æ®µçš„é—®é¢˜è¯Šæ–­" tabindex="-1"><a class="header-anchor" href="#_3-å¼€å‘é˜¶æ®µçš„é—®é¢˜è¯Šæ–­"><span>3. å¼€å‘é˜¶æ®µçš„é—®é¢˜è¯Šæ–­</span></a></h4><p>å¼€å‘å¤æ‚åº”ç”¨æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›éè‡´å‘½çš„é—®é¢˜ï¼Œä½†ä½ å¸Œæœ›åœ¨å¼€å‘è¿‡ç¨‹ä¸­è®°å½•ä¸‹æ¥ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æœ‰ä¸€ä¸ªå‡½æ•°è´Ÿè´£å¤„ç†ç½‘ç»œè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> handleRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">header</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emitWarning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      &quot;Missing header in the request.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      &quot;RequestWarning&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      &quot;REQ_NO_HEADER&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    );</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¤„ç†æ²¡æœ‰å¤´éƒ¨çš„æƒ…å†µ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å…¶ä½™å¤„ç†é€»è¾‘...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">handleRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœå¤„ç†è¯·æ±‚æ—¶ç¼ºå°‘è¯·æ±‚å¤´ï¼Œæˆ‘ä»¬å‘å‡ºä¸€ä¸ªè­¦å‘Šï¼ŒåŒæ—¶æŒ‡å®šä¸€ä¸ªå”¯ä¸€çš„ä»£ç  <code>REQ_NO_HEADER</code>ï¼Œä»¥ä¾¿æ›´å®¹æ˜“åœ°è¿½è¸ªå’Œè¯Šæ–­é—®é¢˜ã€‚</p><h3 id="æ€»ç»“-12" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-12"><span>æ€»ç»“</span></a></h3><p><code>process.emitWarning</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªæå…¶æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå®ƒå…è®¸å¼€å‘è€…åœ¨è¿è¡Œæ—¶å‘å‡ºè­¦å‘Šï¼Œè€Œæ— éœ€ä¸­æ–­ç¨‹åºã€‚é€šè¿‡æä¾›é¢å¤–çš„ä¸Šä¸‹æ–‡ï¼ˆå¦‚ç±»å‹å’Œä»£ç ï¼‰ï¼Œå®ƒå¸®åŠ©å¼€å‘è€…å’Œç”¨æˆ·æ›´å‡†ç¡®åœ°äº†è§£ç¨‹åºçš„çŠ¶æ€ï¼Œä»è€Œæ”¹è¿›å’Œç»´æŠ¤ä»£ç ã€‚</p><h3 id="avoiding-duplicate-warnings" tabindex="-1"><a class="header-anchor" href="#avoiding-duplicate-warnings"><span><a href="https://nodejs.org/docs/latest/api/process.html#avoiding-duplicate-warnings" target="_blank" rel="noopener noreferrer">Avoiding duplicate warnings</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œæœ‰äº›æƒ…å†µä¸‹ï¼Œä½ çš„ç¨‹åºå¯èƒ½ä¼šåå¤è§¦å‘ç›¸åŒçš„è­¦å‘Šã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ ä¸å°å¿ƒåœ¨ä»£ç ä¸­å¤šæ¬¡ä½¿ç”¨äº†å³å°†åºŸå¼ƒçš„åŠŸèƒ½ï¼ŒNode.js é»˜è®¤ä¼šæ¯æ¬¡é‡åˆ°è¿™ç§ç”¨æ³•æ—¶éƒ½æ‰“å°ä¸€ä¸ªè­¦å‘Šã€‚è¿™ç§é‡å¤çš„è­¦å‘Šä¸ä»…ä¼šå¡«æ»¡ä½ çš„æ—¥å¿—æ–‡ä»¶ï¼Œè¿˜å¯èƒ½ä½¿å¾—çœŸæ­£çš„é—®é¢˜è¢«åŸ‹æ²¡åœ¨å¤§é‡çš„é‡å¤ä¿¡æ¯ä¹‹ä¸­ã€‚ä» Node.js v21.7.1 å¼€å§‹ï¼Œå¼•å…¥äº†ä¸€ç§æœºåˆ¶æ¥å¸®åŠ©å¼€å‘è€…é¿å…è¿™ç§é‡å¤è­¦å‘Šçš„æƒ…å†µã€‚</p><h3 id="å®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#å®ç°åŸç†"><span>å®ç°åŸç†</span></a></h3><p>è¿™ä¸ªæœºåˆ¶åŸºäº <code>process.emitWarning()</code> æ–¹æ³•å·¥ä½œã€‚<code>process.emitWarning()</code> æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå…è®¸å¼€å‘è€…åœ¨è‡ªå·±çš„ç¨‹åºä¸­è§¦å‘è­¦å‘Šäº‹ä»¶ã€‚ä»ç‰ˆæœ¬ 21.7.1 å¼€å§‹ï¼ŒNode.js å¢åŠ äº†å¯¹äºé‡å¤è­¦å‘Šæ£€æµ‹çš„æ”¯æŒã€‚å½“é€šè¿‡ <code>process.emitWarning()</code> è§¦å‘ä¸€ä¸ªè­¦å‘Šæ—¶ï¼ŒNode.js ä¼šæ£€æŸ¥è¿™ä¸ªè­¦å‘Šæ˜¯å¦å·²ç»è¢«è§¦å‘è¿‡ã€‚å¦‚æœæ˜¯ï¼Œåˆ™å¯ä»¥æ ¹æ®é…ç½®å†³å®šæ˜¯å¦å†æ¬¡æ˜¾ç¤ºè¿™ä¸ªè­¦å‘Šã€‚</p><h3 id="ä½¿ç”¨æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•"><span>ä½¿ç”¨æ–¹æ³•</span></a></h3><p>ä¸ºäº†åˆ©ç”¨è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œä½ éœ€è¦åœ¨è°ƒç”¨ <code>process.emitWarning()</code> æ—¶ï¼Œä¼ é€’é¢å¤–çš„å‚æ•°ã€‚å…·ä½“æ¥è¯´ï¼Œä½ å¯ä»¥ä¼ é€’ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª <code>dedupeKey</code> å±æ€§ã€‚<code>dedupeKey</code> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ ‡è¯†è­¦å‘Šçš„å”¯ä¸€æ€§ã€‚å¦‚æœä¸¤æ¬¡è°ƒç”¨ <code>process.emitWarning()</code> ä¼ é€’äº†ç›¸åŒçš„ <code>dedupeKey</code>ï¼Œåˆ™ç¬¬äºŒæ¬¡ï¼ˆä»¥åŠä¹‹åçš„ï¼‰è°ƒç”¨é»˜è®¤ä¸ä¼šå†æ˜¾ç¤ºè­¦å‘Šã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-4" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-4"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªä½¿ç”¨äº† Node.js å³å°†åºŸå¼ƒçš„ API çš„ç¨‹åºã€‚æˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•é¿å…å› å¤šæ¬¡ä½¿ç”¨è¯¥ API è€Œäº§ç”Ÿé‡å¤è­¦å‘Šã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> deprecatedFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è§¦å‘ä¸€ä¸ªå…³äºå³å°†åºŸå¼ƒçš„åŠŸèƒ½çš„è­¦å‘Š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">emitWarning</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;deprecatedFunction is deprecated and will be removed in future versions.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;DeprecationWarning&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      code</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;DEP0001&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      dedupeKey</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;deprecatedFunction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œå°†æ˜¾ç¤ºè­¦å‘Š</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">deprecatedFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬äºŒæ¬¡è°ƒç”¨ï¼Œç”±äºä¼ é€’äº†ç›¸åŒçš„ dedupeKeyï¼Œæ‰€ä»¥ä¸ä¼šå†æ˜¾ç¤ºè­¦å‘Š</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">deprecatedFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°½ç®¡ <code>deprecatedFunction</code> è¢«è°ƒç”¨äº†ä¸¤æ¬¡ï¼Œä½†è­¦å‘Šåªä¼šå‡ºç°ä¸€æ¬¡ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬é€šè¿‡æŒ‡å®š <code>dedupeKey: &#39;deprecatedFunction&#39;</code> åœ¨ä¸¤æ¬¡è°ƒç”¨ä¸­æ ‡è¯†äº†è­¦å‘Šçš„å”¯ä¸€æ€§ã€‚è¿™æ ·ï¼Œç¬¬äºŒæ¬¡åŠå…¶åçš„è°ƒç”¨å°±ä¸ä¼šå†é‡å¤æ˜¾ç¤ºè­¦å‘Šäº†ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥ç¡®ä¿æ—¥å¿—æ–‡ä»¶æ›´åŠ æ¸…æ™°ï¼ŒåŒæ—¶ç”¨æˆ·å’Œå¼€å‘è€…ä¹Ÿèƒ½æ›´å®¹æ˜“åœ°å…³æ³¨åˆ°çœŸæ­£é‡è¦çš„ä¿¡æ¯ï¼Œè€Œä¸æ˜¯è¢«å¤§é‡é‡å¤çš„è­¦å‘Šä¿¡æ¯æ·¹æ²¡ã€‚</p><h2 id="process-env" tabindex="-1"><a class="header-anchor" href="#process-env"><span><a href="https://nodejs.org/docs/latest/api/process.html#processenv" target="_blank" rel="noopener noreferrer">process.env</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ JavaScript ä»£ç ã€‚è¿™ä½¿å¾—ç¼–å†™æ„å»ºåœ¨ Web æŠ€æœ¯ä¸Šçš„åç«¯ç¨‹åºå˜å¾—ç®€å•è€Œç›´æ¥ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰å¾ˆå¤šå†…ç½®å¯¹è±¡å’Œæ¨¡å—ï¼Œå…¶ä¸­<code>process</code>æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæ„å‘³ç€å®ƒåœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨ï¼Œä¸éœ€è¦åƒå…¶ä»–æ¨¡å—é‚£æ ·é€šè¿‡<code>require</code>å‡½æ•°å¼•å…¥ã€‚</p><h3 id="process-env-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#process-env-ç®€ä»‹"><span>process.env ç®€ä»‹</span></a></h3><p><code>process.env</code>æ˜¯ä¸€ä¸ªåŒ…å«äº†ç¯å¢ƒå˜é‡é”®å€¼å¯¹çš„å¯¹è±¡ã€‚ç¯å¢ƒå˜é‡æ˜¯åœ¨æ“ä½œç³»ç»Ÿå±‚é¢å®šä¹‰çš„ï¼Œå®ƒä»¬é€šå¸¸è¢«ç”¨æ¥è®¾ç½®ç¨‹åºè¿è¡Œç¯å¢ƒçš„æŸäº›æ¡ä»¶ï¼Œæ¯”å¦‚æ•°æ®åº“è¿æ¥ä¿¡æ¯æˆ–è€…å¤–éƒ¨æœåŠ¡çš„ API å¯†é’¥ç­‰ã€‚ä½¿ç”¨ç¯å¢ƒå˜é‡æ˜¯é…ç½®åº”ç”¨ç¨‹åºçš„ä¸€ç§å®‰å…¨å’Œçµæ´»çš„æ–¹å¼ï¼Œå› ä¸ºå®ƒä»¬ä¸éœ€è¦ç›´æ¥å†™åœ¨ä»£ç ä¸­ï¼Œå¯ä»¥æ ¹æ®éƒ¨ç½²ç¯å¢ƒçš„ä¸åŒè€Œè½»æ¾æ›´æ”¹ã€‚</p><h3 id="ä½¿ç”¨-process-env-çš„ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-process-env-çš„ä¾‹å­"><span>ä½¿ç”¨ process.env çš„ä¾‹å­</span></a></h3><h4 id="_1-è¯»å–ç¯å¢ƒå˜é‡" tabindex="-1"><a class="header-anchor" href="#_1-è¯»å–ç¯å¢ƒå˜é‡"><span>1. è¯»å–ç¯å¢ƒå˜é‡</span></a></h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåº”ç”¨éœ€è¦è¿æ¥åˆ°æ•°æ®åº“ï¼Œæ•°æ®åº“çš„åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡æä¾›ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dbHost</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">DB_HOST</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dbUser</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">DB_USER</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> dbPass</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">DB_PASS</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Connecting to database at </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">dbHost</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> with user </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">dbUser</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œå¯ä»¥ç”¨è¿™äº›å˜é‡å»è¿æ¥æ•°æ®åº“</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>process.env.DB_HOST</code>ã€<code>process.env.DB_USER</code>å’Œ<code>process.env.DB_PASS</code>åˆ†åˆ«è¯»å–äº†ç¯å¢ƒå˜é‡<code>DB_HOST</code>ã€<code>DB_USER</code>å’Œ<code>DB_PASS</code>çš„å€¼ã€‚</p><h4 id="_2-è®¾ç½®é»˜è®¤å€¼" tabindex="-1"><a class="header-anchor" href="#_2-è®¾ç½®é»˜è®¤å€¼"><span>2. è®¾ç½®é»˜è®¤å€¼</span></a></h4><p>æœ‰æ—¶å€™ï¼Œç¯å¢ƒå˜é‡å¯èƒ½æ²¡æœ‰è¢«è®¾ç½®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½æƒ³è¦ä¸ºæŸäº›å˜é‡æŒ‡å®šä¸€ä¸ªé»˜è®¤å€¼ã€‚ä¾‹å¦‚ï¼Œä½ çš„åº”ç”¨å¯èƒ½æœ‰ä¸€ä¸ªè°ƒè¯•æ¨¡å¼ï¼Œè¯¥æ¨¡å¼é»˜è®¤å…³é—­ï¼Œä½†å¯ä»¥é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡æ¥å¯ç”¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> isDebugEnabled</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">DEBUG_MODE</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;true&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">isDebugEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Debug mode is enabled&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Debug mode is disabled&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœç¯å¢ƒå˜é‡<code>DEBUG_MODE</code>è¢«è®¾ç½®ä¸ºå­—ç¬¦ä¸²<code>&#39;true&#39;</code>ï¼Œåˆ™<code>isDebugEnabled</code>å°†ä¸º<code>true</code>ï¼Œå¦åˆ™ä¸º<code>false</code>ã€‚</p><h4 id="_3-æ ¹æ®ç¯å¢ƒå˜é‡è°ƒæ•´è¡Œä¸º" tabindex="-1"><a class="header-anchor" href="#_3-æ ¹æ®ç¯å¢ƒå˜é‡è°ƒæ•´è¡Œä¸º"><span>3. æ ¹æ®ç¯å¢ƒå˜é‡è°ƒæ•´è¡Œä¸º</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶å¸Œæœ›æ ¹æ®æ˜¯åœ¨å¼€å‘ç¯å¢ƒè¿˜æ˜¯ç”Ÿäº§ç¯å¢ƒä¸­æ¥æ”¹å˜å…¶è¡Œä¸ºï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">NODE_ENV</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;production&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Running in production mode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œå¯ä»¥æ”¾ç½®ç”Ÿäº§ç¯å¢ƒç‰¹å®šçš„ä»£ç ï¼Œæ¯”å¦‚é”™è¯¯è¿½è¸ªæœåŠ¡åˆå§‹åŒ–</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Running in development mode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œå¯ä»¥æ”¾ç½®å¼€å‘ç¯å¢ƒç‰¹å®šçš„ä»£ç ï¼Œæ¯”å¦‚è¯¦ç»†çš„æ—¥å¿—è®°å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•é€šè¿‡æ£€æŸ¥<code>NODE_ENV</code>ç¯å¢ƒå˜é‡çš„å€¼æ¥åˆ¤æ–­åº”ç”¨å½“å‰è¿è¡Œåœ¨ä»€ä¹ˆç¯å¢ƒä¸‹ï¼Œå¹¶æ®æ­¤è°ƒæ•´å…¶è¡Œä¸ºã€‚</p><h3 id="æ€»ç»“-13" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-13"><span>æ€»ç»“</span></a></h3><p><code>process.env</code>æ˜¯ Node.js ä¸­ä¸€ä¸ªéå¸¸å®ç”¨çš„åŠŸèƒ½ï¼Œå®ƒè®©ä½ èƒ½å¤Ÿä»¥ä¸€ç§å®‰å…¨å’Œçµæ´»çš„æ–¹å¼é…ç½®ä½ çš„åº”ç”¨ç¨‹åºã€‚é€šè¿‡ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼Œä½ å¯ä»¥é¿å…ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯åˆ°æºä»£ç ä¸­ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾åœ°æ ¹æ®åº”ç”¨è¿è¡Œçš„ç¯å¢ƒï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç­‰ï¼‰æ¥è°ƒæ•´å…¶è¡Œä¸ºã€‚</p><h2 id="process-execargv" tabindex="-1"><a class="header-anchor" href="#process-execargv"><span><a href="https://nodejs.org/docs/latest/api/process.html#processexecargv" target="_blank" rel="noopener noreferrer">process.execArgv</a></span></a></h2><p>å½“ä½ å¯åŠ¨ Node.js è¿›ç¨‹æ—¶ï¼Œä½ å¯èƒ½ä¼šåœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ä¸€ç³»åˆ—é€‰é¡¹æ¥å®šåˆ¶è¿™ä¸ªè¿›ç¨‹çš„è¡Œä¸ºã€‚<code>process.execArgv</code>æ˜¯åœ¨ Node.js ä¸­ç”¨æ¥è®¿é—®è¿™äº›å¯åŠ¨é€‰é¡¹çš„æ–¹å¼ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†å¯åŠ¨ Node.js è¿›ç¨‹æ—¶ä¼ å…¥çš„å‘½ä»¤è¡Œé€‰é¡¹ï¼ˆä¸åŒ…æ‹¬ node è·¯å¾„å’Œè„šæœ¬è·¯å¾„ï¼‰ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="_1-å¯åŠ¨-node-js-å¹¶é™åˆ¶å†…å­˜ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#_1-å¯åŠ¨-node-js-å¹¶é™åˆ¶å†…å­˜ä½¿ç”¨"><span>1. å¯åŠ¨ Node.js å¹¶é™åˆ¶å†…å­˜ä½¿ç”¨</span></a></h4><p>å‡è®¾ä½ æƒ³è¦å¯åŠ¨ä¸€ä¸ª Node.js ç¨‹åºï¼Œå¹¶ä¸”ä¸ºäº†é¿å…ç¨‹åºæ¶ˆè€—å¤ªå¤šå†…å­˜ï¼Œä½ å†³å®šå°† V8 å¼•æ“çš„æœ€å¤§è€å¹´ä»£ï¼ˆè€ç”Ÿä»£ï¼‰å†…å­˜è®¾ç½®ä¸º 200MBã€‚ä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œé‡Œè¿™æ ·åšï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">node</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --max-old-space-size=200</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> yourScript.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ­¤æ—¶ï¼Œå¦‚æœåœ¨<code>yourScript.js</code>æ–‡ä»¶å†…éƒ¨ä½¿ç”¨<code>console.log(process.execArgv);</code>ï¼Œè¾“å‡ºå°†ä¼šæ˜¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;--max-old-space-size=200&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™è¡¨æ˜<code>process.execArgv</code>æ•è·äº†å¯åŠ¨ Node.js è¿›ç¨‹æ—¶æŒ‡å®šçš„å†…å­˜é™åˆ¶å‚æ•°ã€‚</p><h4 id="_2-åŠ¨æ€ä¿®æ”¹æ‰§è¡Œå‚æ•°" tabindex="-1"><a class="header-anchor" href="#_2-åŠ¨æ€ä¿®æ”¹æ‰§è¡Œå‚æ•°"><span>2. åŠ¨æ€ä¿®æ”¹æ‰§è¡Œå‚æ•°</span></a></h4><p>è€ƒè™‘åˆ°ä¸€ä¸ªæ›´å¤æ‚çš„åœºæ™¯ï¼Œä½ æ­£åœ¨å¼€å‘çš„åº”ç”¨éœ€è¦æ ¹æ®ç‰¹å®šæ¡ä»¶åŠ¨æ€åœ°è°ƒæ•´ Node.js çš„æŸäº›è¿è¡Œå‚æ•°ã€‚ä¾‹å¦‚ï¼ŒåŸºäºç”¨æˆ·è¾“å…¥æˆ–è€…é…ç½®æ–‡ä»¶ï¼Œä½ çš„åº”ç”¨å†³å®šæ˜¯å¦å¼€å¯è¯¦ç»†çš„ V8 åƒåœ¾å›æ”¶æ—¥å¿—ã€‚</p><p>å¦‚æœä½ çš„åº”ç”¨é€šè¿‡ä¸€ä¸ªå¯åŠ¨è„šæœ¬å¯åŠ¨ï¼Œè¿™ä¸ªè„šæœ¬å¯èƒ½ä¼šæ ¹æ®æ¡ä»¶åŠ¨æ€æ„é€ ä¸€ä¸ªåŒ…å«æ‰€éœ€å¯åŠ¨å‚æ•°çš„æ•°ç»„ï¼Œç„¶åä½¿ç”¨<code>child_process.spawn()</code>æ–¹æ³•å¯åŠ¨å®é™…çš„ Node.js åº”ç”¨è¿›ç¨‹ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">spawn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child_process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™ä¸ªå˜é‡æ ¹æ®æŸäº›é€»è¾‘å¾—å‡º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> verboseGC</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> args</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./app.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> execArgs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">verboseGC</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  execArgs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;--trace-gc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> child</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> spawn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">execPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  stdio</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;inherit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  execArgv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">execArgs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;exit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å­è¿›ç¨‹é€€å‡ºï¼Œé€€å‡ºç  </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">code</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœ<code>verboseGC</code>ä¸ºçœŸï¼Œåˆ™å¯åŠ¨çš„ Node.js è¿›ç¨‹ä¼šåŒ…å«<code>--trace-gc</code>å‚æ•°ï¼Œè¿™æ„å‘³ç€åƒåœ¾å›æ”¶æ´»åŠ¨ä¼šè¢«è®°å½•åˆ°æ§åˆ¶å°ã€‚è¿™é€šè¿‡<code>process.execArgv</code>åœ¨<code>app.js</code>å†…éƒ¨æ£€æŸ¥å¯è§ï¼Œå› ä¸ºå®ƒä¼šåŒ…å«ä¼ å…¥çš„æ‰€æœ‰æ‰§è¡Œå‚æ•°ã€‚</p><h3 id="æ€»ç»“-14" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-14"><span>æ€»ç»“</span></a></h3><p><code>process.execArgv</code>æä¾›äº†ä¸€ç§æ–¹æ³•æ¥æ£€æŸ¥å’Œæ“ä½œ Node.js è¿›ç¨‹çš„å¯åŠ¨å‚æ•°ï¼Œè¿™åœ¨è¯Šæ–­ã€è°ƒè¯•æˆ–è€…ç‰¹å®šè¡Œä¸ºå®šåˆ¶æ–¹é¢éå¸¸æœ‰ç”¨ã€‚é€šè¿‡ç†è§£å’Œä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œå¼€å‘è€…å¯ä»¥æ›´çµæ´»åœ°æ§åˆ¶ Node.js åº”ç”¨çš„è¡Œä¸ºï¼Œæ»¡è¶³å„ç§è¿è¡Œæ—¶éœ€æ±‚ã€‚</p><h2 id="process-execpath" tabindex="-1"><a class="header-anchor" href="#process-execpath"><span><a href="https://nodejs.org/docs/latest/api/process.html#processexecpath" target="_blank" rel="noopener noreferrer">process.execPath</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥æ·±å…¥ç†è§£ä¸€ä¸‹ Node.js ä¸­çš„ <code>process.execPath</code> è¿™ä¸ªå±æ€§ï¼Œå¹¶ä¸”é€šè¿‡ä¸€äº›å®é™…çš„ä¾‹å­æ¥æ¢ç´¢å®ƒçš„ç”¨æ³•ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-process-execpath" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-process-execpath"><span>ä»€ä¹ˆæ˜¯ <code>process.execPath</code>?</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code> å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†ä¸€ç³»åˆ—å±æ€§å’Œæ–¹æ³•ï¼Œè®©ä½ èƒ½å¤Ÿä¸å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹è¿›è¡Œäº¤äº’ã€‚è€Œ <code>process.execPath</code> å°±æ˜¯è¿™æ ·ä¸€ä¸ªå±æ€§ï¼Œå®ƒè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå¯åŠ¨å½“å‰ Node.js è¿›ç¨‹çš„å¯æ‰§è¡Œæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå‘Šè¯‰ä½ å½“å‰è¿è¡Œçš„ Node.js ç¨‹åºæ˜¯ä»å“ªä¸ªæ–‡ä»¶è·¯å¾„å¯åŠ¨çš„ã€‚</p><h3 id="å®é™…è¿ç”¨-1" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-1"><span>å®é™…è¿ç”¨</span></a></h3><h4 id="ç¤ºä¾‹-1-è·å–-node-js-å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-è·å–-node-js-å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„"><span>ç¤ºä¾‹ 1ï¼šè·å– Node.js å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ï¼Œéœ€è¦æ ¹æ® Node.js çš„å®‰è£…ä½ç½®æ¥å†³å®šæŸäº›æ“ä½œï¼Œæˆ–è€…ä»…ä»…æ˜¯æƒ³è®°å½•ä¸‹å½“å‰ä½¿ç”¨çš„ Node.js ç‰ˆæœ¬å’Œå…¶è·¯å¾„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>process.execPath</code> å°±éå¸¸æœ‰ç”¨äº†ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">execPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œå°†è¾“å‡ºç±»ä¼¼äºä»¥ä¸‹å†…å®¹ï¼ˆå…·ä½“è·¯å¾„å–å†³äºä½ çš„ç³»ç»Ÿå’Œ Node.js å®‰è£…ä½ç½®ï¼‰ï¼š</p><ul><li>åœ¨ Windows ä¸Šå¯èƒ½æ˜¯ï¼š<code>C:\Program Files\nodejs\node.exe</code></li><li>åœ¨ macOS æˆ– Linux ä¸Šå¯èƒ½æ˜¯ï¼š<code>/usr/local/bin/node</code></li></ul><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨-execpath-å¯åŠ¨æ–°çš„-node-js-è¿›ç¨‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨-execpath-å¯åŠ¨æ–°çš„-node-js-è¿›ç¨‹"><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨ execPath å¯åŠ¨æ–°çš„ Node.js è¿›ç¨‹</span></a></h4><p>å‡å¦‚ä½ éœ€è¦åœ¨ä½ çš„åº”ç”¨ä¸­å¯åŠ¨å¦ä¸€ä¸ª Node.js è„šæœ¬ã€‚äº†è§£åˆ° Node.js å¯æ‰§è¡Œæ–‡ä»¶çš„ç¡®åˆ‡ä½ç½®ï¼ˆé€šè¿‡ <code>process.execPath</code>ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>child_process</code> æ¨¡å—æ¥å¯åŠ¨ä¸€ä¸ªæ–°çš„è¿›ç¨‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">spawn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child_process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å­è¿›ç¨‹è¦è¿è¡Œçš„è„šæœ¬</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> scriptPath</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;path/to/your/script.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> child</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> spawn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">execPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, [</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">scriptPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stdout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`stdout: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stderr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`stderr: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;close&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å­è¿›ç¨‹é€€å‡ºï¼Œé€€å‡ºç  </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">code</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆå¼•å…¥äº† Node.js çš„ <code>child_process</code> æ¨¡å—ï¼Œç„¶åä½¿ç”¨ <code>spawn</code> æ–¹æ³•å¯åŠ¨äº†ä¸€ä¸ªæ–°çš„ Node.js è¿›ç¨‹æ¥è¿è¡ŒæŒ‡å®šçš„ JavaScript æ–‡ä»¶ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬åˆ©ç”¨äº† <code>process.execPath</code> æ¥ä¿è¯æ— è®ºåœ¨ä»€ä¹ˆç³»ç»Ÿä¸Šï¼Œéƒ½èƒ½æ‰¾åˆ°æ­£ç¡®çš„ Node.js å¯æ‰§è¡Œæ–‡ä»¶æ¥è¿è¡Œè„šæœ¬ã€‚</p><h3 id="æ€»ç»“-15" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-15"><span>æ€»ç»“</span></a></h3><p><code>process.execPath</code> æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„ Node.js å±æ€§ï¼Œå®ƒä¸ºå¼€å‘è€…æä¾›äº†ä¸€ç§æ–¹æ³•æ¥ç¡®å®šå’Œä½¿ç”¨å½“å‰ Node.js å¯æ‰§è¡Œæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚æ— è®ºæ˜¯è¿›è¡Œæ—¥å¿—è®°å½•ã€è°ƒè¯•ï¼Œè¿˜æ˜¯åœ¨æ›´å¤æ‚çš„åœºæ™¯ä¸‹å¯åŠ¨æ–°çš„ Node.js è¿›ç¨‹ï¼Œ<code>process.execPath</code> éƒ½èƒ½æ´¾ä¸Šç”¨åœºã€‚</p><h2 id="process-exit-code" tabindex="-1"><a class="header-anchor" href="#process-exit-code"><span><a href="https://nodejs.org/docs/latest/api/process.html#processexitcode" target="_blank" rel="noopener noreferrer">process.exit([code])</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªèƒ½å¤Ÿè®©å¼€å‘è€…ä½¿ç”¨ JavaScript ç¼–å†™æœåŠ¡å™¨ç«¯è½¯ä»¶çš„å¹³å°ã€‚å…¶ä¸­ï¼Œ<code>process.exit([code])</code>æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªéå¸¸é‡è¦çš„åŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ å‘Šè¯‰ Node.js ç¨‹åºè¦ç«‹å³åœæ­¢è¿è¡Œã€‚</p><h3 id="è§£é‡Š-process-exit-code" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-process-exit-code"><span>è§£é‡Š <code>process.exit([code])</code></span></a></h3><ul><li><strong>ä½œç”¨</strong>ï¼š<code>process.exit([code])</code> æ–¹æ³•ç”¨äºé€€å‡ºå½“å‰çš„ Node.js è¿›ç¨‹ï¼Œå¹¶ä¸”å¯ä»¥ç»™æ“ä½œç³»ç»Ÿæä¾›ä¸€ä¸ªé€€å‡ºç ã€‚è¿™ä¸ªé€€å‡ºç é€šå¸¸ç”¨æ¥æŒ‡ç¤ºç¨‹åºæ˜¯æ­£å¸¸ç»“æŸè¿˜æ˜¯é‡åˆ°äº†é”™è¯¯ã€‚</li><li><strong>å‚æ•° <code>[code]</code></strong>ï¼šè¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œé»˜è®¤å€¼ä¸º <code>0</code>ã€‚åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼Œ<code>0</code> ä»£è¡¨æ‰§è¡ŒæˆåŠŸè€Œæ— ä»»ä½•é”™è¯¯ï¼›é <code>0</code> å€¼è¡¨ç¤ºæœ‰é”™è¯¯å‘ç”Ÿã€‚ä¾‹å¦‚ï¼Œ<code>1</code> é€šå¸¸è¢«ç”¨æ¥è¡¨ç¤ºé€šç”¨é”™è¯¯ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-6"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>ç®€å•é€€å‡º</strong>ï¼š<br> å¦‚æœä½ çš„ Node.js åº”ç”¨ç¨‹åºå·²ç»å®Œæˆäº†æ‰€æœ‰ä»»åŠ¡ï¼Œæ²¡æœ‰ä»€ä¹ˆæ›´å¤šå·¥ä½œéœ€è¦åšï¼Œä½ å¯ä»¥ç®€å•åœ°è°ƒç”¨ <code>process.exit()</code> æ¥å¹²å‡€åˆ©è½åœ°é€€å‡ºç¨‹åºã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä»»åŠ¡å®Œæˆï¼Œå‡†å¤‡é€€å‡º&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>é”™è¯¯å¤„ç†</strong>ï¼š<br> å½“ä½ çš„ç¨‹åºé‡åˆ°ä¸€ä¸ªä¸èƒ½æ¢å¤çš„é”™è¯¯æ—¶ï¼Œä½ å¯èƒ½æƒ³ç«‹å³ç»ˆæ­¢ç¨‹åºï¼Œå¹¶ä¸”é€šè¿‡é€€å‡ºç æ ‡ç¤ºå‡ºé”™è¯¯ç±»å‹ã€‚è¿™å¯¹äºè°ƒè¯•æˆ–è€…ç¨‹åºä¸å…¶ä»–è½¯ä»¶é›†æˆæ—¶éå¸¸æœ‰ç”¨ã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°è¯•æ‰§è¡ŒæŸäº›ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å‘ç”Ÿé”™è¯¯:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨é€€å‡ºç  1 è¡¨ç¤ºæœ‰é”™è¯¯å‘ç”Ÿ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>è„šæœ¬ç¼–å†™</strong>ï¼š<br> åœ¨ç¼–å†™è‡ªåŠ¨åŒ–è„šæœ¬æ—¶ï¼Œæ ¹æ®ä¸åŒçš„æ‰§è¡Œç»“æœè¿”å›ä¸åŒçš„é€€å‡ºç éå¸¸æœ‰ç”¨ã€‚è¿™æ ·çˆ¶è¿›ç¨‹æˆ–è€…è°ƒç”¨è¿™ä¸ªè„šæœ¬çš„ç¨‹åºå¯ä»¥æ ¹æ®é€€å‡ºç å†³å®šä¸‹ä¸€æ­¥æ€ä¹ˆåšã€‚</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">access</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;somefile.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">F_OK</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–‡ä»¶ä¸å­˜åœ¨&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨é€€å‡ºç  2 è¡¨ç¤ºæ–‡ä»¶ä¸å­˜åœ¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ–‡ä»¶å­˜åœ¨&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆåŠŸï¼Œæ— é”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="æ³¨æ„äº‹é¡¹-4" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-4"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>ä½¿ç”¨ <code>process.exit()</code> å°†ä¼šå¼ºåˆ¶ç¨‹åºç«‹å³é€€å‡ºï¼Œè¿™æ„å‘³ç€ä»»ä½•è¿˜æ²¡æœ‰å®Œæˆçš„å¼‚æ­¥æ“ä½œã€æ­£åœ¨è¿›è¡Œä¸­çš„ I/O æ“ä½œç­‰éƒ½ä¼šçªç„¶ä¸­æ–­ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰åº”å½“ç¡®ä¿æ‰€æœ‰å¿…è¦çš„æ¸…ç†å·¥ä½œéƒ½å·²å®Œæˆã€‚</li><li>å¦‚æœå¯èƒ½çš„è¯ï¼Œæœ€å¥½è®© Node.js ç¨‹åºè‡ªç„¶é€€å‡ºï¼Œä¹Ÿå°±æ˜¯åœ¨å®Œæˆæ‰€æœ‰å·¥ä½œä¹‹åä¸è°ƒç”¨ <code>process.exit()</code>ï¼Œè®©ç¨‹åºè‡ªå·±ç»“æŸã€‚è¿™ç§æ–¹å¼æ¯”è¾ƒä¼˜é›…ï¼Œèƒ½ä¿è¯æ‰€æœ‰çš„èµ„æºéƒ½å¾—åˆ°å¦¥å–„çš„å¤„ç†ã€‚</li></ul><h2 id="process-exitcode" tabindex="-1"><a class="header-anchor" href="#process-exitcode"><span><a href="https://nodejs.org/docs/latest/api/process.html#processexitcode_1" target="_blank" rel="noopener noreferrer">process.exitCode</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚åœ¨ Node.js ä¸­ï¼Œ<code>process</code> å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæä¾›äº†å…³äºå½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚<code>process.exitCode</code> å±æ€§å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-process-exitcode" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-process-exitcode"><span>ä»€ä¹ˆæ˜¯ <code>process.exitCode</code>ï¼Ÿ</span></a></h3><p><code>process.exitCode</code> å±æ€§ç”¨æ¥æŒ‡å®šè¿›ç¨‹é€€å‡ºæ—¶çš„ä»£ç ã€‚åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼ˆæ¯”å¦‚ Linux å’Œ macOSï¼‰ï¼Œè¿™ä¸ªé€€å‡ºç æ˜¯ä¸€ä¸ªæ•´æ•°å€¼ï¼Œç”¨äºè¡¨ç¤ºç¨‹åºæ‰§è¡Œçš„æˆåŠŸæˆ–å¤±è´¥ã€‚é€šå¸¸ï¼Œ<code>0</code> è¡¨ç¤ºæˆåŠŸï¼Œé <code>0</code> å€¼è¡¨ç¤ºå‘ç”Ÿäº†é”™è¯¯æˆ–å¼‚å¸¸ã€‚</p><h3 id="è®¾ç½®-process-exitcode" tabindex="-1"><a class="header-anchor" href="#è®¾ç½®-process-exitcode"><span>è®¾ç½® <code>process.exitCode</code></span></a></h3><p>ä½ å¯ä»¥åœ¨ç¨‹åºä»»ä½•éœ€è¦çš„åœ°æ–¹è®¾ç½® <code>process.exitCode</code> çš„å€¼ã€‚å½“ Node.js è¿›ç¨‹è‡ªç„¶ç»“æŸæ‰§è¡Œæ—¶ï¼ˆå³äº‹ä»¶å¾ªç¯ä¸­æ²¡æœ‰æ›´å¤šå·¥ä½œè¦åšæ—¶ï¼‰ï¼ŒNode.js å°†ä½¿ç”¨ <code>process.exitCode</code> çš„å€¼ä½œä¸ºè¿›ç¨‹çš„é€€å‡ºç ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯-1"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><p>ä¸‹é¢æ˜¯ä¸€äº› <code>process.exitCode</code> çš„å®é™…åº”ç”¨ä¾‹å­ï¼š</p><ol><li><p><strong>ç®€å•çš„è„šæœ¬æ‰§è¡Œæƒ…å†µåé¦ˆ</strong></p><p>å¦‚æœä½ ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„è„šæœ¬æ¥å¤„ç†æ–‡ä»¶æˆ–æ•°æ®ï¼Œå¹¶ä¸”æƒ³åœ¨è„šæœ¬æˆåŠŸæ‰§è¡Œå®Œæ¯•ååé¦ˆç»™æ“ä½œç³»ç»Ÿä¸€ä¸ªæˆåŠŸä¿¡å·ï¼ˆæˆ–è€…åœ¨å‡ºç°é”™è¯¯æ—¶è¿”å›ä¸€ä¸ªé”™è¯¯ä¿¡å·ï¼‰ï¼Œä½ å¯ä»¥è®¾ç½® <code>process.exitCode</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°è¯•æ‰§è¡ŒæŸäº›æ“ä½œ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ“ä½œæˆåŠŸå®Œæˆ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exitCode</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æˆåŠŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ“ä½œå¤±è´¥:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exitCode</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>é›†æˆæµ‹è¯•</strong></p><p>å½“ä½¿ç”¨ Node.js ç¼–å†™è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬æ—¶ï¼Œ<code>process.exitCode</code> å¯ä»¥ç”¨æ¥æŒ‡ç¤ºæµ‹è¯•ç»“æœã€‚æˆåŠŸçš„æµ‹è¯•å¯ä»¥è®¾ç½® <code>exitCode</code> ä¸º <code>0</code>ï¼Œè€Œå¤±è´¥çš„æµ‹è¯•åˆ™å¯ä»¥è®¾ç½®ä¸ºå…¶ä»–å€¼ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">runTests</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ‰€æœ‰æµ‹è¯•é€šè¿‡&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exitCode</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æµ‹è¯•å¤±è´¥:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exitCode</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>CLI å·¥å…·</strong></p><p>å¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼ˆCLIï¼‰ï¼Œæ ¹æ®ä¸åŒçš„å‘½ä»¤æ‰§è¡Œç»“æœï¼Œå¯ä»¥è®¾ç½®ä¸åŒçš„ <code>process.exitCode</code>ã€‚è¿™å¯¹äºè„šæœ¬ç¼–å†™å’Œè‡ªåŠ¨åŒ–ä»»åŠ¡ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥æ ¹æ®é€€å‡ºç æ¥å†³å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> args</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">argv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–å‘½ä»¤è¡Œå‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">switch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  case</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;--help&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exitCode</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    break</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  case</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;--version&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exitCode</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    break</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  default</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ— æ•ˆçš„å‘½ä»¤&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exitCode</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="æ³¨æ„äº‹é¡¹-5" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-5"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>ç›´æ¥è°ƒç”¨ <code>process.exit()</code> æ–¹æ³•ä¹Ÿå¯ä»¥ä½¿ Node.js è¿›ç¨‹é€€å‡ºï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥ä¼ é€’é€€å‡ºç ã€‚ä½†ä½¿ç”¨ <code>process.exitCode</code> å¹¶è®©è¿›ç¨‹è‡ªç„¶ç»“æŸå¯èƒ½æ›´ä¼˜é›…ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥ä¿è¯æ‰€æœ‰å¼‚æ­¥æ“ä½œï¼ˆä¾‹å¦‚æ–‡ä»¶æ“ä½œå’Œç½‘ç»œè¯·æ±‚ï¼‰æ­£å¸¸å®Œæˆã€‚</li><li>è®¾ç½® <code>process.exitCode</code> ä¸ä¼šç«‹å³ç»ˆæ­¢ Node.js è¿›ç¨‹ï¼Œè€Œæ˜¯ç­‰å¾…æ‰€æœ‰å¾…å¤„ç†çš„ä»»åŠ¡å®Œæˆåæ‰ä¼šè‡ªåŠ¨é€€å‡ºã€‚</li></ul><p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>process.exitCode</code> æä¾›äº†ä¸€ç§ä¼˜é›…çš„æ–¹å¼æ¥æ§åˆ¶ Node.js åº”ç”¨çš„é€€å‡ºçŠ¶æ€ï¼Œä½¿å¾—å¤–éƒ¨ç¨‹åºæˆ–è„šæœ¬å¯ä»¥æ ¹æ®è¿™ä¸ªé€€å‡ºç æ¥åˆ¤æ–­åº”ç”¨çš„æ‰§è¡Œç»“æœæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚</p><h2 id="process-getactiveresourcesinfo" tabindex="-1"><a class="header-anchor" href="#process-getactiveresourcesinfo"><span><a href="https://nodejs.org/docs/latest/api/process.html#processgetactiveresourcesinfo" target="_blank" rel="noopener noreferrer">process.getActiveResourcesInfo()</a></span></a></h2><p>Node.js v21.7.1 ä¸­çš„<code>process.getActiveResourcesInfo()</code>æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å‡½æ•°ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬äº†è§£å½“å‰ Node.js è¿›ç¨‹ä¸­æ´»è·ƒçš„èµ„æºä¿¡æ¯ã€‚åœ¨ Node.js çš„ä¸–ç•Œé‡Œï¼Œ&quot;èµ„æº&quot;é€šå¸¸æŒ‡çš„æ˜¯ä¸€äº›ç³»ç»Ÿçº§çš„å¯¹è±¡ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶æ“ä½œç­‰ï¼Œå®ƒä»¬æ˜¯å¼‚æ­¥æ“ä½œçš„åŸºç¡€ï¼Œå¯¹äºç†è§£å’Œä¼˜åŒ–åº”ç”¨çš„æ€§èƒ½è‡³å…³é‡è¦ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯process-getactiveresourcesinfo" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯process-getactiveresourcesinfo"><span>ä»€ä¹ˆæ˜¯<code>process.getActiveResourcesInfo()</code>ï¼Ÿ</span></a></h3><p>è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†å½“å‰è¿›ç¨‹ä¸­æ¯ä¸ªæ´»è·ƒèµ„æºçš„è¯¦ç»†ä¿¡æ¯ã€‚é€šè¿‡è¿™äº›ä¿¡æ¯ï¼Œå¼€å‘è€…å¯ä»¥è·å¾—å¯¹å½“å‰è¿è¡ŒçŠ¶å†µçš„æ·±å…¥äº†è§£ï¼Œæ¯”å¦‚å“ªäº›èµ„æºè¿˜åœ¨ä½¿ç”¨ä¸­ã€èµ„æºçš„ç±»å‹ä»¥åŠèµ„æºç›¸å…³çš„é¢å¤–ä¿¡æ¯ã€‚</p><h3 id="è¿”å›çš„ä¿¡æ¯åŒ…æ‹¬" tabindex="-1"><a class="header-anchor" href="#è¿”å›çš„ä¿¡æ¯åŒ…æ‹¬"><span>è¿”å›çš„ä¿¡æ¯åŒ…æ‹¬ï¼š</span></a></h3><ul><li><code>type</code>ï¼šèµ„æºçš„ç±»å‹ï¼Œæ¯”å¦‚<code>tcp</code>ã€<code>promise</code>ã€<code>timeout</code>ç­‰ã€‚</li><li><code>asyncId</code>ï¼šèµ„æºçš„å¼‚æ­¥ IDã€‚</li><li><code>triggerAsyncId</code>ï¼šè§¦å‘è¿™ä¸ªèµ„æºçš„å¼‚æ­¥æ“ä½œçš„ IDã€‚</li><li>ä»¥åŠå…¶ä»–ç±»å‹ç‰¹æœ‰çš„ä¿¡æ¯ï¼Œå¦‚èµ„æºçš„å…·ä½“çŠ¶æ€ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-1"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-ç›‘æ§èµ„æºæ³„æ¼" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç›‘æ§èµ„æºæ³„æ¼"><span>ä¾‹å­ 1ï¼šç›‘æ§èµ„æºæ³„æ¼</span></a></h4><p>å‡è®¾ä½ çš„ Node.js åº”ç”¨å‡ºç°äº†æ€§èƒ½ä¸‹é™çš„é—®é¢˜ï¼Œä½ æ€€ç–‘æ˜¯æŸäº›èµ„æºæ²¡æœ‰è¢«æ­£ç¡®é‡Šæ”¾ï¼Œé€ æˆäº†å†…å­˜æ³„æ¼ã€‚é€šè¿‡<code>process.getActiveResourcesInfo()</code>ï¼Œä½ å¯ä»¥å®šæœŸæ£€æŸ¥æ´»è·ƒçš„èµ„æºï¼Œåˆ†æå“ªäº›èµ„æºé•¿æ—¶é—´æœªè¢«é‡Šæ”¾ï¼Œè¿›è€Œå®šä½æ³„æ¼çš„æ¥æºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getActiveResourcesInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šæ¯ 10 ç§’æ‰“å°ä¸€æ¬¡æ‰€æœ‰æ´»è·ƒèµ„æºçš„ä¿¡æ¯ï¼Œä½ å¯ä»¥é€šè¿‡è¿™äº›ä¿¡æ¯è§‚å¯Ÿåˆ°å“ªäº›èµ„æºæŒç»­å­˜åœ¨ï¼Œå¯èƒ½æ˜¯æ³„æ¼çš„æºå¤´ã€‚</p><h4 id="ä¾‹å­-2-æ€§èƒ½è°ƒä¼˜" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-æ€§èƒ½è°ƒä¼˜"><span>ä¾‹å­ 2ï¼šæ€§èƒ½è°ƒä¼˜</span></a></h4><p>åœ¨è¿›è¡Œæ€§èƒ½è°ƒä¼˜æ—¶ï¼Œäº†è§£ç³»ç»Ÿèµ„æºçš„ä½¿ç”¨æƒ…å†µæ˜¯éå¸¸é‡è¦çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å‘ç°æœ‰å¤§é‡çš„<code>tcp</code>è¿æ¥å¤„äºæ´»è·ƒçŠ¶æ€ï¼Œå¯èƒ½éœ€è¦æ£€æŸ¥ç½‘ç»œè¯·æ±‚æ˜¯å¦è¢«æ­£ç¡®ç®¡ç†ï¼Œæˆ–è€…æ˜¯å¦æœ‰è¿‡å¤šçš„å¹¶å‘è¿æ¥ï¼Œè¿™äº›éƒ½å¯èƒ½æ˜¯å¯¼è‡´åº”ç”¨æ€§èƒ½é—®é¢˜çš„åŸå› ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> resourcesInfo</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getActiveResourcesInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> tcpResources</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> resourcesInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">filter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> info</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;tcp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Active TCP connections: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">tcpResources</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å¯ä»¥å¸®åŠ©ä½ äº†è§£å½“å‰è¿›ç¨‹ä¸­æ´»è·ƒçš„ TCP è¿æ¥æ•°ï¼Œä»è€Œåˆ†æç½‘ç»œèµ„æºçš„ä½¿ç”¨æƒ…å†µã€‚</p><h3 id="æ€»ç»“-16" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-16"><span>æ€»ç»“</span></a></h3><p><code>process.getActiveResourcesInfo()</code>æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ æ·±å…¥äº†è§£å¹¶ä¼˜åŒ–ä½ çš„ Node.js åº”ç”¨ã€‚æ— è®ºæ˜¯è¯Šæ–­æ€§èƒ½é—®é¢˜è¿˜æ˜¯ç›‘æ§èµ„æºä½¿ç”¨ï¼Œå®ƒéƒ½èƒ½æä¾›å®è´µçš„ä¿¡æ¯ã€‚è®°å¾—ï¼Œåˆç†ä½¿ç”¨å¹¶ç»“åˆå…¶ä»–æ€§èƒ½åˆ†æå·¥å…·ï¼Œæ‰èƒ½æ›´å…¨é¢åœ°ä¼˜åŒ–ä½ çš„åº”ç”¨æ€§èƒ½ã€‚</p><h2 id="process-getegid" tabindex="-1"><a class="header-anchor" href="#process-getegid"><span><a href="https://nodejs.org/docs/latest/api/process.html#processgetegid" target="_blank" rel="noopener noreferrer">process.getegid()</a></span></a></h2><p>åœ¨è§£é‡Š<code>process.getegid()</code>ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å‡ ä¸ªæ¦‚å¿µï¼šè¿›ç¨‹ã€ç”¨æˆ· IDï¼ˆUIDï¼‰ã€ç»„ IDï¼ˆGIDï¼‰ï¼Œä»¥åŠåœ¨ Linux å’Œç±» Unix ç³»ç»Ÿä¸­çš„æœ‰æ•ˆç»„ IDï¼ˆeffective group ID, eGIDï¼‰ã€‚</p><ul><li><strong>è¿›ç¨‹</strong>ï¼šåœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€ä¸ªå®ä¾‹ï¼Œæ­£åœ¨æ‰§è¡Œä¸­çš„ç¨‹åºã€‚</li><li><strong>ç”¨æˆ· ID (UID)</strong>ï¼šæ˜¯æŒ‡åˆ†é…ç»™æ¯ä¸ªç”¨æˆ·è´¦æˆ·çš„å”¯ä¸€æ•°å­—æ ‡è¯†ç¬¦ã€‚ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨ UID è€Œä¸æ˜¯ç”¨æˆ·åæ¥è¯†åˆ«ç”¨æˆ·ã€‚</li><li><strong>ç»„ ID (GID)</strong>ï¼šä¸ UID ç›¸ä¼¼ï¼Œæ¯ä¸ªç”¨æˆ·è¿˜å¯ä»¥å±äºä¸€ä¸ªæˆ–å¤šä¸ªç”¨æˆ·ç»„ï¼Œæ¯ä¸ªç»„ä¹Ÿæœ‰ä¸€ä¸ªå”¯ä¸€çš„æ•°å­—æ ‡è¯†ç¬¦ï¼Œç§°ä¸ºç»„ IDã€‚</li><li><strong>æœ‰æ•ˆç»„ ID (eGID)</strong>ï¼šåœ¨ Unix å’Œç±» Unix ç³»ç»Ÿä¸­ï¼Œè¿è¡Œè¿›ç¨‹çš„æœ‰æ•ˆç»„ ID å¯èƒ½ä¸å¯åŠ¨è¯¥è¿›ç¨‹çš„ç”¨æˆ·çš„å®é™…ç»„ ID ä¸åŒã€‚è¿™ä¸»è¦ç”¨äºæƒé™æ§åˆ¶ï¼Œè®©è¿›ç¨‹æœ‰èƒ½åŠ›ä»¥ä¸åŒäºå¯åŠ¨å®ƒçš„ç”¨æˆ·çš„æƒé™è¿è¡Œã€‚</li></ul><h3 id="process-getegid-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#process-getegid-æ–¹æ³•"><span>process.getegid()æ–¹æ³•</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code>å¯¹è±¡æä¾›äº†ä¸€å¥—ä¸å½“å‰ Node.js è¿›ç¨‹ç›¸å…³çš„åŠŸèƒ½ã€‚<code>process.getegid()</code>æ–¹æ³•æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œè¿™ä¸ªæ–¹æ³•ä»…åœ¨ Node.js è¿è¡Œåœ¨ POSIX å…¼å®¹çš„æ“ä½œç³»ç»Ÿä¸Šæ—¶æœ‰æ•ˆï¼ˆä¾‹å¦‚ Linuxã€UNIX ç­‰ï¼‰ï¼Œå› ä¸ºå®ƒä¸æ“ä½œç³»ç»Ÿçš„ç”¨æˆ·å’Œç»„æƒé™ç®¡ç†æœºåˆ¶ç´§å¯†ç›¸å…³ã€‚</p><p>å½“ä½ è°ƒç”¨<code>process.getegid()</code>æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªæ•°å­—ï¼Œè¿™ä¸ªæ•°å­—æ˜¯å½“å‰ Node.js è¿›ç¨‹çš„æœ‰æ•ˆç»„ IDï¼ˆeGIDï¼‰ã€‚å¦‚æœ Node.js åœ¨ä¸æ”¯æŒæ­¤æ¦‚å¿µçš„å¹³å°ä¸Šè¿è¡Œï¼ˆå¦‚ Windowsï¼‰ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-2"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><ol><li><p><strong>æƒé™ç®¡ç†</strong>ï¼šå‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºéœ€è¦è®¿é—®ç³»ç»Ÿä¸ŠæŸäº›å—é™åˆ¶çš„æ–‡ä»¶æˆ–èµ„æºã€‚é€šè¿‡æ£€æŸ¥å…¶æœ‰æ•ˆç»„ IDï¼Œç¨‹åºå¯ä»¥ç¡®å®šè‡ªå·±æ˜¯å¦æœ‰è¶³å¤Ÿçš„æƒé™è®¿é—®è¿™äº›èµ„æºã€‚å¦‚æœæ²¡æœ‰ï¼Œç¨‹åºå¯ä»¥æ®æ­¤å†³å®šæ‹’ç»æ‰§è¡Œç‰¹å®šæ“ä½œæˆ–è€…ä»¥ä¸åŒçš„æ–¹å¼è¡Œäº‹ã€‚</p></li><li><p><strong>å®‰å…¨å®¡è®¡</strong>ï¼šåœ¨åˆ›å»ºæ—¥å¿—è®°å½•æˆ–è¿›è¡Œå®‰å…¨å®¡è®¡æ—¶ï¼Œè®°å½•ä¸‹æ‰§è¡ŒæŸäº›æ“ä½œçš„è¿›ç¨‹çš„ UID å’Œ GID å¯ä»¥å¸®åŠ©è¿½è¸ªè°åœ¨ä»€ä¹ˆæ—¶é—´è¿›è¡Œäº†å“ªäº›æ“ä½œã€‚</p></li><li><p><strong>å¤šç”¨æˆ·ç¯å¢ƒä¸­çš„èµ„æºå…±äº«</strong>ï¼šå‡è®¾ä½ çš„ Node.js åº”ç”¨æœåŠ¡äºä¸€ä¸ªå¤šç”¨æˆ·ç³»ç»Ÿï¼Œåœ¨è¿™ç§ç³»ç»Ÿä¸­ï¼Œä¸åŒçš„ç”¨æˆ·å¯èƒ½å±äºä¸åŒçš„ç»„ï¼Œå®ƒä»¬å¯¹æŸäº›å…±äº«èµ„æºæœ‰ä¸åŒçš„è®¿é—®æƒé™ã€‚é€šè¿‡æ£€æŸ¥è¿›ç¨‹çš„ eGIDï¼Œåº”ç”¨å¯ä»¥åˆ¤æ–­è‡ªå·±æ˜¯å¦èƒ½ä»£è¡¨æŸä¸ªç”¨æˆ·ç¾¤ä½“è®¿é—®è¿™äº›èµ„æºã€‚</p></li></ol><h3 id="ç¤ºä¾‹ä»£ç -2" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -2"><span>ç¤ºä¾‹ä»£ç </span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">platform</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> !==</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;win32&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å½“å‰è¿›ç¨‹çš„æœ‰æ•ˆç»„IDæ˜¯: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getegid</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ­¤æ–¹æ³•åœ¨Windowså¹³å°ä¸Šä¸å¯ç”¨ã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆæ£€æŸ¥è¿è¡Œå¹³å°ï¼Œå¦‚æœä¸æ˜¯ Windowsï¼Œåˆ™è¾“å‡ºå½“å‰è¿›ç¨‹çš„æœ‰æ•ˆç»„ IDï¼›å¦‚æœæ˜¯ Windowsï¼Œåˆ™æç¤ºè¯¥æ–¹æ³•ä¸å¯ç”¨ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>process.getegid()</code>æ–¹æ³•æ˜¯ä¸ç³»ç»Ÿçº§æƒé™æ§åˆ¶ç›¸å…³çš„ï¼Œå®ƒè®© Node.js åº”ç”¨èƒ½å¤Ÿæ›´ç²¾ç»†åœ°è·å–å’Œå¤„ç†æ“ä½œç³»ç»Ÿçº§çš„æƒé™ä¿¡æ¯ã€‚</p><h2 id="process-geteuid" tabindex="-1"><a class="header-anchor" href="#process-geteuid"><span><a href="https://nodejs.org/docs/latest/api/process.html#processgeteuid" target="_blank" rel="noopener noreferrer">process.geteuid()</a></span></a></h2><p>Node.js ä¸­çš„<code>process.geteuid()</code>æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºè·å–å½“å‰è¿›ç¨‹çš„æœ‰æ•ˆç”¨æˆ·èº«ä»½ï¼ˆeffective user IDï¼‰çš„æ•°å­—æ ‡è¯†ã€‚åœ¨ Unix-like ç³»ç»Ÿï¼ˆå¦‚ Linuxã€macOS ç­‰ï¼‰ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç”¨æˆ· IDï¼ˆUIDï¼‰ï¼Œè¿™æ˜¯ç®¡ç†æƒé™å’Œæ§åˆ¶å¯¹ç³»ç»Ÿèµ„æºè®¿é—®çš„å…³é”®æ–¹å¼ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ul><li><strong>è¿›ç¨‹</strong>ï¼šè¿è¡Œä¸­çš„ç¨‹åºå®ä¾‹ã€‚</li><li><strong>ç”¨æˆ· ID (UID)</strong>ï¼šæ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªç”¨æˆ·è´¦å·åˆ†é…çš„å”¯ä¸€æ•°å­—æ ‡è¯†ã€‚</li><li><strong>æœ‰æ•ˆç”¨æˆ· ID (EUID)</strong>ï¼šå†³å®šäº†è¿›ç¨‹æ‰§è¡Œæ—¶æ‹¥æœ‰çš„æƒé™ï¼Œé€šå¸¸æƒ…å†µä¸‹ EUID ç­‰åŒäºå¯åŠ¨è¿›ç¨‹çš„ç”¨æˆ·çš„ UIDï¼Œä½†åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹å¯ä»¥ä¸åŒã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯-2" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯-2"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><p><code>process.geteuid()</code>çš„ä½¿ç”¨åœºæ™¯ä¸»è¦ä¸å®‰å…¨æ€§å’Œæƒé™ç®¡ç†ç›¸å…³ã€‚ä¾‹å¦‚ï¼š</p><ol><li><p><strong>æƒé™åˆ¤æ–­</strong>ï¼šåœ¨ä¸€ä¸ª Node.js åº”ç”¨ä¸­ï¼Œå¯èƒ½éœ€è¦æ ¹æ®è¿è¡Œè¯¥åº”ç”¨çš„ç”¨æˆ·çš„æƒé™æ¥å†³å®šæ˜¯å¦å…è®¸æ‰§è¡ŒæŸäº›æ“ä½œã€‚é€šè¿‡<code>process.geteuid()</code>è·å¾—çš„å€¼ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬äº†è§£å½“å‰è¿›ç¨‹æ˜¯ä»¥å“ªä¸ªç”¨æˆ·çš„æƒé™è¿è¡Œçš„ã€‚</p></li><li><p><strong>æ¡ä»¶é€»è¾‘</strong>ï¼šåœ¨ç¼–å†™éœ€è¦è·¨å¹³å°å…¼å®¹çš„ä»£ç æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³ç¡®è®¤ä»£ç æ˜¯åœ¨ç±» Unix ç³»ç»Ÿä¸Šè¿è¡Œï¼ˆå¦‚ Linux æˆ– macOSï¼‰ï¼Œå› ä¸ºåœ¨ Windows ç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªæ–¹æ³•å¯èƒ½æ²¡æœ‰æ„ä¹‰ã€‚åŸºäº<code>process.geteuid()</code>çš„è¿”å›å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è®¾å®šåªæœ‰åœ¨ç‰¹å®šç”¨æˆ·æƒé™ä¸‹æ‰æ‰§è¡ŒæŸäº›ä»»åŠ¡æˆ–æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯ã€‚</p></li><li><p><strong>å®‰å…¨å®¡è®¡</strong>ï¼šåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œäº†è§£åº”ç”¨åœ¨ä¸åŒæƒé™ä¸‹çš„è¡Œä¸ºå¯¹äºä¿è¯è½¯ä»¶çš„å®‰å…¨æ€§è‡³å…³é‡è¦ã€‚ä½¿ç”¨<code>process.geteuid()</code>å¯ä»¥å¸®åŠ©å¼€å‘è€…ç†è§£åº”ç”¨åœ¨ä¸åŒç”¨æˆ·æƒé™ä¸‹çš„è¡Œä¸ºï¼Œä»è€Œæ›´å¥½åœ°è®¾è®¡æƒé™ç®¡ç†ç­–ç•¥ã€‚</p></li></ol><h3 id="ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1"><span>ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¯¥åº”ç”¨éœ€è¦è®¿é—®ä¸€äº›æ•æ„Ÿæ–‡ä»¶ã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä½ å¸Œæœ›è¿™ä¸ªæ“ä½œåªèƒ½ç”±å…·æœ‰ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·æ‰§è¡Œã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">geteuid</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">geteuid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">===</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¦‚æœå½“å‰è¿›ç¨‹çš„æœ‰æ•ˆç”¨æˆ·IDæ˜¯0ï¼ˆé€šå¸¸è¡¨ç¤ºrootç”¨æˆ·ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å½“å‰ä»¥rootæƒé™è¿è¡Œï¼Œå¯ä»¥æ‰§è¡Œæ“ä½œã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ‰§è¡Œéœ€è¦é«˜çº§æƒé™çš„æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å½“å‰æ²¡æœ‰è¶³å¤Ÿçš„æƒé™æ‰§è¡Œæ­¤æ“ä½œï¼Œè¯·ä»¥rootç”¨æˆ·èº«ä»½è¿è¡Œæ­¤åº”ç”¨ã€‚&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ³¨æ„</strong>ï¼šåœ¨é Unix-like ç³»ç»Ÿï¼ˆæ¯”å¦‚ Windowsï¼‰ä¸Šï¼Œå°è¯•è°ƒç”¨<code>process.geteuid()</code>å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯ï¼Œå› ä¸ºè¿™ä¸ªæ¦‚å¿µåœ¨ Windows ä¸­å¹¶ä¸å­˜åœ¨ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰æœ€å¥½æ£€æŸ¥<code>process.geteuid</code>æ˜¯å¦å­˜åœ¨ã€‚</p><p>é€šè¿‡ä»¥ä¸Šçš„è§£é‡Šå’Œç¤ºä¾‹ï¼Œæˆ‘å¸Œæœ›ä½ å¯¹<code>process.geteuid()</code>æœ‰äº†åŸºæœ¬çš„äº†è§£ï¼Œä»¥åŠå¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­åˆ©ç”¨å®ƒæ¥ç®¡ç†å’Œæ§åˆ¶æƒé™ã€‚</p><h2 id="process-getgid" tabindex="-1"><a class="header-anchor" href="#process-getgid"><span><a href="https://nodejs.org/docs/latest/api/process.html#processgetgid" target="_blank" rel="noopener noreferrer">process.getgid()</a></span></a></h2><p>Node.js çš„ <code>process.getgid()</code> å‡½æ•°æ˜¯ä¸€ä¸ªåœ¨ Node.js ç¯å¢ƒä¸­ç”¨äºè·å–å½“å‰è¿›ç¨‹çš„ç¾¤ç»„èº«ä»½æ ‡è¯†ï¼ˆGroup IDï¼Œç®€ç§° GIDï¼‰çš„æ–¹æ³•ã€‚è¿™ä¸ªå‡½æ•°ä»…åœ¨ POSIX å…¼å®¹ç³»ç»Ÿä¸Šæœ‰æ„ä¹‰ï¼Œæ¯”å¦‚ Linux å’Œ macOSï¼Œå› ä¸ºå®ƒä»¬ä½¿ç”¨ç¾¤ç»„ ID æ¥è¡¨ç¤ºæ–‡ä»¶å’Œè¿›ç¨‹çš„æƒé™åˆ†é…ã€‚åœ¨ Windows ä¸Šï¼Œè¿™ä¸ªå‡½æ•°ä¸å…·å¤‡å®é™…æ„ä¹‰ï¼Œå› ä¸º Windows ä½¿ç”¨ä¸åŒçš„æƒé™ç®¡ç†æœºåˆ¶ã€‚</p><h3 id="è§£é‡Š-1" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-1"><span>è§£é‡Š</span></a></h3><p>åœ¨ç†è§£ <code>process.getgid()</code> ä¹‹å‰ï¼Œä½ éœ€è¦çŸ¥é“ UNIX-like ç³»ç»Ÿï¼ˆæ¯”å¦‚ Linux å’Œ macOSï¼‰åœ¨å¤„ç†æ–‡ä»¶å’Œè¿›ç¨‹æƒé™æ—¶ï¼Œä½¿ç”¨äº†ç”¨æˆ· IDï¼ˆUIDï¼‰å’Œç¾¤ç»„ IDï¼ˆGIDï¼‰çš„æ¦‚å¿µã€‚æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªç”¨æˆ· IDï¼Œä¸”å¯èƒ½å±äºä¸€ä¸ªæˆ–å¤šä¸ªç¾¤ç»„ï¼Œæ¯ä¸ªç¾¤ç»„ä¹Ÿæœ‰å¯¹åº”çš„ç¾¤ç»„ IDã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç³»ç»Ÿèƒ½å¤Ÿæ§åˆ¶ç”¨æˆ·å¯¹æ–‡ä»¶çš„è®¿é—®æƒé™ã€‚</p><p>å½“ä½ åœ¨è¿™æ ·çš„ç³»ç»Ÿä¸Šè¿è¡Œ Node.js ç¨‹åºæ—¶ï¼Œè¯¥ç¨‹åºæœ¬èº«å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ã€‚<code>process.getgid()</code> å°±æ˜¯ç”¨æ¥æŸ¥è¯¢è¿è¡Œå½“å‰ Node.js ç¨‹åºçš„è¿›ç¨‹æ‰€å±ç¾¤ç»„çš„ IDã€‚</p><h3 id="ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2"><span>ç¤ºä¾‹</span></a></h3><p>å‡è®¾æˆ‘ä»¬è¦å†™ä¸€ä¸ªç®€å•çš„ Node.js è„šæœ¬ï¼Œè¯¥è„šæœ¬éœ€è¦æ ¹æ®å…¶è¿è¡Œç¯å¢ƒï¼ˆç‰¹åˆ«æ˜¯è¿è¡Œè¯¥è„šæœ¬çš„ç”¨æˆ·ç¾¤ç»„æƒé™ï¼‰æ¥å†³å®šæ˜¯å¦æ‰§è¡ŒæŸäº›æ“ä½œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ£€æŸ¥å½“å‰è¿›ç¨‹çš„ GID æ¥å¸®åŠ©å†³å®šã€‚</p><p>**æ³¨æ„:**ä»¥ä¸‹ç¤ºä¾‹å‡è®¾ä½ åœ¨ä¸€ä¸ª UNIX-like ç³»ç»Ÿä¸Šè¿è¡Œå®ƒä»¬ã€‚</p><ol><li><strong>åŸºç¡€ä½¿ç”¨ï¼šè·å–å½“å‰è¿›ç¨‹çš„ç¾¤ç»„ ID</strong></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼•å…¥processæ¨¡å—</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨Node.jsä¸­ï¼Œprocesså¯¹è±¡æ˜¯å…¨å±€å¯ç”¨çš„ï¼Œä¸éœ€è¦é€šè¿‡requireå¼•å…¥</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è·å–å¹¶æ‰“å°å½“å‰è¿›ç¨‹çš„ç¾¤ç»„ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å½“å‰è¿›ç¨‹çš„ç¾¤ç»„ID: &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getgid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç è¿è¡Œåä¼šè¾“å‡ºç±»ä¼¼è¿™æ ·çš„ç»“æœï¼ˆå…·ä½“çš„æ•°å€¼å–å†³äºä½ çš„ç³»ç»Ÿå’Œè¿è¡Œç¯å¢ƒï¼‰ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>å½“å‰è¿›ç¨‹çš„ç¾¤ç»„ID: 1000</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li><strong>å®é™…åº”ç”¨åœºæ™¯ç¤ºä¾‹</strong></li></ol><p>è€ƒè™‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œå®ƒéœ€è¦è®¿é—®ä¸€ä¸ªåªå…è®¸ç‰¹å®šç¾¤ç»„æˆå‘˜è®¿é—®çš„èµ„æºã€‚ä½ å¯ä»¥ä½¿ç”¨<code>process.getgid()</code>æ¥æ£€æŸ¥å½“å‰è¿›ç¨‹æ˜¯å¦æœ‰æƒè®¿é—®è¯¥èµ„æºï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> allowedGID</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾åªæœ‰ç¾¤ç»„IDä¸º1000çš„ç”¨æˆ·ç»„æœ‰æƒè®¿é—®</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getgid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> allowedGID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è®¿é—®è¢«æˆæƒ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ‰§è¡Œè®¿é—®èµ„æºçš„ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è®¿é—®è¢«æ‹’ç»&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¤„ç†æ— æƒè®¿é—®çš„æƒ…å†µ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•æ ¹æ®è¿›ç¨‹çš„ç¾¤ç»„ ID æ¥å†³å®šæ˜¯å¦æ‰§è¡ŒæŸäº›æ“ä½œã€‚</p><h3 id="æ€»ç»“-17" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-17"><span>æ€»ç»“</span></a></h3><p><code>process.getgid()</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªæœ‰ç”¨çš„åŠŸèƒ½ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†ä¸ç³»ç»Ÿå®‰å…¨å’Œæƒé™ç›¸å…³çš„ä»»åŠ¡æ—¶ã€‚é€šè¿‡å®ƒï¼Œä½ èƒ½å¤Ÿè·å–è¿è¡Œå½“å‰ Node.js ç¨‹åºçš„è¿›ç¨‹çš„ç¾¤ç»„ IDï¼Œè¿™å¯ä»¥å¸®åŠ©ä½ æ ¹æ®æ“ä½œç³»ç»Ÿçš„å®‰å…¨æ¨¡å‹æ¥ä½œå‡ºç›¸åº”çš„é€»è¾‘å†³ç­–ã€‚</p><h2 id="process-getgroups" tabindex="-1"><a class="header-anchor" href="#process-getgroups"><span><a href="https://nodejs.org/docs/latest/api/process.html#processgetgroups" target="_blank" rel="noopener noreferrer">process.getgroups()</a></span></a></h2><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„ <code>process.getgroups()</code> æ–¹æ³•ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºå¦‚ä½•è·å–å½“å‰è¿›ç¨‹æ‰€å±çš„ç”¨æˆ·ç»„ ID åˆ—è¡¨ã€‚è¿™å¯¹äºç†è§£å’Œæ§åˆ¶è¿›ç¨‹çš„æƒé™éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼ˆå¦‚ Linux å’Œ macOSï¼‰ï¼Œå› ä¸ºåœ¨è¿™äº›ç³»ç»Ÿä¸­ï¼Œæƒé™å’Œç”¨æˆ·ç»„ç®¡ç†å¯¹äºç³»ç»Ÿå®‰å…¨è‡³å…³é‡è¦ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç®€å•åœ°äº†è§£ä¸€ä¸‹â€œç”¨æˆ·ç»„â€æ˜¯ä»€ä¹ˆã€‚åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½å±äºä¸€ä¸ªæˆ–å¤šä¸ªâ€œç»„â€ã€‚è¿™äº›ç»„å¸®åŠ©ç³»ç»Ÿç®¡ç†å‘˜æ§åˆ¶å¯¹æ–‡ä»¶ã€ç›®å½•å’Œå…¶ä»–ç³»ç»Ÿèµ„æºçš„è®¿é—®æƒé™ã€‚ä¾‹å¦‚ï¼Œå¯èƒ½æœ‰ä¸€ä¸ªåä¸ºâ€œwebadminsâ€çš„ç»„ï¼Œè¯¥ç»„çš„æˆå‘˜å¯ä»¥è®¿é—®å’Œä¿®æ”¹ç½‘ç«™ç›¸å…³çš„æ–‡ä»¶ã€‚</p><p>ç°åœ¨ï¼Œè¿›å…¥ Node.js çš„é¢†åŸŸï¼š</p><h3 id="process-getgroups-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#process-getgroups-æ–¹æ³•"><span>process.getgroups() æ–¹æ³•</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code> å¯¹è±¡æä¾›äº†ä¸€ä¸ªæ¥å£æ¥ä¸å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹äº’åŠ¨ã€‚<code>process.getgroups()</code> æ˜¯æ­¤å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå½“è¢«è°ƒç”¨æ—¶ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„åŒ…å«äº†å½“å‰è¿›ç¨‹æ‰€å±çš„ç”¨æˆ·ç»„çš„æ•°å­— IDã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨å®ƒ" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨å®ƒ"><span>å¦‚ä½•ä½¿ç”¨å®ƒï¼Ÿ</span></a></h3><ol><li><p><strong>æŸ¥çœ‹è¿›ç¨‹æ‰€å±ç”¨æˆ·ç»„</strong></p><p>å‡è®¾æ‚¨æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæ‚¨éœ€è¦ç¡®è®¤è¯¥åº”ç”¨ï¼ˆæˆ–æ›´å…·ä½“åœ°è¯´ï¼ŒNode.js è¿›ç¨‹ï¼‰æ˜¯å¦å±äºç‰¹å®šçš„å®‰å…¨ç”¨æˆ·ç»„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <code>process.getgroups()</code> æ¥åšè¿™ä»¶äº‹ã€‚</p><p>ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getgroups</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ®µç®€å•çš„ä»£ç ä¼šæ‰“å°å‡ºå½“å‰ Node.js è¿›ç¨‹æ‰€å±çš„æ‰€æœ‰ç”¨æˆ·ç»„ IDã€‚æ‚¨å¯ä»¥é€šè¿‡æ¯”è¾ƒè¿™äº› ID æ¥åˆ¤æ–­è¿›ç¨‹æ˜¯å¦æœ‰æ­£ç¡®çš„ç”¨æˆ·ç»„å½’å±ã€‚</p></li><li><p><strong>å®‰å…¨æ€§æ ¡éªŒ</strong></p><p>åœ¨å¼€å‘æŸäº›éœ€è¦ç‰¹å®šç³»ç»Ÿæƒé™æ‰èƒ½æ‰§è¡Œçš„åŠŸèƒ½æ—¶ï¼Œæ‚¨å¯ä»¥åˆ©ç”¨ <code>process.getgroups()</code> æ¥ç¡®è®¤ Node.js è¿›ç¨‹æ˜¯å¦å…·æœ‰é‚£äº›æƒé™â€”â€”å³ï¼Œæ£€æŸ¥è¿›ç¨‹æ‰€å±çš„ç”¨æˆ·ç»„æ˜¯å¦æ‹¥æœ‰å¿…è¦çš„æƒé™ã€‚</p><p>ç¤ºä¾‹åœºæ™¯ï¼š<br> è®¾æƒ³æ‚¨çš„ Node.js åº”ç”¨éœ€è¦è¯»å–ç³»ç»Ÿä¸Šçš„æ•æ„Ÿæ—¥å¿—æ–‡ä»¶ï¼Œè€Œè¿™äº›æ–‡ä»¶åªå…è®¸ &quot;sysadmin&quot; ç»„çš„æˆå‘˜è®¿é—®ã€‚æ‚¨çš„ä»£ç å¯ä»¥é¦–å…ˆè°ƒç”¨ <code>process.getgroups()</code> æ¥è·å–è¿›ç¨‹çš„ç”¨æˆ·ç»„ IDï¼Œç„¶ååˆ¤æ–­ &quot;sysadmin&quot; ç»„çš„ ID æ˜¯å¦åœ¨è¿”å›çš„åˆ—è¡¨ä¸­ã€‚</p></li></ol><h3 id="æ³¨æ„äº‹é¡¹-6" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-6"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>å½“ä½ åœ¨ Windows ç³»ç»Ÿä¸Šä½¿ç”¨ <code>process.getgroups()</code> æ—¶ï¼Œç”±äº Windows çš„ç”¨æˆ·ç»„ç®¡ç†æœºåˆ¶ä¸ Unix-like ç³»ç»Ÿä¸åŒï¼Œæ­¤æ–¹æ³•å¯èƒ½ä¸ä¼šæŒ‰é¢„æœŸå·¥ä½œï¼Œç”šè‡³å¯èƒ½æŠ›å‡ºé”™è¯¯ã€‚</li><li>ç†è§£å’Œæ“ä½œç”¨æˆ·ç»„é€šå¸¸éœ€è¦ä¸€å®šçš„ç³»ç»Ÿç®¡ç†çŸ¥è¯†ï¼Œç‰¹åˆ«æ˜¯åœ¨è®¾ç½®å’Œè°ƒè¯•æƒé™é—®é¢˜æ—¶ã€‚</li></ul><p>é€šè¿‡ <code>process.getgroups()</code> æ–¹æ³•ï¼ŒNode.js å¼€å‘è€…å¯ä»¥åœ¨ä»–ä»¬çš„åº”ç”¨ç¨‹åºä¸­æ·»åŠ ä¸€å±‚é¢å¤–çš„å®‰å…¨æ€§å’Œçµæ´»æ€§ï¼Œä»è€Œç¡®ä¿è¿›ç¨‹è¿è¡Œåœ¨é€‚å½“çš„å®‰å…¨ç¯å¢ƒä¸­ã€‚è¿™åœ¨å¤„ç†æ¶‰åŠæ•æ„Ÿæ•°æ®æˆ–èµ„æºçš„åº”ç”¨ç¨‹åºæ—¶å°¤ä¸ºé‡è¦ã€‚</p><h2 id="process-getuid" tabindex="-1"><a class="header-anchor" href="#process-getuid"><span><a href="https://nodejs.org/docs/latest/api/process.html#processgetuid" target="_blank" rel="noopener noreferrer">process.getuid()</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªè®© JavaScript å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œçš„å¹³å°ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨ JavaScript å¼€å‘ç½‘é¡µå’Œä¸ç”¨æˆ·äº¤äº’çš„å‰ç«¯ç¨‹åºã€‚ä½†æ˜¯ï¼Œæœ‰äº† Node.jsï¼Œä½ å°±èƒ½ç”¨ JavaScript åšæ›´å¤šåç«¯çš„äº‹æƒ…äº†ï¼Œæ¯”å¦‚æ“ä½œæ–‡ä»¶ç³»ç»Ÿã€åˆ›å»ºç½‘ç»œæœåŠ¡ç­‰ç­‰ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code>æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†ä¸€ç³»åˆ—å±æ€§å’Œæ–¹æ³•ï¼Œç”¨äºä¸å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹äº’åŠ¨ã€‚ç®€å•åœ°è¯´ï¼Œä½ å¯ä»¥é€šè¿‡<code>process</code>å¯¹è±¡è·å–å¾ˆå¤šå…³äºå½“å‰ Node.js ç¨‹åºçš„ä¿¡æ¯ï¼Œæˆ–è€…æ§åˆ¶è¿™ä¸ªç¨‹åºçš„è¡Œä¸ºã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬èšç„¦äº<code>process.getuid()</code>è¿™ä¸ªæ–¹æ³•ã€‚</p><h3 id="process-getuid-1" tabindex="-1"><a class="header-anchor" href="#process-getuid-1"><span><code>process.getuid()</code></span></a></h3><p>åœ¨ Unix-likeï¼ˆç±» Unixï¼‰ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªè¿è¡Œçš„è¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªç”¨æˆ· IDï¼ˆUIDï¼‰ã€‚è¿™ä¸ª ID å†³å®šäº†è¿™ä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®å“ªäº›ç³»ç»Ÿèµ„æºã€‚<code>process.getuid()</code>è¿™ä¸ªæ–¹æ³•ä¼šè¿”å›å¯åŠ¨å½“å‰ Node.js è¿›ç¨‹çš„ç”¨æˆ·çš„æ•°å­—æ ‡è¯†ç¬¦ï¼Œä¹Ÿå°±æ˜¯ UIDã€‚</p><p>ç®€å•æ¥è¯´ï¼Œå½“ä½ åœ¨ Linux æˆ–è€… MacOS ç³»ç»Ÿä¸Šè¿è¡Œ Node.js ç¨‹åºæ—¶ï¼Œè°ƒç”¨<code>process.getuid()</code>ä¼šå‘Šè¯‰ä½ ï¼Œå½“å‰ç¨‹åºæ˜¯ä»¥å“ªä¸ªç”¨æˆ·çš„æƒé™è¿è¡Œçš„ã€‚</p><h3 id="æ³¨æ„" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„"><span>æ³¨æ„</span></a></h3><ul><li><code>process.getuid()</code>åªåœ¨ Unix-like ç³»ç»Ÿä¸Šæœ‰æ•ˆï¼Œåœ¨ Windows ç³»ç»Ÿä¸Šä½¿ç”¨è¿™ä¸ªæ–¹æ³•ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå› ä¸º Windows å¹¶ä¸æ˜¯ç”¨ UID æ¥ç®¡ç†ç”¨æˆ·æƒé™ã€‚</li><li>è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨äºå®‰å…¨å’Œæƒé™æ§åˆ¶çš„åœºæ™¯ï¼Œæ¯”å¦‚ï¼Œä½ å¯èƒ½éœ€è¦æ£€æŸ¥å½“å‰çš„ç”¨æˆ·æ˜¯å¦æœ‰æƒé™æ‰§è¡ŒæŸä¸ªæ“ä½œã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-7" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-7"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>æ£€æŸ¥æƒé™</strong>ï¼šå‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js è„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬éœ€è¦è®¿é—®ä¸€äº›æ•æ„Ÿæ–‡ä»¶ã€‚ä½ å¯ä»¥å…ˆç”¨<code>process.getuid()</code>æ£€æŸ¥å½“å‰ç”¨æˆ·çš„ UIDï¼Œç„¶åæ ¹æ® UID åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœ‰è¶³å¤Ÿçš„æƒé™ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getuid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">===</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å½“å‰ä»¥rootæƒé™è¿è¡Œ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿›è¡Œä¸€äº›åªæœ‰rootæ‰èƒ½æ‰§è¡Œçš„æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯·ä»¥rootæƒé™é‡æ–°è¿è¡Œè¯¥è„šæœ¬&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ—¥å¿—è®°å½•</strong>ï¼šåœ¨è¿›è¡Œä¸€äº›å…³é”®æ“ä½œä¹‹å‰ï¼Œä½ å¯èƒ½æƒ³åœ¨æ—¥å¿—é‡Œè®°å½•ä¸‹æ˜¯è°ï¼ˆå“ªä¸ªç”¨æˆ·çš„ UIDï¼‰æ‰§è¡Œçš„è¿™ä¸ªæ“ä½œï¼Œä»¥å¤‡åç»­å®¡è®¡ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ“ä½œç”±UID: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getuid</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> çš„ç”¨æˆ·å‘èµ·`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰§è¡Œæ“ä½œ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ¡ä»¶é€»è¾‘</strong>ï¼šä½ çš„ Node.js åº”ç”¨å¯èƒ½éœ€è¦æ ¹æ®è¿è¡Œå®ƒçš„ç”¨æˆ·çš„ä¸åŒï¼Œå±•ç¤ºä¸åŒçš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œæ™®é€šç”¨æˆ·å’Œç®¡ç†å‘˜ç”¨æˆ·çœ‹åˆ°çš„ç•Œé¢å’Œå¯æ‰§è¡Œçš„æ“ä½œå¯èƒ½ä¸åŒã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getuid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ™®é€šç”¨æˆ·æ¨¡å¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åˆå§‹åŒ–æ™®é€šç”¨æˆ·ç•Œé¢å’ŒåŠŸèƒ½</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç®¡ç†å‘˜æ¨¡å¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åˆå§‹åŒ–ç®¡ç†å‘˜è®¤è¯å’ŒåŠŸèƒ½</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>æ€»ç»“èµ·æ¥ï¼Œ<code>process.getuid()</code>æ˜¯ Node.js ä¸­ä¸€ä¸ªç”¨äºè·å–å½“å‰è¿›ç¨‹ç”¨æˆ· ID çš„æ–¹æ³•ï¼Œä¸»è¦åº”ç”¨äºåŸºäºç”¨æˆ·æƒé™çš„æ“ä½œå’Œæ—¥å¿—è®°å½•ç­‰åœºæ™¯ã€‚ä¸è¿‡ï¼Œè®°å¾—è¿™ä¸ªæ–¹æ³•åœ¨ Windows ä¸Šä¸å¯ç”¨ï¼Œå› æ­¤å¦‚æœä½ çš„ä»£ç éœ€è¦è·¨å¹³å°å…¼å®¹ï¼Œå°±éœ€è¦åšç›¸åº”çš„å¤„ç†ã€‚</p><h2 id="process-hasuncaughtexceptioncapturecallback" tabindex="-1"><a class="header-anchor" href="#process-hasuncaughtexceptioncapturecallback"><span><a href="https://nodejs.org/docs/latest/api/process.html#processhasuncaughtexceptioncapturecallback" target="_blank" rel="noopener noreferrer">process.hasUncaughtExceptionCaptureCallback()</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ Node.js ä¸­çš„ <code>process.hasUncaughtExceptionCaptureCallback()</code> æ–¹æ³•ï¼Œå¹¶ä¸”æˆ‘ä¼šå°½é‡ç”¨ç®€å•çš„è¯­è¨€å’Œå®é™…ä¾‹å­æ¥è¯´æ˜ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code> å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒæä¾›äº†å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚ç†è§£ <code>process</code> å¯¹è±¡å¯¹äºç¼–å†™é«˜æ•ˆä¸”ç¨³å®šçš„ Node.js åº”ç”¨è‡³å…³é‡è¦ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-uncaught-exception" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-uncaught-exception"><span>ä»€ä¹ˆæ˜¯ Uncaught Exceptionï¼Ÿ</span></a></h3><p>é¦–å…ˆï¼Œ&quot;uncaught exception&quot;ï¼ˆæœªæ•è·çš„å¼‚å¸¸ï¼‰æŒ‡çš„æ˜¯åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿçš„ã€ä½†æ²¡æœ‰è¢« try-catch å—æ•è·çš„é”™è¯¯ã€‚åœ¨ Node.js åº”ç”¨ä¸­ï¼Œå¦‚æœæœ‰è¿™æ ·çš„é”™è¯¯å‘ç”Ÿå¹¶ä¸”æ²¡æœ‰å¤„ç†ï¼Œé€šå¸¸ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚</p><h3 id="å¼‚å¸¸æ•è·" tabindex="-1"><a class="header-anchor" href="#å¼‚å¸¸æ•è·"><span>å¼‚å¸¸æ•è·</span></a></h3><p>ä¸ºäº†é˜²æ­¢å› ä¸ºæœªæ•è·çš„å¼‚å¸¸è€Œå¯¼è‡´æ•´ä¸ªç¨‹åºå´©æºƒï¼ŒNode.js å…è®¸ä½ ä½¿ç”¨ç‰¹å®šçš„æ–¹æ³•æ¥æ•è·è¿™äº›å¼‚å¸¸ï¼Œä»è€Œå¯ä»¥å¯¹å…¶è¿›è¡Œæ—¥å¿—è®°å½•ã€èµ„æºæ¸…ç†æˆ–è€…ä¼˜é›…åœ°å…³é—­ç¨‹åºã€‚</p><p>è¿™é‡Œä»‹ç»çš„ <code>process.hasUncaughtExceptionCaptureCallback()</code> æ–¹æ³•å°±ä¸æ­¤æœ‰å…³ã€‚è¿™ä¸ªæ–¹æ³•ç”¨äºæ£€æŸ¥æ˜¯å¦å·²ç»é€šè¿‡ <code>process.setUncaughtExceptionCaptureCallback()</code> è®¾ç½®äº†ä¸€ä¸ªç”¨äºæ•è·æœªæ•è·å¼‚å¸¸çš„å›è°ƒå‡½æ•°ã€‚</p><h3 id="ä½¿ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-1"><span>ä½¿ç”¨ç¤ºä¾‹ï¼š</span></a></h3><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿä¼˜é›…åœ°å¤„ç†æœªæ•è·çš„å¼‚å¸¸ä»¥é¿å…ç¨‹åºç›´æ¥å´©æºƒã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨è¿™äº›æ–¹æ³•çš„æ­¥éª¤ï¼š</p><ol><li><strong>è®¾ç½®æ•è·å›è°ƒ</strong>: é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>process.setUncaughtExceptionCaptureCallback()</code> æ–¹æ³•æ¥è®¾ç½®ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†åœ¨æœªæ•è·çš„å¼‚å¸¸å‘ç”Ÿæ—¶è¢«è°ƒç”¨ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setUncaughtExceptionCaptureCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ•è·åˆ°æœªå¤„ç†çš„å¼‚å¸¸:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åœ¨è¿™é‡Œä½ å¯ä»¥è®°å½•æ—¥å¿—ï¼Œæˆ–è€…æ ¹æ®éœ€è¦åšä¸€äº›æ¸…ç†å·¥ä½œ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä¹Ÿå¯ä»¥é€‰æ‹©é€€å‡ºç¨‹åº</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>æ£€æŸ¥æ˜¯å¦å·²è®¾ç½®å›è°ƒ</strong>: ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ£€æŸ¥æ˜¯å¦å·²ç»æˆåŠŸè®¾ç½®äº†æ•è·å›è°ƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>process.hasUncaughtExceptionCaptureCallback()</code> æ–¹æ³•ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hasUncaughtExceptionCaptureCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å·²ç»è®¾ç½®äº†æœªæ•è·å¼‚å¸¸çš„æ•è·å›è°ƒ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æœªè®¾ç½®æœªæ•è·å¼‚å¸¸çš„æ•è·å›è°ƒ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>ç§»é™¤å›è°ƒ</strong>ï¼šå¦‚æœå‡ºäºæŸç§åŸå› ï¼Œä½ æƒ³å–æ¶ˆä¹‹å‰è®¾ç½®çš„å›è°ƒåŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡ä¼ é€’ <code>null</code> åˆ° <code>setUncaughtExceptionCaptureCallback</code> æ¥å®ç°ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setUncaughtExceptionCaptureCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†æ¬¡æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hasUncaughtExceptionCaptureCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æœªæ•è·å¼‚å¸¸çš„æ•è·å›è°ƒå·²è¢«ç§»é™¤&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨åœºæ™¯"><span>å®é™…è¿ç”¨åœºæ™¯</span></a></h3><ul><li><strong>æ—¥å¿—è®°å½•</strong>: åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ•è·æœªå¤„ç†çš„å¼‚å¸¸å¹¶è®°å½•è¯¦ç»†æ—¥å¿—å¯¹äºåç»­åˆ†æå’Œä¿®å¤é—®é¢˜éå¸¸é‡è¦ã€‚</li><li><strong>èµ„æºæ¸…ç†</strong>: å¦‚æœä½ çš„åº”ç”¨åœ¨è¿è¡Œæ—¶æ‰“å¼€äº†æ–‡ä»¶ã€ç½‘ç»œè¿æ¥ç­‰èµ„æºï¼Œé‚£ä¹ˆåœ¨ç¨‹åºå´©æºƒå‰è¿›è¡Œé€‚å½“çš„èµ„æºæ¸…ç†æ˜¯ä¸ªå¥½ä¹ æƒ¯ã€‚</li><li><strong>ä¼˜é›…é€€å‡º</strong>: é€šè¿‡è®¾ç½®å›è°ƒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºå³å°†å´©æºƒæ—¶å°è¯•è¿›è¡Œä¸€äº›æ¸…ç†å·¥ä½œï¼Œå¹¶ç»™ç¨‹åºä¸€ä¸ªé‡æ–°å¯åŠ¨æˆ–è€…å®‰å…¨é€€å‡ºçš„æœºä¼šï¼Œæ¯”å¦‚é€šçŸ¥ç›‘æ§ç³»ç»Ÿæˆ–è€…å‘é€å‘Šè­¦é‚®ä»¶ã€‚</li></ul><p>é€šè¿‡ä»¥ä¸Šä»‹ç»å’Œç¤ºä¾‹ï¼Œå¸Œæœ›ä½ å¯¹ <code>process.hasUncaughtExceptionCaptureCallback()</code> æ–¹æ³•æœ‰äº†æ›´æ·±å…¥çš„ç†è§£ã€‚åœ¨å¼€å‘å¤§å‹æˆ–è€…å…³é”®æ€§çš„ Node.js åº”ç”¨æ—¶ï¼Œåˆç†åˆ©ç”¨è¿™äº›æ–¹æ³•æ¥æå‡åº”ç”¨çš„å¥å£®æ€§å’Œç¨³å®šæ€§æ˜¯éå¸¸é‡è¦çš„ã€‚</p><h2 id="process-hrtime-time" tabindex="-1"><a class="header-anchor" href="#process-hrtime-time"><span><a href="https://nodejs.org/docs/latest/api/process.html#processhrtimetime" target="_blank" rel="noopener noreferrer">process.hrtime([time])</a></span></a></h2><p>å½“ç„¶ï¼Œæˆ‘å¾ˆä¹æ„å¸®ä½ è§£é‡Š Node.js ä¸­çš„ <code>process.hrtime([time])</code> å‡½æ•°ã€‚</p><p>é¦–å…ˆï¼Œ<code>process.hrtime()</code> æ˜¯ä¸€ä¸ªåœ¨ Node.js ä¸­ç”¨æ¥è·å¾—é«˜ç²¾åº¦æ—¶é—´çš„å‡½æ•°ã€‚&quot;hr&quot; åœ¨è¿™é‡Œä»£è¡¨â€œé«˜ç²¾åº¦â€(high-resolution)ã€‚è¿™ä¸ªåŠŸèƒ½é€šå¸¸ç”¨äºè®¡ç®—ä»£ç æ‰§è¡Œçš„æ—¶é—´ï¼Œä»¥å¸®åŠ©ä¼˜åŒ–æ€§èƒ½æˆ–è¿›è¡ŒåŸºå‡†æµ‹è¯•ï¼ˆbenchmarkingï¼‰ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-1" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-1"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><ul><li><strong>æ—¶é—´å•ä½</strong>ï¼š<code>process.hrtime()</code> è¿”å›ä¸€ä¸ªåŒ…å«ç§’æ•°å’Œçº³ç§’æ•°çš„æ•°ç»„ <code>[seconds, nanoseconds]</code>ã€‚è¿™æ¯”æ™®é€šçš„ JavaScript æ—¶é—´ï¼ˆé€šå¸¸ä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰è¦ç²¾ç¡®å¾—å¤šã€‚</li><li><strong>å‚æ•° <code>[time]</code></strong>ï¼šæ‚¨å¯ä»¥å°†ä¸€ä¸ªä¹‹å‰ç”± <code>process.hrtime()</code> äº§ç”Ÿçš„æ•°ç»„ä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒã€‚å¦‚æœä¼ é€’äº†è¿™ä¸ªå‚æ•°ï¼Œ<code>process.hrtime([time])</code> å°†è¿”å›è‡ªé‚£æ—¶ä»¥æ¥ç»è¿‡çš„æ—¶é—´ã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯ä¸ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯ä¸ä¾‹å­"><span>ä½¿ç”¨åœºæ™¯ä¸ä¾‹å­</span></a></h3><h4 id="åœºæ™¯ä¸€-åŸºå‡†æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯ä¸€-åŸºå‡†æµ‹è¯•"><span>åœºæ™¯ä¸€ï¼šåŸºå‡†æµ‹è¯•</span></a></h4><p>å‡è®¾ä½ æƒ³è¦æµ‹é‡æŸä¸ªå‡½æ•°æ‰§è¡Œæ‰€éœ€çš„æ—¶é—´ã€‚ä½¿ç”¨ <code>process.hrtime()</code> å¯ä»¥è®©ä½ å¾—åˆ°æ›´ç²¾ç¡®çš„ç»“æœï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸€äº›éœ€è¦æ—¶é—´æµ‹é‡çš„æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">start</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ“ä½œè€—æ—¶ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ç§’ å’Œ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> çº³ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆè®°å½•ä¸‹å¼€å§‹æ—¶é—´ï¼Œç„¶åæ‰§è¡Œä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ <code>setTimeout</code> å»¶è¿Ÿï¼‰ï¼Œæœ€åè®¡ç®—å¹¶è¾“å‡ºæ“ä½œçš„è€—æ—¶ã€‚</p><h4 id="åœºæ™¯äºŒ-æ€§èƒ½ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯äºŒ-æ€§èƒ½ä¼˜åŒ–"><span>åœºæ™¯äºŒï¼šæ€§èƒ½ä¼˜åŒ–</span></a></h4><p>é€šè¿‡å¯¹ä»£ç çš„ä¸åŒéƒ¨åˆ†ä½¿ç”¨ <code>process.hrtime()</code>ï¼Œä½ å¯ä»¥æ¯”è¾ƒå®ƒä»¬çš„æ‰§è¡Œæ—¶é—´ï¼Œæ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> startFunction1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬ä¸€ä¸ªå‡½æ•°/æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">functionOne</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> endFunction1</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">startFunction1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`ç¬¬ä¸€ä¸ªå‡½æ•°è€—æ—¶ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endFunction1</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ç§’ å’Œ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endFunction1</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> çº³ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> startFunction2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¬¬äºŒä¸ªå‡½æ•°/æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">functionTwo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> endFunction2</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">startFunction2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`ç¬¬äºŒä¸ªå‡½æ•°è€—æ—¶ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endFunction2</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ç§’ å’Œ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endFunction2</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> çº³ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•æµ‹é‡ä¸¤ä¸ªå‡½æ•°å„è‡ªçš„æ‰§è¡Œæ—¶é—´ï¼Œå¹¶å°†å®ƒä»¬è¿›è¡Œæ¯”è¾ƒã€‚</p><h3 id="ç»“è®º-3" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-3"><span>ç»“è®º</span></a></h3><p><code>process.hrtime()</code> æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å·¥å…·ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦ç²¾ç¡®æµ‹é‡ä»£ç æ‰§è¡Œæ—¶é—´çš„åœºåˆã€‚å®ƒæä¾›çš„é«˜ç²¾åº¦æ—¶é—´å¯ä»¥å¸®åŠ©å¼€å‘è€…è¯Šæ–­æ€§èƒ½é—®é¢˜ï¼Œè¿›è€Œä¼˜åŒ–ç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚</p><h2 id="process-hrtime-bigint" tabindex="-1"><a class="header-anchor" href="#process-hrtime-bigint"><span><a href="https://nodejs.org/docs/latest/api/process.html#processhrtimebigint" target="_blank" rel="noopener noreferrer">process.hrtime.bigint()</a></span></a></h2><p>ç†è§£<code>process.hrtime.bigint()</code>ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦äº†è§£ä¸€äº›èƒŒæ™¯ä¿¡æ¯ã€‚</p><p>åœ¨è®¡ç®—æœºç¼–ç¨‹ä¸­ï¼Œç»å¸¸éœ€è¦æµ‹é‡ä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œç‰¹åˆ«æ˜¯åœ¨æ€§èƒ½è°ƒæ•´æ—¶ã€‚ä¼ ç»Ÿçš„ JavaScript æ—¶é—´å‡½æ•°ï¼ˆæ¯”å¦‚<code>Date.now()</code>ï¼‰æä¾›çš„æ—¶é—´ç²¾åº¦é€šå¸¸ä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œè¿™å¯¹äºå¤§å¤šæ•°åº”ç”¨æ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚ä½†æ˜¯ï¼Œåœ¨æŸäº›é«˜æ€§èƒ½çš„åº”ç”¨åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ›´é«˜ç²¾åº¦çš„æ—¶é—´æµ‹é‡ï¼Œæ¯”å¦‚ä»¥å¾®ç§’ï¼ˆåƒåˆ†ä¹‹ä¸€æ¯«ç§’ï¼‰æˆ–çº³ç§’ï¼ˆç™¾ä¸‡åˆ†ä¹‹ä¸€æ¯«ç§’ï¼‰ä¸ºå•ä½ã€‚è¿™å°±æ˜¯<code>process.hrtime.bigint()</code>ç™»åœºçš„æ—¶å€™äº†ã€‚</p><h3 id="process-hrtime-bigint-1" tabindex="-1"><a class="header-anchor" href="#process-hrtime-bigint-1"><span>process.hrtime.bigint()</span></a></h3><p><code>process.hrtime.bigint()</code>æ˜¯ Node.js ä¸­ç”¨äºè·å–é«˜ç²¾åº¦æ—¶é—´çš„æ–¹æ³•ã€‚å®ƒè¿”å›ä¸€ä¸ªè¡¨ç¤ºå½“å‰æ—¶é—´çš„<code>BigInt</code>ç±»å‹çš„å€¼ï¼Œå•ä½ä¸ºçº³ç§’ã€‚ä¸<code>process.hrtime()</code>ä¸åŒçš„æ˜¯ï¼Œ<code>process.hrtime.bigint()</code>ç›´æ¥è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä½¿å¾—å®ƒæ›´æ–¹ä¾¿åœ¨æ•°å­¦è¿ç®—ä¸­ä½¿ç”¨ã€‚</p><h4 id="å®é™…è¿ç”¨ç¤ºä¾‹-9" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-9"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h4><ol><li><p><strong>æ€§èƒ½æµ‹é‡</strong></p><p>æœ€ç›´æ¥çš„ä½¿ç”¨åœºæ™¯å°±æ˜¯æµ‹é‡ä»£ç ç‰‡æ®µçš„æ‰§è¡Œæ—¶é—´ã€‚æ¯”å¦‚ï¼Œä½ æƒ³çŸ¥é“æŸä¸ªå‡½æ•°æ‰§è¡Œäº†å¤šé•¿æ—¶é—´ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">bigint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿™é‡Œæ˜¯ä½ è¦æµ‹é‡çš„ä»£ç ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    ; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™é‡Œæœ‰å¤æ‚çš„æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">bigint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¯¥ä»£ç æ‰§è¡Œæ—¶é—´ä¸ºï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000000</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">n</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ¯«ç§’`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç é€šè¿‡<code>process.hrtime.bigint()</code>è·å–ä»£ç æ‰§è¡Œå‰åçš„æ—¶é—´ç‚¹ï¼Œç„¶åè®¡ç®—å·®å€¼å¾—åˆ°æ‰§è¡Œæ—¶é—´ã€‚æœ€åå°†çº³ç§’è½¬æ¢ä¸ºæ›´æ˜“è¯»çš„æ¯«ç§’å•ä½è¿›è¡Œå±•ç¤ºã€‚</p></li><li><p><strong>ç”Ÿæˆå”¯ä¸€æ ‡è¯†ç¬¦</strong></p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åŸºäºæ—¶é—´ç”Ÿæˆä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ ‡è¯†ç¬¦ã€‚ç”±äº<code>process.hrtime.bigint()</code>å¯ä»¥ç»™å‡ºçº³ç§’çº§åˆ«çš„æ—¶é—´æˆ³ï¼Œè¿™æ„å‘³ç€è¿ç»­è°ƒç”¨å®ƒä»¬å¾—åˆ°çš„ç»“æœå‡ ä¹ä¸å¯èƒ½ç›¸åŒï¼Œä»è€Œå¯ä»¥ç”¨ä½œç”Ÿæˆé«˜ç²¾åº¦çš„å”¯ä¸€æ ‡è¯†ç¬¦çš„åŸºç¡€ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> generateUniqueId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">bigint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">generateUniqueId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºä¸€ä¸ªåŸºäºå½“å‰æ—¶é—´çš„å”¯ä¸€ID</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ—¶é—´é—´éš”æµ‹é‡</strong></p><p>å¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªéœ€è¦éå¸¸ç²¾ç¡®çš„å®šæ—¶å™¨æˆ–è€…æ—¶é—´é—´éš”çš„åº”ç”¨ï¼ˆæ¯”å¦‚æ¸¸æˆã€å®æ—¶äº¤äº’åº”ç”¨ç­‰ï¼‰ï¼Œ<code>process.hrtime.bigint()</code>æä¾›çš„çº³ç§’çº§æ—¶é—´æˆ³å°±éå¸¸æœ‰ç”¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ éœ€è¦ç²¾ç¡®æ§åˆ¶æŸä¸ªä»»åŠ¡æ¯éš”50æ¯«ç§’æ‰§è¡Œä¸€æ¬¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> preciseIntervalTask</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> lastTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">bigint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  while</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> currentTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">hrtime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">bigint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">currentTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> lastTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 50000000</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // 50æ¯«ç§’</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ‰§è¡Œä»»åŠ¡&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      lastTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> currentTime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    await</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é˜²æ­¢æ­»å¾ªç¯å¡æ­»</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">preciseIntervalTask</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>ä»¥ä¸Šä¾‹å­å±•ç¤ºäº†<code>process.hrtime.bigint()</code>åœ¨ä¸åŒåœºæ™¯ä¸‹çš„åº”ç”¨ï¼Œä»æ€§èƒ½æµ‹é‡åˆ°ç”Ÿæˆå”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå†åˆ°æ—¶é—´é—´éš”æµ‹é‡ã€‚ç”±äºå…¶æä¾›äº†çº³ç§’çº§åˆ«çš„ç²¾åº¦ï¼Œéå¸¸é€‚åˆéœ€è¦é«˜ç²¾åº¦æ—¶é—´æµ‹é‡çš„åº”ç”¨åœºæ™¯ã€‚</p><h2 id="process-initgroups-user-extragroup" tabindex="-1"><a class="header-anchor" href="#process-initgroups-user-extragroup"><span><a href="https://nodejs.org/docs/latest/api/process.html#processinitgroupsuser-extragroup" target="_blank" rel="noopener noreferrer">process.initgroups(user, extraGroup)</a></span></a></h2><p>ç†è§£ <code>process.initgroups(user, extraGroup)</code> ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ Node.js çš„ä¸€äº›åŸºç¡€çŸ¥è¯†å’Œä¸€äº›ç³»ç»Ÿçº§åˆ«çš„æ¦‚å¿µï¼Œè¿™æ ·ä½ å°±èƒ½æ›´å¥½åœ°æŠŠæ¡è¿™ä¸ªå‡½æ•°çš„å®é™…åº”ç”¨åœºæ™¯ã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><ol><li><strong>Node.js</strong>: æ˜¯ä¸€ä¸ªå¼€æºå’Œè·¨å¹³å°çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒã€‚å®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptï¼Œä½¿å¾— JavaScript å¯ä»¥åšåˆ°ç±»ä¼¼äº PHPã€Python æˆ– Ruby ç­‰è¯­è¨€çš„åç«¯æ“ä½œã€‚</li><li><strong>è¿›ç¨‹ï¼ˆProcessï¼‰</strong>: è®¡ç®—æœºä¸­æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºçš„å®ä¾‹ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´å’Œç³»ç»Ÿèµ„æºã€‚</li><li><strong>ç”¨æˆ·ï¼ˆUserï¼‰</strong> å’Œ <strong>ç¾¤ç»„ï¼ˆGroupï¼‰</strong>: åœ¨ Unix-like ç³»ç»Ÿï¼ˆæ¯”å¦‚ Linux æˆ– Mac OSï¼‰ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶å’Œè¿›ç¨‹éƒ½å±äºä¸€ä¸ªç”¨æˆ·å’Œä¸€ä¸ªç¾¤ç»„ã€‚æƒé™ç³»ç»Ÿé€šè¿‡è¿™äº›å½’å±å…³ç³»æ¥æ§åˆ¶å¯¹æ–‡ä»¶å’Œè¿›ç¨‹çš„è®¿é—®ã€‚</li><li><strong>initgroups å‡½æ•°</strong>: è¿™æ˜¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºåˆå§‹åŒ–è¿›ç¨‹çš„ç¾¤ç»„è®¿é—®åˆ—è¡¨ã€‚å½“è¿›ç¨‹å¯åŠ¨æ—¶ï¼Œå®ƒä¼šè®¾ç½®è¯¥è¿›ç¨‹å¯ä»¥è®¿é—®çš„æ‰€æœ‰ç¾¤ç»„ã€‚</li></ol><h3 id="process-initgroups-user-extragroup-1" tabindex="-1"><a class="header-anchor" href="#process-initgroups-user-extragroup-1"><span>process.initgroups(user, extraGroup)</span></a></h3><p>åœ¨ Node.js ç¯å¢ƒä¸‹ï¼Œ<code>process.initgroups(user, extraGroup)</code> æ–¹æ³•æ˜¯ç”¨äºè®¾ç½®å½“å‰è¿›ç¨‹çš„ç”¨æˆ· ID å’Œç¾¤ç»„ ID çš„ã€‚è¿™ä¸ªæ–¹æ³•ä¸»è¦åœ¨ä½ éœ€è¦æ”¹å˜ Node.js ç¨‹åºè¿è¡Œæ—¶çš„æƒé™æ—¶ä½¿ç”¨ï¼Œæ¯”å¦‚å½“ä½ çš„ç¨‹åºéœ€è¦è®¿é—®æŸäº›å—é™åˆ¶çš„ç³»ç»Ÿèµ„æºæ—¶ã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><strong>user</strong>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ•°å­—ï¼Œä»£è¡¨ç”¨æˆ·çš„åç§°æˆ– UIDï¼ˆç”¨æˆ·æ ‡è¯†ç¬¦ï¼‰ã€‚è¯¥ç”¨æˆ·å°†æˆä¸ºè¿›ç¨‹çš„æ–°ç”¨æˆ·ã€‚</li><li><strong>extraGroup</strong>: è¿™æ˜¯é¢å¤–æ·»åŠ åˆ°è¿›ç¨‹ç¾¤ç»„åˆ—è¡¨ä¸­çš„ä¸€ä¸ªç¾¤ç»„åç§°æˆ– GIDï¼ˆç¾¤ç»„æ ‡è¯†ç¬¦ï¼‰ã€‚</li></ul><p>å®é™…è¿ç”¨ä¾‹å­ï¼š</p><ol><li><strong>Web æœåŠ¡å™¨è¿è¡Œåœ¨ç‰¹æƒç«¯å£ä¸Š</strong>:<br> å‡è®¾ä½ çš„ Node.js åº”ç”¨æ˜¯ä¸€ä¸ª web æœåŠ¡å™¨ï¼Œä½ å¸Œæœ›å®ƒç›‘å¬ 80 ç«¯å£ï¼ˆHTTP é»˜è®¤ç«¯å£ï¼‰ï¼Œä½†å‡ºäºå®‰å…¨è€ƒè™‘ï¼ŒUNIX ç³»ç»Ÿé€šå¸¸ä¸å…è®¸éç‰¹æƒç”¨æˆ·ï¼ˆé root ç”¨æˆ·ï¼‰ç»‘å®šåˆ° 1024 ä»¥ä¸‹çš„ç«¯å£ã€‚ä½ å¯ä»¥ä»¥ root ç”¨æˆ·å¯åŠ¨åº”ç”¨ï¼Œç„¶åç«‹å³ä½¿ç”¨<code>process.initgroups</code>é™ä½æƒé™åˆ°ä¸€ä¸ªæ™®é€šç”¨æˆ·ï¼Œä»¥é¿å…æ•´ä¸ªè¿‡ç¨‹éƒ½ç”¨ root æƒé™è¿è¡Œï¼Œä»è€Œæé«˜å®‰å…¨æ€§ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">getuid</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getuid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">===</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°è¯•æŠŠç”¨æˆ·åˆ‡æ¢åˆ° &quot;nobody&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">initgroups</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;nobody&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;nobody&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setgid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;nobody&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setuid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;nobody&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>å¤šç”¨æˆ·æœåŠ¡åº”ç”¨</strong>:<br> å¦‚æœä½ çš„ Node.js åº”ç”¨æ˜¯ä¸ºå¤šä¸ªç”¨æˆ·æä¾›æœåŠ¡çš„ï¼Œæ¯”å¦‚ä¸€ä¸ªå…±äº«çš„æ–‡ä»¶ç®¡ç†å™¨ï¼Œä½ å¯èƒ½éœ€è¦æ ¹æ®ä¸åŒçš„ç”¨æˆ·è¯·æ±‚ï¼Œè®©ä½ çš„æœåŠ¡ä»¥ä¸åŒç”¨æˆ·çš„èº«ä»½æ‰§è¡ŒæŸäº›æ“ä½œã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>process.initgroups</code> å¯ä»¥åœ¨å¤„ç†æ¯ä¸ªè¯·æ±‚å‰è¢«ç”¨æ¥åˆ‡æ¢å½“å‰è¿›ç¨‹çš„ç”¨æˆ·å’Œç¾¤ç»„ï¼Œç¡®ä¿æ“ä½œçš„æƒé™æ­£ç¡®ã€‚</li></ol><p>æ³¨æ„äº‹é¡¹ï¼š</p><ul><li>ä½¿ç”¨<code>process.initgroups</code>éœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œå› ä¸ºå®ƒæ¶‰åŠåˆ°æ”¹å˜è¿›ç¨‹çš„ç”¨æˆ·å’Œç¾¤ç»„ä¿¡æ¯ã€‚</li><li>åœ¨ä¿®æ”¹è¿›ç¨‹çš„ç”¨æˆ·/ç¾¤ç»„å‰ï¼Œç¡®ä¿ç†è§£ç›¸å…³çš„å®‰å…¨é£é™©ï¼Œé”™è¯¯çš„ä½¿ç”¨å¯èƒ½ä¼šé™ä½ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚</li></ul><p>ç†è§£å¹¶æ­£ç¡®ä½¿ç”¨<code>process.initgroups</code>å¯ä»¥å¸®åŠ©ä½ ç¼–å†™æ›´å®‰å…¨ã€æ›´çµæ´»çš„ Node.js åº”ç”¨ç¨‹åºï¼Œå°¤å…¶æ˜¯é‚£äº›éœ€è¦è¯¦ç»†æ§åˆ¶æ“ä½œç³»ç»Ÿèµ„æºæƒé™çš„åº”ç”¨ã€‚</p><h2 id="process-kill-pid-signal" tabindex="-1"><a class="header-anchor" href="#process-kill-pid-signal"><span><a href="https://nodejs.org/docs/latest/api/process.html#processkillpid-signal" target="_blank" rel="noopener noreferrer">process.kill(pid[, signal])</a></span></a></h2><p>äº†è§£<code>process.kill(pid[, signal])</code>è¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œå…ˆè®©æˆ‘ä»¬ç®€è¦äº†è§£ä¸€ä¸‹å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p><ol><li><strong>è¿›ç¨‹(Process)</strong>ï¼šåœ¨è®¡ç®—æœºä¸­ï¼Œè¿›ç¨‹æ˜¯æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºçš„å®ä¾‹ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„å†…å­˜åœ°å€ç©ºé—´ã€ä»£ç ã€æ•°æ®å’Œå…¶ä»–ç³»ç»Ÿèµ„æºã€‚</li><li><strong>PID(Process ID)</strong>ï¼šæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ•°å­—æ ‡è¯†ç¬¦ï¼Œç§°ä¸ºè¿›ç¨‹ IDï¼ˆPIDï¼‰ã€‚å®ƒç”¨äºæ“ä½œç³»ç»Ÿä¸­å¯¹è¿›ç¨‹è¿›è¡Œå”¯ä¸€æ ‡è¯†ã€‚</li><li><strong>ä¿¡å·(Signal)</strong>ï¼šä¿¡å·æ˜¯ä¸€ç§åœ¨ Unixã€Linux å’Œç±» Unix æ“ä½œç³»ç»Ÿï¼ˆåŒ…æ‹¬ MacOSï¼‰ä¸­è¿›ç¨‹é€šä¿¡çš„æ–¹å¼ã€‚é€šè¿‡å‘é€ä¿¡å·ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥å‘Šè¯‰å¦ä¸€ä¸ªè¿›ç¨‹å‘ç”Ÿäº†æŸä¸ªç‰¹å®šçš„äº‹ä»¶ã€‚æ¯”å¦‚ï¼Œ<code>SIGKILL</code>ç”¨äºç«‹å³ç»ˆæ­¢è¿›ç¨‹ï¼Œ<code>SIGTERM</code>ç”¨äºè¯·æ±‚è¿›ç¨‹æ­£å¸¸é€€å‡ºã€‚</li></ol><p>ç°åœ¨ï¼Œä»‹ç»<code>process.kill(pid[, signal])</code>ï¼š</p><p>è¿™ä¸ªå‡½æ•°ä¸»è¦ç”¨äºå‘æŒ‡å®šçš„è¿›ç¨‹å‘é€ä¿¡å·ã€‚å‚æ•°<code>pid</code>æ˜¯è¦å‘é€ä¿¡å·çš„ç›®æ ‡è¿›ç¨‹çš„è¿›ç¨‹ IDï¼Œè€Œ<code>signal</code>æ˜¯ä½ æƒ³è¦å‘é€çš„ä¿¡å·ï¼›å¦‚æœä¸æŒ‡å®š<code>signal</code>ï¼Œé»˜è®¤ä¿¡å·æ˜¯<code>SIGTERM</code>ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-2"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="_1-ç»ˆæ­¢ä¸€ä¸ªè¿›ç¨‹" tabindex="-1"><a class="header-anchor" href="#_1-ç»ˆæ­¢ä¸€ä¸ªè¿›ç¨‹"><span>1. ç»ˆæ­¢ä¸€ä¸ªè¿›ç¨‹</span></a></h4><p>å‡è®¾æœ‰ä¸€ä¸ªè¿è¡Œç€çš„è¿›ç¨‹ï¼Œå…¶ PID æ˜¯ 1234ï¼Œä½ å¸Œæœ›ç»ˆæ­¢å®ƒã€‚ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ Node.js ä»£ç ç‰‡æ®µæ¥å®ç°ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kill</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1234</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™é‡Œæ²¡æœ‰æŒ‡å®šä¿¡å·ï¼Œæ‰€ä»¥å°†ä¼šå‘é€<code>SIGTERM</code>ä¿¡å·ç»™ PID ä¸º 1234 çš„è¿›ç¨‹ï¼Œè¯·æ±‚å®ƒæ­£å¸¸é€€å‡ºã€‚</p><h4 id="_2-å¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹" tabindex="-1"><a class="header-anchor" href="#_2-å¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹"><span>2. å¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹</span></a></h4><p>å¦‚æœè¿›ç¨‹æ²¡æœ‰å“åº”<code>SIGTERM</code>ä¿¡å·ï¼Œä½ å¯èƒ½éœ€è¦å¼ºåˆ¶å®ƒç«‹å³åœæ­¢ã€‚è¿™æ—¶ï¼Œå¯ä»¥å‘é€<code>SIGKILL</code>ä¿¡å·ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kill</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1234</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SIGKILL&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™ä¼šç«‹å³ç»ˆæ­¢ PID ä¸º 1234 çš„è¿›ç¨‹ï¼Œä¸ç»™å®ƒè¿›è¡Œä»»ä½•æ¸…ç†å·¥ä½œçš„æœºä¼šã€‚</p><h4 id="_3-ç»™è¿›ç¨‹å‘é€å…¶ä»–ç±»å‹çš„ä¿¡å·" tabindex="-1"><a class="header-anchor" href="#_3-ç»™è¿›ç¨‹å‘é€å…¶ä»–ç±»å‹çš„ä¿¡å·"><span>3. ç»™è¿›ç¨‹å‘é€å…¶ä»–ç±»å‹çš„ä¿¡å·</span></a></h4><p>é™¤äº†ç»ˆæ­¢è¿›ç¨‹å¤–ï¼Œ<code>process.kill</code>è¿˜å¯ä»¥ç”¨äºå‘é€å…¶ä»–ç±»å‹çš„ä¿¡å·ã€‚ä¾‹å¦‚ï¼Œ<code>SIGHUP</code>é€šå¸¸è¢«ç”¨æ¥å‘Šè¯‰è¿›ç¨‹é‡æ–°è¯»å–å…¶é…ç½®æ–‡ä»¶ã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªè¿›ç¨‹çš„ PID ä¸º 5678ï¼Œå¹¶ä¸”ä½ å¸Œæœ›å®ƒé‡æ–°åŠ è½½é…ç½®ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kill</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5678</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SIGHUP&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="æ³¨æ„äº‹é¡¹-7" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-7"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>ä½¿ç”¨<code>process.kill()</code>éœ€è¦è°¨æ…ï¼Œå°¤å…¶æ˜¯å½“ä½ å‘é€<code>SIGKILL</code>ä¿¡å·æ—¶ï¼Œå› ä¸ºå®ƒä¸å…è®¸è¿›ç¨‹è¿›è¡Œä»»ä½•æ¸…ç†å·¥ä½œã€‚</li><li>ç¡®ä¿ä½ æœ‰æƒé™å‘ç›®æ ‡è¿›ç¨‹å‘é€ä¿¡å·ã€‚åœ¨å¤šç”¨æˆ·ç³»ç»Ÿä¸­ï¼Œé€šå¸¸åªèƒ½å‘å±äºä½ æˆ–è€…ç”±ä½ å¯åŠ¨çš„è¿›ç¨‹å‘é€ä¿¡å·ã€‚</li><li>å¹¶éæ‰€æœ‰çš„æ“ä½œç³»ç»Ÿéƒ½æ”¯æŒæ‰€æœ‰ç±»å‹çš„ä¿¡å·ã€‚åœ¨ä½¿ç”¨ä¸å¸¸è§çš„ä¿¡å·å‰ï¼Œæœ€å¥½æŸ¥é˜…ç›¸å…³çš„æ“ä½œç³»ç»Ÿæ–‡æ¡£ã€‚</li></ul><p>é€šè¿‡åˆé€‚åœ°ä½¿ç”¨<code>process.kill()</code>ï¼Œä½ å¯ä»¥åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­æœ‰æ•ˆåœ°ç®¡ç†ç³»ç»Ÿè¿›ç¨‹ã€‚</p><h2 id="process-loadenvfile-path" tabindex="-1"><a class="header-anchor" href="#process-loadenvfile-path"><span><a href="https://nodejs.org/docs/latest/api/process.html#processloadenvfilepath" target="_blank" rel="noopener noreferrer">process.loadEnvFile(path)</a></span></a></h2><p>Node.js åœ¨å…¶ç‰ˆæœ¬ä¸­å¼•å…¥äº†è®¸å¤šå®ç”¨çš„ç‰¹æ€§å’Œæ–¹æ³•ï¼Œ<code>process.loadEnvFile(path)</code> æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ åœ¨ Node.js åº”ç”¨ç¨‹åºä¸­åŠ¨æ€åœ°åŠ è½½ç¯å¢ƒå˜é‡æ–‡ä»¶(.env æ–‡ä»¶)ã€‚è¿™æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå› ä¸ºç¯å¢ƒå˜é‡å¸¸ç”¨äºå­˜å‚¨é…ç½®é€‰é¡¹å’Œæ•æ„Ÿä¿¡æ¯ï¼Œè€Œä¸å°†å®ƒä»¬ç¡¬ç¼–ç åˆ°æºä»£ç ä¸­ã€‚</p><h3 id="è§£é‡Š-2" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-2"><span>è§£é‡Š</span></a></h3><p>ç¯å¢ƒå˜é‡æ˜¯åœ¨æ“ä½œç³»ç»Ÿçº§åˆ«æˆ–å‘½ä»¤è¡Œä¸Šè®¾ç½®çš„é”®å€¼å¯¹ï¼ŒNode.js é€šè¿‡ <code>process.env</code> å¯¹è±¡æä¾›å¯¹è¿™äº›å˜é‡çš„è®¿é—®ã€‚é€šå¸¸ï¼Œç¯å¢ƒå˜é‡ç”¨äºæ§åˆ¶åº”ç”¨ç¨‹åºçš„è¡Œä¸ºæˆ–é…ç½®ï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥ä¿¡æ¯ã€å¤–éƒ¨æœåŠ¡çš„ API å¯†é’¥æˆ–åº”ç”¨è¿è¡Œæ¨¡å¼ï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç­‰ï¼‰ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ Node.js åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨è¯»å–å½“å‰ç¯å¢ƒä¸­è®¾ç½®çš„ç¯å¢ƒå˜é‡ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œä½ å¯èƒ½æƒ³è¦æ ¹æ®ä¸åŒçš„ç¯å¢ƒæˆ–æ¡ä»¶ä»æ–‡ä»¶ä¸­åŠ è½½é¢å¤–çš„ç¯å¢ƒå˜é‡ï¼Œè€Œ <code>process.loadEnvFile(path)</code> å°±æ˜¯ä¸ºæ­¤è®¾è®¡çš„ã€‚</p><h3 id="ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#ç”¨æ³•"><span>ç”¨æ³•</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º .env çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// DATABASE_URL=mongodb://localhost/myapp</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// SECRET_KEY=verysecretkey</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä½¿ç”¨ process.loadEnvFile() åŠ è½½ç¯å¢ƒå˜é‡æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">loadEnvFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./.env&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨å¯ä»¥é€šè¿‡ process.env è®¿é—®è¿™äº›å˜é‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">DATABASE_URL</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: mongodb://localhost/myapp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">SECRET_KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡º: verysecretkey</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®é™…è¿ç”¨ä¾‹å­-8" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-8"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>å¤šç¯å¢ƒé…ç½®</strong>ï¼šåœ¨å¼€å‘è½¯ä»¶æ—¶ï¼Œé€šå¸¸æœ‰å¤šä¸ªç¯å¢ƒï¼ˆä¾‹å¦‚æœ¬åœ°å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒï¼‰ã€‚æ¯ä¸ªç¯å¢ƒéƒ½å¯èƒ½éœ€è¦ä¸åŒçš„æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ã€API å¯†é’¥æˆ–æ—¥å¿—çº§åˆ«ã€‚é€šè¿‡ä¸ºæ¯ä¸ªç¯å¢ƒåˆ›å»ºä¸åŒçš„ <code>.env</code> æ–‡ä»¶ï¼ˆå¦‚ <code>.env.development</code>, <code>.env.test</code>, <code>.env.production</code>ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>process.loadEnvFile()</code> åŠ¨æ€åŠ è½½é€‚åˆå½“å‰ç¯å¢ƒçš„é…ç½®ã€‚</p></li><li><p><strong>æ•æ„Ÿä¿¡æ¯ç®¡ç†</strong>ï¼šåœ¨å¼€å‘åº”ç”¨æ—¶ï¼Œå¤„ç†è¯¸å¦‚æ•°æ®åº“å‡­æ®ã€ç¬¬ä¸‰æ–¹æœåŠ¡çš„ API å¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯éœ€è¦ç‰¹åˆ«å°å¿ƒã€‚å°†è¿™äº›ä¿¡æ¯ä¿å­˜åœ¨ç¯å¢ƒå˜é‡ä¸­ï¼Œè€Œä¸æ˜¯ç›´æ¥å†™åœ¨ä»£ç é‡Œï¼Œå¯ä»¥å¢åŠ å®‰å…¨æ€§ã€‚ä½ å¯ä»¥å°†æ•æ„Ÿä¿¡æ¯æ”¾åœ¨ <code>.env</code> æ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨éƒ¨ç½²æ—¶ç¡®ä¿è¿™äº›æ–‡ä»¶ä¸è¢«åŒ…å«åœ¨ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ã€‚é€šè¿‡ <code>process.loadEnvFile()</code> åŠ è½½è¿™äº›æ•æ„Ÿä¿¡æ¯ï¼ŒåŒæ—¶ä¿æŒä»£ç çš„æ¸…æ´å’Œå®‰å…¨ã€‚</p></li><li><p><strong>åº”ç”¨é…ç½®</strong>ï¼šæœ‰æ—¶ï¼Œåº”ç”¨ç¨‹åºéœ€è¦æ ¹æ®ä¸åŒçš„ç”¨æˆ·è¾“å…¥æˆ–æ¡ä»¶æ¥è°ƒæ•´å…¶é…ç½®ã€‚ä¾‹å¦‚ï¼ŒåŸºäºç”¨æˆ·é€‰æ‹©çš„è¯­è¨€æˆ–åœ°åŒºè®¾ç½®ä¸åŒçš„æœåŠ¡ç«¯ç‚¹ã€‚ä½ å¯ä»¥ä¸ºæ¯ç§æƒ…å†µåˆ›å»ºä¸€ä¸ª <code>.env</code> æ–‡ä»¶ï¼Œç„¶åæ ¹æ®éœ€è¦åŠ¨æ€åŠ è½½è¿™äº›æ–‡ä»¶ä»¥è°ƒæ•´åº”ç”¨é…ç½®ã€‚</p></li></ol><h3 id="ç»“è®º-4" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-4"><span>ç»“è®º</span></a></h3><p><code>process.loadEnvFile(path)</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç‰¹æ€§ï¼Œå®ƒå…è®¸å¼€å‘è€…ä»æ–‡ä»¶ä¸­åŠ¨æ€åŠ è½½ç¯å¢ƒå˜é‡ï¼Œè¿›è€Œè½»æ¾ç®¡ç†åº”ç”¨é…ç½®ã€æ•æ„Ÿä¿¡æ¯ç­‰ã€‚è¿™æé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå®‰å…¨æ€§ï¼Œä¹Ÿä½¿å¾—åœ¨ä¸åŒç¯å¢ƒä¹‹é—´åˆ‡æ¢å˜å¾—æ›´åŠ çµæ´»å’Œæ— ç¼ã€‚</p><h2 id="process-mainmodule" tabindex="-1"><a class="header-anchor" href="#process-mainmodule"><span><a href="https://nodejs.org/docs/latest/api/process.html#processmainmodule" target="_blank" rel="noopener noreferrer">process.mainModule</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>process</code> æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†ä¸€ç³»åˆ—å±æ€§å’Œæ–¹æ³•ï¼Œç”¨äºä¸å½“å‰ Node.js è¿›ç¨‹äº¤äº’ã€‚è€Œ <code>process.mainModule</code> æ˜¯ <code>process</code> å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒæœ‰åŠ©äºæˆ‘ä»¬è·å–å½“å‰åº”ç”¨ç¨‹åºçš„å…¥å£æ¨¡å—ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯æ¨¡å—"><span>ä»€ä¹ˆæ˜¯æ¨¡å—ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½è¢«è§†ä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ã€‚å½“ä½ è¿è¡Œä¸€ä¸ª Node.js åº”ç”¨æ—¶ï¼Œä½ å®é™…ä¸Šæ˜¯åœ¨è¿è¡Œè¿™ä¸ªåº”ç”¨çš„å…¥å£æ¨¡å—ï¼Œè¯¥æ¨¡å—å¯èƒ½ä¼šå¼•å…¥å…¶ä»–æ¨¡å—ï¼ˆé€šè¿‡ <code>require</code> å‡½æ•°ï¼‰æ¥è¿›è¡Œå·¥ä½œã€‚</p><h3 id="process-mainmodule-çš„å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#process-mainmodule-çš„å®šä¹‰"><span>process.mainModule çš„å®šä¹‰</span></a></h3><p><code>process.mainModule</code> å±æ€§æŒ‡å‘äº†åº”ç”¨ç¨‹åºçš„ä¸»æ¨¡å—ï¼Œå³å¯åŠ¨åº”ç”¨ç¨‹åºçš„é‚£ä¸ª JavaScript æ–‡ä»¶ã€‚è¿™ä¸ªå±æ€§æ˜¯å¯¹ <code>require.main</code> çš„ä¸€ä¸ªåˆ«åã€‚å¦‚æœä½ çš„åº”ç”¨æ˜¯é€šè¿‡ <code>node myApp.js</code> å¯åŠ¨çš„ï¼Œé‚£ä¹ˆ <code>process.mainModule</code> å°±ä¼šæŒ‡å‘ <code>myApp.js</code> æ–‡ä»¶å¯¹åº”çš„æ¨¡å—ã€‚</p><p>ä» Node.js v14.0.0 å¼€å§‹ï¼Œ<code>process.mainModule</code> å’Œ <code>require.main</code> è¢«å¼ƒç”¨ï¼Œæ¨èä½¿ç”¨æ–°çš„æ–¹æ³•æ¥ä»£æ›¿å®ƒä»¬ï¼Œä½†äº†è§£ <code>process.mainModule</code> ä»ç„¶å¯¹ç†è§£æ—§ä»£ç æˆ–ä¸€äº›ç‰¹å®šåº“å¾ˆé‡è¦ã€‚</p><h3 id="å®é™…ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-3"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„ Node.js åº”ç”¨ï¼Œå®ƒç”±ä¸¤ä¸ªæ–‡ä»¶æ„æˆï¼š<code>app.js</code> å’Œ <code>moduleA.js</code>ã€‚</p><p><strong>app.js:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> moduleA</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./moduleA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This is the main module:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mainModule</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">filename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>moduleA.js:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This is module A.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å½“ä½ é€šè¿‡å‘½ä»¤è¡Œè¿è¡Œ <code>node app.js</code> æ—¶ï¼Œæ§åˆ¶å°å°†è¾“å‡ºå¦‚ä¸‹ä¿¡æ¯ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>This is module A.</span></span>
<span class="line"><span>This is the main module: /your/path/to/app.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>process.mainModule.filename</code> ç»™å‡ºäº†ä¸»æ¨¡å—çš„å®Œæ•´è·¯å¾„ï¼Œè¯´æ˜ <code>app.js</code> æ˜¯è¿™ä¸ª Node.js åº”ç”¨çš„å…¥å£ç‚¹ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯-3" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯-3"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><p>è™½ç„¶ç›´æ¥ä½¿ç”¨ <code>process.mainModule</code> çš„æƒ…å†µæ¯”è¾ƒå°‘ï¼Œäº†è§£å®ƒå¯ä»¥å¸®ä½ è¯Šæ–­é—®é¢˜ï¼Œä¾‹å¦‚åˆ¤æ–­å½“å‰æ‰§è¡Œçš„è„šæœ¬æ˜¯å¦ä¸ºåº”ç”¨çš„å…¥å£ç‚¹ã€‚æ­¤å¤–ï¼Œåœ¨æŸäº›éœ€è¦æ ¹æ®åº”ç”¨å…¥å£æ¨¡å—åŠ¨æ€åŠ è½½èµ„æºæˆ–é…ç½®çš„æƒ…å†µä¸‹ï¼Œ<code>process.mainModule</code> çš„æ¦‚å¿µä¹Ÿéå¸¸æœ‰ç”¨ã€‚</p><p>æ€»ä¹‹ï¼Œ<code>process.mainModule</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬è·å–å…³äº Node.js åº”ç”¨å…¥å£æ¨¡å—çš„ä¿¡æ¯ï¼Œå°½ç®¡å®ƒå·²ç»è¢«å¼ƒç”¨ï¼Œä½†åœ¨é˜…è¯»å’Œç†è§£æ—§ä»£ç æ—¶ä»å¯èƒ½é‡åˆ°ã€‚</p><h2 id="process-memoryusage" tabindex="-1"><a class="header-anchor" href="#process-memoryusage"><span><a href="https://nodejs.org/docs/latest/api/process.html#processmemoryusage" target="_blank" rel="noopener noreferrer">process.memoryUsage()</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥æ·±å…¥æ¢è®¨ Node.js ä¸­çš„ <code>process.memoryUsage()</code> æ–¹æ³•ï¼Œå¹¶é€šè¿‡ä¸€äº›å®ç”¨çš„ä¾‹å­æ¥ç†è§£å®ƒçš„å·¥ä½œåŸç†å’Œåº”ç”¨ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-process-memoryusage" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-process-memoryusage"><span>ä»€ä¹ˆæ˜¯ <code>process.memoryUsage()</code>ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code> æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†æœ‰å…³å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚<code>memoryUsage()</code> æ–¹æ³•å°±æ˜¯ <code>process</code> å¯¹è±¡æä¾›çš„æ–¹æ³•ä¹‹ä¸€ï¼Œå®ƒç”¨äºè¿”å› Node.js è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨æƒ…å†µçš„å¯¹è±¡ï¼Œå¸®åŠ©å¼€å‘è€…äº†è§£ç¨‹åºåœ¨è¿è¡Œæ—¶æ¶ˆè€—çš„å†…å­˜é‡ã€‚</p><h3 id="è¿”å›å€¼-1" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-1"><span>è¿”å›å€¼</span></a></h3><p><code>process.memoryUsage()</code> æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«ä»¥ä¸‹å‡ ä¸ªå±æ€§ï¼š</p><ul><li><code>rss</code>ï¼ˆResident Set Sizeï¼‰: è¡¨ç¤º Node.js è¿›ç¨‹å ç”¨çš„ç‰©ç†å†…å­˜é‡ã€‚</li><li><code>heapTotal</code>: è¡¨ç¤º V8 å¼•æ“åˆ†é…çš„å†…å­˜æ€»é‡ã€‚</li><li><code>heapUsed</code>: å®é™…ä½¿ç”¨çš„å †å¤§å°ã€‚</li><li><code>external</code>: è¡¨ç¤º V8 ç®¡ç†çš„ï¼Œç»‘å®šåˆ° JavaScript çš„ C++ å¯¹è±¡çš„å†…å­˜ä½¿ç”¨é‡ã€‚</li><li><code>arrayBuffers</code>: è¡¨ç¤ºåˆ†é…ç»™ ArrayBuffer å’Œ SharedArrayBuffer çš„å†…å­˜ï¼Œè¿™æ˜¯ ECMAScript 2015 (ES6) æ–°å¢çš„ã€‚</li></ul><h3 id="ä½¿ç”¨ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä¾‹å­-1"><span>ä½¿ç”¨ä¾‹å­</span></a></h3><h4 id="åŸºæœ¬ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ä½¿ç”¨"><span>åŸºæœ¬ä½¿ç”¨</span></a></h4><p>è¦æŸ¥çœ‹ä½ çš„ Node.js åº”ç”¨ç¨‹åºå½“å‰çš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œä½ å¯ä»¥ç®€å•åœ°è°ƒç”¨è¿™ä¸ªæ–¹æ³•å¹¶æ‰“å°å…¶è¿”å›å€¼ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">memoryUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿è¡Œè¿™æ®µä»£ç ï¼Œä½ å¯èƒ½ä¼šå¾—åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡ºï¼š</p><div class="language-plaintext line-numbers-mode" data-highlighter="shiki" data-ext="plaintext" data-title="plaintext" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>{</span></span>
<span class="line"><span>  rss: 20480000,</span></span>
<span class="line"><span>  heapTotal: 7159808,</span></span>
<span class="line"><span>  heapUsed: 4465936,</span></span>
<span class="line"><span>  external: 823200,</span></span>
<span class="line"><span>  arrayBuffers: 9386</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®é™…åº”ç”¨ä¾‹å­-ç›‘æ§å†…å­˜ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-ç›‘æ§å†…å­˜ä½¿ç”¨"><span>å®é™…åº”ç”¨ä¾‹å­ï¼šç›‘æ§å†…å­˜ä½¿ç”¨</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶ä¸”æƒ³è¦ç›‘æ§åº”ç”¨çš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œä»¥ç¡®ä¿å®ƒä¸ä¼šå› ä¸ºä½¿ç”¨è¿‡å¤šçš„å†…å­˜è€Œå´©æºƒã€‚ä½ å¯ä»¥è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå‘¨æœŸæ€§åœ°æ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå¹¶è®°å½•æˆ–æŠ¥è­¦ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> usage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">memoryUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å†…å­˜ä½¿ç”¨æƒ…å†µï¼š</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">JSON</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stringify</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">usage</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">usage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">heapUsed</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000000000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ä¾‹å¦‚ï¼Œå¦‚æœä½¿ç”¨çš„å †å†…å­˜è¶…è¿‡äº†1GB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å†…å­˜ä½¿ç”¨è¿‡é«˜ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // è¿™é‡Œå¯ä»¥æ·»åŠ æ›´å¤šçš„å¤„ç†é€»è¾‘ï¼Œæ¯”å¦‚å‘é€è­¦æŠ¥é‚®ä»¶ã€å°è¯•æ¸…ç†å†…å­˜ç­‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯10ç§’æ‰§è¡Œä¸€æ¬¡</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä¼˜åŒ–å†…å­˜ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ä¼˜åŒ–å†…å­˜ä½¿ç”¨"><span>ä¼˜åŒ–å†…å­˜ä½¿ç”¨</span></a></h4><p>äº†è§£åº”ç”¨çš„å†…å­˜ä½¿ç”¨æƒ…å†µåï¼Œä½ å¯èƒ½ä¼šé‡‡å–æªæ–½æ¥ä¼˜åŒ–å†…å­˜ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ å‘ç° <code>heapUsed</code> éšç€æ—¶é—´çš„æ¨ç§»ä¸æ–­å¢åŠ ï¼Œå¯èƒ½è¡¨ç¤ºå†…å­˜æ³„æ¼ã€‚ä½ å¯ä»¥è¿›ä¸€æ­¥åˆ†æå’Œè°ƒè¯•ä½ çš„ä»£ç ï¼Œæ‰¾å‡ºå¹¶ä¿®å¤å†…å­˜æ³„æ¼çš„æºå¤´ã€‚</p><h3 id="æ€»ç»“-18" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-18"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä½¿ç”¨ <code>process.memoryUsage()</code> æ–¹æ³•ï¼Œå¼€å‘äººå‘˜å¯ä»¥è·å¾—å…³äº Node.js åº”ç”¨ç¨‹åºå†…å­˜ä½¿ç”¨çš„é‡è¦ä¿¡æ¯ï¼Œè¿™å¯¹äºç›‘æ§ã€è°ƒè¯•å’Œä¼˜åŒ–åº”ç”¨æ¥è¯´æ˜¯éå¸¸æœ‰ä»·å€¼çš„ã€‚è®°ä½ï¼Œè‰¯å¥½çš„å†…å­˜ç®¡ç†æ˜¯ä¿æŒåº”ç”¨æ€§èƒ½å’Œç¨³å®šæ€§çš„å…³é”®ã€‚</p><h2 id="process-memoryusage-rss" tabindex="-1"><a class="header-anchor" href="#process-memoryusage-rss"><span><a href="https://nodejs.org/docs/latest/api/process.html#processmemoryusagerss" target="_blank" rel="noopener noreferrer">process.memoryUsage.rss()</a></span></a></h2><p>ç†è§£ <code>process.memoryUsage.rss()</code> æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-2" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-2"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><ol><li><strong>Node.js</strong>ï¼šæ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ã€‚</li><li><strong>è¿›ç¨‹ï¼ˆProcessï¼‰</strong>ï¼šå½“ä½ è¿è¡Œä¸€ä¸ªç¨‹åºæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šä¸ºè¿™ä¸ªç¨‹åºåˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªæ‰§è¡Œç¯å¢ƒï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œè¿›ç¨‹â€ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç­‰èµ„æºã€‚</li><li><strong>å†…å­˜ï¼ˆMemoryï¼‰</strong>ï¼šè®¡ç®—æœºä¸­ç”¨äºæš‚æ—¶å­˜å‚¨æ•°æ®çš„éƒ¨åˆ†ã€‚ç¨‹åºè¿è¡Œæ—¶ï¼Œå…¶æ•°æ®å’Œä»£ç éœ€è¦è¢«åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</li></ol><h3 id="process-memoryusage-rss-è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#process-memoryusage-rss-è§£é‡Š"><span>process.memoryUsage.rss() è§£é‡Š</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code>å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯ã€‚<code>memoryUsage</code>æ˜¯<code>process</code>å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ªåŒ…å«äº†å½“å‰è¿›ç¨‹å†…å­˜ä½¿ç”¨æƒ…å†µçš„å¯¹è±¡ã€‚è€Œ<code>rss</code>ï¼Œå³ Resident Set Sizeï¼Œæ˜¯å…¶ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œè¡¨ç¤ºè¿›ç¨‹å½“å‰å ç”¨çš„ç‰©ç†å†…å­˜é‡ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚</p><p>ç®€å•è¯´ï¼Œ<code>process.memoryUsage.rss()</code>ç”¨äºè·å–å½“å‰ Node.js åº”ç”¨ç¨‹åºå ç”¨çš„ç‰©ç†å†…å­˜å¤§å°ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-9" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-9"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="ä¾‹å­-1-ç›‘æµ‹å†…å­˜ä½¿ç”¨é‡" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1-ç›‘æµ‹å†…å­˜ä½¿ç”¨é‡"><span>ä¾‹å­ 1ï¼šç›‘æµ‹å†…å­˜ä½¿ç”¨é‡</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œæƒ³è¦ç¡®ä¿å®ƒä¸ä¼šæ¶ˆè€—è¿‡å¤šçš„å†…å­˜ã€‚ä½ å¯ä»¥å®šæœŸè°ƒç”¨<code>process.memoryUsage.rss()</code>æ¥ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> memoryUsageInBytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">memoryUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">rss</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å½“å‰å ç”¨çš„ç‰©ç†å†…å­˜é‡: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">memoryUsageInBytes</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bytes`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç æ¯éš” 1 ç§’è¾“å‡ºä¸€æ¬¡å½“å‰ Node.js è¿›ç¨‹å ç”¨çš„ç‰©ç†å†…å­˜é‡ã€‚</p><h4 id="ä¾‹å­-2-å†…å­˜ä½¿ç”¨æŠ¥è­¦" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-2-å†…å­˜ä½¿ç”¨æŠ¥è­¦"><span>ä¾‹å­ 2ï¼šå†…å­˜ä½¿ç”¨æŠ¥è­¦</span></a></h4><p>å¦‚æœä½ æƒ³è¦åœ¨å†…å­˜ä½¿ç”¨è¶…è¿‡æŸä¸ªé˜ˆå€¼æ—¶æ”¶åˆ°è­¦å‘Šï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> memoryUsage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">memoryUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">rss</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  //Le document provient de Ying Chao Tea. Ne pas utiliser Ã  des fins commerciales.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾é˜ˆå€¼è®¾ç½®ä¸º100MB</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">memoryUsage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">warn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å†…å­˜ä½¿ç”¨è¶…è¿‡100MBï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥åŠæ—¶äº†è§£åˆ°åº”ç”¨çš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œé‡‡å–ç›¸åº”æªæ–½è¿›è¡Œä¼˜åŒ–æˆ–å¤„ç†ï¼Œä»¥é¿å…åº”ç”¨å› å†…å­˜æº¢å‡ºè€Œå´©æºƒã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>process.memoryUsage.rss()</code>æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ ç†è§£å¹¶ç›‘æ§ä½ çš„ Node.js åº”ç”¨çš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œä»è€Œä½¿ä½ èƒ½å¤Ÿæ›´å¥½åœ°ç®¡ç†å’Œä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€‚</p><h2 id="process-nexttick-callback-args" tabindex="-1"><a class="header-anchor" href="#process-nexttick-callback-args"><span><a href="https://nodejs.org/docs/latest/api/process.html#processnexttickcallback-args" target="_blank" rel="noopener noreferrer">process.nextTick(callback[, ...args])</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªè®© JavaScript å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œçš„ç¯å¢ƒï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨æµè§ˆå™¨ä¸­ã€‚å…¶ä¸­ï¼Œ<code>process.nextTick()</code> æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªéå¸¸é‡è¦çš„åŠŸèƒ½ã€‚</p><h3 id="ç†è§£-process-nexttick" tabindex="-1"><a class="header-anchor" href="#ç†è§£-process-nexttick"><span>ç†è§£ <code>process.nextTick()</code></span></a></h3><p>é¦–å…ˆï¼Œè¦ç†è§£ <code>process.nextTick()</code>ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£ Node.js çš„äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰ã€‚Node.js çš„æ‰§è¡Œæ¨¡å‹æ˜¯åŸºäºäº‹ä»¶å¾ªç¯å’Œå›è°ƒå‡½æ•°çš„ã€‚å½“ä½ è¿è¡Œä¸€ä¸ª Node.js ç¨‹åºæ—¶ï¼ŒNode.js ä¼šåˆ›å»ºä¸€ä¸ªäº‹ä»¶å¾ªç¯æ¥ç®¡ç†å¼‚æ­¥æ“ä½œå’Œäº‹ä»¶ã€‚è¿™æ„å‘³ç€ä»£ç ä¸æ˜¯ä»ä¸Šåˆ°ä¸‹ä¸€æ¬¡æ€§æ‰§è¡Œå®Œï¼Œè€Œæ˜¯å¯ä»¥åœ¨ç­‰å¾…å¼‚æ­¥æ“ä½œï¼ˆæ¯”å¦‚è¯»å–æ–‡ä»¶ã€ç½‘ç»œè¯·æ±‚ç­‰ï¼‰çš„åŒæ—¶ç»§ç»­æ‰§è¡Œå…¶ä»–ä»£ç ã€‚</p><p>åœ¨è¿™ä¸ªäº‹ä»¶å¾ªç¯ä¸­ï¼Œ<code>process.nextTick()</code> å…è®¸ä½ å°†ä¸€ä¸ªå›è°ƒå‡½æ•°æ”¾åˆ°ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯è¿­ä»£çš„å¼€å§‹å¤„æ‰§è¡Œã€‚è¿™æ„å‘³ç€æ— è®ºä½•æ—¶è°ƒç”¨ <code>process.nextTick()</code>ï¼Œæä¾›ç»™å®ƒçš„å›è°ƒå‡½æ•°éƒ½ä¼šåœ¨å½“å‰æ“ä½œå®Œæˆåã€ä»»ä½• I/O äº‹ä»¶ï¼ˆåŒ…æ‹¬å®šæ—¶å™¨ï¼‰å¤„ç†ä¹‹å‰è¢«æ‰§è¡Œã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹"><span>ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹</span></a></h3><h4 id="å¼‚æ­¥-api-çš„å°è£…" tabindex="-1"><a class="header-anchor" href="#å¼‚æ­¥-api-çš„å°è£…"><span>å¼‚æ­¥ API çš„å°è£…</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°éœ€è¦å¼‚æ­¥åœ°è¿”å›ä¸€äº›æ•°æ®ã€‚ä¸ºäº†ç¡®ä¿è¿™ä¸ªå‡½æ•°æ€»æ˜¯å¼‚æ­¥è¿”å›æ•°æ®ï¼Œå³ä½¿æ˜¯å·²ç»å¯ç”¨çš„æ•°æ®ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>process.nextTick()</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> myAsyncAPI</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">nextTick</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    callback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">myAsyncAPI</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// {key: &quot;value&quot;}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå³ä½¿æ•°æ®ç«‹å³å¯ç”¨ï¼Œ<code>myAsyncAPI</code> å‡½æ•°ä¹Ÿä¼šé€šè¿‡ <code>process.nextTick()</code> ç¡®ä¿å›è°ƒå‡½æ•°å¼‚æ­¥æ‰§è¡Œã€‚</p><h4 id="é˜²æ­¢é€’å½’è°ƒç”¨æ ˆæº¢å‡º" tabindex="-1"><a class="header-anchor" href="#é˜²æ­¢é€’å½’è°ƒç”¨æ ˆæº¢å‡º"><span>é˜²æ­¢é€’å½’è°ƒç”¨æ ˆæº¢å‡º</span></a></h4><p>å¦‚æœä½ æœ‰ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œç›´æ¥çš„é€’å½’è°ƒç”¨å¯èƒ½ä¼šå¯¼è‡´è°ƒç”¨æ ˆæº¢å‡ºé”™è¯¯ï¼Œå› ä¸º JavaScript å¼•æ“æœ‰ä¸€ä¸ªæœ€å¤§è°ƒç”¨æ ˆå¤§å°é™åˆ¶ã€‚ä½¿ç”¨ <code>process.nextTick()</code>ï¼Œä½ å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒä¼šå°†æ¯æ¬¡é€’å½’çš„æ‰§è¡Œæ¨è¿Ÿåˆ°ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯è¿­ä»£ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> recursiveFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">count</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">nextTick</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> recursiveFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">count</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">recursiveFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¸ä¼šå¯¼è‡´è°ƒç”¨æ ˆæº¢å‡º</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>recursiveFunction</code> é€’å‡è®¡æ•°å¹¶é€’å½’è°ƒç”¨è‡ªå·±ã€‚é€šè¿‡ä½¿ç”¨ <code>process.nextTick()</code>ï¼Œé€’å½’è°ƒç”¨æ˜¯å¼‚æ­¥è¿›è¡Œçš„ï¼Œé¿å…äº†è°ƒç”¨æ ˆæº¢å‡ºã€‚</p><h3 id="æ€»ç»“-19" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-19"><span>æ€»ç»“</span></a></h3><p><code>process.nextTick()</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå…è®¸å¼€å‘è€…æ§åˆ¶ä»£ç çš„æ‰§è¡Œæ—¶æœºï¼Œå°¤å…¶æ˜¯åœ¨æ¶‰åŠåˆ°å¼‚æ­¥æ“ä½œå’Œäº‹ä»¶å¾ªç¯æ—¶ã€‚å®ƒèƒ½å¤Ÿç¡®ä¿å›è°ƒå‡½æ•°åœ¨å½“å‰æ‰§è¡Œæ ˆçš„æ“ä½œå®Œæˆåã€äº‹ä»¶å¾ªç¯ç»§ç»­ä¹‹å‰å¾—åˆ°æ‰§è¡Œï¼Œéå¸¸é€‚åˆå¤„ç†å¼‚æ­¥é€»è¾‘å’Œé¿å…è°ƒç”¨æ ˆæº¢å‡ºçš„é—®é¢˜ã€‚ä¸è¿‡ï¼Œä¹Ÿéœ€è¦ç•™æ„ä¸è¦æ»¥ç”¨ï¼Œå› ä¸ºè¿‡å¤šçš„ä½¿ç”¨ <code>process.nextTick()</code> å¯èƒ½ä¼šå¯¼è‡´ I/O æ“ä½œå»¶è¿Ÿã€‚</p><h3 id="when-to-use-queuemicrotask-vs-process-nexttick" tabindex="-1"><a class="header-anchor" href="#when-to-use-queuemicrotask-vs-process-nexttick"><span><a href="https://nodejs.org/docs/latest/api/process.html#when-to-use-queuemicrotask-vs-processnexttick" target="_blank" rel="noopener noreferrer">When to use queueMicrotask() vs. process.nextTick()</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>queueMicrotask()</code>å’Œ<code>process.nextTick()</code>éƒ½æ˜¯ç”¨æ¥å®‰æ’å¼‚æ­¥æ“ä½œçš„æ–¹æ³•ï¼Œä½†å®ƒä»¬åœ¨äº‹ä»¶å¾ªç¯ä¸­çš„è¡Œä¸ºå’Œä½¿ç”¨åœºæ™¯æœ‰æ‰€ä¸åŒã€‚ç†è§£è¿™ä¸¤ä¸ªå‡½æ•°çš„å·®å¼‚å¯¹äºç¼–å†™é«˜æ•ˆã€å¯é¢„æµ‹çš„ Node.js åº”ç”¨ç¨‹åºéå¸¸é‡è¦ã€‚</p><h3 id="_1-process-nexttick" tabindex="-1"><a class="header-anchor" href="#_1-process-nexttick"><span>1. process.nextTick()</span></a></h3><ul><li><strong>å®šä¹‰</strong>: <code>process.nextTick()</code>å…è®¸ä½ å°†ä¸€ä¸ªå›è°ƒæ”¾åˆ°å½“å‰äº‹ä»¶å¾ªç¯é˜¶æ®µçš„æœ«å°¾ã€‚è¿™æ„å‘³ç€æ— è®ºä½•æ—¶ä½ è°ƒç”¨<code>process.nextTick()</code>ï¼Œä½ æä¾›çš„å›è°ƒå‡½æ•°éƒ½ä¼šåœ¨å½“å‰æ“ä½œå®Œæˆåã€åœ¨æ‰§è¡Œä»»ä½• I/O æ“ä½œï¼ˆä¾‹å¦‚å®šæ—¶å™¨æˆ–è¯»å†™æ“ä½œç­‰ï¼‰ä¹‹å‰è¢«æ‰§è¡Œã€‚</li><li><strong>ä½¿ç”¨åœºæ™¯</strong>: <code>process.nextTick()</code>ä¸»è¦ç”¨äºç¡®ä¿åœ¨å½“å‰äº‹ä»¶å¾ªç¯é˜¶æ®µå®Œæˆåã€ä¸‹ä¸€äº‹ä»¶å¾ªç¯é˜¶æ®µå¼€å§‹ä¹‹å‰æ‰§è¡ŒæŸäº›æ“ä½œã€‚è¿™å¯¹é”™è¯¯å¤„ç†ï¼Œä»¥åŠåœ¨ç»§ç»­æ‰§è¡Œå…¶ä»– I/O æ“ä½œä¹‹å‰æ›´æ–°æˆ–æ£€æŸ¥åº”ç”¨çŠ¶æ€ç‰¹åˆ«æœ‰ç”¨ã€‚</li></ul><p><strong>ä¾‹å­</strong>: å‡å¦‚ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªäº‹ä»¶è§¦å‘ç³»ç»Ÿï¼Œåœ¨è§¦å‘ä¸€ä¸ªäº‹ä»¶åï¼Œä½ å¯èƒ½æƒ³ç«‹å³å¤„ç†è¿™ä¸ªäº‹ä»¶ï¼Œè€Œä¸æ˜¯ç­‰å¾…ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">nextTick</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™å°†åœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯è¿­ä»£ä¸­è¿è¡Œï¼Œä½†åœ¨ä»»ä½•I/Oäº‹ä»¶ä¹‹å‰&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™å°†ç«‹å³è¿è¡Œ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-queuemicrotask" tabindex="-1"><a class="header-anchor" href="#_2-queuemicrotask"><span>2. queueMicrotask()</span></a></h3><ul><li><strong>å®šä¹‰</strong>: <code>queueMicrotask()</code>å°†ä¸€ä¸ªä»»åŠ¡æ·»åŠ åˆ° microtask é˜Ÿåˆ—ä¸­ï¼Œè¿™äº›ä»»åŠ¡åœ¨å½“å‰äº‹ä»¶å¾ªç¯çš„æœ€åæ‰§è¡Œï¼Œä½†åœ¨æ¸²æŸ“ä¹‹å‰æ‰§è¡Œã€‚åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œmicrotasks ä¸»è¦ç”¨äºç¡®ä¿ä»»åŠ¡å¦‚ Promise å›è°ƒèƒ½å¤Ÿå°½å¿«åœ°ã€åœ¨åŒä¸€ä¸ªäº‹ä»¶å¾ªç¯å†…éƒ¨æ‰§è¡Œå®Œæ¯•ã€‚</li><li><strong>ä½¿ç”¨åœºæ™¯</strong>: <code>queueMicrotask()</code>é€‚ç”¨äºä½ å¸Œæœ›å¼‚æ­¥æ‰§è¡Œä½†åˆä¸æƒ³ç­‰å¾…ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯è¿­ä»£çš„æƒ…å†µï¼Œæ¯”å¦‚åœ¨å½“å‰æ“ä½œå®Œæˆåç«‹å³å¤„ç† Promise ç»“æœï¼Œæˆ–è€…æ˜¯éœ€è¦åœ¨å½“å‰æ ˆæ¸…ç©ºä½†ä¸å¼•å…¥é¢å¤–çš„äº‹ä»¶å¾ªç¯å»¶è¿Ÿçš„åœºåˆã€‚</li></ul><p><strong>ä¾‹å­</strong>: å½“ä½ æƒ³è¦åœ¨å½“å‰çš„ä»£ç æ‰§è¡Œå®Œæ¯•åï¼Œç«‹å³æ‰§è¡ŒæŸä¸ªæ“ä½œï¼Œä½†åˆä¸æƒ³é˜»å¡åç»­çš„å®ä»»åŠ¡ï¼ˆå¦‚ setTimeout, setImmediate ç­‰ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">queueMicrotask</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åœ¨å½“å‰äº‹ä»¶å¾ªç¯ç»“æŸï¼Œä½†åœ¨ä»»ä½•å…¶ä»–å®ä»»åŠ¡ä¹‹å‰æ‰§è¡Œ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¿™ä¹Ÿå°†ç«‹å³è¿è¡Œ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ¯”è¾ƒä¸é€‰æ‹©" tabindex="-1"><a class="header-anchor" href="#æ¯”è¾ƒä¸é€‰æ‹©"><span>æ¯”è¾ƒä¸é€‰æ‹©</span></a></h3><ul><li><strong>æ€§èƒ½è€ƒé‡</strong>: <code>process.nextTick()</code>å› ä¸ºæ€»æ˜¯åœ¨å½“å‰äº‹ä»¶å¾ªç¯çš„å‰©ä½™éƒ¨åˆ†å’Œä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯çš„å¼€å§‹ä¹‹é—´æ‰§è¡Œï¼Œå¯èƒ½ä¼šå¯¼è‡´é€’å½’è°ƒç”¨<code>process.nextTick()</code>åˆ›å»ºçš„å›è°ƒå †ç§¯ï¼Œä»è€Œå»¶è¿Ÿ I/O æ“ä½œã€‚ç›¸åï¼Œ<code>queueMicrotask()</code>ç”±äºå…¶åœ¨äº‹ä»¶å¾ªç¯çš„åŒä¸€é˜¶æ®µç¨åæ‰§è¡Œï¼Œé€šå¸¸ä¸ä¼šå¯¹ I/O é€ æˆæ˜¾è‘—çš„å»¶è¿Ÿã€‚</li><li><strong>é€‚ç”¨åœºæ™¯</strong>: å¦‚æœä½ çš„å›è°ƒé€»è¾‘æ¶‰åŠåˆ°ç´§æ¥ç€å½“å‰æ‰§è¡Œæ ˆçš„é”™è¯¯å¤„ç†æˆ–çŠ¶æ€æ›´æ–°ï¼Œ<code>process.nextTick()</code>æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚å¦‚æœä½ çš„é€»è¾‘æ˜¯åŸºäº Promise æˆ–è€…éœ€è¦ä¿è¯åœ¨å½“å‰äº‹ä»¶å¾ªç¯ç»“æŸå‰è¿è¡Œï¼ˆä½†ä¸å½±å“åˆ°ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯çš„å¼€å§‹ï¼‰ï¼Œ<code>queueMicrotask()</code>ä¼šæ˜¯æ›´åˆé€‚çš„é€‰æ‹©ã€‚</li></ul><p>ç†è§£å¹¶æ­£ç¡®ä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œå¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°æ§åˆ¶ä½ çš„ Node.js åº”ç”¨ç¨‹åºä¸­çš„å¼‚æ­¥é€»è¾‘æ‰§è¡Œé¡ºåºï¼Œä»è€Œå†™å‡ºæ›´é«˜æ•ˆã€æ›´å¯é çš„ä»£ç ã€‚</p><h2 id="process-nodeprecation" tabindex="-1"><a class="header-anchor" href="#process-nodeprecation"><span><a href="https://nodejs.org/docs/latest/api/process.html#processnodeprecation" target="_blank" rel="noopener noreferrer">process.noDeprecation</a></span></a></h2><p>å½“ç„¶å¯ä»¥ã€‚Node.js ä¸­çš„ <code>process.noDeprecation</code> æ˜¯ä¸€ä¸ªæ ‡å¿—ï¼Œç”¨äºæŒ‡ç¤ºæ˜¯å¦åœ¨è¿è¡Œæ—¶æ˜¾ç¤ºåºŸå¼ƒè­¦å‘Šã€‚åœ¨ç¼–ç¨‹å’Œè½¯ä»¶å¼€å‘ä¸­ï¼Œâ€œåºŸå¼ƒâ€æŒ‡çš„æ˜¯ä¸€ç§æ¨èä¸å†ä½¿ç”¨æŸä¸ªç‰¹æ€§ã€æ–¹æ³•æˆ–å‡½æ•°çš„çŠ¶æ€ï¼Œé€šå¸¸æ˜¯å› ä¸ºå®ƒä»¬å·²ç»è¢«æ›´å¥½çš„é€‰é¡¹æ‰€å–ä»£ã€‚</p><h3 id="ç®€å•è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#ç®€å•è§£é‡Š"><span>ç®€å•è§£é‡Š</span></a></h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€æœ¬æ—§çš„é£Ÿè°±ä¹¦ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€äº›ç”¨è¿‡æ—¶æ–¹æ³•åšèœçš„é£Ÿè°±ã€‚ç°åœ¨ï¼Œå‡ºç‰ˆå•†å†³å®šæ›´æ–°è¿™æœ¬ä¹¦ï¼Œæ›¿æ¢é‚£äº›è¿‡æ—¶çš„æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œä»–ä»¬ä¹Ÿæƒ³è®©ä»ç„¶ä½¿ç”¨æ—§ç‰ˆçš„äººçŸ¥é“å“ªäº›æ–¹æ³•ä¸æ¨èä½¿ç”¨äº†ã€‚åœ¨ Node.js çš„ä¸–ç•Œé‡Œï¼Œ<code>process.noDeprecation</code> å°±åƒæ˜¯ä¸€ä¸ªå¼€å…³ï¼Œå¦‚æœä½ æ‰“å¼€å®ƒï¼ˆè®¾ç½®ä¸º <code>true</code>ï¼‰ï¼ŒNode.js å°±ä¸ä¼šå‘Šè¯‰ä½ å“ªäº›æ–¹æ³•å·²ç»è¿‡æ—¶ä¸åº”è¯¥å†ç”¨äº†ï¼›å¦‚æœå…³é—­ï¼ˆé»˜è®¤æƒ…å†µï¼Œå³è®¾ç½®ä¸º <code>false</code> æˆ–ä¸è®¾ç½®ï¼‰ï¼ŒNode.js ä¼šåœ¨ä½ ä½¿ç”¨è¿™äº›ä¸æ¨èçš„æ–¹æ³•æ—¶æé†’ä½ ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯-4" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯-4"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›å®é™…çš„ä¾‹å­æ¥çœ‹çœ‹ <code>process.noDeprecation</code> çš„åº”ç”¨åœºæ™¯ï¼š</p><h4 id="ç¤ºä¾‹-1-å¿½ç•¥è¿‡æ—¶è­¦å‘Š" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-å¿½ç•¥è¿‡æ—¶è­¦å‘Š"><span>ç¤ºä¾‹ 1ï¼šå¿½ç•¥è¿‡æ—¶è­¦å‘Š</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨ç»´æŠ¤ä¸€ä¸ªå¤§å‹é¡¹ç›®ï¼Œè€Œè¿™ä¸ªé¡¹ç›®ä¾èµ–äº†å¾ˆå¤šå…¶ä»–ç¬¬ä¸‰æ–¹åº“ã€‚å¦‚æœæŸä¸ªåº“ä½¿ç”¨äº† Node.js ä¸­å³å°†åºŸå¼ƒçš„åŠŸèƒ½ï¼Œæ¯æ¬¡è¿è¡Œæ—¶ä½ éƒ½ä¼šçœ‹åˆ°è­¦å‘Šä¿¡æ¯ï¼Œè¿™å¯èƒ½ä¼šå¹²æ‰°ä½ å…³æ³¨çœŸæ­£é‡è¦çš„æ—¥å¿—ä¿¡æ¯ã€‚è¿™æ—¶å€™ï¼Œä½ å¯ä»¥åœ¨å¯åŠ¨é¡¹ç›®ä¹‹å‰è®¾ç½® <code>process.noDeprecation = true;</code> æ¥å¿½ç•¥è¿™äº›è­¦å‘Šï¼Œä»¥ä¾¿æ›´æ¸…æ™°åœ°çœ‹åˆ°å…¶ä»–é‡è¦æ—¥å¿—ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">noDeprecation</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾åç»­ä»£ç ä¸­æœ‰ä½¿ç”¨å°†è¦è¢«åºŸå¼ƒçš„ Node.js æ ¸å¿ƒAPIï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®äº† process.noDeprecation = true åï¼Œå°±ä¸ä¼šçœ‹åˆ°ç›¸åº”çš„åºŸå¼ƒè­¦å‘Šã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-åœ¨è„šæœ¬ä¸­åŠ¨æ€å†³å®š" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-åœ¨è„šæœ¬ä¸­åŠ¨æ€å†³å®š"><span>ç¤ºä¾‹ 2ï¼šåœ¨è„šæœ¬ä¸­åŠ¨æ€å†³å®š</span></a></h4><p>å¦‚æœä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ï¼Œå¯èƒ½å¸Œæœ›åŸºäºç‰¹å®šæ¡ä»¶ï¼ˆæ¯”å¦‚ç›®æ ‡ç¯å¢ƒçš„ Node.js ç‰ˆæœ¬ï¼‰æ¥å†³å®šæ˜¯å¦æ˜¾ç¤ºåºŸå¼ƒè­¦å‘Šã€‚æ­¤æ—¶ï¼Œä½ å¯ä»¥åŠ¨æ€åœ°è®¾ç½® <code>process.noDeprecation</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">éœ€è¦å¿½ç•¥åºŸå¼ƒè­¦å‘Šçš„æ¡ä»¶</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">noDeprecation</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿è¡Œä¸€äº›å¯èƒ½ä½¿ç”¨äº†è¿‡æ—¶APIçš„æ“ä½œ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-3-ä½œä¸ºå¯åŠ¨å‚æ•°" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3-ä½œä¸ºå¯åŠ¨å‚æ•°"><span>ç¤ºä¾‹ 3ï¼šä½œä¸ºå¯åŠ¨å‚æ•°</span></a></h4><p>è™½ç„¶æ–‡æ¡£ä¸­æ²¡æœ‰æ˜ç¡®æåˆ°ï¼Œä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<code>process.noDeprecation</code> ä¹Ÿå¯ä»¥é€šè¿‡ Node.js è¿è¡Œæ—¶çš„å‘½ä»¤è¡Œå‚æ•°è¿›è¡Œè®¾ç½®ï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨ä»£ç ä¸­è®¾ç½®ã€‚è¿™åœ¨æŸäº›è‡ªåŠ¨åŒ–åœºæ™¯æˆ–è€…å®¹å™¨åŒ–éƒ¨ç½²ä¸­éå¸¸æœ‰ç”¨ï¼Œå®ƒå…è®¸å¼€å‘è€…æˆ–è¿ç»´äººå‘˜åœ¨ä¸ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹æ§åˆ¶æ­¤è¡Œä¸ºã€‚</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">node</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --no-deprecation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> your-script.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™ä¼šå¯åŠ¨ <code>your-script.js</code> å¹¶è®¾ç½® <code>process.noDeprecation = true</code>, ä»è€Œåœ¨æ•´ä¸ªè„šæœ¬è¿è¡ŒæœŸé—´å¿½ç•¥ä»»ä½•åºŸå¼ƒè­¦å‘Šã€‚</p><h3 id="æ€»ç»“-20" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-20"><span>æ€»ç»“</span></a></h3><p><code>process.noDeprecation</code> æ˜¯ä¸€ä¸ªéå¸¸å…·ä½“çš„ç‰¹æ€§ï¼Œç”¨äºæ§åˆ¶ Node.js åº”ç”¨ç¨‹åºä¸­æ˜¯å¦æ˜¾ç¤ºåºŸå¼ƒè­¦å‘Šã€‚è™½ç„¶å¤§å¤šæ•°æ—¶é—´ä½ å¯èƒ½ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®å®ƒï¼Œä½†åœ¨è¿›è¡Œå¤§è§„æ¨¡é¡¹ç›®ç»´æŠ¤ã€å¤„ç†ç¹æ‚çš„æ—¥å¿—è¾“å‡ºï¼Œæˆ–è€…éœ€è¦ç²¾ç»†æ§åˆ¶å“ªäº›è­¦å‘Šæ˜¾ç¤ºæ—¶ï¼Œäº†è§£å¹¶åˆç†åˆ©ç”¨å®ƒä¼šéå¸¸æœ‰å¸®åŠ©ã€‚</p><h2 id="process-permission" tabindex="-1"><a class="header-anchor" href="#process-permission"><span><a href="https://nodejs.org/docs/latest/api/process.html#processpermission" target="_blank" rel="noopener noreferrer">process.permission</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„åº”ç”¨ç¨‹åºã€‚å®ƒéå¸¸é€‚åˆæ„å»ºå¿«é€Ÿçš„ã€å¯æ‰©å±•çš„ç½‘ç»œåº”ç”¨ã€‚åœ¨ Node.js ä¸­ï¼Œæœ‰ä¸€ä¸ªå…¨å±€å¯¹è±¡ <code>process</code>ï¼Œå®ƒæä¾›äº†å…³äºå½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å…è®¸ä½ ä¸è¯¥è¿›ç¨‹è¿›è¡Œäº¤äº’ã€‚</p><p>æˆªè‡³æˆ‘æ‰€çŸ¥çš„æœ€æ–°ç‰ˆæœ¬ä¿¡æ¯åˆ° 2023 å¹´ 4 æœˆä¸ºæ­¢ï¼ŒNode.js å®˜æ–¹æ–‡æ¡£ä¸­å¹¶æ²¡æœ‰ç›´æ¥æåŠåä¸º <code>process.permission</code> çš„å±æ€§æˆ–æ–¹æ³•ã€‚è¿™å¯èƒ½æ˜¯ç”±äºç‰ˆæœ¬æ›´æ–°æˆ–è€…æ˜¯æŒ‡å‘äº†æŸç§å…·ä½“çš„åŠŸèƒ½æˆ–ææ¡ˆè¿˜æœªæ­£å¼çº³å…¥åˆ°ç¨³å®šç‰ˆä¸­ã€‚å› æ­¤ï¼Œåœ¨å›ç­”ä½ çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä¼šå‡è®¾ä½ æ˜¯æƒ³äº†è§£ <code>process</code> å¯¹è±¡å¦‚ä½•è¢«ç”¨äºå¤„ç†æƒé™ç›¸å…³çš„ä»»åŠ¡ï¼Œç‰¹åˆ«æ˜¯åœ¨å®‰å…¨å’Œæƒé™æ§åˆ¶çš„ä¸Šä¸‹æ–‡ä¸­ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œè™½ç„¶æ²¡æœ‰ç›´æ¥çš„ <code>process.permission</code> å±æ€§ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼æ¥ç†è§£å’Œæ§åˆ¶ä¸æ“ä½œç³»ç»Ÿå±‚é¢çš„ç”¨æˆ·æƒé™ç›¸å…³è”çš„è¡Œä¸ºã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªå¦‚ä½•åœ¨ Node.js ä¸­å®ç°ä¸æƒé™ç›¸å…³é€»è¾‘çš„ä¾‹å­ï¼š</p><h3 id="_1-æ”¹å˜è¿›ç¨‹çš„ç”¨æˆ·å’Œç»„æ ‡è¯†" tabindex="-1"><a class="header-anchor" href="#_1-æ”¹å˜è¿›ç¨‹çš„ç”¨æˆ·å’Œç»„æ ‡è¯†"><span>1. æ”¹å˜è¿›ç¨‹çš„ç”¨æˆ·å’Œç»„æ ‡è¯†</span></a></h3><p>å¦‚æœ Node.js è¿›ç¨‹ä»¥ root ç”¨æˆ·å¯åŠ¨ï¼ˆä¾‹å¦‚ï¼Œåœ¨ Linux ç³»ç»Ÿä¸Šï¼‰ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä½ å¯èƒ½å¸Œæœ›å°†è¿›ç¨‹çš„æƒé™é™ä½ï¼Œä½¿å…¶ä»¥éç‰¹æƒç”¨æˆ·è¿è¡Œã€‚è¿™å¯ä»¥é€šè¿‡æ”¹å˜è¿›ç¨‹çš„ç”¨æˆ· ID (UID) å’Œç»„ ID (GID) æ¥å®ç°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾æˆ‘ä»¬æƒ³åˆ‡æ¢åˆ° userID 1000 å’Œ groupID 1000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setuid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setgid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Process is now running with less privileges&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Failed to set UID/GID: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-æŸ¥è¯¢è¿›ç¨‹æƒé™" tabindex="-1"><a class="header-anchor" href="#_2-æŸ¥è¯¢è¿›ç¨‹æƒé™"><span>2. æŸ¥è¯¢è¿›ç¨‹æƒé™</span></a></h3><p>è™½ç„¶ä¸èƒ½ç›´æ¥æŸ¥è¯¢â€œæƒé™â€ï¼Œä½†å¯ä»¥æŸ¥è¯¢å½“å‰è¿›ç¨‹çš„ç”¨æˆ· ID å’Œç»„ IDï¼Œè¿™é—´æ¥åæ˜ äº†è¿›ç¨‹çš„æƒé™çº§åˆ«ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Current UID: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getuid</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Current GID: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getgid</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæƒé™" tabindex="-1"><a class="header-anchor" href="#_3-ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæƒé™"><span>3. ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæƒé™</span></a></h3><p>Node.js åº”ç”¨å¸¸å¸¸éœ€è¦è¯»å†™æ–‡ä»¶ç³»ç»Ÿã€‚é€šè¿‡æ£€æŸ¥æ–‡ä»¶çš„æƒé™ï¼Œä½ å¯ä»¥å†³å®šæ˜¯å¦å¯¹æ–‡ä»¶è¿›è¡Œæ“ä½œã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ <code>fs</code> æ¨¡å—æ£€æŸ¥æ–‡ä»¶æƒé™ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">access</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;/path/to/your/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">R_OK</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">constants</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">W_OK</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;No access to read/write the file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;The file can be read and written&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šç¤ºä¾‹ä¸­ï¼Œ<code>fs.access</code> æ–¹æ³•è¢«ç”¨æ¥æ£€æµ‹å½“å‰è¿›ç¨‹æ˜¯å¦æœ‰æƒé™å¯¹æŒ‡å®šæ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œè™½ç„¶ Node.js çš„ <code>process</code> å¯¹è±¡ä¸­æ²¡æœ‰ç›´æ¥åä¸º <code>process.permission</code> çš„å±æ€§æˆ–æ–¹æ³•ï¼Œä½†é€šè¿‡ç»“åˆ <code>process</code> å¯¹è±¡å’Œå…¶ä»– Node.js APIï¼Œæˆ‘ä»¬èƒ½å¤Ÿç®¡ç†å’Œæ§åˆ¶ä¸æ“ä½œç³»ç»Ÿå±‚é¢çš„æƒé™ç›¸å…³çš„è¡Œä¸ºã€‚è¿™å¯¹äºç¼–å†™å®‰å…¨çš„åº”ç”¨ç¨‹åºæ¥è¯´è‡³å…³é‡è¦ã€‚</p><h3 id="process-permission-has-scope-reference" tabindex="-1"><a class="header-anchor" href="#process-permission-has-scope-reference"><span><a href="https://nodejs.org/docs/latest/api/process.html#processpermissionhasscope-reference" target="_blank" rel="noopener noreferrer">process.permission.has(scope[, reference])</a></span></a></h3><p>å½“æˆ‘ä»¬è®¨è®º Node.js ä¸­çš„<code>process.permission.has(scope[, reference])</code>æ—¶ï¼Œæˆ‘ä»¬æ˜¯åœ¨è°ˆè®ºä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå¸®åŠ©ä½ æ£€æŸ¥ä»£ç åœ¨è¿è¡Œæ—¶æ˜¯å¦æœ‰æ‰§è¡Œç‰¹å®šæ“ä½œçš„æƒé™ã€‚è¿™å¯¹äºç¼–å†™å®‰å…¨ã€å¯é çš„åº”ç”¨ç¨‹åºéå¸¸é‡è¦ï¼Œå°¤å…¶æ˜¯åœ¨æ¶‰åŠåˆ°æ–‡ä»¶è®¿é—®ã€ç½‘ç»œé€šä¿¡ç­‰æ•æ„Ÿæ“ä½œæ—¶ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-3" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-3"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code>å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæä¾›äº†ä¸å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹ç›¸å…³çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚<code>process.permission.has()</code>æ˜¯<code>process</code>å¯¹è±¡ä¸‹çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæŸ¥è¯¢å½“å‰è¿›ç¨‹æ˜¯å¦æ‹¥æœ‰ç‰¹å®šçš„æƒé™ã€‚</p><p>å‚æ•°è§£é‡Š:</p><ul><li><code>scope</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šä½ æƒ³æŸ¥è¯¢çš„æƒé™ç§ç±»ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥æ˜¯<code>&#39;fs.write&#39;</code>ï¼ˆå†™å…¥æ–‡ä»¶ç³»ç»Ÿçš„æƒé™ï¼‰ã€<code>&#39;net.connect&#39;</code>ï¼ˆå»ºç«‹ç½‘ç»œè¿æ¥çš„æƒé™ï¼‰ç­‰ã€‚</li><li><code>reference</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¿™ä¸ªå‚æ•°æä¾›é¢å¤–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯æ¥å…·ä½“åŒ–æƒé™æŸ¥è¯¢ã€‚æ ¹æ®æƒé™çš„ç±»å‹ï¼Œè¿™é‡Œå¯ä»¥ä¼ é€’ä¸åŒçš„å€¼ï¼Œæ¯”å¦‚ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ã€ä¸€ä¸ªç½‘ç»œåœ°å€ç­‰ã€‚</li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-3"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>æ£€æŸ¥æ–‡ä»¶å†™å…¥æƒé™</strong></p><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œéœ€è¦åœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡ä»¶å¤¹é‡Œåˆ›å»ºæˆ–ä¿®æ”¹æ–‡ä»¶ã€‚åœ¨å°è¯•è¿™æ ·åšä¹‹å‰ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>process.permission.has(&#39;fs.write&#39;, &#39;/path/to/directory&#39;)</code>æ¥æ£€æŸ¥ç¨‹åºæ˜¯å¦æœ‰æƒé™å†™å…¥é‚£ä¸ªæ–‡ä»¶å¤¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">permission</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">has</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs.write&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/directory&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä»£ç æ¥å†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ²¡æœ‰æƒé™å†™å…¥æŒ‡å®šçš„ç›®å½•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ£€æŸ¥ç½‘ç»œè¿æ¥æƒé™</strong></p><p>å¦‚æœä½ çš„åº”ç”¨éœ€è¦è¿æ¥åˆ°ä¸€ä¸ªè¿œç¨‹æœåŠ¡å™¨ï¼Œæ¯”å¦‚å‘é€ API è¯·æ±‚ï¼Œä½ å¯èƒ½æƒ³å…ˆç¡®è®¤ä½ æœ‰å»ºç«‹ç½‘ç»œè¿æ¥çš„æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡æŸ¥è¯¢<code>&#39;net.connect&#39;</code>æƒé™æ¥å®ç°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> serverAddress</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">permission</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">has</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;net.connect&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">serverAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä»£ç æ¥è¿æ¥æœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ²¡æœ‰æƒé™è¿æ¥åˆ° </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">serverAddress</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ¡ä»¶æ€§åœ°å¯ç”¨åŠŸèƒ½</strong></p><p>ä½ çš„åº”ç”¨å¯èƒ½æœ‰ä¸€äº›é«˜çº§åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½éœ€è¦ç‰¹å®šçš„ç³»ç»Ÿæƒé™æ‰èƒ½è¿è¡Œã€‚é€šè¿‡ä½¿ç”¨<code>process.permission.has</code>ï¼Œä½ å¯ä»¥æ¡ä»¶æ€§åœ°å¯ç”¨è¿™äº›åŠŸèƒ½ï¼Œåªæœ‰å½“å¿…è¦çš„æƒé™è¢«æˆäºˆæ—¶ï¼Œè¿™äº›åŠŸèƒ½æ‰ä¼šè¢«æ¿€æ´»ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> advancedFeature</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // é«˜çº§åŠŸèƒ½çš„å®ç°ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">permission</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">has</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;some.special.permission&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  advancedFeature</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;é«˜çº§åŠŸèƒ½ä¸å¯ç”¨ï¼Œå› ä¸ºç¼ºä¹ç›¸åº”æƒé™&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="å°ç»“" tabindex="-1"><a class="header-anchor" href="#å°ç»“"><span>å°ç»“</span></a></h3><p>é€šè¿‡ä½¿ç”¨<code>process.permission.has</code>ï¼Œä½ å¯ä»¥åœ¨ä½ çš„ Node.js åº”ç”¨ç¨‹åºä¸­æ·»åŠ æƒé™æ£€æŸ¥ï¼Œä»è€Œæå‡åº”ç”¨çš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚è¿™ç§æ–¹å¼ä½¿å¾—ä½ èƒ½å¤Ÿåœ¨å°è¯•æ‰§è¡Œå¯èƒ½ä¼šå¤±è´¥çš„æ“ä½œä¹‹å‰ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦å…·å¤‡ç›¸åº”çš„æƒé™ï¼Œä»è€Œé¿å…æ½œåœ¨çš„é”™è¯¯æˆ–å®‰å…¨é—®é¢˜ã€‚</p><h2 id="process-pid" tabindex="-1"><a class="header-anchor" href="#process-pid"><span><a href="https://nodejs.org/docs/latest/api/process.html#processpid" target="_blank" rel="noopener noreferrer">process.pid</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome çš„ V8 JavaScript å¼•æ“æ‰§è¡Œ JavaScript ä»£ç çš„ç¯å¢ƒã€‚å®ƒä½¿å¾—å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptï¼Œä»è€Œå¼€å‘å‡ºé«˜æ€§èƒ½çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code> æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†æœ‰å…³å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚é€šè¿‡ <code>process</code> å¯¹è±¡ï¼Œä½ å¯ä»¥è®¿é—®ç¯å¢ƒä¿¡æ¯ï¼Œè¯»å–ç¯å¢ƒå˜é‡ï¼Œç›‘å¬è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ç­‰ã€‚</p><h3 id="process-pid-1" tabindex="-1"><a class="header-anchor" href="#process-pid-1"><span><code>process.pid</code></span></a></h3><p><code>process.pid</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒè¿”å›å½“å‰è¿›ç¨‹çš„è¿›ç¨‹æ ‡è¯†ç¬¦ï¼ˆPIDï¼‰ã€‚è¿›ç¨‹æ ‡è¯†ç¬¦æ˜¯ä¸€ä¸ªå”¯ä¸€çš„æ•°å­—ï¼Œæ“ä½œç³»ç»Ÿç”¨å®ƒæ¥æ ‡è¯†æ¯ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ã€‚çŸ¥é“è¿™ä¸ªæ•°å­—å¯¹äºè°ƒè¯•ã€ç›‘è§†æˆ–ç®¡ç†åº”ç”¨ç¨‹åºçš„èµ„æºä½¿ç”¨æƒ…å†µå¯èƒ½éå¸¸æœ‰ç”¨ã€‚</p><h4 id="å®é™…è¿ç”¨çš„ä¾‹å­-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-3"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h4><ol><li><p><strong>ç›‘æ§å’Œè°ƒè¯•</strong></p><p>å½“ä½ è¿è¡Œä¸€ä¸ª Node.js åº”ç”¨æ—¶ï¼Œå¯èƒ½éœ€è¦çŸ¥é“å®ƒçš„ PIDï¼Œä»¥ä¾¿äºä½ å¯ä»¥ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„å·¥å…·æ¥ç›‘æ§è¿™ä¸ªè¿›ç¨‹çš„èµ„æºå ç”¨æƒ…å†µï¼ˆå¦‚ CPU ä½¿ç”¨ç‡ã€å†…å­˜å ç”¨ï¼‰æˆ–è€…è·Ÿè¸ªè¿›ç¨‹è¡Œä¸ºã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`This process is your pid </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pid</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å¦‚æœä½ å‘ç°ä½ çš„ Node.js åº”ç”¨æ¶ˆè€—è¿‡å¤šçš„èµ„æºï¼Œå¯ä»¥é€šè¿‡ PID æŸ¥æ‰¾å¹¶åˆ†æè¯¥è¿›ç¨‹ï¼Œé‡‡å–ç›¸åº”çš„ä¼˜åŒ–æªæ–½ã€‚</p></li><li><p><strong>å¤šè¿›ç¨‹ç®¡ç†</strong></p><p>åœ¨æŸäº›é«˜æ€§èƒ½çš„ Node.js åº”ç”¨ä¸­ï¼Œå¯èƒ½ä¼šå¯åŠ¨å¤šä¸ªè¿›ç¨‹æ¥å¤„ç†ä¸åŒçš„ä»»åŠ¡ï¼Œé€šè¿‡ä¸»è¿›ç¨‹åˆ›å»ºå’Œç®¡ç†å­è¿›ç¨‹ã€‚è¿™æ—¶å€™ï¼ŒçŸ¥é“æ¯ä¸ªå­è¿›ç¨‹çš„ PID éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒè®©ä¸»è¿›ç¨‹èƒ½å¤Ÿç›´æ¥ä¸ç‰¹å®šçš„å­è¿›ç¨‹é€šä¿¡æˆ–ç®¡ç†å®ƒä»¬ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child_process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> child</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/child/script.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Started child process with pid </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pid</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å¯åŠ¨äº†ä¸€ä¸ªå­è¿›ç¨‹æ¥è¿è¡Œå¦ä¸€ä¸ª Node.js è„šæœ¬ï¼Œå¹¶æ‰“å°å‡ºè¿™ä¸ªå­è¿›ç¨‹çš„ PIDã€‚çˆ¶è¿›ç¨‹å¯ä»¥ä½¿ç”¨è¿™ä¸ª PID æ¥ç›‘è§†æˆ–ç»ˆæ­¢å­è¿›ç¨‹ã€‚</p></li><li><p><strong>æ—¥å¿—è®°å½•</strong></p><p>åœ¨å¼€å‘å¤æ‚çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œæ—¥å¿—è®°å½•æ˜¯ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ã€‚åœ¨æ—¥å¿—ä¸­è®°å½• PID å¯ä»¥å¸®åŠ©ä½ è¿½è¸ªé‚£äº›äº§ç”Ÿç‰¹å®šæ—¥å¿—æ¡ç›®çš„è¿›ç¨‹ï¼Œå°¤å…¶æ˜¯åœ¨å¤šè¿›ç¨‹ç¯å¢ƒä¸‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    `</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toISOString</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> [PID: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">pid</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">] - </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Application is running.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µç®€å•çš„æ—¥å¿—å‡½æ•°åœ¨æ¶ˆæ¯å‰åŠ ä¸Šäº†æ—¶é—´æˆ³å’Œ PIDï¼Œä½¿å¾—åœ¨æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æ—¶ï¼Œèƒ½æ›´å®¹æ˜“åœ°ç¡®å®šå“ªä¸ªè¿›ç¨‹äº§ç”Ÿäº†æ—¥å¿—ã€‚</p></li></ol><p>æ€»ç»“èµ·æ¥ï¼Œ<code>process.pid</code> åœ¨ Node.js åº”ç”¨çš„ç›‘æ§ã€è°ƒè¯•ã€å¤šè¿›ç¨‹ç®¡ç†ä»¥åŠæ—¥å¿—è®°å½•ç­‰æ–¹é¢éƒ½æœ‰ç€é‡è¦çš„ä½œç”¨ã€‚é€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥è·å–åˆ°è¿›ç¨‹çš„æ ‡è¯†ç¬¦ï¼Œä»è€Œå¯¹è¿›ç¨‹è¿›è¡Œå‡†ç¡®çš„ç›‘æ§å’Œç®¡ç†ã€‚</p><h2 id="process-platform" tabindex="-1"><a class="header-anchor" href="#process-platform"><span><a href="https://nodejs.org/docs/latest/api/process.html#processplatform" target="_blank" rel="noopener noreferrer">process.platform</a></span></a></h2><p>Node.js ä¸­çš„<code>process.platform</code>å±æ€§æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç®€å•çš„æ–¹å¼æ¥ç¡®å®šæˆ‘ä»¬çš„ä»£ç æ­£åœ¨å“ªä¸ªæ“ä½œç³»ç»Ÿå¹³å°ä¸Šè¿è¡Œã€‚è¿™ä¸ªå±æ€§è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡ç¤º Node.js è¿›ç¨‹æ­£åœ¨å…¶ä¸Šè¿è¡Œçš„æ“ä½œç³»ç»Ÿå¹³å°ã€‚</p><p>ç†è§£<code>process.platform</code>çš„ä»·å€¼ä¸»è¦åœ¨äºå®ƒå…è®¸å¼€å‘è€…ç¼–å†™å¯åœ¨å¤šç§æ“ä½œç³»ç»Ÿé—´æ— ç¼è¿è¡Œçš„ä»£ç ã€‚è€ƒè™‘åˆ°ä¸åŒæ“ä½œç³»ç»Ÿï¼ˆæ¯”å¦‚ Windows, macOS, Linux ç­‰ï¼‰ä¹‹é—´å­˜åœ¨çš„è·¯å¾„è¡¨ç¤ºã€æ–‡ä»¶ç³»ç»Ÿæƒé™ã€ç¯å¢ƒå˜é‡è®¾ç½®ç­‰æ–¹é¢çš„å·®å¼‚ï¼Œé€šè¿‡æ£€æŸ¥<code>process.platform</code>çš„å€¼ï¼Œå¼€å‘äººå‘˜å¯ä»¥æ ¹æ®ä¸åŒæ“ä½œç³»ç»Ÿæ‰§è¡Œç‰¹å®šçš„é€»è¾‘ã€‚</p><h3 id="process-platform-å¯èƒ½çš„å€¼" tabindex="-1"><a class="header-anchor" href="#process-platform-å¯èƒ½çš„å€¼"><span><code>process.platform</code> å¯èƒ½çš„å€¼ï¼š</span></a></h3><ul><li><code>&#39;aix&#39;</code>ï¼šè¿è¡Œåœ¨ IBM AIX å¹³å°ä¸Š</li><li><code>&#39;darwin&#39;</code>ï¼šè¿è¡Œåœ¨ macOS å¹³å°ä¸Š</li><li><code>&#39;freebsd&#39;</code>ï¼šè¿è¡Œåœ¨ FreeBSD å¹³å°ä¸Š</li><li><code>&#39;linux&#39;</code>ï¼šè¿è¡Œåœ¨ Linux å¹³å°ä¸Š</li><li><code>&#39;openbsd&#39;</code>ï¼šè¿è¡Œåœ¨ OpenBSD å¹³å°ä¸Š</li><li><code>&#39;sunos&#39;</code>ï¼šè¿è¡Œåœ¨ SunOS (Solaris) å¹³å°ä¸Š</li><li><code>&#39;win32&#39;</code>ï¼šè¿è¡Œåœ¨ Windows å¹³å°ä¸Š</li></ul><p>æ³¨æ„ï¼Œå³ä½¿æ˜¯åœ¨ 64 ä½ Windows ä¸Šï¼Œ<code>process.platform</code>ä¹Ÿä¼šè¿”å›<code>&#39;win32&#39;</code>ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-4"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><h4 id="_1-è·¨å¹³å°æ–‡ä»¶è·¯å¾„å¤„ç†" tabindex="-1"><a class="header-anchor" href="#_1-è·¨å¹³å°æ–‡ä»¶è·¯å¾„å¤„ç†"><span>1. è·¨å¹³å°æ–‡ä»¶è·¯å¾„å¤„ç†</span></a></h4><p>åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶è·¯å¾„çš„è¡¨ç¤ºæ–¹å¼ä¸åŒã€‚æ¯”å¦‚ï¼Œåœ¨ Windows ä¸­ä½¿ç”¨åæ–œæ <code>\</code>ä½œä¸ºè·¯å¾„åˆ†éš”ç¬¦ï¼Œè€Œåœ¨ UNIX-like ç³»ç»Ÿï¼ˆLinux, macOS ç­‰ï¼‰ä¸­ä½¿ç”¨æ­£æ–œæ <code>/</code>ã€‚å¦‚æœä½ çš„ä»£ç éœ€è¦å¤„ç†æ–‡ä»¶è·¯å¾„ï¼ŒçŸ¥é“å½“å‰çš„æ“ä½œç³»ç»Ÿå°†å¸®åŠ©ä½ æ­£ç¡®åœ°æ„é€ æˆ–è§£æè·¯å¾„ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> path</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">platform</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;win32&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Running on Windows&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨åæ–œæ å¤„ç†è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> myPath</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;C:</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Users</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">YourName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">basename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">myPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿”å› &#39;YourName&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Running on a UNIX-like system&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨æ­£æ–œæ å¤„ç†è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> myPath</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/home/yourname&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">basename</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">myPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¿”å› &#39;yourname&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-è®¾ç½®ç¯å¢ƒå˜é‡" tabindex="-1"><a class="header-anchor" href="#_2-è®¾ç½®ç¯å¢ƒå˜é‡"><span>2. è®¾ç½®ç¯å¢ƒå˜é‡</span></a></h4><p>ä¸åŒçš„æ“ä½œç³»ç»Ÿä½¿ç”¨ä¸åŒçš„å‘½ä»¤æ¥è®¾ç½®ç¯å¢ƒå˜é‡ã€‚ä¾‹å¦‚ï¼Œåœ¨ Windows ä¸Šï¼Œæ‚¨å¯èƒ½éœ€è¦ä½¿ç”¨<code>set</code>å‘½ä»¤ï¼Œè€Œåœ¨ Linux æˆ– macOS ä¸Šï¼Œæ‚¨å°†ä½¿ç”¨<code>export</code>å‘½ä»¤ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> setEnvCommand</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">platform</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;win32&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  setEnvCommand</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;set&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  setEnvCommand</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;export&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Use &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">setEnvCommand</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot; to set an environment variable.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-å¯åŠ¨ç³»ç»Ÿç‰¹å®šçš„è¿›ç¨‹" tabindex="-1"><a class="header-anchor" href="#_3-å¯åŠ¨ç³»ç»Ÿç‰¹å®šçš„è¿›ç¨‹"><span>3. å¯åŠ¨ç³»ç»Ÿç‰¹å®šçš„è¿›ç¨‹</span></a></h4><p>æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦æ ¹æ®è¿è¡Œçš„æ“ä½œç³»ç»Ÿå¯åŠ¨ä¸åŒçš„è¿›ç¨‹æˆ–æ‰§è¡Œä¸åŒçš„å‘½ä»¤ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">exec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child_process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">platform</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;win32&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  exec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start .&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨Windowsä¸Šæ‰“å¼€å½“å‰ç›®å½•çš„æ–‡ä»¶æµè§ˆå™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">platform</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;darwin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  exec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;open .&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨macOSä¸ŠåšåŒæ ·çš„äº‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">platform</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;linux&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  exec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;xdg-open .&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨Linuxä¸ŠåšåŒæ ·çš„äº‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œä½ åº”è¯¥èƒ½çœ‹å‡º<code>process.platform</code>åœ¨å®ç°è·¨å¹³å°åŠŸèƒ½æ—¶çš„å…³é”®ä½œç”¨ã€‚äº†è§£å’Œåˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå¯ä»¥æå¤§æé«˜ä½ çš„ä»£ç çš„å¯ç§»æ¤æ€§å’Œå¥å£®æ€§ã€‚</p><h2 id="process-ppid" tabindex="-1"><a class="header-anchor" href="#process-ppid"><span><a href="https://nodejs.org/docs/latest/api/process.html#processppid" target="_blank" rel="noopener noreferrer">process.ppid</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„ JavaScript ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>process</code> æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ¥èšç„¦äº <code>process.ppid</code> è¿™ä¸€ç‰¹æ€§ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-process-ppid" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-process-ppid"><span>ä»€ä¹ˆæ˜¯ <code>process.ppid</code>ï¼Ÿ</span></a></h3><p>ç®€å•æ¥è¯´ï¼Œ<code>process.ppid</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒè¿”å›å½“å‰è¿›ç¨‹çš„çˆ¶è¿›ç¨‹çš„ IDï¼ˆProcess IDentifierï¼‰ã€‚åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªè¿è¡Œçš„ç¨‹åºéƒ½è¢«åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„æ•°å­—æ ‡è¯†ç¬¦ï¼Œå³è¿›ç¨‹ IDã€‚å½“ä¸€ä¸ªç¨‹åºï¼ˆè¿›ç¨‹ï¼‰å¯åŠ¨å¦ä¸€ä¸ªç¨‹åºæ—¶ï¼ŒåŸå…ˆçš„ç¨‹åºæˆä¸ºçˆ¶è¿›ç¨‹ï¼Œè€Œæ–°å¯åŠ¨çš„ç¨‹åºæˆä¸ºå­è¿›ç¨‹ã€‚</p><h3 id="ä¸ºä»€ä¹ˆ-process-ppid-é‡è¦" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆ-process-ppid-é‡è¦"><span>ä¸ºä»€ä¹ˆ <code>process.ppid</code> é‡è¦ï¼Ÿ</span></a></h3><p>äº†è§£å½“å‰è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ ID å¯¹äºç†è§£ç¨‹åºæ˜¯å¦‚ä½•è¢«å¯åŠ¨çš„ã€ç›‘æ§ç¨‹åºçš„å¥åº·çŠ¶å†µä»¥åŠåœ¨æŸäº›æƒ…å†µä¸‹è¿›è¡Œé—®é¢˜æ’æŸ¥éƒ½éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„åº”ç”¨ç¨‹åºæ„å¤–å´©æºƒæˆ–è¡¨ç°å¼‚å¸¸ï¼ŒçŸ¥é“å…¶çˆ¶è¿›ç¨‹å¯èƒ½å¸®åŠ©ä½ è¿½è¸ªé—®é¢˜çš„æ ¹æºï¼Œå°¤å…¶æ˜¯åœ¨å¤æ‚çš„åº”ç”¨æ¶æ„ä¸­ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-10" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-10"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>ç›‘æ§ä¸æ—¥å¿—è®°å½•</strong>ï¼šå‡è®¾ä½ å¼€å‘äº†ä¸€ä¸ªåº”ç”¨ï¼Œå®ƒç”±å¤šä¸ªå­è¿›ç¨‹ç»„æˆã€‚åˆ©ç”¨<code>process.ppid</code>ï¼Œä½ å¯ä»¥åœ¨æ—¥å¿—ä¿¡æ¯ä¸­åŒ…å«æ¯ä¸ªå­è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ IDï¼Œè¿™æ ·å½“é—®é¢˜å‡ºç°æ—¶ï¼Œä½ å¯ä»¥è½»æ¾åœ°è¿½è¸ªåˆ°é—®é¢˜å‘ç”Ÿçš„ä¸Šä¸‹æ–‡ã€‚</p></li><li><p><strong>å¥åº·æ£€æŸ¥</strong>ï¼šåœ¨ä¸€ä¸ªå¤§å‹ç³»ç»Ÿä¸­ï¼Œæœ‰æ—¶ä½ å¯èƒ½æƒ³è¦ç¡®ä¿æ‰€æœ‰çš„å­è¿›ç¨‹éƒ½æ˜¯ç”±ç‰¹å®šçš„æœåŠ¡æˆ–è°ƒåº¦å™¨å¯åŠ¨çš„ã€‚é€šè¿‡æ£€æŸ¥<code>process.ppid</code>ï¼Œä½ å¯ä»¥éªŒè¯å­è¿›ç¨‹æ˜¯å¦ç¡®å®ç”±é¢„æœŸçš„çˆ¶è¿›ç¨‹å¯åŠ¨ï¼Œè¿™æœ‰åŠ©äºç»´æŠ¤ç³»ç»Ÿçš„å®‰å…¨å’Œç¨³å®šæ€§ã€‚</p></li><li><p><strong>ä¼˜é›…å…³é—­</strong>ï¼šåœ¨æŸäº›æƒ…å¢ƒä¸‹ï¼Œå¦‚æœçˆ¶è¿›ç¨‹é€€å‡ºæˆ–å´©æºƒï¼Œä½ å¯èƒ½å¸Œæœ›ç›¸åº”åœ°å…³é—­å­è¿›ç¨‹ã€‚é€šè¿‡ç›‘å¬çˆ¶è¿›ç¨‹çš„çŠ¶æ€ï¼ˆåˆ©ç”¨<code>process.ppid</code>æ¥è¯†åˆ«çˆ¶è¿›ç¨‹ï¼‰ï¼Œå­è¿›ç¨‹å¯ä»¥åœ¨çˆ¶è¿›ç¨‹ä¸å¯ç”¨æ—¶è‡ªåŠ¨è¿›è¡Œæ¸…ç†å’Œå…³é—­æ“ä½œã€‚</p></li></ol><h3 id="å¦‚ä½•ä½¿ç”¨-process-ppid" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-process-ppid"><span>å¦‚ä½•ä½¿ç”¨ <code>process.ppid</code>ï¼Ÿ</span></a></h3><p>ä½¿ç”¨<code>process.ppid</code>éå¸¸ç›´æ¥ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ Node.js è„šæœ¬ç¤ºä¾‹ï¼Œå®ƒä¼šæ‰“å°å‡ºå½“å‰è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ IDï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`The parent process ID (PPID) is: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ppid</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿è¡Œè¿™æ®µä»£ç ï¼Œä½ å°†çœ‹åˆ°ç±»ä¼¼äº&quot;The parent process ID (PPID) is: 1234&quot;çš„è¾“å‡ºï¼Œå…¶ä¸­&quot;1234&quot;ä»£è¡¨äº†å¯åŠ¨è¯¥ Node.js è¿›ç¨‹çš„çˆ¶è¿›ç¨‹çš„ IDã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œ<code>process.ppid</code>åœ¨ Node.js ä¸­æä¾›äº†ä¸€ç§è·å–å½“å‰è¿›ç¨‹çˆ¶è¿›ç¨‹ ID çš„ç®€ä¾¿æ–¹æ³•ï¼Œå®ƒåœ¨ç›‘æ§ã€æ—¥å¿—è®°å½•ã€ç³»ç»Ÿå®‰å…¨å’Œä¼˜é›…å…³é—­ç­‰æ–¹é¢æœ‰ç€å¹¿æ³›çš„åº”ç”¨ã€‚</p><h2 id="process-release" tabindex="-1"><a class="header-anchor" href="#process-release"><span><a href="https://nodejs.org/docs/latest/api/process.html#processrelease" target="_blank" rel="noopener noreferrer">process.release</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScriptã€‚<code>process.release</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ <code>process</code> çš„å±æ€§ï¼Œå®ƒæä¾›äº†æœ‰å…³å½“å‰ Node.js å‘è¡Œç‰ˆçš„ä¿¡æ¯ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>process.release</code> åŒ…å«ä»¥ä¸‹ä¸»è¦ä¿¡æ¯ï¼š</p><ul><li><code>name</code>: è¿™é€šå¸¸æ˜¯ <code>&quot;node&quot;</code>ï¼Œè¡¨ç¤ºè¿™æ˜¯ Node.js çš„å‘è¡Œç‰ˆã€‚</li><li><code>sourceUrl</code>: æä¾›äº†ä¸‹è½½æ­¤ Node.js ç‰ˆæœ¬æºä»£ç çš„ URLã€‚</li><li><code>headersUrl</code>: å¦‚æœä½ éœ€è¦ç¼–è¯‘åŸç”Ÿæ’ä»¶ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ C++ ç¼–å†™çš„æ¨¡å—ï¼‰ï¼Œè¿™ä¸ª URL æä¾›äº†ç›¸åº”ç‰ˆæœ¬çš„å¤´æ–‡ä»¶ã€‚</li><li><code>libUrl</code>: åœ¨æŸäº›å¹³å°ä¸Šï¼Œæä¾›äº†é“¾æ¥åˆ° Node.js åº“çš„ URLï¼Œè¿™å¯¹äºç¼–è¯‘ä¸€äº›ç‰¹å®šç±»å‹çš„é¡¹ç›®å¯èƒ½å¾ˆé‡è¦ã€‚</li><li><code>lts</code>: å¦‚æœå½“å‰ç‰ˆæœ¬æ˜¯é•¿æœŸæ”¯æŒï¼ˆLong Term Supportï¼Œç®€ç§° LTSï¼‰ç‰ˆæœ¬ï¼Œè¿™é‡Œä¼šæ ‡æ³¨ LTS çš„åç§°ã€‚å¦‚æœä¸æ˜¯ LTS ç‰ˆæœ¬ï¼Œåˆ™å¯èƒ½æ˜¯ <code>false</code> æˆ– <code>undefined</code>ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-11" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-11"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><h4 id="_1-æ£€æµ‹å¹¶æŠ¥å‘Š-node-js-ç‰ˆæœ¬ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_1-æ£€æµ‹å¹¶æŠ¥å‘Š-node-js-ç‰ˆæœ¬ä¿¡æ¯"><span>1. æ£€æµ‹å¹¶æŠ¥å‘Š Node.js ç‰ˆæœ¬ä¿¡æ¯</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨æˆ–è€…å·¥å…·ï¼Œè¯¥å·¥å…·éœ€è¦æ ¹æ® Node.js çš„ä¸åŒç‰ˆæœ¬æ¥è°ƒæ•´å…¶åŠŸèƒ½æˆ–æ€§èƒ½ä¼˜åŒ–ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>process.release</code> æ¥æ£€æµ‹ Node.js çš„ç‰ˆæœ¬å’Œå…¶ä»–é‡è¦ä¿¡æ¯ï¼Œä»¥å¸®åŠ©å†³å®šä½¿ç”¨å“ªäº›ç‰¹å®šçš„ API æˆ–åŠŸèƒ½ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`è¿è¡Œçš„ Node.js ç‰ˆæœ¬æ˜¯: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Node.js å‘å¸ƒåç§°: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">release</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æºä»£ç ä¸‹è½½åœ°å€: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">release</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">sourceUrl</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-æ„å»ºè‡ªåŠ¨åŒ–è„šæœ¬" tabindex="-1"><a class="header-anchor" href="#_2-æ„å»ºè‡ªåŠ¨åŒ–è„šæœ¬"><span>2. æ„å»ºè‡ªåŠ¨åŒ–è„šæœ¬</span></a></h4><p>åœ¨æ„å»ºè‡ªåŠ¨åŒ–è„šæœ¬æ—¶ï¼Œå°¤å…¶æ˜¯æ¶‰åŠåˆ°è·¨å¹³å°ç¼–è¯‘åŸç”Ÿæ¨¡å—çš„åœºæ™¯ï¼Œå¯ä»¥åˆ©ç”¨ <code>process.release.headersUrl</code> å’Œ <code>process.release.libUrl</code> è‡ªåŠ¨è·å–ç›¸åº”çš„å¤´æ–‡ä»¶å’Œåº“æ–‡ä»¶ï¼Œä»è€Œç®€åŒ–æ„å»ºè¿‡ç¨‹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">exec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child_process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æˆ‘ä»¬éœ€è¦ä¸ºä¸€ä¸ªåŸç”Ÿæ¨¡å—ä¸‹è½½å¤´æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`curl -O </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">release</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">headersUrl</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">stdout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">stderr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ— æ³•ä¸‹è½½å¤´æ–‡ä»¶: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å¤´æ–‡ä»¶ä¸‹è½½æˆåŠŸ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-å¼€å‘å…¼å®¹æ€§æ£€æŸ¥å·¥å…·" tabindex="-1"><a class="header-anchor" href="#_3-å¼€å‘å…¼å®¹æ€§æ£€æŸ¥å·¥å…·"><span>3. å¼€å‘å…¼å®¹æ€§æ£€æŸ¥å·¥å…·</span></a></h4><p>å½“ä½ çš„åº”ç”¨éœ€è¦è¿è¡Œåœ¨å¤šä¸ª Node.js ç‰ˆæœ¬ä¸Šæ—¶ï¼Œåˆ©ç”¨ <code>process.release.lts</code> å¯ä»¥å¸®åŠ©ä½ è¯†åˆ«å‡ºå½“å‰è¿è¡Œçš„ç‰ˆæœ¬æ˜¯å¦ä¸ºé•¿æœŸæ”¯æŒç‰ˆæœ¬ï¼Œä»è€Œå¯¹ä¸åŒçš„è¿è¡Œç¯å¢ƒé‡‡å–ä¸åŒçš„ç­–ç•¥ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">release</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">lts</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    `å½“å‰ Node.js ç‰ˆæœ¬ (</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">) æ˜¯ä¸€ä¸ªé•¿æœŸæ”¯æŒç‰ˆæœ¬: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">release</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">lts</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å½“å‰ Node.js ç‰ˆæœ¬ (</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">) ä¸æ˜¯é•¿æœŸæ”¯æŒç‰ˆæœ¬`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä»¥ä¸Šç¤ºä¾‹ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>process.release</code> å¦‚ä½•åœ¨å®é™…åº”ç”¨ç¨‹åºä¸­æä¾›å…³äº Node.js å‘è¡Œç‰ˆçš„é‡è¦ä¿¡æ¯ï¼Œè¿™å¯¹äºç¡®ä¿å…¼å®¹æ€§ã€ä¼˜åŒ–æ€§èƒ½å’Œç®€åŒ–å¼€å‘æµç¨‹éƒ½éå¸¸æœ‰å¸®åŠ©ã€‚</p><h2 id="process-report" tabindex="-1"><a class="header-anchor" href="#process-report"><span><a href="https://nodejs.org/docs/latest/api/process.html#processreport" target="_blank" rel="noopener noreferrer">process.report</a></span></a></h2><p>Node.js çš„ <code>process.report</code> æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„è¯Šæ–­å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ äº†è§£åº”ç”¨ç¨‹åºçš„è¿è¡ŒçŠ¶æ€æˆ–æ˜¯åœ¨å‡ºç°é—®é¢˜æ—¶è¿›è¡Œè°ƒè¯•ã€‚ä» Node.js v21.7.1 çš„æ–‡æ¡£ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>process.report</code> æä¾›äº†å¤šç§æ–¹æ³•å’Œå±æ€§ï¼Œæ¥ç”Ÿæˆå…³äºå½“å‰ Node.js è¿›ç¨‹çŠ¶æ€çš„æŠ¥å‘Šã€‚è¿™äº›æŠ¥å‘Šä»¥ JSON æ ¼å¼æä¾›è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚é”™è¯¯å †æ ˆã€JavaScript å †ä¿¡æ¯ã€ç³»ç»Ÿä¿¡æ¯ç­‰ï¼Œæœ‰åŠ©äºå¼€å‘è€…å¿«é€Ÿå®šä½é—®é¢˜ã€‚</p><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›ä¾‹å­æ¥å…·ä½“ç†è§£ <code>process.report</code> çš„ä½¿ç”¨ï¼š</p><h3 id="_1-ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š" tabindex="-1"><a class="header-anchor" href="#_1-ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š"><span>1. ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š</span></a></h3><p>å‡è®¾ä½ çš„ Node.js åº”ç”¨çªç„¶å´©æºƒæˆ–å‡ºç°æ€§èƒ½é—®é¢˜ï¼Œä½ æƒ³è¦å¿«é€Ÿåœ°æ”¶é›†ç¯å¢ƒå’ŒçŠ¶æ€ä¿¡æ¯æ¥åˆ†æåŸå› ã€‚ä½ å¯ä»¥åœ¨ä»£ç ä¸­è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeReport</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;report.json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç æ£€æŸ¥ <code>process.report</code> æ˜¯å¦å¯ç”¨ï¼ˆç¡®ä¿å…¼å®¹è¾ƒæ—§ç‰ˆæœ¬çš„ Node.jsï¼‰ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªåä¸º <code>report.json</code> çš„è¯Šæ–­æŠ¥å‘Šæ–‡ä»¶ã€‚æ­¤æ–‡ä»¶åŒ…å«äº†æ‰§è¡Œä¸Šä¸‹æ–‡ã€èµ„æºå ç”¨ã€æ´»åŠ¨è¯·æ±‚ç­‰ä¿¡æ¯ã€‚</p><h3 id="_2-åœ¨å¼‚å¸¸é€€å‡ºæ—¶è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Š" tabindex="-1"><a class="header-anchor" href="#_2-åœ¨å¼‚å¸¸é€€å‡ºæ—¶è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Š"><span>2. åœ¨å¼‚å¸¸é€€å‡ºæ—¶è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Š</span></a></h3><p>ä½ å¯èƒ½æƒ³è¦åœ¨åº”ç”¨å¼‚å¸¸é€€å‡ºæ—¶ï¼ˆå¦‚æœªæ•è·çš„å¼‚å¸¸æˆ–è‡´å‘½é”™è¯¯ï¼‰è‡ªåŠ¨ç”Ÿæˆè¯Šæ–­æŠ¥å‘Šï¼Œä»¥ä¾¿äº‹ååˆ†æã€‚å¯ä»¥è¿™æ ·é…ç½®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®åœ¨åº”ç”¨å¼‚å¸¸é€€å‡ºæ—¶è‡ªåŠ¨ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">directory</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;./reports&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŒ‡å®šæŠ¥å‘Šç”Ÿæˆç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">filename</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;crash_report.json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æŠ¥å‘Šæ–‡ä»¶å</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">onUncaughtException</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¼€å¯æœªæ•è·å¼‚å¸¸æ—¶ç”ŸæˆæŠ¥å‘Š</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œæ¯å½“åº”ç”¨å› æœªæ•è·å¼‚å¸¸è€Œå´©æºƒæ—¶ï¼Œä¼šåœ¨ <code>./reports</code> ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªåä¸º <code>crash_report.json</code> çš„æŠ¥å‘Šæ–‡ä»¶ã€‚</p><h3 id="_3-è§¦å‘æ¡ä»¶ä¸‹ç”ŸæˆæŠ¥å‘Š" tabindex="-1"><a class="header-anchor" href="#_3-è§¦å‘æ¡ä»¶ä¸‹ç”ŸæˆæŠ¥å‘Š"><span>3. è§¦å‘æ¡ä»¶ä¸‹ç”ŸæˆæŠ¥å‘Š</span></a></h3><p>é™¤äº†ä»¥ä¸Šè¢«åŠ¨æ¥å—æŠ¥å‘Šçš„æ–¹å¼ï¼Œä½ è¿˜å¯ä»¥æ ¹æ®ç‰¹å®šæ¡ä»¶ä¸»åŠ¨ç”ŸæˆæŠ¥å‘Šã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ ç›‘æµ‹åˆ°æŸä¸ªæ“ä½œè¶…æ—¶æˆ–å“åº”æ—¶é—´è¿‡é•¿ï¼Œå¯ä»¥è¿™æ ·æ“ä½œï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> onOperationTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾è¿™æ˜¯å› ä¸ºæ“ä½œè¶…æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç”ŸæˆæŠ¥å‘Š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeReport</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`timeout_</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">Date</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">now</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.json`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸€ä¸ªæ“ä½œè¶…æ—¶çš„åœºæ™¯</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">onOperationTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾5ç§’ä¸ºè¶…æ—¶é˜ˆå€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªä¾‹å­åœ¨æ¨¡æ‹Ÿçš„æ“ä½œè¶…æ—¶åä¸»åŠ¨ç”Ÿæˆäº†ä¸€ä¸ªä»¥å½“å‰æ—¶é—´æˆ³å‘½åçš„æŠ¥å‘Šï¼Œæœ‰åŠ©äºåˆ†æè¶…æ—¶æ—¶åˆ»çš„ç³»ç»ŸçŠ¶æ€ã€‚</p><h3 id="æ€»ç»“-21" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-21"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ä¸Šè¿°ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œ<code>process.report</code> æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å·¥å…·ï¼Œå°¤å…¶æ˜¯åœ¨å¼€å‘å¤§å‹åº”ç”¨æˆ–éœ€è¦æ·±å…¥äº†è§£åº”ç”¨è¿è¡ŒçŠ¶æ€æ—¶ã€‚å®ƒæä¾›çš„è¯¦ç»†æŠ¥å‘Šå¯ä»¥å¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®šä½é—®é¢˜æ ¹æºï¼ŒåŠ é€Ÿå¼€å‘è°ƒè¯•è¿‡ç¨‹ã€‚ä¸è¿‡ï¼Œè¦æ³¨æ„åˆç†ä½¿ç”¨è¯¥åŠŸèƒ½ï¼Œé¿å…ç”Ÿæˆè¿‡å¤šæŠ¥å‘Šæ¶ˆè€—å­˜å‚¨èµ„æºã€‚</p><h3 id="process-report-compact" tabindex="-1"><a class="header-anchor" href="#process-report-compact"><span><a href="https://nodejs.org/docs/latest/api/process.html#processreportcompact" target="_blank" rel="noopener noreferrer">process.report.compact</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process.report.compact</code>æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå½“è®¾ç½®ä¸º<code>true</code>æ—¶ï¼Œå®ƒè®© Node.js ç”Ÿæˆçš„è¯Šæ–­æŠ¥å‘Šï¼ˆdiagnostic reportsï¼‰ä»¥ä¸€ç§æ›´ç´§å‡‘çš„ JSON æ ¼å¼è¾“å‡ºã€‚è¿™ç§æ ¼å¼ä¸»è¦ç”¨äºèŠ‚çœç©ºé—´ï¼Œå¹¶ä½¿å¾—æŠ¥å‘Šæ›´å®¹æ˜“è¢«æœºå™¨è§£æï¼Œå°½ç®¡è¿™å¯èƒ½ä¼šç‰ºç‰²ä¸€äº›äººç±»çš„å¯è¯»æ€§ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯è¯Šæ–­æŠ¥å‘Š" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯è¯Šæ–­æŠ¥å‘Š"><span>ä»€ä¹ˆæ˜¯è¯Šæ–­æŠ¥å‘Šï¼Ÿ</span></a></h3><p>è¯Šæ–­æŠ¥å‘Šæ˜¯ä¸€ä»½åŒ…å«äº† Node.js è¿›ç¨‹çš„çŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯çš„è¯¦ç»†æ–‡æ¡£ã€‚å®ƒé€šå¸¸åœ¨è°ƒè¯•å’Œè¯Šæ–­åº”ç”¨ç¨‹åºé—®é¢˜æ—¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚å†…å­˜æ³„æ¼ã€é«˜ CPU ä½¿ç”¨ç‡ã€æ„å¤–çš„é”™è¯¯ç­‰ã€‚æŠ¥å‘ŠåŒ…æ‹¬ä½†ä¸é™äºè°ƒç”¨æ ˆã€å †ä¿¡æ¯ã€ç³»ç»Ÿä¿¡æ¯å’Œèµ„æºä½¿ç”¨è¯¦æƒ…ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨process-report-compact" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨process-report-compact"><span>å¦‚ä½•ä½¿ç”¨<code>process.report.compact</code></span></a></h3><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¯Šæ–­æŠ¥å‘Šæ˜¯ä»¥è¾ƒä¸ºâ€œç¾è§‚â€çš„ JSON æ ¼å¼è¾“å‡ºçš„ï¼Œè¿™å¯¹äºå¼€å‘è€…ç›´æ¥é˜…è¯»æ¥è¯´ç›¸å¯¹å‹å¥½ä¸€äº›ã€‚å¦‚æœæƒ³è¦åˆ‡æ¢åˆ°æ›´ç´§å‡‘çš„æ ¼å¼ï¼Œä½ å¯ä»¥é€šè¿‡ç¼–ç¨‹æ–¹å¼è®¾ç½®<code>process.report.compact = true;</code>æˆ–è€…åœ¨å¯åŠ¨ Node.js åº”ç”¨ç¨‹åºæ—¶é€šè¿‡å‘½ä»¤è¡Œå‚æ•°<code>--report-compact</code>æ¥å®ç°ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-10" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-10"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-é€šè¿‡ä»£ç è®¾ç½®ç´§å‡‘æ ¼å¼" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-é€šè¿‡ä»£ç è®¾ç½®ç´§å‡‘æ ¼å¼"><span>ç¤ºä¾‹ 1ï¼šé€šè¿‡ä»£ç è®¾ç½®ç´§å‡‘æ ¼å¼</span></a></h4><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œçªç„¶é‡åˆ°äº†ä¸€ä¸ªéš¾ä»¥æ•æ‰çš„é”™è¯¯ï¼Œæˆ‘ä»¬å¸Œæœ›ç”Ÿæˆä¸€ä¸ªè¯Šæ–­æŠ¥å‘Šæ¥å¸®åŠ©åˆ†æé—®é¢˜ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®è¯Šæ–­æŠ¥å‘Šçš„ç´§å‡‘è¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">compact</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è§¦å‘ä¸€ä¸ªè¯Šæ–­æŠ¥å‘Š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeReport</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./path/to/my-diagnostic-report.json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡<code>process.report.compact = true;</code>è®¾ç½®æŠ¥å‘Šè¾“å‡ºä¸ºç´§å‡‘æ ¼å¼ï¼Œç„¶åè°ƒç”¨<code>process.report.writeReport()</code>å‡½æ•°ç”Ÿæˆè¯Šæ–­æŠ¥å‘Šã€‚æŠ¥å‘Šå°†ä»¥ç´§å‡‘çš„ JSON æ ¼å¼ä¿å­˜åœ¨æŒ‡å®šçš„è·¯å¾„ã€‚</p><h4 id="ç¤ºä¾‹-2-ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°å¯åŠ¨åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°å¯åŠ¨åº”ç”¨"><span>ç¤ºä¾‹ 2ï¼šä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°å¯åŠ¨åº”ç”¨</span></a></h4><p>å¦‚æœä½ æ›´å€¾å‘äºåœ¨å¯åŠ¨åº”ç”¨æ—¶å°±æŒ‡å®šç´§å‡‘æ ¼å¼çš„æŠ¥å‘Šï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­æ·»åŠ <code>--report-compact</code>å‚æ•°ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">node</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --report-compact</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> myapp.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œå¦‚æœåœ¨åº”ç”¨è¿è¡ŒæœŸé—´éœ€è¦ç”Ÿæˆè¯Šæ–­æŠ¥å‘Šï¼ˆæ— è®ºæ˜¯è‡ªåŠ¨çš„è¿˜æ˜¯æ‰‹åŠ¨è§¦å‘çš„ï¼‰ï¼Œå®ƒä»¬éƒ½å°†ä¼šä»¥ç´§å‡‘çš„æ ¼å¼è¾“å‡ºã€‚</p><h3 id="ä¸ºä½•é€‰æ‹©ç´§å‡‘æ ¼å¼" tabindex="-1"><a class="header-anchor" href="#ä¸ºä½•é€‰æ‹©ç´§å‡‘æ ¼å¼"><span>ä¸ºä½•é€‰æ‹©ç´§å‡‘æ ¼å¼</span></a></h3><p>é€‰æ‹©<code>process.report.compact</code>çš„ä¸»è¦ç†ç”±æ˜¯å½“ä½ éœ€è¦å¤„ç†å¤§é‡çš„è¯Šæ–­æŠ¥å‘Šæˆ–è€…å°†æŠ¥å‘Šæ•°æ®å‘é€åˆ°æ—¥å¿—æ”¶é›†æœåŠ¡æ—¶ï¼Œç´§å‡‘æ ¼å¼å¯ä»¥æ˜¾è‘—å‡å°‘æ‰€éœ€çš„å­˜å‚¨ç©ºé—´å’Œä¼ è¾“æ—¶é—´ã€‚æ­¤å¤–ï¼Œå¯¹äºè‡ªåŠ¨åŒ–å·¥å…·æ¥è¯´ï¼Œè§£æç´§å‡‘æ ¼å¼çš„ JSON æ•°æ®ä¹Ÿè®¸ä¼šæ›´åŠ é«˜æ•ˆã€‚ç„¶è€Œï¼Œè¿™æ˜¯åœ¨ç‰ºç‰²äº†ä¸€éƒ¨åˆ†å¯è¯»æ€§çš„åŸºç¡€ä¸Šå®ç°çš„ï¼Œå› æ­¤åœ¨è°ƒè¯•æ—¶å¯èƒ½éœ€è¦é¢å¤–çš„æ­¥éª¤æ¥æ ¼å¼åŒ–è¿™äº›æŠ¥å‘Šã€‚</p><h3 id="process-report-directory" tabindex="-1"><a class="header-anchor" href="#process-report-directory"><span><a href="https://nodejs.org/docs/latest/api/process.html#processreportdirectory" target="_blank" rel="noopener noreferrer">process.report.directory</a></span></a></h3><p>å¥½çš„ï¼Œæˆ‘å°†å°½åŠ›ä»¥é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è§£é‡Šç»™ä½ ã€‚</p><p>Node.js ä¸­çš„<code>process.report.directory</code>æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒç”¨æ¥è®¾ç½®æˆ–è·å– Node.js è¿›ç¨‹æŠ¥å‘Šæ–‡ä»¶çš„é»˜è®¤ç›®å½•ã€‚è¿™é‡Œæ‰€è¯´çš„â€œæŠ¥å‘Šæ–‡ä»¶â€ä¸»è¦æŒ‡çš„æ˜¯å½“ Node.js è¿›ç¨‹é‡åˆ°ä¸€äº›é—®é¢˜ï¼ˆæ¯”å¦‚é”™è¯¯ã€å¼‚å¸¸ç­‰ï¼‰æ—¶è‡ªåŠ¨ç”Ÿæˆçš„ä¸€ç§è¯Šæ–­æŠ¥å‘Šï¼Œè¿™ä¸ªæŠ¥å‘Šå¯¹äºç†è§£å’Œè§£å†³é—®é¢˜éå¸¸æœ‰å¸®åŠ©ã€‚</p><h3 id="ç†è§£process-report-directory" tabindex="-1"><a class="header-anchor" href="#ç†è§£process-report-directory"><span>ç†è§£<code>process.report.directory</code></span></a></h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“<code>process</code>æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œä»£è¡¨å½“å‰çš„ Node.js è¿›ç¨‹ï¼Œé€šè¿‡å®ƒå¯ä»¥è®¿é—®åˆ°å¾ˆå¤šä¸å½“å‰è¿è¡Œçš„è¿›ç¨‹ç›¸å…³çš„ä¿¡æ¯å’ŒåŠŸèƒ½ã€‚è€Œ<code>process.report</code>åˆ™æ˜¯ Node.js çš„è¯Šæ–­æŠ¥å‘ŠåŠŸèƒ½çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œå®ƒå…è®¸ä½ é…ç½®ç”Ÿæˆè¯Šæ–­æŠ¥å‘Šçš„è¡Œä¸ºã€‚</p><p>åœ¨è¿™ä¹‹ä¸­ï¼Œ<code>process.report.directory</code>å…è®¸ä½ è®¾ç½®æˆ–æŸ¥è¯¢å­˜å‚¨è¿™äº›è¯Šæ–­æŠ¥å‘Šçš„æ–‡ä»¶å¤¹ä½ç½®ã€‚å¦‚æœä½ æ²¡æœ‰æ˜ç¡®è®¾ç½®è¿™ä¸ªå±æ€§ï¼Œé‚£ä¹ˆ Node.js ä¼šä½¿ç”¨é»˜è®¤çš„ä½ç½®æ¥å­˜å‚¨è¿™äº›æŠ¥å‘Šæ–‡ä»¶ï¼Œé€šå¸¸æ˜¯è¿›ç¨‹å½“å‰çš„å·¥ä½œç›®å½•ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-4" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-4"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>å‡è®¾æˆ‘ä»¬æƒ³è¦æŠŠæ‰€æœ‰çš„è¯Šæ–­æŠ¥å‘Šéƒ½å­˜åˆ°ä¸€ä¸ªåä¸º&quot;reports&quot;çš„ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®æŠ¥å‘Šç›®å½•ä¸º&quot;./reports&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">directory</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;./reports&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">directory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå®é™…è®¾ç½®çš„æŠ¥å‘Šç›®å½•ï¼Œä¾‹å¦‚&quot;/Users/yourname/projects/myapp/reports&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œæœªæ¥å½“ Node.js è¿›ç¨‹äº§ç”Ÿä»»ä½•è¯Šæ–­æŠ¥å‘Šæ—¶ï¼Œè¿™äº›æŠ¥å‘Šéƒ½ä¼šè¢«è‡ªåŠ¨ä¿å­˜åˆ°ä½ æŒ‡å®šçš„ç›®å½•ä¸­ã€‚</p><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹-5" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹-5"><span>å®é™…åº”ç”¨ç¤ºä¾‹</span></a></h3><ol><li><p><strong>ç›‘æ§æœåŠ¡å¥åº·</strong>ï¼šæ¯”å¦‚ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œä½ å¯ä»¥é…ç½®<code>process.report.directory</code>æ¥ç¡®ä¿æ‰€æœ‰è‡ªåŠ¨ç”Ÿæˆçš„è¯Šæ–­æŠ¥å‘Šéƒ½è¢«é›†ä¸­ç®¡ç†ï¼Œæ–¹ä¾¿åç»­åˆ†æå’Œé—®é¢˜å®šä½ã€‚</p></li><li><p><strong>é”™è¯¯è·Ÿè¸ª</strong>ï¼šåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°ä¸€äº›æ£˜æ‰‹çš„é”™è¯¯ã€‚é€šè¿‡è®¾ç½®è¯Šæ–­æŠ¥å‘Šçš„è¾“å‡ºç›®å½•ï¼Œå¹¶åœ¨å‡ºé”™æ—¶è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Šï¼Œå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿäº†è§£é—®é¢˜çš„ä¸Šä¸‹æ–‡ï¼ŒåŠ å¿«è°ƒè¯•é€Ÿåº¦ã€‚</p></li><li><p><strong>æ€§èƒ½åˆ†æ</strong>ï¼šNode.js çš„è¯Šæ–­æŠ¥å‘Šä¸ä»…åŒ…å«é”™è¯¯ä¿¡æ¯ï¼Œè¿˜å¯èƒ½åŒ…å«æ€§èƒ½æ•°æ®ã€‚å°†è¿™äº›æŠ¥å‘Šè¾“å‡ºåˆ°ç‰¹å®šç›®å½•ï¼Œå¯ä»¥å¸®åŠ©ä½ å»ºç«‹èµ·ä¸€ä¸ªæ€§èƒ½æ•°æ®çš„å½’æ¡£ï¼Œæ–¹ä¾¿è¿›è¡Œé•¿æœŸçš„æ€§èƒ½åˆ†æå’Œä¼˜åŒ–ã€‚</p></li></ol><p>æ€»çš„æ¥è¯´ï¼Œé€šè¿‡åˆç†åˆ©ç”¨<code>process.report.directory</code>ï¼Œä½ å¯ä»¥æ›´æœ‰æ•ˆåœ°ç®¡ç†å’Œä½¿ç”¨ Node.js çš„è¯Šæ–­æŠ¥å‘ŠåŠŸèƒ½ï¼Œè¿™å¯¹äºæé«˜åº”ç”¨çš„ç¨³å®šæ€§å’Œæ€§èƒ½éƒ½éå¸¸æœ‰ç›Šã€‚</p><h3 id="process-report-filename" tabindex="-1"><a class="header-anchor" href="#process-report-filename"><span><a href="https://nodejs.org/docs/latest/api/process.html#processreportfilename" target="_blank" rel="noopener noreferrer">process.report.filename</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒï¼Œå®ƒå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚åœ¨è¿™ä¸ªç¯å¢ƒä¸­ï¼Œ<code>process</code>å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚è€Œ<code>process.report</code>æ˜¯ä¸€ä¸ªè¾ƒæ–°åŠ å…¥çš„ç‰¹æ€§ï¼Œå®ƒå…è®¸ç”Ÿæˆè¯Šæ–­æŠ¥å‘Šæ¥å¸®åŠ©å¼€å‘äººå‘˜ç†è§£åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼Œç‰¹åˆ«æ˜¯åœ¨é—®é¢˜æ’æŸ¥å’Œæ€§èƒ½åˆ†ææ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="process-report-filename-1" tabindex="-1"><a class="header-anchor" href="#process-report-filename-1"><span><code>process.report.filename</code></span></a></h3><p><code>process.report.filename</code>å±æ€§å…è®¸ä½ è·å–æˆ–è®¾ç½®å°†è¦å†™å…¥è¯Šæ–­æŠ¥å‘Šçš„æ–‡ä»¶çš„ä½ç½®å’Œåç§°ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®è¿™ä¸ªå±æ€§ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒæŠ¥å‘Šä¼šè¢«å†™å…¥åˆ°å½“å‰å·¥ä½œç›®å½•ä¸­ï¼Œæ–‡ä»¶ååŒ…å«äº†æŠ¥å‘Šçš„æ—¥æœŸã€æ—¶é—´ã€PIDï¼ˆProcess IDï¼Œè¿›ç¨‹ IDï¼‰å’Œç±»å‹ã€‚è¿™ä¸ªæ–‡ä»¶åéµå¾ªä¸€å®šçš„æ ¼å¼ï¼Œä¾‹å¦‚ï¼š<code>report.20230515.123456.1234.0.json</code>ï¼Œè¿™å¯¹äºç»„ç»‡å’Œæ£€ç´¢æŠ¥å‘Šéå¸¸æœ‰å¸®åŠ©ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-5" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-5"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”é‡åˆ°äº†ä¸€äº›æ€§èƒ½é—®é¢˜æˆ–å¼‚å¸¸é”™è¯¯ï¼Œä½ æƒ³ç”Ÿæˆä¸€ä¸ªè¯Šæ–­æŠ¥å‘Šæ¥æ·±å…¥åˆ†æé—®é¢˜ã€‚</p><p>é¦–å…ˆï¼Œç¡®ä¿ä½ çš„ Node.js ç‰ˆæœ¬æ”¯æŒ<code>process.report</code>åŠŸèƒ½ã€‚æ¥ç€ï¼Œå¯ä»¥é€šè¿‡ç¼–ç æ–¹å¼è®¾ç½®è¯Šæ–­æŠ¥å‘Šçš„è¾“å‡ºæ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®è¯Šæ–­æŠ¥å‘Šçš„è¾“å‡ºæ–‡ä»¶å</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">filename</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;path/to/your/diagnostic-report.json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä¸è®¾ç½®<code>process.report.filename</code>ï¼Œä½¿ç”¨é»˜è®¤çš„æ–‡ä»¶åå’Œè·¯å¾„ã€‚ä½†æ˜¯åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸ºäº†æ›´å¥½åœ°ç®¡ç†è¿™äº›æŠ¥å‘Šæ–‡ä»¶ï¼Œé€šå¸¸æ¨èæ˜¾å¼æŒ‡å®šæ–‡ä»¶åå’Œä¿å­˜è·¯å¾„ã€‚</p><p>å½“éœ€è¦ç”ŸæˆæŠ¥å‘Šæ—¶ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è§¦å‘ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰‹åŠ¨è§¦å‘ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeReport</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç æ‰§è¡Œåï¼Œå°±ä¼šåœ¨æŒ‡å®šçš„è·¯å¾„ï¼ˆæˆ–é»˜è®¤è·¯å¾„ï¼‰ç”Ÿæˆä¸€ä¸ªåŒ…å«äº†å½“å‰è¿›ç¨‹çŠ¶æ€çš„è¯Šæ–­æŠ¥å‘Šæ–‡ä»¶ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-12" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-12"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šåœ¨ä¸€ä¸ªé«˜å¹¶å‘çš„ Web æœåŠ¡ä¸­ï¼Œçªç„¶å“åº”æ—¶é—´å¢é•¿ï¼Œé€šè¿‡æ‰‹åŠ¨æˆ–è‡ªåŠ¨è§¦å‘è¯Šæ–­æŠ¥å‘Šç”Ÿæˆï¼Œåˆ†ææŠ¥å‘Šä¸­çš„ CPU ä½¿ç”¨ç‡å’Œå†…å­˜çŠ¶æ€ï¼Œæ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆã€‚</p></li><li><p><strong>é”™è¯¯è¿½è¸ª</strong>ï¼šåœ¨ç”¨æˆ·æŠ¥å‘ŠæŸä¸ªç‰¹å®šæ“ä½œæ—¶åº”ç”¨å´©æºƒï¼Œå¯ä»¥åœ¨å¼‚å¸¸å¤„ç†é€»è¾‘ä¸­æ·»åŠ è¯Šæ–­æŠ¥å‘Šçš„ç”Ÿæˆï¼Œä»è€Œæ”¶é›†å¼‚å¸¸å‘ç”Ÿæ—¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¸®åŠ©å¿«é€Ÿå®šä½é—®é¢˜ã€‚</p></li><li><p><strong>å®šæœŸå¥åº·æ£€æŸ¥</strong>ï¼šä¸ºäº†ç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œï¼Œå¯ä»¥å®šæœŸï¼ˆå¦‚æ¯å¤©å‡Œæ™¨ï¼‰ç”Ÿæˆè¯Šæ–­æŠ¥å‘Šï¼Œåˆ†æç³»ç»Ÿçš„æ•´ä½“å¥åº·çŠ¶å†µï¼ŒåŠæ—¶å‘ç°å¯èƒ½çš„æ½œåœ¨é—®é¢˜ã€‚</p></li></ol><p>é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>process.report.filename</code>ä»¥åŠè¯Šæ–­æŠ¥å‘ŠåŠŸèƒ½ä¸º Node.js åº”ç”¨ç¨‹åºçš„æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–æä¾›äº†ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚</p><h3 id="process-report-getreport-err" tabindex="-1"><a class="header-anchor" href="#process-report-getreport-err"><span><a href="https://nodejs.org/docs/latest/api/process.html#processreportgetreporterr" target="_blank" rel="noopener noreferrer">process.report.getReport([err])</a></span></a></h3><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„ <code>process.report.getReport([err])</code> æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šåœ¨è®¨è®º Node.js çš„ä¸€ä¸ªéå¸¸å¼ºå¤§çš„è¯Šæ–­åŠŸèƒ½ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ ç”Ÿæˆä¸€ä¸ªå…³äºå½“å‰ Node.js è¿›ç¨‹çŠ¶æ€çš„æŠ¥å‘Šï¼Œè¿™å¯¹äºç†è§£åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€æŸ¥æ‰¾é—®é¢˜æˆ–è€…ç›‘æ§ç³»ç»Ÿè¡Œä¸ºéå¸¸æœ‰å¸®åŠ©ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-process-report-getreport-err" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-process-report-getreport-err"><span>ä»€ä¹ˆæ˜¯ <code>process.report.getReport([err])</code>ï¼Ÿ</span></a></h3><p><code>process.report.getReport([err])</code> æ˜¯ Node.js ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥è¢«è°ƒç”¨æ¥ç”Ÿæˆä¸€ä¸ªåŒ…å«äº† Node.js è¿›ç¨‹çš„è¯¦ç»†çŠ¶æ€ä¿¡æ¯çš„æŠ¥å‘Šã€‚è¿™ä¸ªæŠ¥å‘Šä»¥ JSON æ ¼å¼è¿”å›ï¼ŒåŒ…å«äº†å¾ˆå¤šæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å‘½ä»¤è¡Œå‚æ•°ã€ç¯å¢ƒå˜é‡ã€ç”¨æˆ·ä¿¡æ¯ã€ç³»ç»Ÿç‰ˆæœ¬ã€å†…å­˜ä½¿ç”¨æƒ…å†µã€æ´»åŠ¨å¥æŸ„ç­‰ç­‰ã€‚</p><p>å¦‚æœä½ æä¾›äº† <code>[err]</code> å‚æ•°ï¼ˆå³ä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼‰ï¼Œé‚£ä¹ˆæŠ¥å‘Šè¿˜ä¼šåŒ…æ‹¬è¿™ä¸ªé”™è¯¯çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¿™å¯¹äºè¯Šæ–­ç‰¹å®šçš„é”™è¯¯éå¸¸æœ‰ç”¨ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-6" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-6"><span>å¦‚ä½•ä½¿ç”¨ï¼Ÿ</span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦ç¡®ä¿ä½ çš„ Node.js ç‰ˆæœ¬æ”¯æŒ <code>process.report.getReport()</code> æ–¹æ³•ï¼Œå› ä¸ºè¿™æ˜¯ä»æŸä¸ªç‰ˆæœ¬ä¹‹åæ‰å¼•å…¥çš„æ–°ç‰¹æ€§ã€‚</p><p>å‡è®¾æˆ‘ä»¬åœ¨å¤„ç†ä¸€äº›ä»£ç ï¼Œçªç„¶é—´é‡åˆ°äº†ä¸€ä¸ªé”™è¯¯ï¼Œæˆ‘ä»¬å¸Œæœ›æ›´æ·±å…¥åœ°äº†è§£å‘ç”Ÿäº†ä»€ä¹ˆã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> problematicFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å‡ºç°äº†ä¸€ä¸ªé”™è¯¯ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  problematicFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> report</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getReport</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“ <code>problematicFunction</code> å‡½æ•°æŠ›å‡ºä¸€ä¸ªé”™è¯¯æ—¶ï¼Œæˆ‘ä»¬æ•è·äº†è¿™ä¸ªé”™è¯¯ï¼Œå¹¶å°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™ <code>process.report.getReport(err)</code>ã€‚è¿™æ ·å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªè¯¦ç»†çš„æŠ¥å‘Šï¼Œå…¶ä¸­åŒ…å«äº†é”™è¯¯çš„å…·ä½“ä¿¡æ¯ï¼Œå¸®åŠ©æˆ‘ä»¬ç†è§£ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªé”™è¯¯ã€‚</p><h3 id="å®é™…è¿ç”¨-2" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-2"><span>å®é™…è¿ç”¨</span></a></h3><ol><li><strong>è°ƒè¯•å’Œé”™è¯¯åˆ†æ</strong>ï¼šæœ€ç›´æ¥çš„ç”¨é€”å°±æ˜¯åœ¨å‘ç”Ÿé”™è¯¯æ—¶å¿«é€Ÿè·å–ç³»ç»Ÿçš„çŠ¶æ€ï¼Œä»è€Œè¿›è¡Œè°ƒè¯•å’Œé”™è¯¯åˆ†æã€‚</li><li><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šé€šè¿‡å®šæœŸç”ŸæˆæŠ¥å‘Šï¼Œå¯ä»¥ç›‘æ§åº”ç”¨ç¨‹åºéšæ—¶é—´çš„æ€§èƒ½è¡¨ç°ï¼Œæ¯”å¦‚å†…å­˜æ³„æ¼é—®é¢˜ï¼ŒCPU ä½¿ç”¨æƒ…å†µç­‰ã€‚</li><li><strong>ç³»ç»Ÿå®¡è®¡</strong>ï¼šæŠ¥å‘Šæä¾›çš„ä¿¡æ¯å¯ä»¥ç”¨äºç³»ç»Ÿå®¡è®¡ï¼Œå¸®åŠ©ç¡®è®¤ç³»ç»Ÿé…ç½®å’Œè¿è¡Œç¯å¢ƒæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</li></ol><h3 id="æ³¨æ„äº‹é¡¹-8" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-8"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>éœ€è¦æ„è¯†åˆ°ç”ŸæˆæŠ¥å‘Šå¯èƒ½ä¼šæš´éœ²æ•æ„Ÿä¿¡æ¯ï¼ˆæ¯”å¦‚ç¯å¢ƒå˜é‡ä¸­å¯èƒ½åŒ…å«çš„å¯†é’¥ï¼‰ï¼Œæ‰€ä»¥åœ¨å°†æŠ¥å‘Šå…±äº«ç»™å…¶ä»–äººä¹‹å‰ï¼Œè¯·ç¡®ä¿ç§»é™¤æˆ–éšè—æ•æ„Ÿå†…å®¹ã€‚</li><li>æŠ¥å‘Šçš„è¯¦ç»†ç¨‹åº¦å¯èƒ½ä¼šå›  Node.js çš„ä¸åŒç‰ˆæœ¬è€Œå¼‚ï¼Œè®°å¾—æ£€æŸ¥ä½ çš„ç‰ˆæœ¬æ–‡æ¡£ä»¥äº†è§£å¯ç”¨çš„ä¿¡æ¯è¯¦æƒ…ã€‚</li></ul><p>é€šè¿‡ä»¥ä¸Šçš„ä»‹ç»å’Œä¾‹å­ï¼Œå¸Œæœ›ä½ å¯¹ <code>process.report.getReport([err])</code> æœ‰äº†åŸºæœ¬çš„äº†è§£ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·æ¥å¸®åŠ©ä½ è¯Šæ–­å’Œç†è§£ Node.js åº”ç”¨ç¨‹åºçš„è¿è¡ŒçŠ¶å†µã€‚</p><h3 id="process-report-reportonfatalerror" tabindex="-1"><a class="header-anchor" href="#process-report-reportonfatalerror"><span><a href="https://nodejs.org/docs/latest/api/process.html#processreportreportonfatalerror" target="_blank" rel="noopener noreferrer">process.report.reportOnFatalError</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªè¿è¡ŒäºæœåŠ¡å™¨ç«¯çš„å¹³å°ï¼Œå®ƒè®© JavaScript å¯ä»¥è„±ç¦»æµè§ˆå™¨è¿è¡Œã€‚åœ¨è¿™ä¸ªç¯å¢ƒä¸‹ï¼Œ<code>process</code>æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†ä¸€ç³»åˆ—å±æ€§å’Œæ–¹æ³•ï¼Œç”¨äºä¸å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹äº’åŠ¨ã€‚å…¶ä¸­ä¸€ä¸ªåŠŸèƒ½æ˜¯<code>process.report</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªå®éªŒæ€§è´¨çš„ APIï¼Œç”¨äºç”Ÿæˆè¯Šæ–­æŠ¥å‘Šã€‚</p><h3 id="ä»€ä¹ˆæ˜¯process-report-reportonfatalerror" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯process-report-reportonfatalerror"><span>ä»€ä¹ˆæ˜¯<code>process.report.reportOnFatalError</code>ï¼Ÿ</span></a></h3><p><code>process.report.reportOnFatalError</code>æ˜¯<code>process.report</code>å¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒå…è®¸ä½ åœ¨é‡åˆ°è‡´å‘½é”™è¯¯æ—¶ï¼ˆæ¯”å¦‚æœªæ•è·çš„å¼‚å¸¸æˆ–è€…å†…éƒ¨çš„ Node.js é”™è¯¯ï¼‰ï¼Œè‡ªåŠ¨åœ°ç”Ÿæˆä¸€ä¸ªè¯Šæ–­æŠ¥å‘Šã€‚è¿™ä»½æŠ¥å‘Šæä¾›äº†å…³äºå½“å‰è¿›ç¨‹çŠ¶æ€çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºè°ƒç”¨æ ˆã€å¹³å°ä¿¡æ¯ã€å†…å­˜ä½¿ç”¨æƒ…å†µç­‰ï¼Œè¿™å¯¹äºè°ƒè¯•å’Œè¯Šæ–­é—®é¢˜éå¸¸æœ‰å¸®åŠ©ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªåŠŸèƒ½æ˜¯å…³é—­çš„ï¼Œå¦‚æœä½ æƒ³åœ¨é‡åˆ°è‡´å‘½é”™è¯¯æ—¶è‡ªåŠ¨ç”Ÿæˆè¯Šæ–­æŠ¥å‘Šï¼Œä½ éœ€è¦æ‰‹åŠ¨å¼€å¯å®ƒã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨process-report-reportonfatalerror" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨process-report-reportonfatalerror"><span>å¦‚ä½•ä½¿ç”¨<code>process.report.reportOnFatalError</code>ï¼Ÿ</span></a></h3><p>é¦–å…ˆï¼Œä½ éœ€è¦ç¡®ä¿ä½ çš„ Node.js ç‰ˆæœ¬æ”¯æŒ<code>process.report</code>ï¼ˆè¿™æ˜¯ä¸€ä¸ªå®éªŒç‰¹æ€§ï¼Œå› æ­¤å¯èƒ½ä¼šåœ¨å°†æ¥çš„ç‰ˆæœ¬ä¸­æœ‰æ‰€å˜åŠ¨ï¼‰ã€‚ç„¶åï¼Œä½ å¯ä»¥é€šè¿‡ç®€å•åœ°è®¾ç½®<code>process.report.reportOnFatalError = true;</code>æ¥å¼€å¯è¿™ä¸ªåŠŸèƒ½ã€‚</p><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-4"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="å¼€å¯reportonfatalerror" tabindex="-1"><a class="header-anchor" href="#å¼€å¯reportonfatalerror"><span>å¼€å¯<code>reportOnFatalError</code></span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç¡®ä¿process.reportå¯ç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">report</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">reportOnFatalError</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;boolean&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¼€å¯fatal errorè¯Šæ–­æŠ¥å‘Šç”Ÿæˆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">reportOnFatalError</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ•…æ„å¼•å‘ä¸€ä¸ªæœªæ•è·çš„å¼‚å¸¸</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Oops, something went wrong!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç æ®µé¦–å…ˆæ£€æŸ¥<code>process.report</code>æ˜¯å¦å­˜åœ¨ä»¥åŠ<code>reportOnFatalError</code>å±æ€§æ˜¯å¦å¯è¢«è®¾ç½®ä¸ºå¸ƒå°”å€¼ã€‚å¦‚æœæ¡ä»¶æ»¡è¶³ï¼Œå®ƒä¼šå¼€å¯ fatal error è‡ªåŠ¨æŠ¥å‘ŠåŠŸèƒ½ã€‚ç„¶åï¼Œç¤ºä¾‹ä»£ç é€šè¿‡æ•…æ„æŠ›å‡ºä¸€ä¸ªæœªæ•è·çš„å¼‚å¸¸æ¥æ¨¡æ‹Ÿä¸€ä¸ª fatal error åœºæ™¯ã€‚ä¸€æ—¦è¿™ä¸ªé”™è¯¯å‘ç”Ÿï¼ŒNode.js å°†ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªè¯Šæ–­æŠ¥å‘Šã€‚</p><h3 id="æ³¨æ„ç‚¹" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„ç‚¹"><span>æ³¨æ„ç‚¹</span></a></h3><ul><li>å› ä¸º<code>process.report</code>æ˜¯ä¸€ä¸ªå®éªŒæ€§ APIï¼Œæ‰€ä»¥å®ƒçš„è¡Œä¸ºå’Œå¯ç”¨æ€§å¯èƒ½ä¼šéšç€ Node.js çš„ç‰ˆæœ¬æ›´æ–°è€Œæ”¹å˜ã€‚</li><li>è‡ªåŠ¨ç”Ÿæˆçš„è¯Šæ–­æŠ¥å‘Šå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚ç¯å¢ƒå˜é‡å’Œåº”ç”¨ç¨‹åºè·¯å¾„ç­‰ï¼Œå› æ­¤åœ¨å…±äº«è¿™äº›æŠ¥å‘Šæ—¶è¦å°å¿ƒå¤„ç†è¿™äº›æ•°æ®ã€‚</li></ul><p>ç»¼ä¸Šæ‰€è¿°ï¼Œ<code>process.report.reportOnFatalError</code>æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå°¤å…¶æ˜¯åœ¨å¼€å‘é˜¶æ®µï¼Œå®ƒèƒ½å¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®šä½å’Œç†è§£å¯¼è‡´ç¨‹åºå´©æºƒçš„åŸå› ã€‚ç„¶è€Œï¼Œè€ƒè™‘åˆ°å…¶å®éªŒæ€§è´¨å’Œå¯èƒ½æ³„éœ²æ•æ„Ÿä¿¡æ¯çš„é£é™©ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯ç”¨ä¹‹å‰åº”è¯¥è°¨æ…è€ƒè™‘ã€‚</p><h3 id="process-report-reportonsignal" tabindex="-1"><a class="header-anchor" href="#process-report-reportonsignal"><span><a href="https://nodejs.org/docs/latest/api/process.html#processreportreportonsignal" target="_blank" rel="noopener noreferrer">process.report.reportOnSignal</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºæœåŠ¡å™¨å’Œå‘½ä»¤è¡Œå·¥å…·çš„ JavaScript è¿è¡Œæ—¶ç¯å¢ƒã€‚åœ¨ Node.js ä¸­ï¼Œ<code>process</code> å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯ï¼Œå¹¶å…è®¸ä½ ä¸è¯¥è¿›ç¨‹äº’åŠ¨ã€‚åœ¨ Node.js çš„ä¸åŒç‰ˆæœ¬ä¸­ï¼Œ<code>process</code> å¯¹è±¡æä¾›çš„åŠŸèƒ½ä¹Ÿåœ¨ä¸æ–­æ‰©å±•å’Œæ”¹è¿›ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>process.report.reportOnSignal</code> æ˜¯ <code>process</code> å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒå…è®¸å¼€å‘è€…è®¾ç½®ä¸€ä¸ªä¿¡å·ï¼Œå½“è¯¥ä¿¡å·ç»™è¿›ç¨‹å‘é€æ—¶ï¼ŒNode.js ä¼šè‡ªåŠ¨ç”Ÿæˆå¹¶è¾“å‡ºä¸€ä¸ªè¯Šæ–­æŠ¥å‘Šã€‚è¯Šæ–­æŠ¥å‘Šæ˜¯ä¸€ä»½åŒ…å«äº† Node.js è¿›ç¨‹å½“å‰çŠ¶æ€çš„è¯¦ç»†ä¿¡æ¯çš„æ–‡æ¡£ï¼Œä¾‹å¦‚ CPU ä½¿ç”¨æƒ…å†µã€å†…å­˜ä½¿ç”¨æƒ…å†µã€æ‰§è¡Œå †æ ˆã€æ­£åœ¨æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ç­‰ã€‚è¿™å¯¹äºè¯Šæ–­åº”ç”¨ç¨‹åºçš„æ€§èƒ½é—®é¢˜æˆ–å¼‚å¸¸éå¸¸æœ‰ç”¨ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-11" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-11"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªç¨‹åºå¶å°”ä¼šå‡ºç°æ€§èƒ½ä¸‹é™çš„é—®é¢˜ï¼Œä½†ä½ ä¸ç¡®å®šæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>process.report.reportOnSignal</code> åŠŸèƒ½æ¥å¸®åŠ©ä½ è¯Šæ–­ã€‚</p><ol><li><p><strong>å¯ç”¨è¯Šæ–­æŠ¥å‘Šç”Ÿæˆ</strong></p><p>é¦–å…ˆï¼Œåœ¨ä½ çš„åº”ç”¨ä»£ç ä¸­ï¼Œä½ éœ€è¦æŒ‡å®šå½“æ¥æ”¶åˆ°ç‰¹å®šä¿¡å·æ—¶ï¼Œç”Ÿæˆè¯Šæ–­æŠ¥å‘Šã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•åšçš„ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®å½“è¿›ç¨‹æ¥æ”¶åˆ° SIGUSR2 ä¿¡å·æ—¶ï¼Œç”Ÿæˆè¯Šæ–­æŠ¥å‘Šã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">reportOnSignal</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signal</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;SIGUSR2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è®¾ç½® <code>process.report.reportOnSignal</code> ä¸º <code>true</code> æ¥å¯ç”¨è¿™é¡¹åŠŸèƒ½ï¼Œå¹¶æŒ‡å®šå½“è¿›ç¨‹æ¥æ”¶åˆ° <code>SIGUSR2</code> ä¿¡å·æ—¶ç”ŸæˆæŠ¥å‘Šã€‚<code>SIGUSR2</code> æ˜¯ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„ä¿¡å·ï¼Œé€šå¸¸ä¸ä¼šè¢«ç³»ç»Ÿä½¿ç”¨ï¼Œæ‰€ä»¥å®ƒå¾ˆé€‚åˆç”¨äºè¿™ç§ç”¨é€”ã€‚</p></li><li><p><strong>ç”Ÿæˆå’ŒæŸ¥çœ‹è¯Šæ–­æŠ¥å‘Š</strong></p><p>å½“ä½ çš„åº”ç”¨æ­£åœ¨è¿è¡Œï¼Œè€Œä½ æƒ³è¦ç”Ÿæˆä¸€ä¸ªè¯Šæ–­æŠ¥å‘Šæ—¶ï¼Œä½ åªéœ€è¦åœ¨ç»ˆç«¯ä¸­å‘é€ <code>SIGUSR2</code> ä¿¡å·åˆ°ä½ çš„ Node.js è¿›ç¨‹ã€‚å‡è®¾ä½ çš„ Node.js åº”ç”¨çš„è¿›ç¨‹ ID æ˜¯ 12345ï¼Œä½ å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å‘é€ä¿¡å·ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">kill</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -SIGUSR2</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12345</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å‘é€ä¿¡å·åï¼ŒNode.js ä¼šè‡ªåŠ¨åœ¨è¿›ç¨‹çš„å½“å‰å·¥ä½œç›®å½•ç”Ÿæˆä¸€ä¸ªè¯Šæ–­æŠ¥å‘Šæ–‡ä»¶ã€‚ä½ å¯ä»¥æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼ŒæŸ¥çœ‹å„ç§è¯Šæ–­ä¿¡æ¯ï¼Œä»¥å¸®åŠ©ä½ åˆ†æå’Œè§£å†³æ€§èƒ½é—®é¢˜ã€‚</p></li></ol><p>é€šè¿‡ä½¿ç”¨ <code>process.report.reportOnSignal</code> åŠŸèƒ½ï¼Œå¼€å‘è€…å¯ä»¥æ›´å®¹æ˜“åœ°åœ¨å¿…è¦æ—¶ç”Ÿæˆ Node.js åº”ç”¨çš„è¯Šæ–­æŠ¥å‘Šï¼Œè€Œæ— éœ€é‡å¯åº”ç”¨æˆ–è¿›è¡Œå¤æ‚çš„é…ç½®ã€‚è¿™æ˜¯ä¸€ç§å¼ºå¤§çš„è°ƒè¯•å’Œç›‘æ§å·¥å…·ï¼Œèƒ½å¸®åŠ©ä½ å¿«é€Ÿå®šä½å’Œè§£å†³åº”ç”¨ä¸­çš„é—®é¢˜ã€‚</p><h3 id="process-report-reportonuncaughtexception" tabindex="-1"><a class="header-anchor" href="#process-report-reportonuncaughtexception"><span><a href="https://nodejs.org/docs/latest/api/process.html#processreportreportonuncaughtexception" target="_blank" rel="noopener noreferrer">process.report.reportOnUncaughtException</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ï¼Œå…è®¸å¼€å‘è€…ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ã€‚åœ¨ Node.js ä¸­ï¼Œâ€œprocessâ€æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†æœ‰å…³å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚è€Œ <code>process.report.reportOnUncaughtException</code> æ˜¯ <code>process.report</code> å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨äºé…ç½®åœ¨æœªæ•è·çš„å¼‚å¸¸å‘ç”Ÿæ—¶æ˜¯å¦è‡ªåŠ¨ç”Ÿæˆè¯Šæ–­æŠ¥å‘Šã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç†è§£ä»€ä¹ˆæ˜¯æœªæ•è·çš„å¼‚å¸¸ï¼ˆUncaught Exceptionï¼‰ã€‚åœ¨ Node.js ä¸­ï¼Œå½“ä»£ç æ‰§è¡Œä¸­å‘ç”Ÿé”™è¯¯ï¼Œè€Œè¿™ä¸ªé”™è¯¯æ²¡æœ‰è¢«æ•è·ï¼ˆå³æ²¡æœ‰ç”¨ try...catch è¯­å¥æ•è·ï¼‰æ—¶ï¼Œè¿™ä¸ªé”™è¯¯å°±ä¼šè¢«è§†ä¸ºæœªæ•è·çš„å¼‚å¸¸ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒNode.js ä¼šæ‰“å°å‡ºé”™è¯¯ä¿¡æ¯å¹¶é€€å‡ºè¿›ç¨‹ã€‚ä½†æ˜¯ï¼Œåœ¨ä¸€äº›åœºæ™¯ä¸­ï¼Œä»…ä»…çŸ¥é“é”™è¯¯ä¿¡æ¯å¯èƒ½ä¸è¶³ä»¥è¯Šæ–­é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ã€‚è¿™æ—¶å€™ï¼Œè‡ªåŠ¨ç”Ÿæˆè¯Šæ–­æŠ¥å‘Šå°±æ˜¾å¾—éå¸¸æœ‰ç”¨ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-7" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-7"><span>å¦‚ä½•ä½¿ç”¨</span></a></h3><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>process.report.reportOnUncaughtException</code> çš„å€¼å¯ä»¥é…ç½®ä¸º <code>true</code> æˆ– <code>false</code>ï¼š</p><ul><li>å½“è®¾ç½®ä¸º <code>true</code> æ—¶ï¼Œå¦‚æœæœ‰æœªæ•è·çš„å¼‚å¸¸å‘ç”Ÿï¼ŒNode.js å°†è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªè¯Šæ–­æŠ¥å‘Šã€‚</li><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ–è€…å½“è®¾ä¸º <code>false</code> æ—¶ï¼Œä¸ä¼šç”ŸæˆæŠ¥å‘Šã€‚</li></ul><h3 id="å®ä¾‹åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹åº”ç”¨"><span>å®ä¾‹åº”ç”¨</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œçªç„¶ä¹‹é—´ï¼Œä½ çš„æœåŠ¡å™¨å› ä¸ºæŸä¸ªæœªé¢„è§çš„é”™è¯¯å´©æºƒäº†ã€‚å¦‚æœä½ æ²¡æœ‰å¯ç”¨æœªæ•è·å¼‚å¸¸çš„æŠ¥å‘Šï¼Œä½ å¯èƒ½åªèƒ½é€šè¿‡æ—¥å¿—æ¥çŒœæµ‹å‘ç”Ÿäº†ä»€ä¹ˆã€‚ä½†å¦‚æœä½ å¯ç”¨äº†è¿™ä¸ªåŠŸèƒ½ï¼Œæ¯å½“æœåŠ¡å™¨å´©æºƒæ—¶ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªè¯¦ç»†çš„è¯Šæ–­æŠ¥å‘Šï¼ŒåŒ…æ‹¬é”™è¯¯æ ˆã€ç³»ç»Ÿä¿¡æ¯ã€æ­£åœ¨è¿è¡Œçš„è¯·æ±‚ç­‰ä¿¡æ¯ï¼Œå¤§å¤§é™ä½äº†å®šä½é—®é¢˜çš„éš¾åº¦ã€‚</p><h3 id="ç¤ºä¾‹ä»£ç -3" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -3"><span>ç¤ºä¾‹ä»£ç </span></a></h3><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹æ¥å±•ç¤ºå¦‚ä½•å¯ç”¨æ­¤åŠŸèƒ½ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// é¦–å…ˆï¼Œç¡®ä¿æˆ‘ä»¬å¯ç”¨äº†å¯¹æœªæ•è·å¼‚å¸¸çš„æŠ¥å‘Šç”Ÿæˆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">reportOnUncaughtException</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ•…æ„æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œæ¨¡æ‹Ÿæœªæ•è·çš„å¼‚å¸¸</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Oops! Something went wrong.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æœåŠ¡å™¨è¿è¡Œä¸­...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡è®¾ç½® <code>process.report.reportOnUncaughtException = true</code> å¯ç”¨äº†æŠ¥å‘Šç”Ÿæˆã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡ <code>setTimeout</code> å»¶è¿ŸæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚åœ¨å®é™…è¿è¡Œä¸­ï¼Œå½“é”™è¯¯å‘ç”Ÿæ—¶ï¼Œé™¤äº†åœ¨æ§åˆ¶å°çœ‹åˆ°é”™è¯¯ä¿¡æ¯å¤–ï¼Œè¿˜ä¼šåœ¨è¿›ç¨‹çš„å½“å‰å·¥ä½œç›®å½•ç”Ÿæˆä¸€ä¸ªè¯Šæ–­æŠ¥å‘Šæ–‡ä»¶ã€‚ä½ å¯ä»¥æ‰“å¼€è¿™ä¸ªæ–‡ä»¶æŸ¥çœ‹è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå…¶ä»–æœ‰ç”¨çš„ç³»ç»Ÿä¿¡æ¯ã€‚</p><p>é€šè¿‡åˆ©ç”¨ <code>process.report.reportOnUncaughtException</code>ï¼Œä½ å¯ä»¥æ›´æœ‰æ•ˆåœ°ç›‘æ§å’Œè°ƒè¯• Node.js åº”ç”¨ç¨‹åºä¸­çš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ã€‚</p><h3 id="process-report-signal" tabindex="-1"><a class="header-anchor" href="#process-report-signal"><span><a href="https://nodejs.org/docs/latest/api/process.html#processreportsignal" target="_blank" rel="noopener noreferrer">process.report.signal</a></span></a></h3><p>å½“ä½ å¼€å§‹ä½¿ç”¨ Node.jsï¼Œä½ ä¼šå‘ç°å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„ç¯å¢ƒï¼Œè¿˜æä¾›äº†å¼ºå¤§çš„å†…ç½®æ¨¡å—å’Œ API æ¥å¸®åŠ©å¼€å‘è€…æ„å»ºé«˜æ•ˆã€å¯æ‰©å±•çš„åº”ç”¨ç¨‹åºã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ¢è®¨<code>process.report.signal</code>è¿™ä¸ªåŠŸèƒ½ï¼Œå®ƒæ˜¯åœ¨ Node.js v21.7.1 ä¸­å¼•å…¥çš„ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-process-report-signal" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-process-report-signal"><span>ä»€ä¹ˆæ˜¯ <code>process.report.signal</code>?</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code>å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯ã€‚é€šè¿‡è¿™ä¸ªå¯¹è±¡ï¼Œä½ å¯ä»¥è®¿é—®ç¯å¢ƒä¿¡æ¯ã€ç”¨æˆ·å‡­æ®ã€è¿è¡Œå‚æ•°ç­‰ã€‚è€Œ<code>process.report</code>åˆ™æ˜¯<code>process</code>å¯¹è±¡ä¸‹çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒå…è®¸é…ç½®ç”Ÿæˆè¯Šæ–­æŠ¥å‘Šçš„é€‰é¡¹ã€‚</p><p><code>process.report.signal</code>ç‰¹åˆ«æŒ‡çš„æ˜¯ä¸€ä¸ªå±æ€§ï¼Œç”¨äºé…ç½®è§¦å‘ç”Ÿæˆè¯Šæ–­æŠ¥å‘Šçš„ä¿¡å·ç±»å‹ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å½“ Node.js è¿›ç¨‹æ¥æ”¶åˆ°ä½ æŒ‡å®šçš„ç³»ç»Ÿä¿¡å·æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŒ…å«äº†è¿›ç¨‹çŠ¶æ€ä¿¡æ¯ã€å †æ ˆè·Ÿè¸ªç­‰è¯Šæ–­ä¿¡æ¯çš„æŠ¥å‘Šã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯-5" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯-5"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œå¹¶ä¸”çªç„¶ä½ çš„åº”ç”¨å‡ºç°æ€§èƒ½ä¸‹é™æˆ–è€…æ„å¤–å´©æºƒçš„æƒ…å†µã€‚é€šå¸¸è¿™æ—¶å€™ï¼Œä½ éœ€è¦ä¸€äº›å†…éƒ¨ä¿¡æ¯æ¥å¸®åŠ©ä½ å®šä½é—®é¢˜ã€‚è¿™æ—¶ï¼Œå¦‚æœä½ å·²ç»è®¾ç½®äº†<code>process.report.signal</code>ï¼Œé‚£ä¹ˆä½ åªéœ€è¦ç»™ Node.js è¿›ç¨‹å‘é€ä¸€ä¸ªæŒ‡å®šçš„ä¿¡å·ï¼Œå³å¯å¾—åˆ°ä¸€ä¸ªè¯¦ç»†çš„è¯Šæ–­æŠ¥å‘Šã€‚è¿™ä¸ªæŠ¥å‘Šå¯èƒ½åŒ…æ‹¬å†…å­˜ä½¿ç”¨æƒ…å†µã€æ´»åŠ¨è¯·æ±‚çš„ä¿¡æ¯ã€JavaScript è°ƒç”¨æ ˆç­‰ï¼Œè¿™å¯¹äºè°ƒè¯•å’Œä¼˜åŒ–ä½ çš„åº”ç”¨éå¸¸æœ‰å¸®åŠ©ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-8" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-8"><span>å¦‚ä½•ä½¿ç”¨ï¼Ÿ</span></a></h3><ol><li><strong>è®¾ç½®è§¦å‘ä¿¡å·</strong>ï¼šé¦–å…ˆï¼Œä½ éœ€è¦æŒ‡å®šå“ªä¸ªä¿¡å·å°†è§¦å‘æŠ¥å‘Šçš„ç”Ÿæˆã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥é€‰æ‹©<code>SIGUSR2</code>è¿™ä¸ªä¿¡å·ï¼ˆå¸¸ç”¨äºç”¨æˆ·å®šä¹‰çš„æ¡ä»¶ï¼‰ï¼Œå› ä¸ºå®ƒåœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸Šé»˜è®¤å¹¶æœªä½¿ç”¨ã€‚è®¾ç½®æ–¹å¼å¦‚ä¸‹ï¼š</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">signal</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;SIGUSR2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li><strong>å‘é€ä¿¡å·</strong>ï¼šå½“åº”ç”¨è¿è¡Œè¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œä½¿ç”¨<code>kill</code>å‘½ä»¤å‘é€ä¿¡å·ç»™ Node.js è¿›ç¨‹ã€‚å‡è®¾ä½ çš„ Node.js åº”ç”¨çš„è¿›ç¨‹ IDï¼ˆPIDï¼‰æ˜¯ 12345ï¼Œé‚£ä¹ˆå‘½ä»¤å¦‚ä¸‹ï¼š</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">kill</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -SIGUSR2</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12345</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="3"><li><strong>æŸ¥çœ‹æŠ¥å‘Š</strong>ï¼šå‘é€ä¿¡å·åï¼ŒNode.js å°†åœ¨å½“å‰å·¥ä½œç›®å½•ç”Ÿæˆä¸€ä¸ªè¯Šæ–­æŠ¥å‘Šæ–‡ä»¶ï¼Œæ–‡ä»¶åé€šå¸¸ä»¥æ—¥æœŸæ—¶é—´å¼€å¤´ï¼Œåç¼€ä¸º<code>.json</code>æˆ–<code>.txt</code>ï¼ˆå–å†³äº<code>process.report</code>çš„å…¶ä»–é…ç½®ï¼‰ã€‚ä½ å¯ä»¥æ‰“å¼€è¿™ä¸ªæ–‡ä»¶æŸ¥çœ‹è¯¦ç»†çš„è¯Šæ–­ä¿¡æ¯ã€‚</li></ol><h3 id="å®é™…è¿ç”¨ä¾‹å­-13" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-13"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ åœ¨ç®¡ç†ä¸€ä¸ªç”µå•†å¹³å°çš„åç«¯æœåŠ¡ï¼Œè¿™ä¸ªæœåŠ¡æœ€è¿‘é¢‘ç¹å‡ºç°æ€§èƒ½é—®é¢˜ï¼Œä½†ä½ æ— æ³•ç«‹åˆ»å®šä½åˆ°å…·ä½“çš„åŸå› ã€‚é€šè¿‡è®¾ç½®<code>process.report.signal</code>ä¸º<code>SIGUSR2</code>ï¼Œä½ å¯ä»¥åœ¨é—®é¢˜å†æ¬¡å‘ç”Ÿæ—¶ï¼Œå¿«é€Ÿåœ°è·å–åˆ°æœåŠ¡çš„å®æ—¶è¯Šæ–­æŠ¥å‘Šï¼Œè¿›è€Œåˆ†æå‡ºæ˜¯æ•°æ®åº“æŸ¥è¯¢æ•ˆç‡ä½ä¸‹ã€æŸä¸ªç¬¬ä¸‰æ–¹æœåŠ¡å“åº”æ…¢ã€è¿˜æ˜¯åº”ç”¨æœ¬èº«çš„ä»£ç é€»è¾‘å‡ºç°äº†é—®é¢˜ã€‚</p><p>è¿™æ ·ï¼Œç›¸è¾ƒäºç›²ç›®åœ°æ£€æŸ¥æ—¥å¿—æˆ–ä¿®æ”¹ä»£ç å°è¯•ï¼Œä½¿ç”¨<code>process.report.signal</code>èƒ½æ›´ç›´æ¥ã€æœ‰æ•ˆåœ°å¸®åŠ©ä½ å®šä½å¹¶è§£å†³é—®é¢˜ï¼Œæå‡å¼€å‘æ•ˆç‡å’Œåº”ç”¨ç¨³å®šæ€§ã€‚</p><h3 id="process-report-writereport-filename-err" tabindex="-1"><a class="header-anchor" href="#process-report-writereport-filename-err"><span><a href="https://nodejs.org/docs/latest/api/process.html#processreportwritereportfilename-err" target="_blank" rel="noopener noreferrer">process.report.writeReport([filename][, err])</a></span></a></h3><p>Node.js çš„<code>process.report.writeReport([filename][, err])</code>å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå°¤å…¶æ˜¯åœ¨ä½ éœ€è¦è¯Šæ–­åº”ç”¨ç¨‹åºé—®é¢˜æ—¶ã€‚è¿™ä¸ªå‡½æ•°èƒ½å¤Ÿè®©ä½ ç”Ÿæˆä¸€ä»½åŒ…å«äº†å½“å‰ Node.js è¿›ç¨‹çŠ¶æ€çš„æŠ¥å‘Šã€‚è¿™ä»½æŠ¥å‘Šè¢«ç§°ä¸ºè¯Šæ–­æŠ¥å‘Šï¼ˆdiagnostic reportï¼‰ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—å…³äºå½“å‰è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚ CPU ä½¿ç”¨æƒ…å†µã€å†…å­˜ä½¿ç”¨æƒ…å†µã€JavaScript å †æ ˆè·Ÿè¸ªã€å¼€æ”¾çš„å¥æŸ„åˆ—è¡¨ã€ç³»ç»Ÿä¿¡æ¯ç­‰ã€‚</p><h3 id="ä½¿ç”¨æ–¹æ³•-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ–¹æ³•-1"><span>ä½¿ç”¨æ–¹æ³•</span></a></h3><p><code>process.report.writeReport([filename][, err])</code> å‡½æ•°å¯ä»¥æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p><ul><li><code>filename</code> ï¼ˆå¯é€‰ï¼‰: æŒ‡å®šç”ŸæˆæŠ¥å‘Šçš„æ–‡ä»¶åã€‚å¦‚æœä¸æä¾›æˆ–è€…æä¾›çš„æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œåˆ™æŠ¥å‘Šå†…å®¹ä¼šè¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼ˆé€šå¸¸æ˜¯æ§åˆ¶å°ï¼‰ã€‚</li><li><code>err</code> ï¼ˆå¯é€‰ï¼‰: å¦‚æœè°ƒç”¨è¿™ä¸ªå‡½æ•°æ˜¯å› ä¸ºæ•è·åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œä½ å¯ä»¥å°†é‚£ä¸ªé”™è¯¯å¯¹è±¡ä¼ é€’ç»™è¿™ä¸ªå‡½æ•°ï¼Œä»¥ä¾¿æŠ¥å‘Šä¸­åŒ…å«è¯¥é”™è¯¯çš„ç›¸å…³ä¿¡æ¯ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-14" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-14"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>è°ƒè¯•å†…å­˜æ³„æ¼</strong>ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œçªç„¶å‘ç°å®ƒè¿è¡Œä¸€æ®µæ—¶é—´åé€Ÿåº¦å˜å¾—éå¸¸æ…¢ã€‚ä½ æ€€ç–‘å¯èƒ½æ˜¯å†…å­˜æ³„æ¼é€ æˆçš„ã€‚æ­¤æ—¶ï¼Œä½ å¯ä»¥ç”¨<code>process.report.writeReport()</code>ç”Ÿæˆä¸€ä»½è¯Šæ–­æŠ¥å‘Šï¼Œé€šè¿‡åˆ†ææŠ¥å‘Šä¸­çš„å†…å­˜ä½¿ç”¨æƒ…å†µæ¥è¾…åŠ©æ‰¾å‡ºå¯èƒ½çš„å†…å­˜æ³„æ¼ç‚¹ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨ä»£ç ä¸­çš„æŸä¸ªç–‘ä¼¼å†…å­˜æ³„æ¼çš„åœ°æ–¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeReport</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;memory-leak-report.json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ€§èƒ½åˆ†æ</strong>ï¼šå¦‚æœä½ æƒ³è¦æ›´å¥½åœ°ç†è§£ä½ çš„ Node.js åº”ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„è¡¨ç°ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†é«˜å¹¶å‘è¯·æ±‚æ—¶çš„ CPU å’Œå†…å­˜ä½¿ç”¨æƒ…å†µï¼Œä½ å¯ä»¥åœ¨åº”ç”¨çš„å…³é”®è·¯å¾„ä¸Šæ·»åŠ <code>process.report.writeReport()</code>è°ƒç”¨ï¼Œç”Ÿæˆå®æ—¶çš„æ€§èƒ½æŠ¥å‘Šã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åœ¨å¤„ç†HTTPè¯·æ±‚çš„å›è°ƒä¸­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/api/data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">needReport</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾è¿™æ˜¯ä¸€ä¸ªä½ æ ¹æ®ä¸šåŠ¡é€»è¾‘è®¾ç½®çš„æ¡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeReport</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¤„ç†è¯·æ±‚...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>åº”å¯¹æœªæ•è·çš„å¼‚å¸¸</strong>ï¼šåœ¨ Node.js åº”ç”¨ä¸­ï¼Œæœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´è¿›ç¨‹é€€å‡ºï¼Œè¿™å¯¹äºç”Ÿäº§ç¯å¢ƒæ¥è¯´æ˜¯ç¾éš¾æ€§çš„ã€‚ä¸ºäº†æ›´å¥½åœ°äº†è§£å¯¼è‡´æœªæ•è·å¼‚å¸¸çš„åŸå› ï¼Œä½ å¯ä»¥åœ¨å…¨å±€çš„<code>uncaughtException</code>äº‹ä»¶å¤„ç†å™¨ä¸­ä½¿ç”¨<code>process.report.writeReport()</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;uncaughtException&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æœ‰ä¸€ä¸ªæœªæ•è·çš„å¼‚å¸¸&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">report</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeReport</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;uncaught-exception-report.json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>ä»¥ä¸Šä¾‹å­å±•ç¤ºäº†<code>process.report.writeReport()</code>åœ¨å®é™…åº”ç”¨ä¸­çš„å‡ ç§ç”¨é€”ã€‚é€šè¿‡åœ¨å…³é”®ä½ç½®ç”Ÿæˆè¯Šæ–­æŠ¥å‘Šï¼Œå¼€å‘è€…å¯ä»¥è·å–åˆ°åº”ç”¨çš„å†…éƒ¨çŠ¶æ€å’Œè¿è¡Œç¯å¢ƒçš„è¯¦ç»†å¿«ç…§ï¼Œè¿™å¯¹äºè¯Šæ–­é—®é¢˜å’Œä¼˜åŒ–æ€§èƒ½æ¥è¯´éƒ½æ˜¯éå¸¸æœ‰ä»·å€¼çš„ã€‚</p><h2 id="process-resourceusage" tabindex="-1"><a class="header-anchor" href="#process-resourceusage"><span><a href="https://nodejs.org/docs/latest/api/process.html#processresourceusage" target="_blank" rel="noopener noreferrer">process.resourceUsage()</a></span></a></h2><p>å¥½çš„ï¼Œæˆ‘å°†ä¸ºä½ è¯¦ç»†è§£é‡Š <code>process.resourceUsage()</code> åœ¨ Node.js v21.7.1 ä¸­çš„ç”¨æ³•ï¼Œå¹¶é…ä»¥å®é™…ä¾‹å­æ¥å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-process-resourceusage" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-process-resourceusage"><span>ä»€ä¹ˆæ˜¯ <code>process.resourceUsage()</code>ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code> å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†æœ‰å…³å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚<code>process.resourceUsage()</code> æ˜¯è¿™ä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒè¿”å›å½“å‰è¿›ç¨‹çš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œæ¯”å¦‚ CPU æ—¶é—´ã€å†…å­˜ä½¿ç”¨é‡ç­‰ã€‚è¿™å¯¹äºç›‘æ§å’Œåˆ†æåº”ç”¨æ€§èƒ½éå¸¸æœ‰ç”¨ã€‚</p><h3 id="è¿”å›å€¼-2" tabindex="-1"><a class="header-anchor" href="#è¿”å›å€¼-2"><span>è¿”å›å€¼</span></a></h3><p>å½“ä½ è°ƒç”¨ <code>process.resourceUsage()</code> æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å‡ ä¸ªå­—æ®µï¼š</p><ul><li><code>userCPUTime</code>: ç”¨æˆ· CPU æ—¶é—´ï¼ˆå¾®ç§’ï¼‰</li><li><code>systemCPUTime</code>: ç³»ç»Ÿ CPU æ—¶é—´ï¼ˆå¾®ç§’ï¼‰</li><li><code>maxRSS</code>: æœ€å¤§é©»ç•™é›†å¤§å°ï¼ˆå­—èŠ‚ï¼‰</li><li><code>sharedMemorySize</code>: å…±äº«å†…å­˜å¤§å°ï¼ˆå­—èŠ‚ï¼‰</li><li><code>unsharedDataSize</code>: éå…±äº«æ•°æ®å¤§å°ï¼ˆå­—èŠ‚ï¼‰</li><li><code>unsharedStackSize</code>: éå…±äº«æ ˆå¤§å°ï¼ˆå­—èŠ‚ï¼‰</li><li><code>minorPageFault</code>: å°é¡µé¢é”™è¯¯</li><li><code>majorPageFault</code>: å¤§é¡µé¢é”™è¯¯</li><li><code>swappedOut</code>: è¢«æ¢å‡ºï¼ˆäº¤æ¢ç©ºé—´ä½¿ç”¨é‡ï¼‰</li><li><code>fsRead</code>: æ–‡ä»¶ç³»ç»Ÿè¯»å–æ¬¡æ•°</li><li><code>fsWrite</code>: æ–‡ä»¶ç³»ç»Ÿå†™å…¥æ¬¡æ•°</li><li><code>ipcSent</code>: å‘é€çš„ IPC æ¶ˆæ¯æ•°</li><li><code>ipcReceived</code>: æ”¶åˆ°çš„ IPC æ¶ˆæ¯æ•°</li><li><code>signalsCount</code>: æ¥æ”¶åˆ°çš„ä¿¡å·æ•°</li><li><code>voluntaryContextSwitches</code>: ä¸»åŠ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°</li><li><code>involuntaryContextSwitches</code>: è¢«åŠ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°</li></ul><h3 id="å®é™…è¿ç”¨ä¾‹å­-15" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-15"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›ä»£ç ç¤ºä¾‹æ¥çœ‹çœ‹å¦‚ä½•ç”¨ <code>process.resourceUsage()</code> æ¥è·å–è¿›ç¨‹èµ„æºä½¿ç”¨æƒ…å†µã€‚</p><h4 id="åŸºæœ¬ä½¿ç”¨-1" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ä½¿ç”¨-1"><span>åŸºæœ¬ä½¿ç”¨</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> resourceUsage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resourceUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">resourceUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç ç‰‡æ®µè°ƒç”¨äº† <code>process.resourceUsage()</code> å¹¶æ‰“å°äº†è¿”å›çš„èµ„æºä½¿ç”¨æƒ…å†µã€‚è¿™å¯ä»¥è®©ä½ å¿«é€ŸæŸ¥çœ‹å½“å‰ Node.js è¿›ç¨‹çš„èµ„æºçŠ¶å†µã€‚</p><h4 id="ç›‘æ§èµ„æºä½¿ç”¨æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#ç›‘æ§èµ„æºä½¿ç”¨æƒ…å†µ"><span>ç›‘æ§èµ„æºä½¿ç”¨æƒ…å†µ</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œæƒ³è¦ç›‘è§†å…¶è¿è¡Œæ—¶çš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œç‰¹åˆ«æ˜¯ CPU å’Œå†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Œä½ å¯ä»¥å®šæœŸè°ƒç”¨ <code>process.resourceUsage()</code> å¹¶è®°å½•ç»“æœï¼Œä¾‹å¦‚ï¼Œæ¯åˆ†é’Ÿè®°å½•ä¸€æ¬¡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> usage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resourceUsage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`CPU User Time: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">usage</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">userCPUTime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`CPU System Time: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">usage</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">systemCPUTime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Max RSS: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">usage</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">maxRSS</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">60000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥è·Ÿè¸ªä½ çš„åº”ç”¨åœ¨ä¸åŒæ—¶é—´æ®µå†…çš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œä»è€Œè¯Šæ–­å¯èƒ½çš„æ€§èƒ½é—®é¢˜æˆ–å†…å­˜æ³„éœ²ã€‚</p><h4 id="æ€»ç»“-22" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-22"><span>æ€»ç»“</span></a></h4><p><code>process.resourceUsage()</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ Node.js æ–¹æ³•ï¼Œå…è®¸å¼€å‘è€…è·å–å½“å‰è¿›ç¨‹çš„è¯¦ç»†èµ„æºä½¿ç”¨æƒ…å†µã€‚é€šè¿‡åˆ©ç”¨è¿™äº›ä¿¡æ¯ï¼Œå¼€å‘è€…å¯ä»¥æ›´å¥½åœ°ç›‘æ§å’Œä¼˜åŒ–ä»–ä»¬çš„åº”ç”¨æ€§èƒ½ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œç»“åˆæ—¥å¿—è®°å½•å’Œç›‘æ§å·¥å…·ï¼Œ<code>process.resourceUsage()</code> å¯ä»¥å¸®åŠ©ä½ ç¡®ä¿åº”ç”¨çš„é«˜æ•ˆç¨³å®šè¿è¡Œã€‚</p><h2 id="process-send-message-sendhandle-options-callback" tabindex="-1"><a class="header-anchor" href="#process-send-message-sendhandle-options-callback"><span><a href="https://nodejs.org/docs/latest/api/process.html#processsendmessage-sendhandle-options-callback" target="_blank" rel="noopener noreferrer">process.send(message[, sendHandle[, options]][, callback])</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªèƒ½è®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ã€‚å®ƒå…è®¸å¼€å‘è€…ä½¿ç”¨ JavaScript æ¥ç¼–å†™åç«¯ä»£ç ï¼Œè€Œè¿™ç§è¯­è¨€ä¹‹å‰ä¸»è¦è¢«ç”¨äºç¼–å†™ç½‘é¡µä¸Šçš„å‰ç«¯ä»£ç ã€‚Node.js ç‰¹åˆ«é€‚åˆæ„å»ºå¿«é€Ÿçš„ã€å¯æ‰©å±•çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚</p><p><code>process.send()</code>æ–¹æ³•æ˜¯ Node.js ä¸­ä¸€ä¸ªéå¸¸å…·ä½“çš„åŠŸèƒ½ï¼Œå®ƒä¸»è¦ç”¨åœ¨å­è¿›ç¨‹ï¼ˆchild processï¼‰é€šä¿¡çš„åœºæ™¯ä¸­ã€‚åœ¨ Node.js ä¸­ï¼Œå½“æˆ‘ä»¬è°ˆåˆ°è¿›ç¨‹ï¼ŒåŸºæœ¬ä¸ŠæŒ‡çš„æ˜¯æ‰§è¡Œä¸­çš„ç¨‹åºå®ä¾‹ã€‚å½“ä½ è¿è¡Œä¸€ä¸ª Node.js åº”ç”¨æ—¶ï¼Œå®ƒè‡³å°‘ä¼šå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼ˆé€šå¸¸ç§°ä¸ºâ€œä¸»è¿›ç¨‹â€ï¼‰ã€‚ä½†æ˜¯ï¼Œä¸ºäº†æ›´æœ‰æ•ˆåœ°åˆ©ç”¨ç³»ç»Ÿèµ„æºå’Œæé«˜åº”ç”¨æ€§èƒ½ï¼ŒNode.js å…è®¸é€šè¿‡åˆ›å»ºå­è¿›ç¨‹æ¥åˆ†æ‹…å·¥ä½œè´Ÿè½½ã€‚</p><h3 id="process-send-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#process-send-æ¦‚è¿°"><span><code>process.send()</code>: æ¦‚è¿°</span></a></h3><p><code>process.send()</code>æ–¹æ³•å…è®¸ä½ ä»ä¸€ä¸ªå­è¿›ç¨‹å‘å…¶çˆ¶è¿›ç¨‹å‘é€æ¶ˆæ¯ã€‚å®ƒæ˜¯ä¸€ç§ IPCï¼ˆInter-Process Communicationï¼Œè¿›ç¨‹é—´é€šä¿¡ï¼‰æ‰‹æ®µã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªæ–¹æ³•åªæœ‰åœ¨å½“å‰è¿›ç¨‹æ˜¯ç”±<a href="https://nodejs.org/api/child_process.html#child_processforkmodulepath-args-options" target="_blank" rel="noopener noreferrer"><code>child_process.fork()</code></a>æ–¹æ³•åˆ›å»ºçš„å­è¿›ç¨‹æ—¶æ‰å¯ç”¨ã€‚</p><h3 id="å‚æ•°è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è¯´æ˜"><span>å‚æ•°è¯´æ˜</span></a></h3><ul><li><code>message</code>: è¦å‘é€ç»™çˆ¶è¿›ç¨‹çš„æ¶ˆæ¯ã€‚è¿™å¯ä»¥æ˜¯ä»»ä½•å€¼æˆ–å¯¹è±¡ã€‚</li><li><code>sendHandle</code>: ï¼ˆå¯é€‰ï¼‰ä¸€ä¸ªå…³è”çš„å¥æŸ„å¯¹è±¡ï¼Œä¾‹å¦‚ä¸€ä¸ª socket æˆ– serverï¼Œç”¨äºä¼ è¾“æ•°æ®æˆ–å»ºç«‹è¿æ¥ã€‚</li><li><code>options</code>: ï¼ˆå¯é€‰ï¼‰ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œå…¶ä¸­å¯ä»¥åŒ…å«å¦‚<code>swallowErrors</code>ç­‰é€‰é¡¹ã€‚</li><li><code>callback</code>: ï¼ˆå¯é€‰ï¼‰æ¶ˆæ¯æˆåŠŸå‘é€æˆ–é‡åˆ°é”™è¯¯æ—¶çš„å›è°ƒå‡½æ•°ã€‚</li></ul><h3 id="å®é™…ç”¨æ³•ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®é™…ç”¨æ³•ç¤ºä¾‹"><span>å®é™…ç”¨æ³•ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ç¨‹åºï¼Œè¯¥ç¨‹åºéœ€è¦æ‰§è¡Œå¤§é‡ CPU å¯†é›†å‹ä»»åŠ¡ï¼ˆæ¯”å¦‚å›¾åƒå¤„ç†æˆ–å¤æ‚è®¡ç®—ï¼‰ã€‚å¦‚æœåœ¨ä¸»è¿›ç¨‹ä¸­æ‰§è¡Œè¿™äº›ä»»åŠ¡ï¼Œå¯èƒ½ä¼šå¯¼è‡´åº”ç”¨å“åº”å˜æ…¢ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸“é—¨ç”¨äºæ‰§è¡Œè¿™äº›å¯†é›†å‹ä»»åŠ¡çš„å­è¿›ç¨‹ï¼Œå¹¶é€šè¿‡<code>process.send()</code>ä¸ä¹‹é€šä¿¡ã€‚</p><p><strong>æ­¥éª¤ 1</strong>: åˆ›å»ºå­è¿›ç¨‹æ–‡ä»¶ <code>worker.js</code>:</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// worker.js</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™é‡Œæœ‰ä¸€ä¸ªCPUå¯†é›†å‹ä»»åŠ¡çš„å‡½æ•°computeHeavyTask()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> computeHeavyTask</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  /* ... */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ¶ˆæ¯ä»çˆ¶è¿›ç¨‹æ¥æ”¶:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> computeHeavyTask</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ­¥éª¤ 2</strong>: åœ¨ä¸»è¿›ç¨‹ä¸­åˆ›å»ºå¹¶ç®¡ç†å­è¿›ç¨‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// main.js</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;child_process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> child</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> fork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./worker.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‘å­è¿›ç¨‹å‘é€æ¶ˆæ¯ä»¥è§¦å‘é‡ä»»åŠ¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({ </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">task</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;start heavy computation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¥æ”¶å­è¿›ç¨‹å®Œæˆä»»åŠ¡åçš„ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">child</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä»å­è¿›ç¨‹æ¥æ”¶çš„ç»“æœ:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåœ¨<code>worker.js</code>å®šä¹‰äº†ä¸€ä¸ªå­è¿›ç¨‹ï¼Œå®ƒç›‘å¬æ¥è‡ªçˆ¶è¿›ç¨‹çš„æ¶ˆæ¯ã€‚å½“æ”¶åˆ°æ¶ˆæ¯æ—¶ï¼Œæ‰§è¡Œä¸€ä¸ªå‡è®¾çš„å¤æ‚ä»»åŠ¡ï¼Œå¹¶å°†ç»“æœå‘é€å›çˆ¶è¿›ç¨‹ã€‚åœ¨ä¸»è„šæœ¬<code>main.js</code>ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡<code>fork()</code>åˆ›å»º<code>worker.js</code>çš„å­è¿›ç¨‹å®ä¾‹ï¼Œå‘é€ä¸€ä¸ªæ¶ˆæ¯ç»™å®ƒä»¥å¯åŠ¨ä»»åŠ¡ï¼Œç„¶åç›‘å¬æ¥è‡ªå­è¿›ç¨‹çš„æ¶ˆæ¯ä»¥è·å–ç»“æœã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸»è¿›ç¨‹å¯ä»¥ç»§ç»­å¤„ç†å…¶ä»–ä»»åŠ¡ï¼ˆæ¯”å¦‚å“åº”ç”¨æˆ·è¯·æ±‚ï¼‰ï¼Œè€Œä¸ä¼šè¢«é˜»å¡ç­‰å¾…å¯†é›†å‹ä»»åŠ¡å®Œæˆï¼Œä»è€Œæé«˜äº†åº”ç”¨ç¨‹åºçš„æ€»ä½“æ€§èƒ½å’Œå“åº”èƒ½åŠ›ã€‚</p><h2 id="process-setegid-id" tabindex="-1"><a class="header-anchor" href="#process-setegid-id"><span><a href="https://nodejs.org/docs/latest/api/process.html#processsetegidid" target="_blank" rel="noopener noreferrer">process.setegid(id)</a></span></a></h2><p><code>process.setegid(id)</code> æ˜¯ä¸€ä¸ªåœ¨ Node.js ç¯å¢ƒä¸­ç”¨æ¥è®¾ç½®å½“å‰è¿›ç¨‹çš„æœ‰æ•ˆç»„ ID çš„æ–¹æ³•ã€‚åœ¨è¯¦ç»†è§£é‡Šè¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£å‡ ä¸ªæ¦‚å¿µï¼šè¿›ç¨‹ã€æœ‰æ•ˆç»„ ID ä»¥åŠä¸ºä»€ä¹ˆå’Œæ€æ ·å»è®¾ç½®å®ƒã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-1" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-1"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><ol><li><p><strong>è¿›ç¨‹ï¼ˆProcessï¼‰</strong>ï¼šå½“ä½ è¿è¡Œä¸€ä¸ªç¨‹åºæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šåˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹æ¥æ‰§è¡Œç¨‹åºä»£ç ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´å’Œèµ„æºã€‚</p></li><li><p><strong>ç”¨æˆ· ID (UID) å’Œ ç»„ ID (GID)</strong>ï¼šåœ¨ Unix å’Œç±» Unix ç³»ç»Ÿï¼ˆå¦‚ Linuxã€macOSï¼‰ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªç”¨æˆ· IDï¼ˆUIDï¼‰ï¼Œå¹¶ä¸”å¯ä»¥å±äºä¸€ä¸ªæˆ–å¤šä¸ªç»„ï¼Œæ¯ä¸ªç»„ä¹Ÿæœ‰ä¸€ä¸ªç»„ IDï¼ˆGIDï¼‰ã€‚è¿™äº› ID ç”¨äºæ§åˆ¶å¯¹æ–‡ä»¶ç³»ç»Ÿç­‰èµ„æºçš„è®¿é—®æƒé™ã€‚</p></li><li><p><strong>æœ‰æ•ˆç»„ IDï¼ˆEffective Group IDï¼‰</strong>ï¼šä¸€ä¸ªè¿›ç¨‹å¯ä»¥å…³è”å¤šä¸ª GIDï¼šå®é™… GIDã€æœ‰æ•ˆ GID ç­‰ã€‚æœ‰æ•ˆ GID å†³å®šäº†è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯¹èµ„æºçš„è®¿é—®æƒé™ï¼ˆç‰¹åˆ«æ˜¯æ¶‰åŠæ–‡ä»¶ç³»ç»Ÿçš„æ“ä½œï¼‰ã€‚</p></li></ol><h3 id="process-setegid-id-1" tabindex="-1"><a class="header-anchor" href="#process-setegid-id-1"><span><code>process.setegid(id)</code></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process.setegid(id)</code> æ–¹æ³•å…è®¸ä½ æ”¹å˜ Node.js è¿›ç¨‹çš„æœ‰æ•ˆç»„ IDã€‚è¿™ç§èƒ½åŠ›ä¸»è¦ç”¨äºæé«˜å®‰å…¨æ€§ï¼Œä½¿å¾—è¿è¡Œä¸­çš„ Node.js åº”ç”¨èƒ½ä»¥ä¸åŒäºå¯åŠ¨å®ƒçš„ç”¨æˆ·çš„æƒé™è¿è¡Œã€‚<code>id</code> å¯ä»¥æ˜¯æ•°å­—å½¢å¼çš„ç»„ ID æˆ–æ˜¯å­—ç¬¦ä¸²å½¢å¼çš„ç»„åç§°ã€‚</p><p>**æ³¨æ„ï¼š**è¿™ä¸ªåŠŸèƒ½é€šå¸¸åªåœ¨ Unix ç±»æ“ä½œç³»ç»Ÿä¸Šå¯ç”¨ï¼Œå› ä¸º Windows å¹¶æ²¡æœ‰ä¸ Unix/Linux ç›¸ä¼¼çš„ç”¨æˆ·/ç»„æƒé™æ¨¡å‹ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯ç¤ºä¾‹"><span>ä½¿ç”¨åœºæ™¯ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¯¥åº”ç”¨éœ€è¦è®¿é—®ç³»ç»Ÿä¸ŠæŸäº›å—é™çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚è¿™äº›èµ„æºä»…å¯¹ç‰¹å®šçš„ç”¨æˆ·ç»„å¼€æ”¾ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå³ä½¿ä½ çš„åº”ç”¨ç”±ä¸€ä¸ªæ™®é€šç”¨æˆ·å¯åŠ¨ï¼Œä½ ä¹Ÿå¯èƒ½å¸Œæœ›å®ƒä»¥æ‹¥æœ‰è®¿é—®è¿™äº›èµ„æºæƒé™çš„ç»„çš„èº«ä»½è¿è¡Œã€‚</p><h4 id="ç¤ºä¾‹-1-æ›´æ”¹ç»„-id-æ¥è®¿é—®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æ›´æ”¹ç»„-id-æ¥è®¿é—®æ–‡ä»¶"><span>ç¤ºä¾‹ 1: æ›´æ”¹ç»„ ID æ¥è®¿é—®æ–‡ä»¶</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾ &#39;special-group&#39; æ˜¯å…·æœ‰æ‰€éœ€æ–‡ä»¶è®¿é—®æƒé™çš„ç»„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setegid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;special-group&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ–°çš„æœ‰æ•ˆç»„ ID: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getegid</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // è¿™é‡Œå¯ä»¥æ”¾ç½®ä½ éœ€è¦ä»¥ &#39;special-group&#39; æƒé™æ‰§è¡Œçš„ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ›´æ”¹æœ‰æ•ˆç»„ ID å¤±è´¥: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2-æå‡å®‰å…¨æ€§" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-æå‡å®‰å…¨æ€§"><span>ç¤ºä¾‹ 2: æå‡å®‰å…¨æ€§</span></a></h4><p>å¦‚æœä½ çš„ Node.js åº”ç”¨ä½œä¸º root ç”¨æˆ·å¯åŠ¨ï¼Œä½†å¤§éƒ¨åˆ†æ—¶é—´ä¸éœ€è¦ root æƒé™ï¼Œä¸ºäº†é¿å…æ½œåœ¨çš„å®‰å…¨é£é™©ï¼Œä½ å¯ä»¥å°†æœ‰æ•ˆç»„ ID æ›´æ”¹ä¸ºé root ç”¨æˆ·çš„ GIDã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getegid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">===</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å‡è®¾ &#39;nobody&#39; æ˜¯ä¸€ä¸ªè¾ƒä½æƒé™çš„ç»„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setegid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;nobody&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`å·²é™ä½æƒé™ï¼Œå½“å‰æœ‰æ•ˆç»„ ID: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getegid</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ›´æ”¹æœ‰æ•ˆç»„ ID å¤±è´¥: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ€»ç»“-23" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-23"><span>æ€»ç»“</span></a></h3><p>é€šè¿‡ <code>process.setegid(id)</code> æ–¹æ³•ï¼ŒNode.js åº”ç”¨èƒ½å¤Ÿåœ¨è¿è¡Œæ—¶æ›´æ”¹å…¶æœ‰æ•ˆç»„ IDï¼Œè¿™å¯¹äºæé«˜åº”ç”¨çš„å®‰å…¨æ€§ã€å®ç°æ›´ç²¾ç»†çš„æƒé™æ§åˆ¶ç­‰æ–¹é¢éå¸¸æœ‰ç”¨ã€‚ç„¶è€Œï¼Œä½¿ç”¨è¿™ä¸€åŠŸèƒ½éœ€è¦å¯¹æ“ä½œç³»ç»Ÿçš„ç”¨æˆ·å’Œç»„æƒé™æ¨¡å‹æœ‰æ·±å…¥ç†è§£ï¼Œå¹¶ä¸”è¦è°¨æ…æ“ä½œï¼Œä»¥é¿å…ä¸å¿…è¦çš„å®‰å…¨é£é™©ã€‚</p><h2 id="process-seteuid-id" tabindex="-1"><a class="header-anchor" href="#process-seteuid-id"><span><a href="https://nodejs.org/docs/latest/api/process.html#processseteuidid" target="_blank" rel="noopener noreferrer">process.seteuid(id)</a></span></a></h2><p>å½“ä½ ä½¿ç”¨ Node.js è¿›è¡Œç¼–ç¨‹æ—¶ï¼Œæœ‰æ—¶ä½ ä¼šéœ€è¦åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­æ”¹å˜å®ƒçš„æœ‰æ•ˆç”¨æˆ· IDã€‚ç†è§£è¿™ä¸€ç‚¹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£å‡ ä¸ªæ¦‚å¿µï¼šåœ¨ Unix å’Œ Linux ç­‰æ“ä½œç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªè¿è¡Œä¸­çš„ç¨‹åºéƒ½æ˜¯ç”±æŸä¸ªç”¨æˆ·å¯åŠ¨çš„ï¼Œä¸è¿™ä¸ªç”¨æˆ·ç›¸å…³è”çš„å°±æ˜¯ UserIDï¼ˆç”¨æˆ· IDï¼‰ã€‚è€Œâ€œæœ‰æ•ˆç”¨æˆ· IDâ€ (Effective UserID) æ˜¯ç³»ç»Ÿç”¨äºå†³å®šè¯¥ç¨‹åºå…·æœ‰å“ªäº›æƒé™çš„ IDã€‚</p><p><code>process.seteuid(id)</code>æ˜¯ä¸€ä¸ª Node.js æä¾›çš„æ–¹æ³•ï¼Œå…è®¸ä½ åœ¨ç¨‹åºè¿è¡Œä¸­æ›´æ”¹å…¶æœ‰æ•ˆç”¨æˆ· IDã€‚è¿™ä¸ªåŠŸèƒ½åœ¨éœ€è¦ä¸´æ—¶æå‡æˆ–é™ä½ç¨‹åºæƒé™æ—¶éå¸¸æœ‰ç”¨ã€‚</p><p>å‚æ•°<code>id</code>å¯ä»¥æ˜¯æ•°å­—ç±»å‹çš„ç”¨æˆ· ID æˆ–è€…ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„ç”¨æˆ·åã€‚</p><h3 id="ä¸ºä»€ä¹ˆè¦æ›´æ”¹æœ‰æ•ˆç”¨æˆ·-id" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆè¦æ›´æ”¹æœ‰æ•ˆç”¨æˆ·-id"><span>ä¸ºä»€ä¹ˆè¦æ›´æ”¹æœ‰æ•ˆç”¨æˆ· ID?</span></a></h3><p>è€ƒè™‘ä»¥ä¸‹æƒ…æ™¯ï¼š</p><ol><li><p><strong>å®‰å…¨æ€§</strong> - å‡è®¾ä½ çš„ Node.js åº”ç”¨éœ€è¦è¯»å–ä¸€ä¸ªåªæœ‰ root ç”¨æˆ·æ‰èƒ½è®¿é—®çš„æ–‡ä»¶ã€‚ä¸ºäº†å®‰å…¨èµ·è§ï¼Œä½ ä¸æƒ³ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œæ•´ä¸ªç¨‹åºï¼ˆå› ä¸ºè¿™æ ·åšå¦‚æœç¨‹åºæœ‰æ¼æ´ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨æ‰§è¡Œæ¶æ„ä»£ç ï¼‰ã€‚ä½ å¯ä»¥åœ¨ç¨‹åºå¼€å§‹æ—¶ä»¥æ™®é€šç”¨æˆ·èº«ä»½è¿è¡Œï¼Œå½“éœ€è¦è¯»å–ç‰¹æ®Šæ–‡ä»¶æ—¶ï¼Œä½¿ç”¨<code>process.seteuid()</code>åˆ‡æ¢åˆ° root ç”¨æˆ·ï¼Œè¯»å–å®Œåå†åˆ‡å›æ™®é€šç”¨æˆ·ã€‚</p></li><li><p><strong>èµ„æºè®¿é—®æ§åˆ¶</strong> - æŸäº›æƒ…å†µä¸‹ï¼Œä½ çš„ç¨‹åºå¯èƒ½éœ€è¦æ ¹æ®å½“å‰æ“ä½œçš„ä¸åŒè®¿é—®ä¸åŒçš„èµ„æºï¼Œè¿™äº›èµ„æºå¯¹ä¸åŒçš„ç”¨æˆ·æœ‰ä¸åŒçš„è®¿é—®æƒé™ã€‚é€šè¿‡åœ¨ç¨‹åºä¸­é€‚æ—¶åˆ‡æ¢ç”¨æˆ· IDï¼Œå¯ä»¥çµæ´»æ§åˆ¶èµ„æºè®¿é—®æƒé™ã€‚</p></li></ol><h3 id="å®é™…ä¾‹å­-4" tabindex="-1"><a class="header-anchor" href="#å®é™…ä¾‹å­-4"><span>å®é™…ä¾‹å­</span></a></h3><p>å‡è®¾ä½ çš„ Node.js åº”ç”¨éœ€è¦è¯»å–ä¸€ä¸ªç‰¹å®šçš„æ—¥å¿—æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åªæœ‰ root ç”¨æˆ·æ‰æœ‰æƒé™è®¿é—®ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°è¯•ä»¥å½“å‰ç”¨æˆ·èº«ä»½è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/root/only/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;File read successfully:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Failed to read file as normal user:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // åˆ‡æ¢åˆ°rootç”¨æˆ·</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">seteuid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;root&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/root/only/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;File read successfully as root:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å®Œæˆæ“ä½œåï¼Œè®°å¾—åˆ‡å›åŸæ¥çš„ç”¨æˆ·</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">seteuid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;normalUserId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Failed to read file as root:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œé¢‘ç¹åˆ‡æ¢ç”¨æˆ· ID å¯èƒ½ä¼šå¸¦æ¥å®‰å…¨é£é™©ï¼Œå› æ­¤åŠ¡å¿…ç¡®ä¿æ“ä½œçš„å¿…è¦æ€§ï¼Œå¹¶åœ¨æ“ä½œåç«‹å³å°† ID åˆ‡å›ã€‚åŒæ—¶ï¼Œå°½é‡é¿å…ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œç¨‹åºï¼Œé™¤éç»å¯¹å¿…è¦ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯<code>process.seteuid(id)</code>æ–¹æ³•çš„ç®€ä»‹å’Œä¸€äº›å®é™…è¿ç”¨åœºæ™¯ã€‚å¸Œæœ›è¿™å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼</p><h2 id="process-setgid-id" tabindex="-1"><a class="header-anchor" href="#process-setgid-id"><span><a href="https://nodejs.org/docs/latest/api/process.html#processsetgidid" target="_blank" rel="noopener noreferrer">process.setgid(id)</a></span></a></h2><p>ç†è§£ <code>process.setgid(id)</code> åœ¨ Node.js ä¸­çš„ä½œç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£å‡ ä¸ªæ¦‚å¿µï¼šè¿›ç¨‹ã€ç”¨æˆ·ç»„ï¼ˆGroup ID, GIDï¼‰ä»¥åŠä¸ºä½•è¦åœ¨ç¨‹åºä¸­æ”¹å˜ç”¨æˆ·ç»„ã€‚</p><ol><li><p><strong>è¿›ç¨‹</strong>ï¼šåœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹æ˜¯æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºçš„å®ä¾‹ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½è¿è¡Œåœ¨å…¶ç‰¹å®šçš„ã€ç‹¬ç«‹çš„ç¯å¢ƒä¸­ï¼Œè¿™åŒ…æ‹¬å†…å­˜ç©ºé—´ã€æ–‡ä»¶æè¿°ç¬¦ã€ç¯å¢ƒå˜é‡ç­‰ã€‚</p></li><li><p><strong>ç”¨æˆ·ç»„ï¼ˆGroup ID, GIDï¼‰</strong>ï¼šåœ¨ç±» Unix æ“ä½œç³»ç»Ÿä¸­ï¼ˆå¦‚ Linux æˆ– macOSï¼‰ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½å±äºä¸€ä¸ªæˆ–å¤šä¸ªâ€œç”¨æˆ·ç»„â€ã€‚ç”¨æˆ·ç»„å…è®¸ç³»ç»Ÿç®¡ç†å‘˜è®¾ç½®ä¸€ç»„ç”¨æˆ·ï¼Œå¹¶å¯¹è¿™ç»„ç”¨æˆ·ç»Ÿä¸€ç®¡ç†æƒé™ã€‚æ¯”å¦‚ï¼Œå¯ä»¥è®¾å®šæŸä¸ªæ–‡ä»¶åªèƒ½è¢«ç‰¹å®šç”¨æˆ·ç»„çš„æˆå‘˜è¯»å†™ã€‚</p></li><li><p><strong>æ”¹å˜ç”¨æˆ·ç»„çš„éœ€è¦</strong>ï¼šå½“ä¸€ä¸ª Node.js ç¨‹åºè¿è¡Œæ—¶ï¼Œå®ƒä¼šä»¥å¯åŠ¨è¯¥ç¨‹åºçš„ç”¨æˆ·èº«ä»½æ‰§è¡Œã€‚ä½†æœ‰æ—¶ï¼Œå‡ºäºå®‰å…¨æˆ–æƒé™ç®¡ç†çš„åŸå› ï¼Œæˆ‘ä»¬å¸Œæœ›ç¨‹åºéƒ¨åˆ†ä»£ç ä»¥ä¸åŒçš„ç”¨æˆ·ç»„æƒé™è¿è¡Œã€‚æ¯”å¦‚ï¼Œè®¿é—®æŸäº›å—é™åˆ¶çš„æ–‡ä»¶æ—¶ï¼Œå¯èƒ½éœ€è¦ä¸´æ—¶åˆ‡æ¢åˆ°å…·æœ‰é€‚å½“æƒé™çš„ç”¨æˆ·ç»„ã€‚</p></li></ol><p><code>process.setgid(id)</code> æ­£æ˜¯ç”¨äºè¿™ç§åœºæ™¯ï¼Œå®ƒå…è®¸ Node.js ç¨‹åºåŠ¨æ€åœ°æ”¹å˜å½“å‰è¿›ç¨‹çš„ç”¨æˆ·ç»„ IDã€‚é€šè¿‡è°ƒç”¨ <code>process.setgid(id)</code>ï¼Œç¨‹åºå¯ä»¥æå‡æˆ–é™ä½å…¶æƒé™ï¼Œä»¥ä¾¿å®‰å…¨åœ°æ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚</p><h3 id="å‚æ•°" tabindex="-1"><a class="header-anchor" href="#å‚æ•°"><span>å‚æ•°</span></a></h3><ul><li><code>id</code> å¯ä»¥æ˜¯æ•°å­— IDï¼ˆè¡¨ç¤ºç‰¹å®šç”¨æˆ·ç»„çš„ GIDï¼‰æˆ–å­—ç¬¦ä¸²ï¼ˆç”¨æˆ·ç»„çš„åç§°ï¼‰ã€‚Node.js å°†æ ¹æ®è¿™ä¸ªå‚æ•°ï¼Œå°†è¿›ç¨‹çš„ç”¨æˆ·ç»„ ID æ›´æ”¹ä¸ºç›¸åº”çš„å€¼ã€‚</li></ul><h3 id="ä½¿ç”¨ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç¤ºä¾‹-2"><span>ä½¿ç”¨ç¤ºä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js ç¨‹åºï¼Œéœ€è¦è®¿é—®ä¸€ä¸ªåªæœ‰<code>admin</code>ç”¨æˆ·ç»„æˆå‘˜æ‰èƒ½è¯»å†™çš„æ—¥å¿—æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å°è¯•ä»¥å½“å‰ç”¨æˆ·ç»„æƒé™è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/admin-only-file.log&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æ— æ³•ä»¥å½“å‰æƒé™è¯»å–æ–‡ä»¶:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // æ”¹å˜å½“å‰è¿›ç¨‹çš„ç”¨æˆ·ç»„IDä¸º&#39;admin&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setgid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;admin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æˆåŠŸåˆ‡æ¢åˆ°&#39;admin&#39;ç”¨æˆ·ç»„.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // ç°åœ¨å†æ¬¡å°è¯•è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    data</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/admin-only-file.log&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">innerError</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      &quot;å³ä½¿åˆ‡æ¢åˆ°&#39;admin&#39;ç”¨æˆ·ç»„ï¼Œä¹Ÿæ— æ³•è¯»å–æ–‡ä»¶:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      innerError</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ³¨æ„äº‹é¡¹-9" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-9"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>åˆ‡æ¢ç”¨æˆ·ç»„å¯èƒ½ä¼šå¼•èµ·å®‰å…¨é—®é¢˜ï¼Œç¡®ä¿ä»…åœ¨å¿…è¦æ—¶è¿›è¡Œï¼Œå¹¶ä¸”ä»”ç»†æ§åˆ¶æƒé™ã€‚</li><li>ä¸€æ—¦ä½¿ç”¨<code>setgid</code>åˆ‡æ¢äº†ç”¨æˆ·ç»„ï¼Œå¯èƒ½æ— æ³•å†åˆ‡å›åŸæ¥çš„ç”¨æˆ·ç»„ï¼Œé™¤éæœ‰è¶³å¤Ÿçš„æƒé™ã€‚</li><li>è¿™ä¸ªåŠŸèƒ½ä¸»è¦é’ˆå¯¹ç±» Unix ç³»ç»Ÿè®¾è®¡ï¼Œåœ¨ Windows ä¸Šçš„è¡Œä¸ºå¯èƒ½ä¸åŒã€‚</li></ul><p>é€šè¿‡ä»¥ä¸Šè§£é‡Šå’Œç¤ºä¾‹ï¼Œå¸Œæœ›ä½ å¯¹<code>process.setgid(id)</code>åœ¨ Node.js ä¸­çš„ä½œç”¨æœ‰äº†æ¸…æ™°çš„ç†è§£ã€‚</p><h2 id="process-setgroups-groups" tabindex="-1"><a class="header-anchor" href="#process-setgroups-groups"><span><a href="https://nodejs.org/docs/latest/api/process.html#processsetgroupsgroups" target="_blank" rel="noopener noreferrer">process.setgroups(groups)</a></span></a></h2><p>Node.js çš„ <code>process.setgroups(groups)</code> å‡½æ•°æ˜¯ä¸€ä¸ªé«˜çº§ç‰¹æ€§ï¼Œä¸»è¦ç”¨äºåœ¨ POSIX ç³»ç»Ÿï¼ˆå¦‚ Linux å’Œ macOSï¼‰ä¸Šè¿›è¡Œæ“ä½œã€‚è¿™ä¸ªå‡½æ•°å…è®¸ä½ è®¾ç½®ä¸€ä¸ªè¿›ç¨‹çš„è¡¥å……ç»„ IDã€‚ç®€è€Œè¨€ä¹‹ï¼Œå®ƒå¯ä»¥æ”¹å˜è¿è¡Œè¿›ç¨‹æ‰€å±çš„ç”¨æˆ·ç»„ã€‚</p><p>åœ¨ Unix å’Œç±» Unix ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½å±äºä¸€ä¸ªæˆ–å¤šä¸ªâ€œç»„â€ã€‚ç”¨æˆ·ç»„æ˜¯ä¸€ç§ç®¡ç†æƒé™çš„æ–¹å¼ï¼Œæ¯”å¦‚æ§åˆ¶å¯¹æ–‡ä»¶å’Œç›®å½•çš„è®¿é—®ã€‚æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªä¸»è¦çš„ç»„ï¼Œä½†åŒæ—¶ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–å¤šä¸ªç»„çš„æˆå‘˜ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç¨‹åºéœ€è¦ä»¥ä¸åŒçš„ç»„æƒé™è¿è¡Œï¼Œè¿™æ—¶ <code>process.setgroups()</code> å°±æ˜¾å¾—éå¸¸æœ‰ç”¨ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹-1"><span>ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª Node.js åº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨éœ€è¦è®¿é—®ç³»ç»Ÿä¸Šçš„å¤šä¸ªèµ„æºï¼Œè¿™äº›èµ„æºè¢«ä¸åŒçš„ç”¨æˆ·ç»„ç®¡ç†ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½éœ€è¦è¯»å–ä¸€äº›ç”± &quot;admin&quot; ç»„ç®¡ç†çš„æ—¥å¿—æ–‡ä»¶ï¼ŒåŒæ—¶è¿˜éœ€è¦è¯»å–å¦ä¸€äº›ç”± &quot;webusers&quot; ç»„ç®¡ç†çš„æ•°æ®æ–‡ä»¶ã€‚å¦‚æœä½ çš„ Node.js åº”ç”¨ä»¥ä¸€ä¸ªæ—¢ä¸å±äº &quot;admin&quot; ä¹Ÿä¸å±äº &quot;webusers&quot; ç»„çš„ç”¨æˆ·èº«ä»½è¿è¡Œï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå°†æ— æ³•è®¿é—®è¿™äº›æ–‡ä»¶ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>process.setgroups()</code> æ¥ä¸´æ—¶å°†ä½ çš„ Node.js è¿›ç¨‹æ·»åŠ åˆ°è¿™ä¸¤ä¸ªç»„ï¼Œä»è€Œè·å¾—å¿…è¦çš„è®¿é—®æƒé™ã€‚</p><h3 id="æ³¨æ„ç‚¹-1" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„ç‚¹-1"><span>æ³¨æ„ç‚¹</span></a></h3><ul><li><strong>æƒé™</strong>ï¼šåªæœ‰å…·æœ‰è¶…çº§ç”¨æˆ·æƒé™ï¼ˆroot ç”¨æˆ·ï¼‰çš„è¿›ç¨‹æ‰èƒ½è°ƒç”¨ <code>process.setgroups()</code>ã€‚æ™®é€šç”¨æˆ·ä¸èƒ½ä½¿ç”¨æ­¤åŠŸèƒ½ä¿®æ”¹è¿›ç¨‹çš„ç»„æˆå‘˜èµ„æ ¼ã€‚</li><li><strong>å¹³å°é™åˆ¶</strong>ï¼š<code>process.setgroups()</code> ä¸»è¦ç”¨äº POSIX å…¼å®¹ç³»ç»Ÿï¼Œå¦‚ Linux å’Œ macOSã€‚åœ¨ Windows ä¸Šï¼Œè¿™ä¸ªåŠŸèƒ½æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œå› æ­¤ä¸å¯ç”¨ã€‚</li></ul><h3 id="ç¤ºä¾‹ä»£ç -4" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä»£ç -4"><span>ç¤ºä¾‹ä»£ç </span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;process&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾ &#39;1000&#39; å’Œ &#39;1001&#39; åˆ†åˆ«æ˜¯ &#39;admin&#39; å’Œ &#39;webusers&#39; ç»„çš„ç»„ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setgroups</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1001</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;æˆåŠŸè®¾ç½®è¡¥å……ç»„ IDs.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è®¾ç½®è¡¥å……ç»„ IDs å¤±è´¥:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°è¯•å°†å½“å‰è¿›ç¨‹çš„è¡¥å……ç»„ ID è®¾ç½®ä¸ºä¸¤ä¸ªæŒ‡å®šçš„å€¼ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œå°±ä¼šæ‰“å°å‡ºæˆåŠŸæ¶ˆæ¯ï¼›å¦‚æœå¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œå› ä¸ºå½“å‰ç”¨æˆ·æ²¡æœ‰è¶³å¤Ÿçš„æƒé™ï¼‰ï¼Œåˆ™ä¼šæ•è·é”™è¯¯å¹¶æ˜¾ç¤ºã€‚</p><h3 id="ç»“è®º-5" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-5"><span>ç»“è®º</span></a></h3><p><code>process.setgroups(groups)</code> æ˜¯ Node.js ä¸­ä¸€ä¸ªå¼ºå¤§ä½†ä½¿ç”¨èŒƒå›´ç›¸å¯¹è¾ƒçª„çš„åŠŸèƒ½ã€‚å®ƒå…è®¸å¼€å‘è€…ä»¥æ›´ç»†è‡´çš„æ–¹å¼æ§åˆ¶åº”ç”¨ç¨‹åºçš„æƒé™ï¼Œé€‚ç”¨äºéœ€è¦ç²¾ç»†æƒé™ç®¡ç†çš„åœºåˆã€‚ç„¶è€Œï¼Œé‰´äºå…¶æ½œåœ¨çš„å®‰å…¨é£é™©å’Œå¹³å°é™åˆ¶ï¼Œå¼€å‘è€…åœ¨ä½¿ç”¨æ—¶éœ€è°¨æ…ï¼Œå¹¶ç¡®ä¿å……åˆ†ç†è§£å…¶èƒŒåçš„ç³»ç»ŸçŸ¥è¯†ã€‚</p><h2 id="process-setuid-id" tabindex="-1"><a class="header-anchor" href="#process-setuid-id"><span><a href="https://nodejs.org/docs/latest/api/process.html#processsetuidid" target="_blank" rel="noopener noreferrer">process.setuid(id)</a></span></a></h2><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„ <code>process.setuid(id)</code> å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®ºå¦‚ä½•å®‰å…¨åœ°æ”¹å˜ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹çš„ç”¨æˆ·æ ‡è¯†ï¼ˆå³ UIDï¼‰ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨æ¶‰åŠåˆ°ç³»ç»Ÿçº§åˆ«æ“ä½œã€æƒé™ç®¡ç†å’Œæé«˜å®‰å…¨æ€§æ–¹é¢éå¸¸é‡è¦ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¥ç®€å•çš„æ–¹å¼è§£é‡Šä»€ä¹ˆæ˜¯ UID å’Œä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æ›´æ”¹å®ƒã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-uid" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-uid"><span>ä»€ä¹ˆæ˜¯ UIDï¼Ÿ</span></a></h3><p>UID å³ç”¨æˆ·æ ‡è¯†ç¬¦ï¼ˆUser Identifierï¼‰ï¼Œåœ¨ Unix å’Œç±» Unix ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ UIDã€‚ç³»ç»Ÿä½¿ç”¨ UID è€Œä¸æ˜¯ç”¨æˆ·åæ¥æ ‡è¯†ç”¨æˆ·ï¼Œå› ä¸ºå¤„ç†æ•°å­—æ¯”å¤„ç†å­—ç¬¦ä¸²æ›´é«˜æ•ˆã€‚ç®¡ç†å‘˜çš„ UID é€šå¸¸æ˜¯ 0ï¼Œæ™®é€šç”¨æˆ·çš„ UID å¤§äº 0ã€‚</p><h3 id="ä¸ºä»€ä¹ˆéœ€è¦æ›´æ”¹-uid" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦æ›´æ”¹-uid"><span>ä¸ºä»€ä¹ˆéœ€è¦æ›´æ”¹ UIDï¼Ÿ</span></a></h3><p>åœ¨è¿è¡Œå…·æœ‰ä¸åŒçš„æƒé™éœ€æ±‚çš„ç¨‹åºæ—¶ï¼Œå¯èƒ½éœ€è¦ä¸´æ—¶æ›´æ”¹è¿›ç¨‹çš„ UIDã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„ç¨‹åºéœ€è¦è®¿é—®ä¸€äº›åªæœ‰ç‰¹å®šç”¨æˆ·æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œé‚£ä¹ˆç¨‹åºå°±éœ€è¦ä¸´æ—¶åˆ‡æ¢åˆ°é‚£ä¸ªç”¨æˆ·ã€‚å®Œæˆè®¿é—®åï¼Œæœ€å¥½å°† UID åˆ‡æ¢å›åŸæ¥çš„å€¼ï¼Œä»¥é¿å…å®‰å…¨é£é™©ã€‚</p><h3 id="ä½¿ç”¨-process-setuid-id" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-process-setuid-id"><span>ä½¿ç”¨ <code>process.setuid(id)</code></span></a></h3><p><code>process.setuid(id)</code> æ˜¯ Node.js æä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå…è®¸ä½ æ”¹å˜å½“å‰è¿›ç¨‹çš„ç”¨æˆ·æ ‡è¯†ã€‚è¿™ä¸ª <code>id</code> å¯ä»¥æ˜¯æ•°å­—å½¢å¼çš„ UID æˆ–è€…æ˜¯å­—ç¬¦ä¸²å½¢å¼çš„ç”¨æˆ·åã€‚</p><p><strong>æ³¨æ„ï¼š</strong> åªæœ‰å…·æœ‰ç®¡ç†å‘˜æƒé™ï¼ˆroot ç”¨æˆ·ï¼‰çš„è¿›ç¨‹æ‰èƒ½è°ƒç”¨æ­¤å‡½æ•°æˆåŠŸã€‚</p><h4 id="ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­"><span>ä¾‹å­</span></a></h4><p>ä¸‹é¢æ˜¯ä¸€äº› <code>process.setuid(id)</code> çš„ä½¿ç”¨ç¤ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬åœ¨ Node.js ç¯å¢ƒä¸‹è¿è¡Œã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼šæ ¹æ®ç”¨æˆ·åæ”¹å˜ UID</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾æˆ‘ä»¬è¦åˆ‡æ¢åˆ°ç”¨æˆ·åä¸º &quot;john&quot; çš„ç”¨æˆ·</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setuid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;john&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ–°çš„ UID: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getuid</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ›´æ”¹ UID å¤±è´¥: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç¤ºä¾‹ 2ï¼šæ ¹æ® UID æ”¹å˜</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾æˆ‘ä»¬çŸ¥é“ç”¨æˆ· &quot;john&quot; çš„ UID æ˜¯ 1001</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setuid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1001</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ–°çš„ UID: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getuid</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ›´æ”¹ UID å¤±è´¥: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨åœºæ™¯-6" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯-6"><span>ä½¿ç”¨åœºæ™¯</span></a></h3><ol><li><p><strong>æé«˜å®‰å…¨æ€§ï¼š</strong> å¦‚æœä½ çš„ Node.js åº”ç”¨éœ€è¦æš‚æ—¶ä»¥æ›´é«˜æƒé™è¿è¡Œï¼ˆæ¯”å¦‚è®¿é—®å—é™çš„ç³»ç»Ÿæ–‡ä»¶ï¼‰ï¼Œå¯ä»¥åœ¨éœ€è¦æ—¶æå‡æƒé™ï¼Œå¹¶åœ¨æ“ä½œå®Œæˆåç«‹å³é™ä½æƒé™ã€‚</p></li><li><p><strong>å¤šç”¨æˆ·åº”ç”¨ï¼š</strong> åœ¨ä¸€ä¸ªæ¶‰åŠåˆ°å¤šç”¨æˆ·èº«ä»½çš„åº”ç”¨ä¸­ï¼Œå¯èƒ½éœ€è¦ä»¥ä¸åŒçš„ç”¨æˆ·èº«ä»½æ‰§è¡Œä¸åŒçš„æ“ä½œæˆ–è®¿é—®ä¸åŒçš„èµ„æºã€‚</p></li></ol><h3 id="æ³¨æ„äº‹é¡¹-10" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-10"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>ä½¿ç”¨ <code>process.setuid()</code> éœ€è¦æ…é‡ï¼Œå› ä¸ºé”™è¯¯åœ°ä½¿ç”¨å®ƒå¯èƒ½ä¼šå¸¦æ¥å®‰å…¨é£é™©ã€‚</li><li>åœ¨æ›´æ”¹ UID åï¼Œç¡®ä¿åœ¨é€‚å½“çš„æ—¶å€™å°†å…¶æ›´æ”¹å›æ¥ï¼Œä»¥é¿å…ä»¥é«˜æƒé™çŠ¶æ€é•¿æ—¶é—´è¿è¡Œç¨‹åºã€‚</li><li>äº†è§£å¹¶éµå®ˆä½ æ“ä½œç³»ç»Ÿçš„å®‰å…¨ç­–ç•¥å’Œæœ€ä½³å®è·µã€‚</li></ul><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ<code>process.setuid(id)</code> æˆä¸º Node.js åº”ç”¨ä¸­ç®¡ç†è¿›ç¨‹æƒé™çš„ä¸€ä¸ªå¼ºå¤§å·¥å…·ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦ç»†ç²’åº¦æ§åˆ¶è¿›ç¨‹æƒé™æ—¶ã€‚</p><h2 id="process-setsourcemapsenabled-val" tabindex="-1"><a class="header-anchor" href="#process-setsourcemapsenabled-val"><span><a href="https://nodejs.org/docs/latest/api/process.html#processsetsourcemapsenabledval" target="_blank" rel="noopener noreferrer">process.setSourceMapsEnabled(val)</a></span></a></h2><p>å¥½çš„ï¼Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹<code>process.setSourceMapsEnabled(val)</code>åœ¨ Node.js ä¸­çš„ä½œç”¨ï¼Œå¹¶ç»™å‡ºä¸€äº›å®é™…åº”ç”¨çš„ä¾‹å­ã€‚</p><p>åœ¨ Node.js å¼€å‘è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šä½¿ç”¨åˆ°&quot;æºä»£ç æ˜ å°„&quot;(Source Maps)ã€‚ç®€å•æ¥è¯´ï¼Œæºä»£ç æ˜ å°„æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œå®ƒèƒ½å¤Ÿå°†ç¼–è¯‘ã€å‹ç¼©æˆ–è½¬æ¢åçš„ä»£ç æ˜ å°„å›åŸå§‹æºä»£ç ã€‚è¿™åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸ä½ çœ‹åˆ°é”™è¯¯å‘ç”Ÿæ—¶å®é™…çš„æºä»£ç è¡Œæ•°ï¼Œè€Œä¸æ˜¯è½¬æ¢åçš„ä»£ç è¡Œæ•°ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ ä½¿ç”¨ TypeScript æˆ– Babel å°†ç°ä»£ JavaScript ä»£ç è½¬æ¢ä¸ºè€ç‰ˆæœ¬çš„æµè§ˆå™¨ä¹Ÿèƒ½ç†è§£çš„å½¢å¼ï¼Œæˆ–è€…ä½¿ç”¨ Webpack ç­‰å·¥å…·å‹ç¼©ä½ çš„ä»£ç ï¼Œé‚£ä¹ˆå½“åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å‡ºç°é—®é¢˜éœ€è¦è°ƒè¯•æ—¶ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°éš¾ä»¥ç›´æ¥å®šä½åˆ°åŸå§‹ä»£ç çš„æƒ…å†µã€‚è¿™æ—¶å€™ï¼Œæºä»£ç æ˜ å°„æŠ€æœ¯å°±æ˜¾å¾—éå¸¸é‡è¦äº†ã€‚</p><p>åœ¨ Node.js v21.7.1 ä¸­ï¼Œ<code>process.setSourceMapsEnabled(val)</code>è¿™ä¸ª API å…è®¸ä½ åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°å¯ç”¨æˆ–ç¦ç”¨æºä»£ç æ˜ å°„çš„æ”¯æŒã€‚<code>val</code>æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œ<code>true</code>è¡¨ç¤ºå¯ç”¨æºä»£ç æ˜ å°„æ”¯æŒï¼Œ<code>false</code>åˆ™è¡¨ç¤ºç¦ç”¨ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-16" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-16"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>åŠ¨æ€å¼€å¯/å…³é—­æºä»£ç æ˜ å°„</strong></p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº† TypeScriptã€‚ä¸ºäº†æé«˜å¼€å‘æ•ˆç‡ï¼Œä½ å¯èƒ½å¸Œæœ›åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯ç”¨æºä»£ç æ˜ å°„ï¼Œä»¥ä¾¿èƒ½å¤Ÿå¿«é€Ÿå®šä½åˆ°é”™è¯¯æˆ–è°ƒè¯•ä¿¡æ¯å¯¹åº”çš„ TypeScript æ–‡ä»¶å’Œè¡Œå·ã€‚ä½†æ˜¯ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸ºäº†æ€§èƒ½è€ƒè™‘ï¼Œå¯èƒ½å¸Œæœ›ç¦ç”¨æºä»£ç æ˜ å°„ã€‚è¿™æ—¶å¯ä»¥æ ¹æ®ç¯å¢ƒå˜é‡åŠ¨æ€åœ°è°ƒç”¨<code>process.setSourceMapsEnabled()</code>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">NODE_ENV</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;development&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setSourceMapsEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setSourceMapsEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ¡ä»¶æ€§å¯ç”¨æºä»£ç æ˜ å°„</strong></p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½åªæƒ³åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹ï¼ˆæ¯”å¦‚ç‰¹å®šç”¨æˆ·çš„ä¼šè¯ã€ç‰¹å®šç±»å‹çš„é”™è¯¯å‘ç”Ÿæ—¶ï¼‰å¯ç”¨æºä»£ç æ˜ å°„ã€‚è¿™æ ·å¯ä»¥åšæ›´ç²¾ç»†åŒ–çš„æ§åˆ¶ï¼Œå‡å°‘ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™æ˜¯ä¸€ä¸ªé”™è¯¯å¤„ç†å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> handleError</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¦‚æœæ˜¯ç‰¹å®šç±»å‹çš„é”™è¯¯ï¼Œå¯ç”¨æºä»£ç æ˜ å°„ä»¥ä¾¿æ›´å®¹æ˜“åœ°è°ƒè¯•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> instanceof</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> MySpecificError</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setSourceMapsEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Special error occurred:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // å¤„ç†å®Œåå†å…³é—­ï¼Œé¿å…å½±å“æ€§èƒ½</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setSourceMapsEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;An error occurred:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>ä½¿ç”¨<code>process.setSourceMapsEnabled(val)</code>å¯ä»¥è®©æˆ‘ä»¬æ›´çµæ´»åœ°æ§åˆ¶æºä»£ç æ˜ å°„çš„å¯ç”¨ä¸ç¦ç”¨ï¼Œä»è€Œåœ¨ä¿è¯å¼€å‘è°ƒè¯•ä¾¿åˆ©æ€§çš„åŒæ—¶ï¼Œä¹Ÿèƒ½å…¼é¡¾ç”Ÿäº§ç¯å¢ƒçš„æ€§èƒ½éœ€æ±‚ã€‚</p><h2 id="process-setuncaughtexceptioncapturecallback-fn" tabindex="-1"><a class="header-anchor" href="#process-setuncaughtexceptioncapturecallback-fn"><span><a href="https://nodejs.org/docs/latest/api/process.html#processsetuncaughtexceptioncapturecallbackfn" target="_blank" rel="noopener noreferrer">process.setUncaughtExceptionCaptureCallback(fn)</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥æ·±å…¥ç†è§£ä¸€ä¸‹ Node.js ä¸­çš„ <code>process.setUncaughtExceptionCaptureCallback(fn)</code> å‡½æ•°ã€‚</p><p>é¦–å…ˆï¼Œè¦ææ˜ç™½è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¾—å…ˆäº†è§£ Node.js ä¸­çš„å¼‚å¸¸å¤„ç†ã€‚åœ¨ç¼–ç¨‹ä¸­ï¼Œ&quot;å¼‚å¸¸&quot;ï¼ˆErrorï¼‰æ˜¯æŒ‡ç¨‹åºæ‰§è¡Œæ—¶å‘ç”Ÿçš„ä¸æ­£å¸¸æƒ…å†µæˆ–é”™è¯¯ã€‚åœ¨ Node.js ç¯å¢ƒä¸‹ï¼Œå¦‚æœä½ çš„ä»£ç ä¸­å‡ºç°äº†ä¸€ä¸ªæœªè¢«æ•è·çš„å¼‚å¸¸ï¼ˆå³æ²¡æœ‰ç”¨ try...catch åŒ…è£¹ä½çš„é”™è¯¯ï¼‰ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒNode.js ä¼šæ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ï¼Œå¹¶é€€å‡ºç¨‹åºã€‚</p><p>ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½æƒ³è‡ªå®šä¹‰è¿™ç§æœªæ•è·å¼‚å¸¸çš„å¤„ç†æ–¹å¼ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—ã€æ¸…ç†èµ„æºç­‰ï¼Œè€Œä¸æ˜¯ç›´æ¥è®©ç¨‹åºé€€å‡ºã€‚è¿™å°±æ˜¯ <code>process.setUncaughtExceptionCaptureCallback(fn)</code> å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚</p><h3 id="è§£é‡Š-3" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-3"><span>è§£é‡Š</span></a></h3><p><code>process</code> æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›æœ‰å…³å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚<code>setUncaughtExceptionCaptureCallback(fn)</code> æ˜¯ <code>process</code> å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå…è®¸ä½ è®¾ç½®ä¸€ä¸ªå›è°ƒå‡½æ•° (<code>fn</code>)ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°ä¼šåœ¨æœªæ•è·çš„å¼‚å¸¸å‘ç”Ÿæ—¶è¢«è°ƒç”¨ã€‚</p><h3 id="å‚æ•°-1" tabindex="-1"><a class="header-anchor" href="#å‚æ•°-1"><span>å‚æ•°</span></a></h3><ul><li><code>fn</code>ï¼šä¸€ä¸ªå‡½æ•°ï¼Œå½“æœªæ•è·å¼‚å¸¸å‘ç”Ÿæ—¶ï¼Œæ­¤å‡½æ•°å°†è¢«è°ƒç”¨ã€‚å¦‚æœä½ ä¼ é€’ <code>null</code>ï¼Œå®ƒä¼šæ’¤é”€ä¹‹å‰è®¾ç½®çš„å›è°ƒã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-12" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-12"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><ol><li><p><strong>è®°å½•æ—¥å¿—å¹¶ä¼˜é›…é€€å‡º</strong></p><p>å‡è®¾ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œä½ å¸Œæœ›åœ¨æœªæ•è·çš„å¼‚å¸¸å‘ç”Ÿæ—¶è®°å½•é”™è¯¯ä¿¡æ¯åˆ°æ—¥å¿—æ–‡ä»¶ï¼Œå¹¶å°è¯•ä¼˜é›…åœ°å…³é—­æœåŠ¡å™¨ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // æ¨¡æ‹Ÿä¸€ä¸ªé”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Oops! Something went wrong.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setUncaughtExceptionCaptureCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">appendFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    &quot;error.log&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    `</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toISOString</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> - </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">err</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">stack</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">close</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Server running on port 3000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœè®¿é—® <code>/error</code> è·¯å¾„ï¼Œä¼šæ•…æ„æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚é€šè¿‡ <code>process.setUncaughtExceptionCaptureCallback()</code> è®¾ç½®çš„å›è°ƒå‡½æ•°ä¼šæ•è·è¿™ä¸ªå¼‚å¸¸ï¼Œå°†é”™è¯¯ä¿¡æ¯è¿½åŠ åˆ° <code>error.log</code> æ–‡ä»¶ï¼Œå¹¶å°è¯•å…³é—­æœåŠ¡å™¨ï¼Œæœ€åé€€å‡ºè¿›ç¨‹ã€‚</p></li><li><p><strong>å‘é€é”™è¯¯æŠ¥å‘Š</strong></p><p>åœ¨ä¸€ä¸ªæ›´å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œä½ å¯èƒ½å¸Œæœ›åœ¨æœªæ•è·å¼‚å¸¸å‘ç”Ÿæ—¶å‘é€é”™è¯¯æŠ¥å‘Šç»™å¼€å‘å›¢é˜Ÿï¼Œä»¥ä¾¿å¿«é€Ÿå“åº”å’Œä¿®å¤é—®é¢˜ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setUncaughtExceptionCaptureCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> sendErrorReport</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> sendErrorReport</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾è¿™ä¸ªå‡½æ•°å‘é€é”™è¯¯æŠ¥å‘Šåˆ°ä½ çš„é”™è¯¯è·Ÿè¸ªæœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Sending error report:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœªæ•è·å¼‚å¸¸ä¼šè§¦å‘å›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°è°ƒç”¨ <code>sendErrorReport</code> å°†é”™è¯¯ä¿¡æ¯å‘é€å‡ºå»ï¼Œç„¶åé€€å‡ºè¿›ç¨‹ã€‚</p></li></ol><h3 id="æ³¨æ„äº‹é¡¹-11" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-11"><span>æ³¨æ„äº‹é¡¹</span></a></h3><p>è™½ç„¶ä½¿ç”¨ <code>process.setUncaughtExceptionCaptureCallback(fn)</code> å¯ä»¥åœ¨é‡åˆ°æœªæ•è·å¼‚å¸¸æ—¶æ‰§è¡Œè‡ªå®šä¹‰æ“ä½œï¼Œä½†è¯·è®°ä½ï¼Œå½“ä½ çš„ç¨‹åºå¤„äºè¿™ç§çŠ¶æ€æ—¶ï¼Œå®ƒå¯èƒ½å·²ç»ä¸å†ç¨³å®šã€‚å› æ­¤ï¼Œæ¨èçš„åšæ³•æ˜¯åœ¨æ‰§è¡Œå¿…è¦çš„æ¸…ç†å·¥ä½œåï¼Œé‡å¯ç¨‹åºã€‚</p><h2 id="process-sourcemapsenabled" tabindex="-1"><a class="header-anchor" href="#process-sourcemapsenabled"><span><a href="https://nodejs.org/docs/latest/api/process.html#processsourcemapsenabled" target="_blank" rel="noopener noreferrer">process.sourceMapsEnabled</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥èŠèŠ Node.js ä¸­çš„ <code>process.sourceMapsEnabled</code>ã€‚</p><p>é¦–å…ˆï¼Œä¸ºäº†ç†è§£è¿™ä¸ªå±æ€§ï¼Œæˆ‘ä»¬å¾—å…ˆäº†è§£ä»€ä¹ˆæ˜¯ Source Mapsã€‚åœ¨ç¼–ç¨‹ä¸­ï¼Œå°¤å…¶æ˜¯å¤„ç† JavaScript æˆ– TypeScript è¿™æ ·çš„è¯­è¨€æ—¶ï¼Œå¼€å‘è€…å¾€å¾€ä¸ç›´æ¥åœ¨æµè§ˆå™¨ä¸Šè¿è¡Œä»–ä»¬åŸå§‹ç¼–å†™çš„ä»£ç ã€‚åŸå› æ˜¯ï¼Œå¼€å‘è€…å¯èƒ½ä¼šä½¿ç”¨ä¸€äº›ç°ä»£åŒ–å·¥å…·æ¥å¸®åŠ©ä»–ä»¬ç¼–å†™æ›´é«˜æ•ˆã€æ›´æ˜“äºç®¡ç†çš„ä»£ç ï¼Œæ¯”å¦‚ TypeScript æˆ–è€… Babelã€‚è¿™äº›å·¥å…·å¯ä»¥å°†å¼€å‘è€…ç¼–å†™çš„æºä»£ç è½¬æ¢ï¼ˆä¹Ÿå°±æ˜¯â€œç¼–è¯‘â€ï¼‰æˆæµè§ˆå™¨èƒ½å¤Ÿç†è§£å’Œæ‰§è¡Œçš„ JavaScript ä»£ç ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœä»£ç å‡ºé”™äº†ï¼Œé”™è¯¯ä¿¡æ¯å°†ä¼šæŒ‡å‘è½¬æ¢åçš„ä»£ç ï¼Œè€Œä¸æ˜¯å¼€å‘è€…æœ€åˆç¼–å†™çš„æºä»£ç ã€‚è¿™å°±æ˜¯ Source Maps å‘æŒ¥ä½œç”¨çš„åœ°æ–¹â€”â€”å®ƒä»¬å»ºç«‹äº†ä¸€ä¸ªæ˜ å°„å…³ç³»ï¼Œå…è®¸å¼€å‘è€…èƒ½å¤Ÿè¿½è¸ªå›ä»–ä»¬æœ€åˆç¼–å†™çš„ä»£ç è¡Œï¼Œå³ä¾¿æ˜¯åœ¨ä»£ç è¢«è½¬æ¢ä¹‹åã€‚</p><p>Node.js æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ã€‚éšç€ Node.js çš„åº”ç”¨å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œå¼€å‘è€…åœ¨ Node.js ç¯å¢ƒä¸‹ä¹Ÿå¼€å§‹ä½¿ç”¨ TypeScriptã€Babel ç­‰å·¥å…·ã€‚è¿™æ„å‘³ç€ Source Maps åœ¨ Node.js çš„ç¯å¢ƒä¸­ä¹Ÿå˜å¾—éå¸¸é‡è¦ã€‚</p><p>åœ¨ Node.js v21.7.1 ç‰ˆæœ¬ä¸­ï¼Œ<code>process.sourceMapsEnabled</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œç”¨æ¥è¡¨æ˜å½“å‰ Node.js è¿›ç¨‹æ˜¯å¦æ”¯æŒ Source Maps åŠŸèƒ½ã€‚ç®€å•è¯´ï¼Œå®ƒå‘Šè¯‰ä½ å½“å‰ Node.js ç¯å¢ƒæ˜¯å¦å¯ä»¥åˆ©ç”¨ Source Maps æ¥å¸®åŠ©å¼€å‘è€…è°ƒè¯•ä»–ä»¬çš„ä»£ç ã€‚</p><h3 id="å®é™…åº”ç”¨ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-5"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ä½¿ç”¨ TypeScript å¼€å‘ Node.js åº”ç”¨ã€‚TypeScript æ˜¯ä¸€ç§ JavaScript çš„è¶…é›†ï¼Œå®ƒæ·»åŠ äº†ç±»å‹ç³»ç»Ÿå’Œä¸€äº›å…¶ä»–ç‰¹æ€§ï¼Œä»¥å¸®åŠ©å¼€å‘å¤§å‹åº”ç”¨ã€‚ä½†æ˜¯ï¼ŒNode.js ä¸ç›´æ¥æ‰§è¡Œ TypeScript ä»£ç ï¼Œæ‰€ä»¥ä½ éœ€è¦å°† TypeScript ä»£ç ç¼–è¯‘æˆ JavaScriptã€‚</p><ol><li><p><strong>ç¼–å†™ TypeScript ä»£ç </strong>ï¼šä½ å†™äº†ä¸€æ®µ TypeScript ä»£ç ï¼Œä½¿ç”¨äº†ä¸€äº› TypeScript çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ç±»å‹æ³¨è§£ã€‚</p></li><li><p><strong>ç¼–è¯‘</strong>ï¼šä½¿ç”¨ TypeScript ç¼–è¯‘å™¨ï¼ˆé€šå¸¸æ˜¯é€šè¿‡å‘½ä»¤è¡Œè¿è¡Œ <code>tsc</code> å‘½ä»¤ï¼‰å°†ä½ çš„ä»£ç ç¼–è¯‘æˆ JavaScriptã€‚</p></li><li><p><strong>ç”Ÿæˆ Source Map</strong>ï¼šåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œä½ ä¼šè®©ç¼–è¯‘å™¨ç”Ÿæˆ Source Mapsã€‚è¿™äº› Source Maps åŒ…å«äº†ä»ç¼–è¯‘åçš„ JavaScript ä»£ç å›åˆ°ä½ åŸå§‹ TypeScript ä»£ç çš„ä¿¡æ¯ã€‚</p></li><li><p><strong>è¿è¡Œåº”ç”¨å¹¶è°ƒè¯•</strong>ï¼šå½“ä½ è¿è¡Œä½ çš„ Node.js åº”ç”¨å¹¶é‡åˆ°é”™è¯¯æ—¶ï¼Œå¦‚æœ <code>process.sourceMapsEnabled</code> ä¸º <code>true</code>ï¼ŒNode.js å¯ä»¥ä½¿ç”¨ Source Maps æ¥æ˜¾ç¤ºé”™è¯¯å‘ç”Ÿåœ¨ä½ çš„åŸå§‹ TypeScript ä»£ç çš„å“ªä¸€è¡Œï¼Œå³ä½¿é”™è¯¯å®é™…ä¸Šæ˜¯åœ¨ç¼–è¯‘åçš„ JavaScript ä»£ç ä¸­å‘ç”Ÿçš„ã€‚è¿™æå¤§åœ°ç®€åŒ–äº†è°ƒè¯•è¿‡ç¨‹ã€‚</p></li></ol><p>ç»¼ä¸Šæ‰€è¿°ï¼Œ<code>process.sourceMapsEnabled</code> åœ¨ Node.js ä¸­æ‰®æ¼”çš„è§’è‰²å°±æ˜¯å‘ŠçŸ¥å¼€å‘è€…æ˜¯å¦å¯ä»¥ä½¿ç”¨ Source Maps åŠŸèƒ½æ¥å¸®åŠ©è°ƒè¯•å’Œä¼˜åŒ–ä»–ä»¬çš„ä»£ç ã€‚è¿™å¯¹äºé‚£äº›ä½¿ç”¨ TypeScriptã€Babel æˆ–å…¶ä»–éœ€è¦ç¼–è¯‘æ­¥éª¤çš„ç°ä»£ JavaScript å·¥å…·çš„ Node.js å¼€å‘è€…æ¥è¯´æ˜¯ä¸€é¡¹éå¸¸æœ‰ç”¨çš„åŠŸèƒ½ã€‚</p><h2 id="process-stderr" tabindex="-1"><a class="header-anchor" href="#process-stderr"><span><a href="https://nodejs.org/docs/latest/api/process.html#processstderr" target="_blank" rel="noopener noreferrer">process.stderr</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ä¸€ä¸‹ <code>process.stderr</code> åœ¨ Node.js ä¸­çš„ä½œç”¨å’Œå®ƒçš„ä¸€äº›å®é™…åº”ç”¨åœºæ™¯ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-4" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-4"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code> æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚<code>process.stderr</code> æ˜¯ <code>process</code> å¯¹è±¡çš„å±æ€§ä¹‹ä¸€ï¼Œä»£è¡¨æ ‡å‡†é”™è¯¯æµï¼ˆstderrï¼‰ã€‚ç®€å•æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªè¾“å‡ºé€šé“ï¼Œå…è®¸ç¨‹åºå°†é”™è¯¯ä¿¡æ¯æˆ–è­¦å‘Šè¾“å‡ºåˆ°ç»ˆç«¯æˆ–è€…å…¶ä»–æŒ‡å®šçš„åœ°æ–¹ï¼Œä»¥ä¾¿äºè°ƒè¯•å’Œè®°å½•ã€‚</p><h3 id="ç†è§£-stderr" tabindex="-1"><a class="header-anchor" href="#ç†è§£-stderr"><span>ç†è§£ stderr</span></a></h3><p>åœ¨è®¡ç®—æœºä¸­ï¼Œæ ‡å‡†è¾“å‡ºæµï¼ˆstdoutï¼‰ä¸æ ‡å‡†é”™è¯¯æµï¼ˆstderrï¼‰æ˜¯ä¸¤ä¸ªä¸»è¦çš„è¾“å‡ºæ–¹å¼ã€‚stdout é€šå¸¸ç”¨äºè¾“å‡ºæ­£å¸¸çš„ç¨‹åºæ‰§è¡Œç»“æœï¼Œè€Œ stderr åˆ™ä¸“é—¨ç”¨æ¥è¾“å‡ºé”™è¯¯æˆ–è­¦å‘Šä¿¡æ¯ã€‚åˆ†å¼€è¿™ä¸¤ç§è¾“å‡ºå¯ä»¥è®©ç”¨æˆ·æˆ–å…¶ä»–ç¨‹åºæ›´å®¹æ˜“åœ°åŒºåˆ†æ­£å¸¸çš„è¾“å‡ºå’Œé”™è¯¯ä¿¡æ¯ï¼Œå¯¹äºæ—¥å¿—è®°å½•å’Œé—®é¢˜è¯Šæ–­å°¤å…¶æœ‰ç”¨ã€‚</p><h3 id="å®é™…è¿ç”¨-3" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-3"><span>å®é™…è¿ç”¨</span></a></h3><ol><li><strong>åŸºæœ¬é”™è¯¯æ—¥å¿—è®°å½•</strong>ï¼šæœ€ç›´æ¥çš„ç”¨é€”æ˜¯å°†é”™è¯¯ä¿¡æ¯å†™å…¥åˆ° stderrï¼Œè¿™æ¯”å†™å…¥åˆ° stdout æ›´åˆé€‚ï¼Œå› ä¸ºå®ƒä¸ä¼šä¸ä¸»è¦çš„ç¨‹åºè¾“å‡ºæ··æ·†ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">errorOccurred</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stderr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;é”™è¯¯ä¿¡æ¯: &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> errorMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><p><strong>ä¸æ–‡ä»¶ç³»ç»Ÿç»“åˆä½¿ç”¨</strong>ï¼šå¦‚æœä½ æƒ³æŠŠé”™è¯¯æ—¥å¿—ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œé‡å®šå‘ stderr åˆ°ä¸€ä¸ªæ–‡ä»¶ã€‚æ¯”å¦‚ï¼Œå½“ä½ è¿è¡Œä¸€ä¸ª Node.js åº”ç”¨æ—¶ï¼Œåœ¨ç»ˆç«¯ä¸­ä½¿ç”¨ <code>node app.js 2&gt; error.log</code>ï¼Œè¿™æ ·æ‰€æœ‰é€šè¿‡ <code>process.stderr.write()</code> è¾“å‡ºçš„ä¿¡æ¯éƒ½ä¼šè¢«å†™å…¥ <code>error.log</code> æ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚</p></li><li><p><strong>ä¸è°ƒè¯•å·¥å…·é…åˆ</strong>ï¼šåœ¨ä½¿ç”¨åƒæ˜¯ Visual Studio Code è¿™æ ·çš„é›†æˆå¼€å‘ç¯å¢ƒ(IDE)æ—¶ï¼Œ<code>process.stderr</code> çš„è¾“å‡ºå¯ä»¥ç›´æ¥åœ¨ IDE çš„è°ƒè¯•æ§åˆ¶å°ä¸­æ˜¾ç¤ºï¼Œæ–¹ä¾¿å¼€å‘è€…å³æ—¶çœ‹åˆ°é”™è¯¯æˆ–è­¦å‘Šä¿¡æ¯å¹¶è¿›è¡Œè°ƒè¯•ã€‚</p></li><li><p><strong>æ¡ä»¶å¼é”™è¯¯å¤„ç†</strong>ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½åªæƒ³åœ¨é‡åˆ°ç‰¹å®šç±»å‹çš„é”™è¯¯æ—¶æ‰è®°å½•æ—¥å¿—ã€‚é€šè¿‡æ£€æŸ¥é”™è¯¯ç±»å‹æˆ–æ¶ˆæ¯ï¼Œå¹¶ç»“åˆ <code>process.stderr</code> ä½¿ç”¨ï¼Œå¯ä»¥å®ç°æ›´ç»†ç²’åº¦çš„é”™è¯¯å¤„ç†ç­–ç•¥ã€‚</p></li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;ç‰¹å®šé”™è¯¯ç±»å‹&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stderr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;åªè®°å½•ç‰¹å®šç±»å‹çš„é”™è¯¯ä¿¡æ¯</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li><strong>è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰</strong>ï¼šåœ¨ä¸€äº›å¤æ‚çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œå¯èƒ½ä¼šæœ‰å¤šä¸ªè¿›ç¨‹ç›¸äº’åä½œã€‚é€šè¿‡æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰å’Œæ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰çš„åŒºåˆ†ï¼Œçˆ¶è¿›ç¨‹å¯ä»¥æ›´çµæ´»åœ°å¤„ç†æ¥è‡ªå­è¿›ç¨‹çš„æ­£å¸¸æ¶ˆæ¯å’Œé”™è¯¯æ¶ˆæ¯ã€‚</li></ol><h3 id="æ€»ç»“-24" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-24"><span>æ€»ç»“</span></a></h3><p><code>process.stderr</code> æ˜¯ Node.js æä¾›çš„ç”¨äºå¤„ç†é”™è¯¯è¾“å‡ºçš„é‡è¦æœºåˆ¶ã€‚é€šè¿‡å°†é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯ä»æ ‡å‡†è¾“å‡ºï¼ˆæ­£å¸¸ç¨‹åºè¿è¡Œçš„è¾“å‡ºï¼‰ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œå®ƒå¸®åŠ©å¼€å‘è€…æ›´æœ‰æ•ˆåœ°ç›‘æ§å’Œè°ƒè¯•ç¨‹åºã€‚æ— è®ºæ˜¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­å®æ—¶ç›‘æ§é”™è¯¯ï¼Œè¿˜æ˜¯å°†é”™è¯¯ä¿¡æ¯æŒä¹…åŒ–åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œ<code>process.stderr</code> éƒ½æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚ç†è§£å’ŒæŒæ¡å®ƒï¼Œå¯¹äºæé«˜ Node.js å¼€å‘å’Œè°ƒè¯•çš„æ•ˆç‡è‡³å…³é‡è¦ã€‚</p><h3 id="process-stderr-fd" tabindex="-1"><a class="header-anchor" href="#process-stderr-fd"><span><a href="https://nodejs.org/docs/latest/api/process.html#processstderrfd" target="_blank" rel="noopener noreferrer">process.stderr.fd</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process.stderr.fd</code>æ˜¯ä¸€ä¸ªå±æ€§ï¼Œç”¨æ¥è®¿é—®æ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰çš„æ–‡ä»¶æè¿°ç¬¦ã€‚åœ¨æ·±å…¥äº†è§£<code>process.stderr.fd</code>ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç®€å•è§£é‡Šä¸€äº›ç›¸å…³æ¦‚å¿µã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-2" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-2"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><ul><li><strong>Node.js</strong>ï¼šNode.js æ˜¯ä¸€ä¸ªå¼€æºã€è·¨å¹³å°çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå…è®¸ä½ åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚</li><li><strong>è¿›ç¨‹ï¼ˆProcessï¼‰</strong>ï¼šåœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºè¢«ç§°ä¸ºâ€œè¿›ç¨‹â€ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½ä¼šæœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´å’Œä¸€ç³»åˆ—èµ„æºã€‚</li><li><strong>æ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªè¾“å‡ºé€šé“ï¼Œå…è®¸ç¨‹åºå°†é”™è¯¯ä¿¡æ¯æˆ–è­¦å‘Šä¿¡æ¯è¾“å‡ºåˆ°ç»ˆç«¯æˆ–è€…å…¶ä»–è¾“å‡ºè®¾å¤‡ä¸Šã€‚åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒç”¨äºæ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ã€‚</li></ul><h3 id="process-stderr-fd-1" tabindex="-1"><a class="header-anchor" href="#process-stderr-fd-1"><span>process.stderr.fd</span></a></h3><ul><li><code>process.stderr</code> æ˜¯ Node.js ä¸­çš„å…¨å±€å¯¹è±¡ <code>process</code> çš„ä¸€ä¸ªå±æ€§ï¼Œä»£è¡¨ç€æ ‡å‡†é”™è¯¯è¾“å‡ºæµã€‚</li><li><code>.fd</code> æŒ‡çš„æ˜¯â€œæ–‡ä»¶æè¿°ç¬¦â€(File Descriptor)ã€‚åœ¨ Unix å’Œç±» Unix ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªéå¸¸åŸºæœ¬çš„æ¦‚å¿µï¼Œå®ƒæ˜¯ä¸€ä¸ªæŒ‡å‘æ‰“å¼€æ–‡ä»¶çš„ç´¢å¼•å·ï¼Œé€šè¿‡è¿™ä¸ªç´¢å¼•å·ï¼Œæ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¯†åˆ«å¹¶ç®¡ç†æ‰“å¼€çš„æ–‡ä»¶ã€‚å¯¹äºæ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰ã€æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰ã€æ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰ï¼Œç³»ç»Ÿåˆ†åˆ«é¢„ç•™äº†æ–‡ä»¶æè¿°ç¬¦ 0ã€1ã€2ã€‚</li><li>å› æ­¤ï¼Œ<code>process.stderr.fd</code> å®é™…ä¸Šå°±æ˜¯æ ‡å‡†é”™è¯¯æµçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œåœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªå€¼æ˜¯ 2ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-13" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-13"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><ol><li><strong>è°ƒè¯•</strong>: åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä½ å¯èƒ½ä¼šæƒ³æŠŠé”™è¯¯ä¿¡æ¯æˆ–è€…ä¸€äº›è°ƒè¯•ä¿¡æ¯è¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯æµä¸­ï¼Œä»¥ä¾¿åŒºåˆ†æ­£å¸¸çš„åº”ç”¨è¾“å‡ºå’Œé”™è¯¯æˆ–è°ƒè¯•ä¿¡æ¯ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">errorOccurred</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> errorMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;An error has occurred!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stderr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">errorMessage</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœå‘ç”Ÿäº†é”™è¯¯ï¼Œæˆ‘ä»¬æ„é€ äº†ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä½¿ç”¨<code>fs.writeSync</code>æ–¹æ³•ç›´æ¥é€šè¿‡<code>process.stderr.fd</code>å‘æ ‡å‡†é”™è¯¯è¾“å‡ºæµå†™å…¥é”™è¯¯ä¿¡æ¯ã€‚è¿™æ ·åšå¯ä»¥ç¡®ä¿å³ä½¿åœ¨æ­£å¸¸è¾“å‡ºï¼ˆstdoutï¼‰è¢«é‡å®šå‘çš„æƒ…å†µä¸‹ï¼Œé”™è¯¯ä¿¡æ¯ä»ç„¶èƒ½å¤Ÿè¢«æ­£ç¡®åœ°æ˜¾ç¤ºå‡ºæ¥ã€‚</p><ol start="2"><li><p><strong>æ—¥å¿—è®°å½•</strong>: å¯¹äºä¸€äº›éœ€è¦åŒæ—¶å¤„ç†æ­£å¸¸æ—¥å¿—å’Œé”™è¯¯æ—¥å¿—çš„åº”ç”¨ï¼Œä½ å¯ä»¥åˆ©ç”¨<code>process.stderr.fd</code>å’Œ<code>process.stdout.fd</code>æ¥åŒºåˆ†ä¸åŒç±»å‹çš„æ—¥å¿—ã€‚</p></li><li><p><strong>é«˜çº§é”™è¯¯å¤„ç†</strong>: åœ¨ä¸€äº›å¤æ‚çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œæ¯”å¦‚å¤šè¿›ç¨‹é€šä¿¡ï¼Œä½ å¯èƒ½éœ€è¦æ›´ç²¾ç¡®åœ°æ§åˆ¶é”™è¯¯ä¿¡æ¯çš„è¾“å‡ºã€‚é€šè¿‡ç›´æ¥æ“ä½œ<code>process.stderr.fd</code>ï¼Œä½ å¯ä»¥å®ç°ä¸€äº›é«˜çº§çš„é”™è¯¯å¤„ç†é€»è¾‘ï¼Œæ¯”å¦‚å°†é”™è¯¯ä¿¡æ¯é‡å®šå‘åˆ°æŸä¸ªç‰¹å®šçš„å¤„ç†ç¨‹åºæˆ–æ–‡ä»¶ä¸­ã€‚</p></li></ol><p>æ€»ç»“æ¥è¯´ï¼Œ<code>process.stderr.fd</code>æä¾›äº†ä¸€ç§ä½å±‚æ¬¡çš„æ¥å£æ¥æ“ä½œæ ‡å‡†é”™è¯¯è¾“å‡ºæµï¼Œè™½ç„¶å¤§éƒ¨åˆ†æ—¶å€™ä½ å¯èƒ½ä¸éœ€è¦ç›´æ¥ä½¿ç”¨å®ƒï¼Œä½†åœ¨éœ€è¦ç²¾ç»†æ§åˆ¶é”™è¯¯è¾“å‡ºçš„åœºæ™¯ä¸‹ï¼Œå®ƒæ˜¾å¾—éå¸¸æœ‰ç”¨ã€‚</p><h2 id="process-stdin" tabindex="-1"><a class="header-anchor" href="#process-stdin"><span><a href="https://nodejs.org/docs/latest/api/process.html#processstdin" target="_blank" rel="noopener noreferrer">process.stdin</a></span></a></h2><p>äº†è§£<code>process.stdin</code>ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç®€å•äº†è§£ä¸€ä¸‹ Node.js å’Œå®ƒæ˜¯ä»€ä¹ˆã€‚</p><p>Node.js æ˜¯ä¸€ä¸ªå¼€æºçš„ã€è·¨å¹³å°çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨ JavaScript æ¥ç¼–å†™æœåŠ¡å™¨ç«¯çš„ä»£ç ã€‚å®ƒé‡‡ç”¨äº†äº‹ä»¶é©±åŠ¨ã€éé˜»å¡ I/O æ¨¡å‹ä½¿å…¶è½»é‡åˆé«˜æ•ˆã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code>å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæä¾›äº†ä¸å½“å‰ Node.js è¿›ç¨‹äº’åŠ¨çš„æ¥å£ï¼Œæ— éœ€<code>require</code>å¯¼å…¥å°±å¯ä»¥ä½¿ç”¨ã€‚<code>process</code>å¯¹è±¡æœ‰å¾ˆå¤šå±æ€§å’Œæ–¹æ³•ï¼Œä»Šå¤©é‡ç‚¹ä»‹ç»å…¶ä¸­çš„<code>process.stdin</code>ã€‚</p><h3 id="process-stdin-1" tabindex="-1"><a class="header-anchor" href="#process-stdin-1"><span>process.stdin</span></a></h3><p>ç®€å•åœ°è¯´ï¼Œ<code>process.stdin</code>æ˜¯ä¸€ä¸ªæŒ‡å‘æ ‡å‡†è¾“å…¥æµ(stdin)çš„æµ(Stream)å¯è¯»å¯¹è±¡ã€‚&quot;æ ‡å‡†è¾“å…¥æµ&quot;è¿™ä¸ªæ¦‚å¿µæ¥è‡ªäº Unix/Linux ç¯å¢ƒï¼Œä½†å®ƒä¹Ÿé€‚ç”¨äº Windows ç­‰å…¶ä»–æ“ä½œç³»ç»Ÿã€‚å®ƒé€šå¸¸è¡¨ç¤ºç¨‹åºçš„è¾“å…¥æ•°æ®æ¥æºï¼Œå¦‚é”®ç›˜è¾“å…¥æˆ–å…¶ä»–ç¨‹åºçš„è¾“å‡ºã€‚</p><p><code>process.stdin</code>å…è®¸ Node.js ç¨‹åºä»æ ‡å‡†è¾“å…¥ï¼ˆä¾‹å¦‚å‘½ä»¤è¡Œç”¨æˆ·çš„é”®ç›˜è¾“å…¥ï¼‰æ¥æ”¶è¾“å…¥ã€‚å®ƒå®ç°äº† Node.js çš„<code>Stream</code>æ¥å£ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥åƒå¤„ç†å…¶ä»–æµæ•°æ®ä¸€æ ·æ¥å¤„ç†è¾“å…¥æ•°æ®ã€‚</p><h3 id="å®é™…åº”ç”¨ä¸¾ä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-1"><span>å®é™…åº”ç”¨ä¸¾ä¾‹</span></a></h3><h4 id="_1-è¯»å–ç”¨æˆ·è¾“å…¥" tabindex="-1"><a class="header-anchor" href="#_1-è¯»å–ç”¨æˆ·è¾“å…¥"><span>1. è¯»å–ç”¨æˆ·è¾“å…¥</span></a></h4><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨<code>process.stdin</code>è¯»å–ç”¨æˆ·åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥çš„æ•°æ®ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stdin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setEncoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;utf-8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®è¾“å…¥ç¼–ç ä¸ºutf-8</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;è¯·è¾“å…¥ä¸€äº›æ–‡æœ¬ï¼š&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stdin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readable&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨å¾ªç¯ç¡®ä¿æˆ‘ä»¬è¯»å–æ‰€æœ‰å¯ç”¨çš„æ•°æ®ã€‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  while</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ((</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunk</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stdin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">!==</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`ä½ è¾“å…¥çš„å†…å®¹æ˜¯: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">chunk</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stdin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;end&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ç»“æŸè¾“å…¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡<code>setEncoding</code>è®¾ç½®è¾“å…¥æµçš„ç¼–ç æ ¼å¼ã€‚æ¥ç€ï¼Œæˆ‘ä»¬é€šè¿‡ç›‘å¬<code>readable</code>äº‹ä»¶æ¥è¯»å–ç”¨æˆ·è¾“å…¥çš„å†…å®¹ï¼Œå¹¶ä¸”å½“è¾“å…¥æµç»“æŸæ—¶ï¼ˆå³ç”¨æˆ·æŒ‰ä¸‹<code>Ctrl+D</code>ï¼‰ï¼Œè§¦å‘<code>end</code>äº‹ä»¶ã€‚</p><h4 id="_2-ç»“åˆç®¡é“ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#_2-ç»“åˆç®¡é“ä½¿ç”¨"><span>2. ç»“åˆç®¡é“ä½¿ç”¨</span></a></h4><p>ä½ ä¹Ÿå¯ä»¥å°†<code>process.stdin</code>ä¸å…¶ä»–æµç›¸ç»“åˆï¼Œåˆ›å»ºæ›´åŠ å¤æ‚çš„è¾“å…¥å¤„ç†æµç¨‹ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥æŠŠä»æ ‡å‡†è¾“å…¥è¯»å–çš„æ•°æ®é€šè¿‡ç®¡é“ä¼ è¾“ç»™æ–‡ä»¶å†™å…¥æµï¼Œå®ç°æ•°æ®çš„è¯»å–ä¸ä¿å­˜ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¯å†™æµï¼Œå†™å…¥åˆ°output.txtæ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> writeStream</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createWriteStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;output.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å°†æ ‡å‡†è¾“å…¥æµç›´æ¥è¿æ¥åˆ°æ–‡ä»¶å†™å…¥æµ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stdin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">pipe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">writeStream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä»»ä½•ä»å‘½ä»¤è¡Œè¾“å…¥çš„æ•°æ®éƒ½ä¼šè¢«ç›´æ¥å†™å…¥åˆ°<code>output.txt</code>æ–‡ä»¶ä¸­ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ Node.js çš„æµæ§åˆ¶èƒ½åŠ›æ¥å¤„ç†æ•°æ®ã€‚</p><h3 id="å°ç»“-1" tabindex="-1"><a class="header-anchor" href="#å°ç»“-1"><span>å°ç»“</span></a></h3><p><code>process.stdin</code>æä¾›äº†ä¸€ç§æœºåˆ¶æ¥æ¥æ”¶ç”¨æˆ·çš„å‘½ä»¤è¡Œè¾“å…¥ï¼Œä½¿å¾— Node.js ç¨‹åºèƒ½å¤Ÿä»¥äº¤äº’æ–¹å¼æ‰§è¡Œæˆ–å¤„ç†æ¥è‡ªå…¶ä»–ç¨‹åºçš„æ•°æ®æµã€‚é€šè¿‡ç†è§£å’Œä½¿ç”¨<code>process.stdin</code>ï¼Œä½ å¯ä»¥æ„å»ºå‡ºæ›´ä¸ºå¤æ‚å’Œå¼ºå¤§çš„ Node.js åº”ç”¨ç¨‹åºã€‚</p><h3 id="process-stdin-fd" tabindex="-1"><a class="header-anchor" href="#process-stdin-fd"><span><a href="https://nodejs.org/docs/latest/api/process.html#processstdinfd" target="_blank" rel="noopener noreferrer">process.stdin.fd</a></span></a></h3><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå…è®¸åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ JavaScript ä»£ç ã€‚äº†è§£ Node.js ä¸­çš„ <code>process</code> å¯¹è±¡å¯¹äºæŒæ¡ Node.js ç¼–ç¨‹è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹äº¤äº’çš„æ¥å£ã€‚</p><p>åœ¨ Node.js ä¸­ï¼Œ<code>process.stdin.fd</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒä»£è¡¨äº†â€œæ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰â€çš„æ–‡ä»¶æè¿°ç¬¦ã€‚åœ¨è®¡ç®—æœºä¸­ï¼Œæ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå®ƒå”¯ä¸€åœ°æ ‡è¯†äº†è¿›ç¨‹ä¸­æ‰“å¼€çš„æ–‡ä»¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ä¸ªç‰¹å®šçš„æ–‡ä»¶æè¿°ç¬¦å¼•ç”¨çš„æ˜¯æ ‡å‡†è¾“å…¥æµï¼Œè¿™é€šå¸¸ä¸é”®ç›˜è¾“å…¥ç›¸å…³è”ã€‚</p><h3 id="ç†è§£æ ‡å‡†è¾“å…¥-stdin" tabindex="-1"><a class="header-anchor" href="#ç†è§£æ ‡å‡†è¾“å…¥-stdin"><span>ç†è§£æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰</span></a></h3><p>åœ¨ Unix å’Œç±» Unix ç³»ç»Ÿï¼ˆåŒ…æ‹¬ Linux å’Œ macOSï¼‰ä¸­ï¼Œæ¯ä¸ªè¿è¡Œçš„è¿›ç¨‹éƒ½è¢«èµ‹äºˆä¸‰ä¸ªåŸºæœ¬çš„æ–‡ä»¶æè¿°ç¬¦ï¼š</p><ol><li><strong>æ ‡å‡†è¾“å…¥ï¼ˆstdin, 0ï¼‰</strong>ï¼šé€šå¸¸ç”¨äºè¯»å–è¾“å…¥ã€‚</li><li><strong>æ ‡å‡†è¾“å‡ºï¼ˆstdout, 1ï¼‰</strong>ï¼šé€šå¸¸ç”¨äºè¾“å‡ºä¿¡æ¯ã€‚</li><li><strong>æ ‡å‡†é”™è¯¯ï¼ˆstderr, 2ï¼‰</strong>ï¼šé€šå¸¸ç”¨äºè¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚</li></ol><p><code>process.stdin.fd</code> æ­£å¥½å¯¹åº”äºæ ‡å‡†è¾“å…¥çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå…¶å€¼é€šå¸¸æ˜¯ <code>0</code>ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹"><span>ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹</span></a></h3><p>å°½ç®¡ç›´æ¥ä½¿ç”¨ <code>process.stdin.fd</code> çš„åœºæ™¯è¾ƒå°‘ï¼ˆå› ä¸º Node.js æä¾›äº†æ›´é«˜çº§åˆ«çš„ API æ¥å¤„ç†è¾“å…¥å’Œè¾“å‡ºï¼‰ï¼Œä½†äº†è§£å®ƒçš„å­˜åœ¨å¯¹äºç†è§£åº•å±‚æ¦‚å¿µå¾ˆæœ‰å¸®åŠ©ã€‚</p><p>ä¸€ä¸ªå¯èƒ½æ¶‰åŠåˆ°ç›´æ¥ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦çš„åœºæ™¯æ˜¯ä¸åº•å±‚ç³»ç»Ÿè°ƒç”¨æˆ–ç‰¹å®šçš„åº“äº¤äº’ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ éœ€è¦ä½¿ç”¨ <code>fs</code> æ¨¡å—çš„æŸäº›æ–¹æ³•ç›´æ¥æ“ä½œæ ‡å‡†è¾“å…¥æµï¼Œä½ å¯èƒ½ä¼šæ‰¾åˆ° <code>process.stdin.fd</code> çš„ä½¿ç”¨åœºæ™¯ã€‚</p><h4 id="ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3"><span>ç¤ºä¾‹</span></a></h4><p>å‡è®¾æˆ‘ä»¬æƒ³ç›´æ¥ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ï¼Œå¹¶ä½¿ç”¨ <code>fs.read</code> æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ <code>process.stdin</code> æä¾›çš„é«˜çº§æ¥å£ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 1024 å­—èŠ‚çš„ç¼“å†²åŒº</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç›´æ¥ä½¿ç”¨ process.stdin.fd è¯»å–æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stdin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  null</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">bytesRead</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Error reading from stdin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Read </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">bytesRead</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bytes from stdin:`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤ä»£ç ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ç›´æ¥åˆ©ç”¨ <code>process.stdin.fd</code> æ¥è¯»å–æ ‡å‡†è¾“å…¥ã€‚å®ƒåˆ›å»ºäº†ä¸€ä¸ªç¼“å†²åŒºï¼Œç„¶åä½¿ç”¨ <code>fs.read</code> æ–¹æ³•ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®åˆ°è¯¥ç¼“å†²åŒºä¸­ã€‚æ³¨æ„ï¼Œè¿™ç§æ–¹å¼ç›¸æ¯”äºä½¿ç”¨ <code>process.stdin</code> çš„äº‹ä»¶ç›‘å¬æ–¹å¼æ¥è¯´æ›´ä¸ºåº•å±‚å’Œå¤æ‚ï¼Œé€šå¸¸ä¸æ¨èç”¨äºæ—¥å¸¸çš„ Node.js å¼€å‘ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œè™½ç„¶ç›´æ¥ä½¿ç”¨ <code>process.stdin.fd</code> çš„æƒ…å†µè¾ƒä¸ºç½•è§ï¼Œäº†è§£å…¶èƒŒåçš„æ¦‚å¿µæœ‰åŠ©äºæ·±å…¥ç†è§£ Node.js å¦‚ä½•ä¸åº•å±‚ç³»ç»Ÿäº¤äº’ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå»ºè®®ä½¿ç”¨ Node.js æä¾›çš„æ›´é«˜çº§çš„æ ‡å‡†è¾“å…¥è¾“å‡ºå¤„ç†æ–¹å¼ï¼Œä¾‹å¦‚é€šè¿‡ç›‘å¬ <code>process.stdin</code> ä¸Šçš„ <code>&#39;data&#39;</code> äº‹ä»¶æ¥è¯»å–è¾“å…¥ã€‚</p><h2 id="process-stdout" tabindex="-1"><a class="header-anchor" href="#process-stdout"><span><a href="https://nodejs.org/docs/latest/api/process.html#processstdout" target="_blank" rel="noopener noreferrer">process.stdout</a></span></a></h2><p>åœ¨ Node.js ä¸­ï¼Œ<code>process.stdout</code> æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç»„ä»¶ï¼Œå®ƒä»£è¡¨ç€è¿›ç¨‹çš„æ ‡å‡†è¾“å‡ºæµã€‚ç®€å•æ¥è¯´ï¼Œè¿™å°±æ˜¯ä½ ç¨‹åºå‘å¤–ç•Œå±•ç¤ºä¿¡æ¯çš„ä¸€ç§æ–¹å¼ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå½“ä½ åœ¨å‘½ä»¤è¡Œè¿è¡Œä¸€ä¸ªç¨‹åºæ—¶ï¼Œæ‰€æœ‰æ‰“å°åˆ°å±å¹•ä¸Šçš„å†…å®¹éƒ½æ˜¯é€šè¿‡æ ‡å‡†è¾“å‡ºæµå‘å‡ºçš„ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ-5" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ-5"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><ul><li><strong>è¿›ç¨‹ï¼ˆProcessï¼‰</strong>ï¼šæ¯æ¬¡ä½ è¿è¡Œä¸€ä¸ª Node.js ç¨‹åºæ—¶ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªè¿›ç¨‹ã€‚è¿™ä¸ªè¿›ç¨‹å¯ä»¥æ‰§è¡Œä»£ç ï¼Œè®¿é—®èµ„æºï¼Œè¿›è¡Œè®¡ç®—ç­‰ã€‚</li><li><strong>æ ‡å‡†è¾“å‡ºæµï¼ˆStandard Output Streamï¼Œstdoutï¼‰</strong>ï¼šè¿™æ˜¯è¿›ç¨‹ä¸å¤–ç•Œäº¤æµçš„ç®¡é“ä¹‹ä¸€ï¼Œä¸»è¦ç”¨äºè¾“å‡ºä¿¡æ¯ã€‚</li></ul><h3 id="ä¸ºä»€ä¹ˆéœ€è¦process-stdout" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦process-stdout"><span>ä¸ºä»€ä¹ˆéœ€è¦<code>process.stdout</code>?</span></a></h3><p>åœ¨ç¼–ç¨‹ä¸­ï¼Œé€šå¸¸æœ‰éœ€è¦æŠŠä¿¡æ¯åé¦ˆç»™ç”¨æˆ·æˆ–è€…è°ƒè¯•ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨<code>process.stdout</code>ã€‚ä¸å…¶å®ƒæ—¥å¿—è®°å½•æˆ–è€…æ•°æ®è¾“å‡ºæ–¹å¼ç›¸æ¯”ï¼Œç›´æ¥ä½¿ç”¨<code>process.stdout</code>æœ‰æ—¶æ›´ä¸ºç›´æ¥å’Œé«˜æ•ˆã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨process-stdout" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨process-stdout"><span>å¦‚ä½•ä½¿ç”¨<code>process.stdout</code>?</span></a></h3><p>åœ¨ Node.js é‡Œï¼Œä½ å¯ä»¥ç®€å•åœ°ä½¿ç”¨<code>console.log</code>æ¥å‘é€ä¿¡æ¯åˆ°<code>process.stdout</code>ï¼Œä½†å¦‚æœä½ æƒ³æ›´ç›´æ¥åœ°æ§åˆ¶è¾“å‡ºï¼Œæˆ–é¿å…<code>console.log</code>å¸¦æ¥çš„é¢å¤–å¼€é”€ï¼ˆæ¯”å¦‚è‡ªåŠ¨æ·»åŠ æ¢è¡Œç¬¦ï¼‰ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨<code>process.stdout.write()</code>ã€‚</p><h4 id="ç¤ºä¾‹-1-ä½¿ç”¨console-log" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ä½¿ç”¨console-log"><span>ç¤ºä¾‹ 1: ä½¿ç”¨<code>console.log</code></span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç åœ¨æ§åˆ¶å°è¾“å‡º&quot;Hello, World!&quot;ã€‚å®é™…ä¸Šï¼Œè¿™èƒŒåå°±æ˜¯<code>process.stdout.write</code>çš„å°è£…ï¼Œå¹¶ä¸”é™„åŠ äº†ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚</p><h4 id="ç¤ºä¾‹-2-ç›´æ¥ä½¿ç”¨process-stdout-write" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ç›´æ¥ä½¿ç”¨process-stdout-write"><span>ç¤ºä¾‹ 2: ç›´æ¥ä½¿ç”¨<code>process.stdout.write()</code></span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">stdout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, World!</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™é‡Œç›´æ¥ä½¿ç”¨<code>process.stdout.write()</code>æ–¹æ³•è¾“å‡ºä¿¡æ¯ã€‚æ³¨æ„ï¼Œè¿™é‡Œæ‰‹åŠ¨æ·»åŠ äº†<code>\n</code>æ¥æ¢è¡Œï¼Œå› ä¸º<code>process.stdout.write</code>ä¸ä¼šè‡ªåŠ¨æ·»åŠ æ¢è¡Œç¬¦ã€‚</p><h3 id="å®é™…åº”ç”¨åœºæ™¯-3" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨åœºæ™¯-3"><span>å®é™…åº”ç”¨åœºæ™¯</span></a></h3><ol><li><p><strong>åˆ›å»º CLI (å‘½ä»¤è¡Œç•Œé¢) åº”ç”¨</strong>ï¼š<br> å¦‚æœä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª CLI å·¥å…·ï¼Œä½ å¯èƒ½éœ€è¦å‘ç”¨æˆ·æ˜¾ç¤ºå„ç§ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ¬¢è¿æ¶ˆæ¯ã€é”™è¯¯ä¿¡æ¯ã€å¤„ç†ç»“æœç­‰ã€‚è¿™æ—¶å€™ï¼Œç›´æ¥æ“ä½œ<code>process.stdout</code>èƒ½å¤Ÿç»™ä½ æ›´å¤šçš„æ§åˆ¶æƒã€‚</p></li><li><p><strong>äº¤äº’å¼å‘½ä»¤è¡Œå·¥å…·</strong>ï¼š<br> å¯¹äºéœ€è¦ä¸ç”¨æˆ·äº¤äº’çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¦‚è¯»å–ç”¨æˆ·è¾“å…¥å¹¶å³æ—¶åé¦ˆçš„æƒ…å†µï¼Œä½¿ç”¨<code>process.stdout.write</code>ç»“åˆ<code>process.stdin</code>ï¼ˆæ ‡å‡†è¾“å…¥æµï¼‰å¯ä»¥æ„å»ºå‡ºæµç•…çš„ç”¨æˆ·äº¤äº’ä½“éªŒã€‚</p></li><li><p><strong>è¿›åº¦æ¡æ˜¾ç¤º</strong>ï¼š<br> åœ¨ä¸€äº›é•¿æ—¶é—´è¿è¡Œçš„å‘½ä»¤æˆ–è„šæœ¬ä¸­ï¼Œä½¿ç”¨<code>process.stdout.write</code>æ¥æ›´æ–°åŒä¸€è¡Œçš„å†…å®¹ï¼Œå¯ä»¥ç”¨æ¥æ˜¾ç¤ºä¸€ä¸ªåŠ¨æ€çš„è¿›åº¦æ¡ï¼Œè¿™æ¯”æ‰“å°è®¸å¤šè¡Œè¿›åº¦æ›´æ–°è¦æ•´æ´å¾—å¤šã€‚</p></li></ol><p>é€šè¿‡ä»¥ä¸Šç¤ºä¾‹å’Œåº”ç”¨åœºæ™¯ï¼Œä½ åº”è¯¥å¯¹<code>process.stdout</code>æœ‰äº†åŸºæœ¬çš„äº†è§£ã€‚è®°ä½ï¼Œè™½ç„¶<code>console.log</code>åœ¨è®¸å¤šæƒ…å†µä¸‹è¶³å¤Ÿä½¿ç”¨ï¼Œä½†ç›´æ¥æ“ä½œ<code>process.stdout</code>å¯ä»¥ä¸ºç‰¹å®šéœ€æ±‚æä¾›æ›´ç»†è‡´çš„æ§åˆ¶ã€‚</p><h3 id="process-stdout-fd" tabindex="-1"><a class="header-anchor" href="#process-stdout-fd"><span><a href="https://nodejs.org/docs/latest/api/process.html#processstdoutfd" target="_blank" rel="noopener noreferrer">process.stdout.fd</a></span></a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥ç†è§£è¿™ä¸ªæ¦‚å¿µã€‚</p><p>é¦–å…ˆï¼Œ<code>Node.js</code>æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ã€‚åœ¨è¿™ä¸ªç¯å¢ƒä¸­ï¼Œä½ å¯ä»¥åˆ©ç”¨ JavaScript åšå¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ã€æ­å»ºæœåŠ¡å™¨ç­‰ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯process-stdout-fd" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯process-stdout-fd"><span>ä»€ä¹ˆæ˜¯<code>process.stdout.fd</code>?</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code>æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„ç›¸å…³ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚å…¶ä¸­çš„<code>stdout</code>å±æ€§ä»£è¡¨äº†æ ‡å‡†è¾“å‡ºæµï¼ˆstandard outputï¼‰ï¼Œä¹Ÿå°±æ˜¯é€šå¸¸æƒ…å†µä¸‹æ˜¾ç¤ºåœ¨ç»ˆç«¯æˆ–è€…å‘½ä»¤è¡Œç•Œé¢ä¸Šçš„å†…å®¹ã€‚</p><p><code>fd</code>æ˜¯â€œfile descriptorâ€çš„ç®€ç§°ï¼Œå³æ–‡ä»¶æè¿°ç¬¦ã€‚æ¯ä¸ªæ‰“å¼€çš„æ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå®ƒæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åœ¨ UNIX å’Œç±» UNIX æ“ä½œç³»ç»Ÿä¸­ï¼Œæ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰ã€æ ‡å‡†è¾“å‡º(stdout)å’Œæ ‡å‡†é”™è¯¯(stderr)åˆ†åˆ«è¢«åˆ†é…äº†ä¸‰ä¸ªå›ºå®šçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œåˆ†åˆ«æ˜¯ 0ã€1 å’Œ 2ã€‚</p><p>å› æ­¤ï¼Œ<code>process.stdout.fd</code>å°±æ˜¯æ ‡å‡†è¾“å‡ºæµçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå…¶å€¼ä¸º 1ã€‚</p><h3 id="å®é™…åº”ç”¨ä¸¾ä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¸¾ä¾‹-2"><span>å®é™…åº”ç”¨ä¸¾ä¾‹</span></a></h3><ol><li><p><strong>äº†è§£è¿è¡Œç¯å¢ƒ</strong></p><p>åœ¨è¿›è¡ŒæŸäº›åº•å±‚æ“ä½œæˆ–è€…ä¸æ“ä½œç³»ç»Ÿäº¤äº’æ—¶ï¼Œäº†è§£å½“å‰çš„æ ‡å‡†è¾“å‡ºæ–‡ä»¶æè¿°ç¬¦å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ï¼Œå°½ç®¡ç›´æ¥ä½¿ç”¨<code>process.stdout</code>è¿›è¡Œè¾“å‡ºæ›´ä¸ºå¸¸è§ã€‚</p></li><li><p><strong>ä½çº§æ“ä½œ</strong></p><p>å¦‚æœä½ æ­£åœ¨ç¼–å†™æ›´æ¥è¿‘ç³»ç»Ÿè°ƒç”¨çš„ä»£ç ï¼Œæ¯”å¦‚ç›´æ¥ä¸æ“ä½œç³»ç»Ÿçš„ API äº¤äº’ï¼ŒçŸ¥é“æ ‡å‡†è¾“å‡ºçš„æ–‡ä»¶æè¿°ç¬¦å¯èƒ½æ˜¯å¿…è¦çš„ã€‚ä¸è¿‡ï¼Œå¯¹äºå¤§éƒ¨åˆ†é«˜å±‚æ¬¡çš„ Node.js ç¼–ç¨‹è€Œè¨€ï¼Œè¿™ç§éœ€è¦å¹¶ä¸å¸¸è§ã€‚</p></li><li><p><strong>å…¼å®¹æ€§æ£€æŸ¥</strong></p><p>åœ¨ä¸€äº›ç‰¹æ®Šåœºæ™¯ä¸‹ï¼Œäº†è§£æ˜¯å¦èƒ½è·å–åˆ°æœ‰æ•ˆçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œæˆ–è€…æ£€æŸ¥<code>process.stdout.fd</code>çš„å€¼æ˜¯å¦ç¬¦åˆé¢„æœŸï¼ˆä¾‹å¦‚ï¼Œæ˜¯å¦ç­‰äº 1ï¼‰ï¼Œå¯èƒ½å¯¹äºç¡®ä¿ç¨‹åºæ­£ç¡®è¿è¡Œåœ¨ä¸åŒç¯å¢ƒä¸‹æœ‰æ‰€å¸®åŠ©ã€‚</p></li><li><p><strong>é«˜çº§æ—¥å¿—è®°å½•å·¥å…·</strong></p><p>å¦‚æœä½ æ­£åœ¨æ„å»ºä¸€ä¸ªå¤æ‚çš„æ—¥å¿—è®°å½•å·¥å…·ï¼Œè¯¥å·¥å…·éœ€è¦ç›´æ¥ç®¡ç†å’Œæ“ä½œåº•å±‚çš„è¾“å‡ºæµï¼ˆè€Œä¸åªæ˜¯é€šè¿‡<code>console.log</code>è¿™æ ·çš„é«˜çº§ APIï¼‰ï¼Œé‚£ä¹ˆäº†è§£å’Œä½¿ç”¨<code>process.stdout.fd</code>å¯èƒ½æ˜¯æœ‰ç›Šçš„ã€‚</p></li></ol><h3 id="ç»“è®º-6" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-6"><span>ç»“è®º</span></a></h3><p>è™½ç„¶å¯¹äºå¤§å¤šæ•°æ—¥å¸¸çš„ Node.js å¼€å‘ä»»åŠ¡è€Œè¨€ï¼Œç›´æ¥ä½¿ç”¨<code>process.stdout</code>æˆ–å…¶ä»–æ›´é«˜çº§çš„æ—¥å¿—å’Œè¾“å‡ºæœºåˆ¶å°±å·²ç»è¶³å¤Ÿï¼Œä½†åœ¨éœ€è¦è¿›è¡Œåº•å±‚æ“ä½œæˆ–ä¼˜åŒ–æ—¶ï¼Œäº†è§£<code>process.stdout.fd</code>åŠå…¶ä½œç”¨æ˜¯å¾ˆæœ‰ä»·å€¼çš„ã€‚å®ƒæ˜¯è¿æ¥ Node.js ä¸æ“ä½œç³»ç»Ÿåº•å±‚çš„ä¼—å¤šæ¡¥æ¢ä¹‹ä¸€ï¼Œäº†è§£å®ƒå¯ä»¥å¸®åŠ©ä½ æ›´æ·±å…¥åœ°ç†è§£ Node.js çš„å·¥ä½œåŸç†ã€‚</p><h3 id="a-note-on-process-i-o" tabindex="-1"><a class="header-anchor" href="#a-note-on-process-i-o"><span><a href="https://nodejs.org/docs/latest/api/process.html#a-note-on-process-io" target="_blank" rel="noopener noreferrer">A note on process I/O</a></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code>å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œå…è®¸ä½ ä¸å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹äº’åŠ¨ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—å±æ€§å’Œæ–¹æ³•ç”¨äºå¤„ç†è¿›ç¨‹ç›¸å…³çš„ä»»åŠ¡ï¼Œæ¯”å¦‚è¾“å‡ºä¿¡æ¯åˆ°æ§åˆ¶å°ã€è¯»å–ç¯å¢ƒå˜é‡ã€ç®¡ç†è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸç­‰ã€‚</p><p>å½“æˆ‘ä»¬è°ˆåˆ°&quot;process I/O&quot;æ—¶ï¼Œæˆ‘ä»¬ä¸»è¦æŒ‡çš„æ˜¯è¿›ç¨‹çš„è¾“å…¥è¾“å‡ºæ“ä½œã€‚åœ¨ Node.js ä¸­ï¼Œè¿™é€šå¸¸æ¶‰åŠåˆ°ä¸‰ä¸ªä¸»è¦çš„æµï¼ˆstreamï¼‰ï¼š</p><ol><li><strong>æ ‡å‡†è¾“å…¥æµï¼ˆstdinï¼‰</strong>ï¼šç”¨äºä»å¤–éƒ¨æ¥æ”¶è¾“å…¥ã€‚</li><li><strong>æ ‡å‡†è¾“å‡ºæµï¼ˆstdoutï¼‰</strong>ï¼šç”¨äºå‘å¤–éƒ¨å‘é€è¾“å‡ºã€‚</li><li><strong>æ ‡å‡†é”™è¯¯æµï¼ˆstderrï¼‰</strong>ï¼šç”¨äºè¾“å‡ºé”™è¯¯æˆ–æ—¥å¿—ä¿¡æ¯ã€‚</li></ol><h3 id="ä¸ºä»€ä¹ˆ-process-i-o-é‡è¦" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆ-process-i-o-é‡è¦"><span>ä¸ºä»€ä¹ˆ process I/O é‡è¦ï¼Ÿ</span></a></h3><p>ä»»ä½•è¿è¡Œä¸­çš„ç¨‹åºéƒ½éœ€è¦ä¸€ç§æœºåˆ¶æ¥ä¸å¤–éƒ¨ä¸–ç•Œäº¤æµã€‚æ— è®ºæ˜¯è¯»å–ç”¨æˆ·çš„è¾“å…¥æ•°æ®ã€è¾“å‡ºç»“æœåˆ°å±å¹•ã€è¿˜æ˜¯æŠ¥å‘Šé”™è¯¯ä¿¡æ¯ï¼Œè¿™äº›éƒ½æ˜¯ç¨‹åºå¿…é¡»è¿›è¡Œçš„åŸºæœ¬æ“ä½œã€‚é€šè¿‡æŒæ¡å¦‚ä½•ä½¿ç”¨<code>process.stdin</code>ã€<code>process.stdout</code>å’Œ<code>process.stderr</code>ï¼Œä½ å¯ä»¥æ›´åŠ çµæ´»åœ°æ§åˆ¶ä½ çš„ Node.js åº”ç”¨ç¨‹åºä¸å¤–ç•Œçš„äº¤äº’ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-14" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-14"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-ç®€å•çš„å‘½ä»¤è¡Œé—®ç­”åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-ç®€å•çš„å‘½ä»¤è¡Œé—®ç­”åº”ç”¨"><span>ç¤ºä¾‹ 1ï¼šç®€å•çš„å‘½ä»¤è¡Œé—®ç­”åº”ç”¨</span></a></h4><p>å‡è®¾ä½ æƒ³ç¼–å†™ä¸€ä¸ªç®€å•çš„ Node.js åº”ç”¨ï¼Œè¯¥åº”ç”¨è¯¢é—®ç”¨æˆ·çš„åå­—ï¼Œç„¶åå›å¤æ‰“æ‹›å‘¼ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> readline</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;readline&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createInterface</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  input</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">stdin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  output</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">stdout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">readline</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">question</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`ä½ å¥½ </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">!`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  readline</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">close</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>readline</code>æ¨¡å—æ¥æ–¹ä¾¿åœ°ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ï¼Œå¹¶å°†è¾“å‡ºæ‰“å°åˆ°æ ‡å‡†è¾“å‡ºã€‚<code>process.stdin</code>ä½œä¸ºè¾“å…¥æºï¼Œ<code>process.stdout</code>ä½œä¸ºè¾“å‡ºç›®æ ‡ã€‚</p><h4 id="ç¤ºä¾‹-2-å†™å…¥æ—¥å¿—æ–‡ä»¶-å¹¶åœ¨å‡ºé”™æ—¶ä½¿ç”¨æ ‡å‡†é”™è¯¯è¾“å‡º" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-å†™å…¥æ—¥å¿—æ–‡ä»¶-å¹¶åœ¨å‡ºé”™æ—¶ä½¿ç”¨æ ‡å‡†é”™è¯¯è¾“å‡º"><span>ç¤ºä¾‹ 2ï¼šå†™å…¥æ—¥å¿—æ–‡ä»¶ï¼Œå¹¶åœ¨å‡ºé”™æ—¶ä½¿ç”¨æ ‡å‡†é”™è¯¯è¾“å‡º</span></a></h4><p>è€ƒè™‘ä¸€ä¸ªåœºæ™¯ï¼Œä½ æƒ³åœ¨ä½ çš„åº”ç”¨ä¸­è®°å½•äº‹ä»¶æ—¥å¿—ï¼Œå¹¶ä¸”åœ¨é‡åˆ°é”™è¯¯æ—¶å°†é”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯æµã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å†™å…¥æ—¥å¿—åˆ°æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> timestamp</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toISOString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">appendFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;app.log&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">timestamp</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> - </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¨¡æ‹Ÿä¸€ä¸ªå¯èƒ½å¤±è´¥çš„æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å‡è®¾è¿™é‡Œæœ‰å¯èƒ½æŠ›å‡ºé”™è¯¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;å‡ºé”™äº†ï¼&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åœ¨æ§åˆ¶å°ä¸Šè¾“å‡ºé”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // åŒæ—¶ï¼Œå°†é”™è¯¯ä¿¡æ¯å†™å…¥æ—¥å¿—</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œ<code>console.error</code>å®é™…ä¸Šä¼šå°†æ¶ˆæ¯è¾“å‡ºåˆ°<code>process.stderr</code>æµã€‚å¦‚æœä½ çš„åº”ç”¨åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œï¼Œè¿™å¯ä»¥ç¡®ä¿é”™è¯¯ä¿¡æ¯è¢«é€‚å½“åœ°å…³æ³¨ã€‚</p><h3 id="å°ç»“-2" tabindex="-1"><a class="header-anchor" href="#å°ç»“-2"><span>å°ç»“</span></a></h3><p>é€šè¿‡äº†è§£å’Œåˆ©ç”¨ Node.js ä¸­çš„<code>process</code>å¯¹è±¡å’Œ I/O æµï¼Œä½ å¯ä»¥åˆ›å»ºæ›´åŠ åŠ¨æ€å’Œäº¤äº’å¼çš„åº”ç”¨ç¨‹åºã€‚æ— è®ºæ˜¯å®ç°ç®€å•çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œè¿˜æ˜¯å¤„ç†å¤æ‚çš„è¾“å…¥è¾“å‡ºä»»åŠ¡ï¼Œç†Ÿç»ƒä½¿ç”¨è¿™äº›å·¥å…·éƒ½æ˜¯éå¸¸æœ‰ç”¨çš„æŠ€èƒ½ã€‚</p><h2 id="process-throwdeprecation" tabindex="-1"><a class="header-anchor" href="#process-throwdeprecation"><span><a href="https://nodejs.org/docs/latest/api/process.html#processthrowdeprecation" target="_blank" rel="noopener noreferrer">process.throwDeprecation</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ JavaScript ä»£ç ã€‚äº†è§£ Node.js çš„ä¸åŒç‰¹æ€§å’Œé…ç½®é€‰é¡¹å¯¹äºå¼€å‘é«˜æ€§èƒ½åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ã€‚å…¶ä¸­ä¸€ä¸ªè¾ƒå°‘è¢«åˆå­¦è€…æ³¨æ„ä½†å¯¹ç»´æŠ¤ä»£ç è´¨é‡éå¸¸æœ‰å¸®åŠ©çš„ç‰¹æ€§å°±æ˜¯ <code>process.throwDeprecation</code>ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-process-throwdeprecation" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-process-throwdeprecation"><span>ä»€ä¹ˆæ˜¯ <code>process.throwDeprecation</code>?</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code> å¯¹è±¡æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæä¾›äº†ä¸€ç³»åˆ—å±æ€§å’Œæ–¹æ³•ï¼Œç”¨äºä¸å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹è¿›è¡Œäº¤äº’ã€‚<code>process.throwDeprecation</code> æ˜¯è¿™äº›å±æ€§ä¹‹ä¸€ï¼Œå®ƒä¸»è¦ç”¨äºæ§åˆ¶å½“ä½¿ç”¨å·²åºŸå¼ƒï¼ˆdeprecatedï¼‰çš„ API æˆ–åŠŸèƒ½æ—¶ Node.js çš„è¡Œä¸ºã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨å·²åºŸå¼ƒçš„ APIï¼ŒNode.js åªä¼šåœ¨æ§åˆ¶å°è¾“å‡ºä¸€æ¡è­¦å‘Šä¿¡æ¯ã€‚è™½ç„¶è¿™æ ·å¯ä»¥æé†’å¼€å‘è€…æ³¨æ„åˆ°åºŸå¼ƒçš„ç”¨æ³•ï¼Œä½†åœ¨å¾ˆå¤šæƒ…å½¢ä¸‹ï¼Œè¿™æ ·çš„è­¦å‘Šå¯èƒ½ä¼šè¢«å¿½è§†ï¼Œå°¤å…¶æ˜¯åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œæ§åˆ¶å°ä¿¡æ¯ç¹å¤šçš„æƒ…å†µä¸‹ã€‚è¿™é‡Œï¼Œ<code>process.throwDeprecation</code> å°±èµ·åˆ°äº†å…³é”®ä½œç”¨ã€‚</p><p>å¦‚æœè®¾ç½®äº† <code>process.throwDeprecation = true;</code>ï¼Œé‚£ä¹ˆæ¯å½“ä½¿ç”¨äº†åºŸå¼ƒçš„ API æˆ–åŠŸèƒ½æ—¶ï¼ŒNode.js ä¸ä»…ä»…æ˜¯æ‰“å°è­¦å‘Šï¼Œè€Œæ˜¯ç›´æ¥æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚è¿™æ„å‘³ç€ç¨‹åºä¼šåœ¨é‡åˆ°åºŸå¼ƒç”¨æ³•çš„åœ°æ–¹åœæ­¢æ‰§è¡Œï¼Œè¿«ä½¿å¼€å‘è€…å¿…é¡»å¤„ç†ç›¸å…³é—®é¢˜ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-9" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-9"><span>å¦‚ä½•ä½¿ç”¨ï¼Ÿ</span></a></h3><ol><li><p><strong>å¯ç”¨åœ¨ä»£ç ä¸­</strong>ï¼š</p><p>åœ¨ä½ çš„ Node.js åº”ç”¨ç¨‹åºçš„å…¥å£æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ <code>index.js</code> æˆ– <code>app.js</code>ï¼‰ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">throwDeprecation</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ ·ä¸€æ¥ï¼Œå¦‚æœä½ çš„åº”ç”¨ç¨‹åºä¸­æˆ–è€…ä»»ä½•ä¾èµ–ä¸­ä½¿ç”¨äº† Node.js æ ‡è®°ä¸ºåºŸå¼ƒçš„ APIï¼Œç¨‹åºå°†ä¼šæŠ›å‡ºé”™è¯¯å¹¶ç»ˆæ­¢æ‰§è¡Œã€‚</p></li><li><p><strong>é€šè¿‡å‘½ä»¤è¡Œå¯ç”¨</strong>ï¼š</p><p>ä½ ä¹Ÿå¯ä»¥åœ¨å¯åŠ¨ Node.js åº”ç”¨æ—¶é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æ¥å¯ç”¨æ­¤è¡Œä¸ºã€‚åªéœ€åœ¨è¿è¡Œ your_app.js æ–‡ä»¶æ—¶åŠ ä¸Š <code>--throw-deprecation</code> æ ‡å¿—ã€‚</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>node --throw-deprecation your_app.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ol><h3 id="å®é™…è¿ç”¨ä¾‹å­-17" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-17"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p>å‡è®¾ä½ æ­£åœ¨ä½¿ç”¨ Node.js çš„ <code>fs</code> æ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨æ–°ç‰ˆæœ¬ä¸­å·²è¢«æ ‡è®°ä¸ºåºŸå¼ƒï¼Œå¹¶ä¸”æ¨èä½¿ç”¨ä¸€ä¸ªæ–°çš„æ›¿ä»£å‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾æ­¤å‡½æ•°å·²åºŸå¼ƒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">someDeprecatedFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;path/to/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>æœªè®¾ç½® <code>process.throwDeprecation</code></strong>ï¼šä½ çš„ç¨‹åºå¯èƒ½æ­£å¸¸è¿è¡Œï¼Œä½†åœ¨æ§åˆ¶å°ä¼šçœ‹åˆ°ä¸€æ¡åºŸå¼ƒè­¦å‘Šã€‚</li><li><strong>è®¾ç½®äº† <code>process.throwDeprecation = true;</code></strong>ï¼šç¨‹åºåœ¨å°è¯•æ‰§è¡Œ <code>fs.someDeprecatedFunction</code> æ—¶å°†æŠ›å‡ºé”™è¯¯å¹¶ç»ˆæ­¢æ‰§è¡Œï¼Œè¿«ä½¿ä½ æ›´æ–°è¿™éƒ¨åˆ†ä»£ç ï¼Œä½¿ç”¨æ¨èçš„æ–°å‡½æ•°ã€‚</li></ul><p>è¿™ç§æœºåˆ¶ç¡®ä¿äº†ä½ çš„ä»£ç åº“åŠæ—¶æ›´æ–°ï¼Œé¿å…äº†å› ä¾èµ–è¿‡æ—¶ API å¯¼è‡´çš„æ½œåœ¨é—®é¢˜ã€‚ç‰¹åˆ«æ˜¯åœ¨è¿›è¡Œå¤§è§„æ¨¡é‡æ„æˆ–å‡çº§ä¾èµ–æ—¶ï¼Œè¿™ä¸ªç‰¹æ€§å°¤å…¶æœ‰ç”¨ã€‚</p><h2 id="process-title" tabindex="-1"><a class="header-anchor" href="#process-title"><span><a href="https://nodejs.org/docs/latest/api/process.html#processtitle" target="_blank" rel="noopener noreferrer">process.title</a></span></a></h2><p>è®©æˆ‘ä»¬æ·±å…¥äº†è§£ Node.js ä¸­çš„ <code>process.title</code> å±æ€§ï¼Œå°è¯•ç”¨æœ€é€šä¿—æ˜“æ‡‚çš„è¯­è¨€æ¥è§£é‡Šå®ƒï¼Œå¹¶ç»“åˆä¸€äº›å®é™…ä¾‹å­æ¥åŠ æ·±ç†è§£ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-process-title" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-process-title"><span>ä»€ä¹ˆæ˜¯ <code>process.title</code>ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ç¯å¢ƒä¸­ï¼Œ<code>process</code> æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†å½“å‰ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ã€‚è€Œ <code>process.title</code> å±æ€§å…è®¸ä½ è·å–æˆ–è®¾ç½®å½“å‰ Node.js è¿›ç¨‹åœ¨æ“ä½œç³»ç»Ÿä¸­æ˜¾ç¤ºçš„åç§°ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªåç§°å¯èƒ½æ˜¯å¯åŠ¨è¯¥è¿›ç¨‹æ—¶ä½¿ç”¨çš„å‘½ä»¤è¡ŒæŒ‡ä»¤ï¼Œæ¯”å¦‚ <code>node</code>ã€‚ä½†é€šè¿‡ä¿®æ”¹ <code>process.title</code>ï¼Œä½ å¯ä»¥è®©è¿›ç¨‹æ˜¾ç¤ºä¸ºæ›´æœ‰æ„ä¹‰çš„åç§°ï¼Œè¿™åœ¨ç®¡ç†å¤šä¸ªè¿›ç¨‹æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-15" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-15"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-æŸ¥çœ‹å’Œä¿®æ”¹è¿›ç¨‹æ ‡é¢˜" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æŸ¥çœ‹å’Œä¿®æ”¹è¿›ç¨‹æ ‡é¢˜"><span>ç¤ºä¾‹ 1ï¼šæŸ¥çœ‹å’Œä¿®æ”¹è¿›ç¨‹æ ‡é¢˜</span></a></h4><p>å‡è®¾ä½ åœ¨è¿›è¡Œä¸€ä¸ª Node.js åº”ç”¨å¼€å‘ï¼Œè¿™ä¸ªåº”ç”¨éœ€è¦è¿è¡Œå¤šä¸ªä¸åŒçš„æœåŠ¡ï¼Œæ¯”å¦‚ç”¨æˆ·è®¤è¯æœåŠ¡ã€æ•°æ®åˆ†ææœåŠ¡ç­‰ã€‚ä¸ºäº†æ–¹ä¾¿è¯†åˆ«å’Œç®¡ç†è¿™äº›æœåŠ¡ï¼Œä½ æƒ³è¦ä¸ºæ¯ä¸ªæœåŠ¡è®¾ç½®ä¸€ä¸ªæ›´æ˜ç¡®çš„è¿›ç¨‹åç§°ã€‚</p><ul><li><p><strong>æŸ¥çœ‹å½“å‰è¿›ç¨‹æ ‡é¢˜</strong></p><p>é¦–å…ˆï¼Œä½ å¯ä»¥é€šè¿‡ç®€å•åœ°æ‰“å°å‡º <code>process.title</code> çš„å€¼æ¥æŸ¥çœ‹å½“å‰çš„è¿›ç¨‹æ ‡é¢˜ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½æ˜¯ &quot;node&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>ä¿®æ”¹è¿›ç¨‹æ ‡é¢˜</strong></p><p>æ¥ä¸‹æ¥ï¼Œä½ å†³å®šç»™è¿›ç¨‹è®¾ç½®ä¸€ä¸ªæ–°çš„æ ‡é¢˜ï¼Œæ¯”å¦‚ä¸ºç”¨æˆ·è®¤è¯æœåŠ¡è®¾ç½®æ ‡é¢˜ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;user-auth-service&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ç°åœ¨è¾“å‡º &quot;user-auth-service&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>ç°åœ¨ï¼Œå¦‚æœä½ åœ¨æ“ä½œç³»ç»Ÿçš„ä»»åŠ¡ç®¡ç†å™¨æˆ–è€…ä½¿ç”¨æŸäº›å‘½ä»¤è¡Œå·¥å…·æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œè¿™ä¸ª Node.js è¿›ç¨‹å°†ä»¥æ–°çš„åç§°â€œuser-auth-serviceâ€æ˜¾ç¤ºï¼Œä»è€Œä½¿å¾—è¯†åˆ«å’Œç®¡ç†å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</p><h4 id="ç¤ºä¾‹-2-ä¼˜åŒ–æœåŠ¡å™¨ä¸Šçš„è¿›ç¨‹ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-ä¼˜åŒ–æœåŠ¡å™¨ä¸Šçš„è¿›ç¨‹ç®¡ç†"><span>ç¤ºä¾‹ 2ï¼šä¼˜åŒ–æœåŠ¡å™¨ä¸Šçš„è¿›ç¨‹ç®¡ç†</span></a></h4><p>å‡è®¾ä½ è´Ÿè´£ç»´æŠ¤ä¸€ä¸ªå¤§å‹ç½‘ç«™çš„åç«¯æœåŠ¡ï¼Œè¯¥æœåŠ¡ç”±å¤šä¸ª Node.js åº”ç”¨ç»„æˆï¼ŒåŒ…æ‹¬ API æœåŠ¡å™¨ã€åå°ä»»åŠ¡å¤„ç†å™¨ç­‰ã€‚åœ¨æœåŠ¡å™¨ä¸ŠåŒæ—¶è¿è¡Œç€æ•°åä¸ª Node.js è¿›ç¨‹ï¼Œè¿™ä½¿å¾—é€šè¿‡å‘½ä»¤è¡Œå·¥å…·ï¼ˆå¦‚ <code>ps</code>ï¼‰æŸ¥çœ‹å’Œç®¡ç†è¿™äº›è¿›ç¨‹å˜å¾—å¤æ‚ã€‚</p><ul><li><p><strong>è®¾ç½®åŒºåˆ†å„ä¸ªæœåŠ¡çš„è¿›ç¨‹æ ‡é¢˜</strong></p><p>ä½ å¯ä»¥åœ¨æ¯ä¸ªåº”ç”¨å¯åŠ¨è„šæœ¬ä¸­è®¾ç½® <code>process.title</code>ï¼Œä½¿å…¶åæ˜ æœåŠ¡çš„åŠŸèƒ½ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯¹äºAPIæœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;api-server&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å¯¹äºåå°ä»»åŠ¡å¤„ç†å™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;background-job-worker&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>è¿™æ ·åšä¹‹åï¼Œå½“ä½ åœ¨æœåŠ¡å™¨ä¸Šä½¿ç”¨ <code>ps</code> å‘½ä»¤æˆ–å…¶ä»–è¿›ç¨‹æŸ¥çœ‹å·¥å…·æ—¶ï¼Œå°±å¯ä»¥å¾ˆå®¹æ˜“åœ°åŒºåˆ†å’Œç®¡ç†è¿™äº›ä¸åŒçš„æœåŠ¡äº†ã€‚</p><h3 id="ç»“è®º-7" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-7"><span>ç»“è®º</span></a></h3><p>é€šè¿‡æ”¹å˜ <code>process.title</code>ï¼Œä½ å¯ä»¥æ›´æœ‰æ•ˆåœ°ç®¡ç†å’Œè¯†åˆ«è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿå†…çš„ Node.js è¿›ç¨‹ã€‚è¿™åœ¨å¼€å‘å…·æœ‰å¤šä¸ªæœåŠ¡æˆ–ç»„ä»¶çš„å¤§å‹åº”ç”¨ç¨‹åºæ—¶å°¤å…¶æœ‰ç”¨ï¼Œæœ‰åŠ©äºæé«˜å¼€å‘å’Œç»´æŠ¤æ•ˆç‡ã€‚</p><h2 id="process-tracedeprecation" tabindex="-1"><a class="header-anchor" href="#process-tracedeprecation"><span><a href="https://nodejs.org/docs/latest/api/process.html#processtracedeprecation" target="_blank" rel="noopener noreferrer">process.traceDeprecation</a></span></a></h2><p>Node.js æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„ JavaScript ç¯å¢ƒï¼Œè€Œ<code>process</code>æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæä¾›äº†ä¸€ç³»åˆ—å±æ€§å’Œæ–¹æ³•ï¼Œç”¨äºä¸å½“å‰ Node.js è¿›ç¨‹äº’åŠ¨ã€‚åœ¨ Node.js ä¸­ï¼Œå½“æŸäº›ç‰¹æ€§æˆ– API ä¸å†æ¨èä½¿ç”¨ï¼ˆå³è¢«å¼ƒç”¨ï¼‰æ—¶ï¼Œé€šå¸¸ä¼šæœ‰ä¸€ä¸ªè¿‡æ¸¡æœŸï¼Œåœ¨è¿™æœŸé—´ï¼Œæ—§çš„åŠŸèƒ½ä»ç„¶å¯ç”¨ï¼Œä½†æ˜¯åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­å¯èƒ½ä¼šè¢«å®Œå…¨ç§»é™¤ã€‚</p><p><code>process.traceDeprecation</code>æ˜¯<code>process</code>å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨äºæ§åˆ¶æ˜¯å¦ä»¥å †æ ˆè·Ÿè¸ªçš„å½¢å¼æ˜¾ç¤ºå¼ƒç”¨è­¦å‘Šã€‚</p><p>å¼ƒç”¨è­¦å‘Šé€šå¸¸åœ¨ä½ ä½¿ç”¨äº†ä¸æ¨èä½¿ç”¨çš„ Node.js æ ¸å¿ƒ API æ—¶å‡ºç°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›è­¦å‘Šåªä¼šæ‰“å°ä¸€æ¡æ¶ˆæ¯åˆ°æ ‡å‡†é”™è¯¯æµï¼ˆstderrï¼‰ï¼Œå‘Šè¯‰ä½ æŸä¸ªåŠŸèƒ½å°†æ¥å¯èƒ½ä¸å†å¯ç”¨ã€‚è¿™å¯ä»¥å¸®åŠ©å¼€å‘è€…åŠæ—¶æ³¨æ„åˆ°å¹¶æ›¿æ¢æ‰ä»–ä»¬ä»£ç ä¸­å·²è¢«å¼ƒç”¨çš„éƒ¨åˆ†ï¼Œé¿å…å°†æ¥çš„å…¼å®¹æ€§é—®é¢˜ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-process-tracedeprecation" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-process-tracedeprecation"><span>å¦‚ä½•ä½¿ç”¨ <code>process.traceDeprecation</code></span></a></h3><p>å¦‚æœä½ å¸Œæœ›é™¤äº†çœ‹åˆ°å¼ƒç”¨è­¦å‘Šçš„æ¶ˆæ¯å¤–ï¼Œè¿˜æƒ³çŸ¥é“æ˜¯å“ªé‡Œçš„ä»£ç è§¦å‘äº†è¿™ä¸ªè­¦å‘Šï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>process.traceDeprecation</code>ã€‚</p><p>ä½ å¯ä»¥åœ¨ä½ çš„ Node.js åº”ç”¨ç¨‹åºä»£ç ä¸­ç›´æ¥è®¾ç½®æ­¤å±æ€§ä¸º<code>true</code>ï¼Œæˆ–è€…é€šè¿‡åœ¨å¯åŠ¨åº”ç”¨ç¨‹åºæ—¶è®¾ç½®ç¯å¢ƒå˜é‡<code>NODE_OPTIONS</code>æ¥å®ç°ã€‚</p><p><strong>ä¾‹å­ 1ï¼šåœ¨ä»£ç ä¸­è®¾ç½®</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">traceDeprecation</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä»¥ä¸‹å‡½æ•°åœ¨æœªæ¥çš„Node.jsç‰ˆæœ¬ä¸­è¢«å¼ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exists</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;somefile.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">exists</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`æ–‡ä»¶å­˜åœ¨: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exists</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœ<code>fs.exists</code>æ˜¯ä¸€ä¸ªè¢«å¼ƒç”¨çš„ APIï¼Œé‚£ä¹ˆé™¤äº†å¼ƒç”¨è­¦å‘Šæ¶ˆæ¯ä¹‹å¤–ï¼Œä½ è¿˜ä¼šå¾—åˆ°ä¸€ä¸ªå †æ ˆè·Ÿè¸ªï¼Œæ˜¾ç¤ºè§¦å‘è¿™ä¸ªè­¦å‘Šçš„å…·ä½“ä½ç½®ã€‚</p><p><strong>ä¾‹å­ 2ï¼šé€šè¿‡ç¯å¢ƒå˜é‡è®¾ç½®</strong></p><p>åœ¨å‘½ä»¤è¡Œä¸­å¯åŠ¨ä½ çš„ Node.js åº”ç”¨ç¨‹åºæ—¶ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">NODE_OPTIONS</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">--trace-deprecation</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> node</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> your-app.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ ·åšçš„æ•ˆæœå’Œåœ¨ä»£ç ä¸­è®¾ç½®<code>process.traceDeprecation = true;</code>æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿä¼šæ˜¾ç¤ºå¼ƒç”¨è­¦å‘Šçš„å †æ ˆè·Ÿè¸ªã€‚</p><h3 id="å®é™…è¿ç”¨-4" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-4"><span>å®é™…è¿ç”¨</span></a></h3><p>è¿™ä¸ªç‰¹æ€§å¯¹äºç»´æŠ¤å¤§å‹é¡¹ç›®ç‰¹åˆ«æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯å½“ä½ å‡çº§ Node.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”é¡¹ç›®ä¸­ä½¿ç”¨äº†å¾ˆå¤šä¾èµ–åŒ…æ—¶ã€‚é€šè¿‡å¯ç”¨<code>traceDeprecation</code>ï¼Œä½ å¯ä»¥å¿«é€Ÿå®šä½åˆ°æ˜¯å“ªäº›è°ƒç”¨ä½¿ç”¨äº†è¢«å¼ƒç”¨çš„ APIï¼Œä»è€Œæ›´åŠ æœ‰æ•ˆåœ°æ›´æ–°å’Œç»´æŠ¤ä½ çš„ä»£ç åº“ï¼Œä¿è¯ä»£ç çš„å¥å£¯æ€§å’Œå‰ç»æ€§ã€‚</p><p>æœ€ç»ˆï¼Œç†è§£å’Œä½¿ç”¨<code>process.traceDeprecation</code>èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°é€‚é…æœªæ¥çš„ Node.js ç‰ˆæœ¬ï¼Œå‡å°‘å› å¼ƒç”¨ API å¼•èµ·çš„æ½œåœ¨é—®é¢˜ã€‚</p><h2 id="process-umask" tabindex="-1"><a class="header-anchor" href="#process-umask"><span><a href="https://nodejs.org/docs/latest/api/process.html#processumask" target="_blank" rel="noopener noreferrer">process.umask()</a></span></a></h2><p>å½“æˆ‘ä»¬åœ¨è°ˆè®º<code>process.umask()</code>å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è®¨è®º Node.js ä¸­çš„ä¸€ä¸ªç”¨äºå¤„ç†æ“ä½œç³»ç»Ÿæ–‡ä»¶æƒé™çš„åŠŸèƒ½ã€‚è¿™å¯èƒ½å¬èµ·æ¥æœ‰ç‚¹æŠ½è±¡ï¼Œæ‰€ä»¥æˆ‘å°†å°è¯•é€šè¿‡ä¸€äº›æ—¥å¸¸çš„æ¯”å–»å’Œä¾‹å­æ¥è§£é‡Šå®ƒã€‚</p><p>é¦–å…ˆï¼Œç†è§£ä»€ä¹ˆæ˜¯<code>umask</code>ï¼ˆç”¨æˆ·æ©ç ï¼‰éå¸¸é‡è¦ã€‚ä½ å¯ä»¥å°†<code>umask</code>æƒ³è±¡æˆä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œå®ƒå†³å®šäº†æ–°åˆ›å»ºæ–‡ä»¶æˆ–ç›®å½•çš„é»˜è®¤æƒé™ã€‚åœ¨ Unix-like ç³»ç»Ÿï¼ˆæ¯”å¦‚ Linux å’Œ MacOSï¼‰ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶å’Œç›®å½•éƒ½æœ‰ä¸€ç»„æƒé™ï¼Œè¿™äº›æƒé™å†³å®šäº†è°å¯ä»¥è¯»å–ã€å†™å…¥æˆ–æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚</p><p>é€šå¸¸ï¼Œå½“ä½ åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æˆ–ç›®å½•æ—¶ï¼Œç³»ç»Ÿä¼šæ ¹æ®ä¸€å¥—é»˜è®¤è§„åˆ™èµ‹äºˆå®ƒä¸€ç»„æƒé™ã€‚ç„¶è€Œï¼Œ<code>umask</code>æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œå…è®¸ä½ ä¿®æ”¹è¿™äº›é»˜è®¤æƒé™ï¼Œä»¥ä¾¿æ›´ç²¾ç»†åœ°æ§åˆ¶æ–‡ä»¶çš„è®¿é—®æ€§ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<code>umask</code>å¹¶ä¸æ˜¯ç»™æ–‡ä»¶â€œæ·»åŠ â€æƒé™ï¼Œè€Œæ˜¯é™åˆ¶ï¼ˆæˆ–è€…è¯´â€œå‡å»â€ï¼‰æƒé™ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨process-umask" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨process-umask"><span>å¦‚ä½•ä½¿ç”¨<code>process.umask()</code></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process.umask()</code>å‡½æ•°å…è®¸ä½ æŸ¥è¯¢æˆ–è®¾ç½®å½“å‰è¿›ç¨‹çš„<code>umask</code>ã€‚</p><ul><li>æŸ¥è¯¢å½“å‰<code>umask</code>ï¼šåªéœ€è°ƒç”¨<code>process.umask()</code>è€Œä¸ä¼ é€’ä»»ä½•å‚æ•°ã€‚</li><li>è®¾ç½®æ–°çš„<code>umask</code>ï¼šä½ å¯ä»¥é€šè¿‡ä¼ é€’ä¸€ä¸ªæ•°å€¼ä½œä¸ºå‚æ•°æ¥è®¾ç½®ä¸€ä¸ªæ–°çš„<code>umask</code>ã€‚</li></ul><h3 id="å®é™…è¿ç”¨ç¤ºä¾‹-16" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ç¤ºä¾‹-16"><span>å®é™…è¿ç”¨ç¤ºä¾‹</span></a></h3><h4 id="ç¤ºä¾‹-1-æŸ¥è¯¢å½“å‰umask" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1-æŸ¥è¯¢å½“å‰umask"><span>ç¤ºä¾‹ 1ï¼šæŸ¥è¯¢å½“å‰<code>umask</code></span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">umask</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå½“å‰umaskå€¼ï¼ˆè½¬æ¢ä¸ºå…«è¿›åˆ¶å½¢å¼ï¼‰</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬æŸ¥è¯¢äº†å½“å‰è¿›ç¨‹çš„<code>umask</code>å€¼ï¼Œå¹¶é€šè¿‡<code>.toString(8)</code>å°†å…¶è½¬æ¢ä¸ºæ›´å¸¸è§çš„å…«è¿›åˆ¶è¡¨ç¤ºå½¢å¼ã€‚åœ¨ Unix-like ç³»ç»Ÿä¸­ï¼Œ<code>umask</code>å€¼é€šå¸¸ä»¥å…«è¿›åˆ¶å½¢å¼å±•ç¤ºã€‚</p><h4 id="ç¤ºä¾‹-2-è®¾ç½®æ–°çš„umask" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2-è®¾ç½®æ–°çš„umask"><span>ç¤ºä¾‹ 2ï¼šè®¾ç½®æ–°çš„<code>umask</code></span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> oldUmask</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">umask</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">18</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è®¾ç½®æ–°çš„umaskå€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Old umask was: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">oldUmask</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ˜¾ç¤ºæ—§çš„umaskå€¼</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ä¹‹ååˆ›å»ºçš„æ–‡ä»¶æˆ–ç›®å½•å°†å—åˆ°æ–°umaskçš„å½±å“ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ªæ–°çš„<code>umask</code>å€¼ï¼ˆ18ï¼Œå³å…«è¿›åˆ¶çš„ 022ï¼‰ã€‚å½“è®¾ç½®æ–°çš„<code>umask</code>æ—¶ï¼Œ<code>process.umask()</code>å‡½æ•°ä¼šè¿”å›ä¹‹å‰çš„<code>umask</code>å€¼ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ‰“å°å‡ºå˜æ›´å‰çš„å€¼ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-12" tabindex="-1"><a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-12"><span>æ³¨æ„äº‹é¡¹</span></a></h3><ul><li>å½“è®¾ç½®æ–°çš„<code>umask</code>æ—¶ï¼Œè¯·ç¡®ä¿ä½ å®Œå…¨ç†è§£æ›´æ”¹å°†å¦‚ä½•å½±å“æ–‡ä»¶æƒé™ã€‚é”™è¯¯çš„<code>umask</code>è®¾ç½®å¯èƒ½ä¼šå¯¼è‡´æ„å¤–çš„æ–‡ä»¶è®¿é—®é—®é¢˜ã€‚</li><li><code>umask</code>çš„æ•ˆæœæ˜¯å…¨å±€æ€§çš„ï¼›æ¢å¥è¯è¯´ï¼Œå®ƒä¼šå½±å“ Node.js è¿›ç¨‹ä¸­æ‰€æœ‰éšååˆ›å»ºçš„æ–‡ä»¶å’Œç›®å½•ã€‚å› æ­¤ï¼Œåœ¨å¹¶å‘ç¯å¢ƒä¸‹ä¿®æ”¹<code>umask</code>éœ€è¦æ ¼å¤–å°å¿ƒã€‚</li></ul><p>é€šè¿‡å¯¹<code>umask</code>çš„æ·±å…¥ç†è§£å’Œåˆç†åº”ç”¨ï¼Œå¼€å‘äººå‘˜å¯ä»¥æ›´å¥½åœ°æ§åˆ¶åº”ç”¨ç¨‹åºä¸­æ–‡ä»¶å’Œç›®å½•çš„å®‰å…¨æ€§ã€‚å¸Œæœ›è¿™èƒ½å¸®åŠ©ä½ æ›´æ¸…æ¥šåœ°ç†è§£<code>process.umask()</code>åœ¨ Node.js ä¸­çš„ç”¨å¤„ï¼</p><h2 id="process-umask-mask" tabindex="-1"><a class="header-anchor" href="#process-umask-mask"><span><a href="https://nodejs.org/docs/latest/api/process.html#processumaskmask" target="_blank" rel="noopener noreferrer">process.umask(mask)</a></span></a></h2><p>å½“æˆ‘ä»¬è°ˆè®º Node.js ä¸­çš„<code>process.umask(mask)</code>æ—¶ï¼Œæˆ‘ä»¬åœ¨è®¨è®ºçš„æ˜¯å¦‚ä½•è®¾ç½®æˆ–è¯»å– Node.js è¿›ç¨‹çš„é»˜è®¤æƒé™æ©ç ã€‚ä½†é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç†è§£ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚</p><h3 id="åŸºç¡€æ¦‚å¿µ-3" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æ¦‚å¿µ-3"><span>åŸºç¡€æ¦‚å¿µ</span></a></h3><ol><li><p><strong>ä»€ä¹ˆæ˜¯ umaskï¼Ÿ</strong></p><p>umaskï¼Œå…¨ç§°ä¸ºç”¨æˆ·æ©ç ï¼ˆuser maskï¼‰ï¼Œæ˜¯ä¸€ä¸ª Linux å’Œ Unix ç³»ç»Ÿä¸­çš„æ¦‚å¿µï¼Œç”¨äºè®¾ç½®æ–°åˆ›å»ºæ–‡ä»¶å’Œç›®å½•çš„é»˜è®¤æƒé™ã€‚è¿™ä¸ªè®¾ç½®å†³å®šäº†æ–°åˆ›å»ºçš„æ–‡ä»¶å’Œç›®å½•çš„æƒé™è®¾ç½®ã€‚umask é€šå¸¸è¡¨ç¤ºä¸ºå…«è¿›åˆ¶æ•°ã€‚</p></li><li><p><strong>æƒé™</strong></p><p>åœ¨è®¨è®º umask ä¹‹å‰ï¼Œé‡è¦çš„æ˜¯è¦ç†è§£ UNIX/Linux ç³»ç»Ÿä¸Šæ–‡ä»¶å’Œç›®å½•çš„åŸºæœ¬æƒé™ã€‚æœ‰ä¸‰ç§ç±»å‹çš„åŸºæœ¬æƒé™ï¼šè¯»ï¼ˆrï¼‰ã€å†™ï¼ˆwï¼‰å’Œæ‰§è¡Œï¼ˆxï¼‰ã€‚è¿™äº›æƒé™å¯ä»¥è¢«åˆ†é…ç»™æ–‡ä»¶/ç›®å½•çš„æ‰€æœ‰è€…ã€æ‰€å±ç»„ä»¥åŠå…¶ä»–ç”¨æˆ·ã€‚</p></li></ol><h3 id="process-umask-mask-1" tabindex="-1"><a class="header-anchor" href="#process-umask-mask-1"><span><code>process.umask(mask)</code></span></a></h3><p>ç°åœ¨æˆ‘ä»¬å›åˆ°<code>process.umask(mask)</code>ã€‚Node.js çš„<code>process.umask(mask)</code>æ–¹æ³•ç”¨äºè·å–æˆ–è®¾ç½® Node.js è¿›ç¨‹çš„é»˜è®¤æƒé™æ©ç ã€‚å¦‚æœæ²¡æœ‰æä¾›å‚æ•°ï¼Œå®ƒè¿”å›å½“å‰çš„ umaskã€‚å¦‚æœæä¾›äº†å‚æ•°ï¼Œå®ƒå°†è®¾ç½® umask å¹¶è¿”å›ä¹‹å‰çš„ umaskã€‚</p><ul><li><p><strong>è·å–å½“å‰çš„ umask</strong></p><p>å¦‚æœä½ è°ƒç”¨<code>process.umask()</code>è€Œä¸å¸¦å‚æ•°ï¼Œå®ƒä¼šè¿”å›å½“å‰è¿›ç¨‹çš„ umask å€¼ã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">umask</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// è¾“å‡ºå¯èƒ½æ˜¯&quot;022&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™é‡Œä½¿ç”¨<code>.toString(8)</code>æ˜¯å› ä¸ºæˆ‘ä»¬é€šå¸¸ä»¥å…«è¿›åˆ¶å½¢å¼æŸ¥çœ‹ umaskã€‚</p></li><li><p><strong>è®¾ç½®æ–°çš„ umask</strong></p><p>ä½ ä¹Ÿå¯ä»¥é€šè¿‡æä¾›ä¸€ä¸ªå‚æ•°æ¥è®¾ç½®æ–°çš„ umaskã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> newUmask</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;077&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> oldUmask</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">umask</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">newUmask</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  `Old umask was: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">oldUmask</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, new umask is: </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">newUmask</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é¦–å…ˆè®¾ç½®ä¸€ä¸ªæ–°çš„ umaskï¼ˆ&#39;077&#39;ï¼‰ï¼Œç„¶åè¾“å‡ºæ—§çš„å’Œæ–°çš„ umaskã€‚è¯·æ³¨æ„ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œé€šå¸¸åªæœ‰åœ¨å¿…è¦æ—¶æ‰ä¿®æ”¹ umaskã€‚</p></li></ul><h3 id="å®é™…åº”ç”¨ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…åº”ç”¨ä¾‹å­-6"><span>å®é™…åº”ç”¨ä¾‹å­</span></a></h3><ol><li><p><strong>å®‰å…¨æ€§</strong></p><p>è®¾è®¡æŸäº›åº”ç”¨æ—¶ï¼Œå¯èƒ½éœ€è¦ç¡®ä¿æ–‡ä»¶ä¸è¢«å…¶ä»–ç”¨æˆ·è¯»å–ã€‚ä¾‹å¦‚ï¼Œåœ¨åˆ›å»ºä¸´æ—¶æ–‡ä»¶æˆ–æ•æ„Ÿä¿¡æ¯æ–‡ä»¶æ—¶ï¼Œå¯ä»¥è®¾ç½®æ›´ä¸¥æ ¼çš„ umaskï¼Œä»¥é˜²æ­¢éæˆæƒè®¿é—®ã€‚</p></li><li><p><strong>å¤šç”¨æˆ·ç¯å¢ƒ</strong></p><p>åœ¨å¤šç”¨æˆ·ç¯å¢ƒä¸­è¿è¡Œåº”ç”¨æ—¶ï¼Œåˆé€‚çš„ umask è®¾ç½®ç¡®ä¿äº†æ–°åˆ›å»ºçš„æ–‡ä»¶å’Œç›®å½•å¯¹åŒç»„ç”¨æˆ·çš„å¯è®¿é—®æ€§ã€‚è¿™å¯¹äºå›¢é˜Ÿåä½œå’Œèµ„æºå…±äº«å¾ˆé‡è¦ã€‚</p></li><li><p><strong>è‡ªå®šä¹‰åº”ç”¨è®¾ç½®</strong></p><p>ä½¿ç”¨ Node.js å¼€å‘çš„åº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦æ ¹æ®å…·ä½“ä¸šåŠ¡éœ€æ±‚åˆ›å»ºæ–‡ä»¶å’Œç›®å½•ã€‚é€šè¿‡åˆç†è®¾ç½® umaskï¼Œå¯ä»¥ç¡®ä¿è¿™äº›æ–‡ä»¶å’Œç›®å½•æ‹¥æœ‰æ­£ç¡®çš„é»˜è®¤æƒé™ï¼Œä»è€Œé¿å…æ‰‹åŠ¨å»æ›´æ”¹æƒé™ã€‚</p></li></ol><h3 id="ç»“è®º-8" tabindex="-1"><a class="header-anchor" href="#ç»“è®º-8"><span>ç»“è®º</span></a></h3><p>ç†è§£å’Œä½¿ç”¨<code>process.umask()</code>å…è®¸å¼€å‘äººå‘˜ç²¾ç»†åœ°æ§åˆ¶ Node.js åº”ç”¨ä¸­æ–°åˆ›å»ºæ–‡ä»¶å’Œç›®å½•çš„æƒé™ï¼Œè¿™åœ¨ç®¡ç†åº”ç”¨çš„å®‰å…¨æ€§å’Œå¤šç”¨æˆ·ç¯å¢ƒä¸­å°¤å…¶é‡è¦ã€‚è™½ç„¶é»˜è®¤çš„ umask è®¾ç½®é€šå¸¸è¶³å¤Ÿå¤§å¤šæ•°åº”ç”¨ï¼Œä½†èƒ½å¤ŸæŒ‰éœ€è°ƒæ•´è¿™äº›è®¾ç½®æ— ç–‘ä¸ºå¼€å‘äººå‘˜æä¾›äº†æ›´å¤§çš„çµæ´»æ€§å’Œæ§åˆ¶åŠ›ã€‚</p><h2 id="process-uptime" tabindex="-1"><a class="header-anchor" href="#process-uptime"><span><a href="https://nodejs.org/docs/latest/api/process.html#processuptime" target="_blank" rel="noopener noreferrer">process.uptime()</a></span></a></h2><p>å¥½çš„ï¼Œè®©æˆ‘ä¸ºä½ è¯¦ç»†è§£é‡Š <code>process.uptime()</code> æ–¹æ³•åœ¨ Node.js ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå°¤å…¶æ˜¯åœ¨ä½ æåˆ°çš„ç‰ˆæœ¬ï¼ˆNode.js v21.7.1ï¼‰ä¸­ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-process-uptime" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-process-uptime"><span>ä»€ä¹ˆæ˜¯ <code>process.uptime()</code>ï¼Ÿ</span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process.uptime()</code> æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„æ–¹æ³•ï¼Œå®ƒè¿”å› Node.js è¿›ç¨‹å·²ç»è¿è¡Œçš„ç§’æ•°ã€‚è¿™ä¸ªæ–¹æ³•éå¸¸ç›´æ¥â€”â€”å½“ä½ è°ƒç”¨å®ƒæ—¶ï¼Œå®ƒä¼šå‘Šè¯‰ä½ ä»è¿›ç¨‹å¯åŠ¨åˆ°ç°åœ¨å·²ç»è¿‡å»äº†å¤šé•¿æ—¶é—´ï¼Œå…¶è¿”å›å€¼æ˜¯ä»¥ç§’ä¸ºå•ä½çš„æµ®ç‚¹æ•°ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-process-uptime" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-process-uptime"><span>å¦‚ä½•ä½¿ç”¨ <code>process.uptime()</code>ï¼Ÿ</span></a></h3><p>ä½¿ç”¨è¿™ä¸ªæ–¹æ³•éå¸¸ç®€å•ã€‚ä½ ä¸éœ€è¦ä¼ å…¥ä»»ä½•å‚æ•°ï¼Œç›´æ¥è°ƒç”¨å®ƒå°±å¯ä»¥äº†ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> uptime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">uptime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`The process has been running for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">uptime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> seconds`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç ä¼šè¾“å‡ºç±»ä¼¼äº &quot;The process has been running for 0.49 seconds&quot; çš„ä¿¡æ¯ï¼Œå–å†³äºä½ çš„è¿›ç¨‹è¿è¡Œäº†å¤šä¹…ã€‚</p><h3 id="å®é™…è¿ç”¨ä¾‹å­-18" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨ä¾‹å­-18"><span>å®é™…è¿ç”¨ä¾‹å­</span></a></h3><p><strong>1. ç›‘æ§åº”ç”¨å¥åº·ï¼š</strong></p><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web åº”ç”¨ï¼Œä½ å¯èƒ½æƒ³è¦åœ¨æŸä¸ªç«¯ç‚¹å±•ç¤ºåº”ç”¨çš„å¥åº·çŠ¶å†µä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬åº”ç”¨å·²ç»è¿è¡Œäº†å¤šé•¿æ—¶é—´ã€‚è¿™æœ‰åŠ©äºç›‘æ§å’Œè°ƒè¯•ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/health&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> uptime</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">uptime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`App has been running for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">uptime</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> seconds.`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Server is running on port 3000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>2. æ—¥å¿—å’Œè°ƒè¯•ï¼š</strong></p><p>åœ¨è°ƒè¯•å¤æ‚åº”ç”¨æ—¶ï¼ŒçŸ¥é“è¿›ç¨‹è¿è¡Œäº†å¤šé•¿æ—¶é—´å¯èƒ½å¯¹æ‰¾å‡ºé—®é¢˜å¾ˆæœ‰å¸®åŠ©ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½æƒ³åœ¨æ—¥å¿—æ–‡ä»¶ä¸­è®°å½•ä¸‹æœåŠ¡æ¯éš”ä¸€æ®µæ—¶é—´çš„çŠ¶æ€ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`The process has been running for </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">uptime</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> seconds`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">60000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ¯åˆ†é’Ÿè®°å½•ä¸€æ¬¡</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>3. æ€§èƒ½ç›‘æµ‹ï¼š</strong></p><p>å¯¹äºæ€§èƒ½æ•æ„Ÿçš„åº”ç”¨ï¼Œäº†è§£åœ¨æ‰§è¡Œç‰¹å®šæ“ä½œæˆ–ä»»åŠ¡å‰åï¼Œè¿›ç¨‹å·²ç»è¿è¡Œäº†å¤šé•¿æ—¶é—´ï¼Œå¯ä»¥å¸®åŠ©ä½ æµ‹é‡å’Œä¼˜åŒ–ä»£ç æ€§èƒ½ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">uptime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾è¿™é‡Œæœ‰ä¸€äº›æ€§èƒ½æ•æ„Ÿçš„æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">uptime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Operation took </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> seconds`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°ç»“-3" tabindex="-1"><a class="header-anchor" href="#å°ç»“-3"><span>å°ç»“</span></a></h3><p>é€šè¿‡ä»¥ä¸Šä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>process.uptime()</code> åœ¨ Node.js åº”ç”¨ä¸­çš„å¤šç§ç”¨é€”ï¼Œä»ç›‘æ§å¥åº·çŠ¶å†µã€è¾…åŠ©æ—¥å¿—è®°å½•ï¼Œåˆ°æ€§èƒ½ç›‘æµ‹ç­‰ã€‚å®ƒæ˜¯ä¸€ä¸ªç®€å•ä½†å¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä¼˜åŒ–ä½ çš„ Node.js åº”ç”¨ã€‚</p><h2 id="process-version" tabindex="-1"><a class="header-anchor" href="#process-version"><span><a href="https://nodejs.org/docs/latest/api/process.html#processversion" target="_blank" rel="noopener noreferrer">process.version</a></span></a></h2><p>å½“æˆ‘ä»¬è°ˆåˆ° Node.js ä¸­çš„ <code>process.version</code>ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬äº†è§£æ­£åœ¨è¿è¡Œçš„ Node.js ç¨‹åºçš„ç‰ˆæœ¬ã€‚è¿™ä¸ªä¿¡æ¯å¯¹äºè°ƒè¯•ã€æ—¥å¿—è®°å½•æˆ–è€…åœ¨ç¨‹åºä¸­éœ€è¦æ ¹æ®ä¸åŒçš„ Node.js ç‰ˆæœ¬æ‰§è¡Œä¸åŒé€»è¾‘æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="ç†è§£-process-version" tabindex="-1"><a class="header-anchor" href="#ç†è§£-process-version"><span>ç†è§£ <code>process.version</code></span></a></h3><p>åœ¨ Node.js ä¸­ï¼Œ<code>process</code> æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæ— éœ€é€šè¿‡ <code>require</code> å¯¼å…¥å³å¯ç›´æ¥ä½¿ç”¨ã€‚è¿™ä¸ªå¯¹è±¡æä¾›äº†ä¸€ç³»åˆ—å±æ€§å’Œæ–¹æ³•ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿä¸å½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹è¿›è¡Œäº¤äº’ã€‚å…¶ä¸­çš„ <code>version</code> å±æ€§å°±åŒ…å«äº†å½“å‰ Node.js è§£é‡Šå™¨çš„ç‰ˆæœ¬å·ï¼Œè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ï¼Œæ ¼å¼é€šå¸¸ä¸º <code>vX.Y.Z</code>ï¼Œå…¶ä¸­ <code>X</code>ã€<code>Y</code> å’Œ <code>Z</code> åˆ†åˆ«ä»£è¡¨ä¸»è¦ï¼ˆmajorï¼‰ã€æ¬¡è¦ï¼ˆminorï¼‰å’Œè¡¥ä¸ï¼ˆpatchï¼‰ç‰ˆæœ¬å·ã€‚</p><h3 id="å®é™…è¿ç”¨-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨-5"><span>å®é™…è¿ç”¨</span></a></h3><ol><li><p><strong>å…¼å®¹æ€§æ£€æŸ¥</strong></p><p>å‡è®¾ä½ å¼€å‘äº†ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå®ƒä¾èµ–äº Node.js çš„æŸä¸ªæ–°ç‰¹æ€§ï¼Œè¿™ä¸ªç‰¹æ€§åªåœ¨ Node.js 14.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬ä¸­å¯ç”¨ã€‚åœ¨ä½ çš„åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œä½ å¯ä»¥æ£€æŸ¥è¿è¡Œçš„ Node.js ç‰ˆæœ¬ï¼Œä»¥ç¡®ä¿å®ƒæ»¡è¶³æœ€ä½ç‰ˆæœ¬è¦æ±‚ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> `&lt;`</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;v14.0.0&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;This application requires Node.js version 14.0.0 or higher&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// éé›¶çŠ¶æ€ç è¡¨ç¤ºå¼‚å¸¸é€€å‡º</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>åŠŸèƒ½å·®å¼‚å¤„ç†</strong></p><p>åœ¨ä¸åŒç‰ˆæœ¬çš„ Node.js ä¸­ï¼ŒæŸäº› API å¯èƒ½å­˜åœ¨å·®å¼‚ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªåŠŸèƒ½åœ¨æ—©æœŸç‰ˆæœ¬ä¸­å°šæœªå¼•å…¥ï¼Œæˆ–è€…åœ¨åæ¥çš„ç‰ˆæœ¬ä¸­å·²ç»è¢«å¼ƒç”¨å’Œæ›¿æ¢äº†ã€‚é€šè¿‡æ£€æŸ¥ <code>process.version</code>ï¼Œä½ å¯ä»¥ç¼–å†™æ¡ä»¶ä»£ç ï¼Œä¸ºä¸åŒçš„ç‰ˆæœ¬æä¾›ä¸åŒçš„å®ç°ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;fs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> &gt;=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;v10.0.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // ä½¿ç”¨ promises APIï¼Œè¯¥ API åœ¨ Node.js v10.0.0 å¼•å…¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">promises</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // å¯¹äºè€ç‰ˆæœ¬çš„ Node.jsï¼Œå›é€€ä½¿ç”¨å›è°ƒå½¢å¼çš„ API</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  fs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/path/to/file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">      console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>æ—¥å¿—è®°å½•ä¸è°ƒè¯•</strong></p><p>å½“ä½ åœ¨å¤šä¸ªç¯å¢ƒä¸­éƒ¨ç½²åº”ç”¨ç¨‹åºæ—¶ï¼Œäº†è§£æ¯ä¸ªç¯å¢ƒè¿è¡Œçš„ Node.js ç‰ˆæœ¬å¯èƒ½å¯¹è°ƒè¯•éå¸¸é‡è¦ã€‚ä½ å¯ä»¥å°† <code>process.version</code> è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œè¿™æ ·å½“é—®é¢˜å‡ºç°æ—¶ï¼Œä½ å¯ä»¥å¿«é€Ÿæ£€æŸ¥æ˜¯å¦ç”±ç‰¹å®šçš„ Node.js ç‰ˆæœ¬å¼•èµ·ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> logger</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;./logger&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// å‡è®¾ä½ æœ‰ä¸€ä¸ªæ—¥å¿—æ¨¡å—</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">logger</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Application starting...`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">logger</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`Running on Node.js </span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#032F62;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>process.version</code> åœ¨å¤šç§åœºæ™¯ä¸‹çš„å®ç”¨ä»·å€¼ï¼Œä»ç¡®ä¿å…¼å®¹æ€§ã€å¤„ç†ä¸åŒç‰ˆæœ¬é—´çš„å·®å¼‚ï¼Œåˆ°ç®€åŒ–è°ƒè¯•å’Œæ—¥å¿—è®°å½•è¿‡ç¨‹ã€‚å®ƒæ˜¯ Node.js åº”ç”¨ç¨‹åºå¼€å‘ä¸­ä¸€ä¸ªç®€å•ä½†æå…¶æœ‰ç”¨çš„å·¥å…·ã€‚</p><h2 id="process-versions" tabindex="-1"><a class="header-anchor" href="#process-versions"><span><a href="https://nodejs.org/docs/latest/api/process.html#processversions" target="_blank" rel="noopener noreferrer">process.versions</a></span></a></h2><p>Node.js çš„ <code>process.versions</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒåŒ…å«äº† Node.js å’Œå®ƒçš„ä¾èµ–åŒ…ç‰ˆæœ¬çš„ä¿¡æ¯ã€‚è¿™å¯¹äºè°ƒè¯•ã€è¯Šæ–­é—®é¢˜æˆ–ç¡®ä¿ä½ çš„åº”ç”¨è¿è¡Œåœ¨æ­£ç¡®çš„ç¯å¢ƒç‰ˆæœ¬ä¸Šéå¸¸æœ‰ç”¨ã€‚åœ¨ Node.js ä¸­ï¼Œ<code>process</code> å¯¹è±¡æä¾›äº†ä¸€ç³»åˆ—å…³äºå½“å‰è¿è¡Œçš„ Node.js è¿›ç¨‹çš„ä¿¡æ¯å’Œæ§åˆ¶èƒ½åŠ›ï¼Œè€Œ <code>process.versions</code> å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªå±æ€§ã€‚</p><h3 id="è§£é‡Š-4" tabindex="-1"><a class="header-anchor" href="#è§£é‡Š-4"><span>è§£é‡Š</span></a></h3><p>å½“ä½ ä½¿ç”¨ <code>process.versions</code> æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†å½“å‰ Node.js ç¯å¢ƒä¸­å„ä¸ªé‡è¦ç»„ä»¶çš„ç‰ˆæœ¬å·ã€‚è¿™äº›ç»„ä»¶é€šå¸¸åŒ…æ‹¬ï¼š</p><ul><li><code>node</code>: å½“å‰è¿è¡Œçš„ Node.js çš„ç‰ˆæœ¬ã€‚</li><li><code>v8</code>: V8 å¼•æ“çš„ç‰ˆæœ¬ã€‚V8 æ˜¯ Google å¼€å‘çš„å¼€æº JavaScript å¼•æ“ï¼ŒNode.js ä½¿ç”¨å®ƒæ¥æ‰§è¡Œ JavaScript ä»£ç ã€‚</li><li><code>uv</code>: libuv çš„ç‰ˆæœ¬ï¼Œè¿™æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„å¼‚æ­¥ I/O åº“ï¼ŒNode.js ç”¨å®ƒæ¥å¤„ç†æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œã€å®šæ—¶å™¨ç­‰æ“ä½œã€‚</li><li>ä»¥åŠå…¶ä»–ä¸€äº›ä¾èµ–çš„åº“å’Œå·¥å…·çš„ç‰ˆæœ¬ï¼Œå¦‚ <code>openssl</code>ï¼ˆç”¨äºåŠ å¯†ï¼‰ã€<code>zlib</code>ï¼ˆå‹ç¼©åº“ï¼‰ç­‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-5" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-5"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="_1-è°ƒè¯•å’Œè¯Šæ–­é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_1-è°ƒè¯•å’Œè¯Šæ–­é—®é¢˜"><span>1. è°ƒè¯•å’Œè¯Šæ–­é—®é¢˜</span></a></h4><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Node.js åº”ç”¨ï¼Œå¹¶ä¸”é‡åˆ°äº†ä¸€äº›å¥‡æ€ªçš„è¡Œä¸ºæˆ–å…¼å®¹æ€§é—®é¢˜ã€‚é€šè¿‡æŸ¥çœ‹ <code>process.versions</code>ï¼Œä½ å¯ä»¥å¿«é€Ÿå¾—çŸ¥å½“å‰ç¯å¢ƒä¸­å„ä¸ªå…³é”®ç»„ä»¶çš„ç‰ˆæœ¬å·ï¼Œè¿™æœ‰åŠ©äºä½ åˆ¤æ–­é—®é¢˜æ˜¯å¦ä¸ç‰¹å®šç‰ˆæœ¬çš„æŸä¸ªä¾èµ–æœ‰å…³ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ çš„åº”ç”¨åœ¨ä¸€ä¸ªç‰ˆæœ¬çš„ Node.js ä¸Šè¿è¡Œè‰¯å¥½ï¼Œåœ¨å¦ä¸€ä¸ªç‰ˆæœ¬ä¸Šå´å‡ºç°é—®é¢˜ï¼Œ<code>process.versions</code> å¯ä»¥å¸®åŠ©ä½ è¿½è¸ªåˆ°é—®é¢˜çš„æ ¹æœ¬åŸå› ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">versions</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿è¡Œè¿™æ®µä»£ç ï¼Œä½ å°†çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡ºï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">  node</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">14.17</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">  v8</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">8.4</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">371.23</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">-node.</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">63</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">  uv</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1.40</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">  zlib</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1.2</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">11</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">  ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-ç¡®ä¿åº”ç”¨è¿è¡Œåœ¨æ­£ç¡®çš„ç¯å¢ƒä¸Š" tabindex="-1"><a class="header-anchor" href="#_2-ç¡®ä¿åº”ç”¨è¿è¡Œåœ¨æ­£ç¡®çš„ç¯å¢ƒä¸Š"><span>2. ç¡®ä¿åº”ç”¨è¿è¡Œåœ¨æ­£ç¡®çš„ç¯å¢ƒä¸Š</span></a></h4><p>å‡å¦‚ä½ çš„ Node.js åº”ç”¨ä¾èµ–äºç‰¹å®šç‰ˆæœ¬çš„ Node.js æˆ–å…¶å®ƒå…³é”®ç»„ä»¶ï¼ˆå¦‚ V8 å¼•æ“ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>process.versions</code> æ¥æ£€æŸ¥å½“å‰ç¯å¢ƒæ˜¯å¦æ»¡è¶³è¿™äº›éœ€æ±‚ã€‚å¦‚æœä¸æ»¡è¶³ï¼Œä½ å¯ä»¥åœ¨åº”ç”¨å¯åŠ¨æ—¶ç»™å‡ºè­¦å‘Šæˆ–ç›´æ¥ç»ˆæ­¢ç¨‹åºï¼Œé˜²æ­¢å¯èƒ½çš„å…¼å®¹æ€§é—®é¢˜ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">versions</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">node</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">split</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">`&lt;`</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 14</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;This application requires at least Node.js version 14.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç æ£€æŸ¥äº† Node.js çš„ä¸»ç‰ˆæœ¬å·æ˜¯å¦å°äº 14ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æ‰“å°é”™è¯¯ä¿¡æ¯å¹¶é€€å‡ºç¨‹åºã€‚</p><p>æ€»ç»“èµ·æ¥ï¼Œ<code>process.versions</code> æ˜¯äº†è§£å’Œæ§åˆ¶ä½ çš„ Node.js åº”ç”¨è¿è¡Œç¯å¢ƒçš„ä¸€ä¸ªéå¸¸å®ç”¨çš„å·¥å…·ã€‚æ— è®ºæ˜¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­è°ƒè¯•é—®é¢˜ï¼Œè¿˜æ˜¯ç¡®ä¿éƒ¨ç½²ç¯å¢ƒçš„å…¼å®¹æ€§ï¼Œå®ƒéƒ½èƒ½æä¾›é‡è¦çš„æ”¯æŒã€‚</p><h2 id="exit-codes" tabindex="-1"><a class="header-anchor" href="#exit-codes"><span><a href="https://nodejs.org/docs/latest/api/process.html#exit-codes" target="_blank" rel="noopener noreferrer">Exit codes</a></span></a></h2><p>åœ¨ Node.js ä¸­ï¼Œå½“ä¸€ä¸ªç¨‹åºè¿è¡Œç»“æŸåï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªæ•°å­—ï¼Œè¿™ä¸ªæ•°å­—è¢«ç§°ä¸ºâ€œé€€å‡ºä»£ç â€ï¼ˆExit Codeï¼‰ã€‚é€€å‡ºä»£ç æ˜¯ä¸€ä¸ªä¿¡å·ï¼Œå‘Šè¯‰æ“ä½œç³»ç»Ÿæˆ–è€…è°ƒç”¨è¯¥ç¨‹åºçš„å…¶ä»–ç¨‹åºè¿™ä¸ªç¨‹åºæ˜¯å¦‚ä½•ç»“æŸçš„ã€‚åœ¨ Node.js v21.7.1 çš„æ–‡æ¡£ä¸­ï¼Œæœ‰è¯¦ç»†åˆ—å‡ºäº†å„ç§é€€å‡ºä»£ç åŠå…¶å«ä¹‰ã€‚</p><h3 id="å¸¸è§çš„é€€å‡ºä»£ç " tabindex="-1"><a class="header-anchor" href="#å¸¸è§çš„é€€å‡ºä»£ç "><span>å¸¸è§çš„é€€å‡ºä»£ç </span></a></h3><ul><li><code>0</code>ï¼šè¡¨ç¤ºæˆåŠŸå®Œæˆï¼Œæ²¡æœ‰é”™è¯¯ã€‚</li><li><code>1</code>ï¼šé€šç”¨çš„é”™è¯¯ç ï¼Œè¡¨ç¤ºç¨‹åºå› ä¸ºæŸäº›é”™è¯¯è€Œéæ­£å¸¸ç»“æŸã€‚</li><li><code>2</code>ï¼šæœªè¢«ä½¿ç”¨ï¼Œåœ¨ bash shell ä¸­é¢„ç•™ç»™å†…å»ºçš„è¯¯ç”¨ã€‚</li><li><code>3</code>ï¼šè¡¨ç¤ºä¸€ä¸ªå†…éƒ¨çš„ JavaScript è§£æé”™è¯¯ï¼ˆä¾‹å¦‚ï¼šå½“ä¸€ä¸ª JavaScript æ–‡ä»¶ä»å¼€å§‹å°±æœ‰è¯­æ³•é”™è¯¯æ—¶ï¼‰ã€‚</li><li><code>4</code>ï¼šè¡¨ç¤ºä¸€ä¸ªå†…éƒ¨çš„ JavaScript æ‰§è¡Œå¤±è´¥ï¼ˆä¾‹å¦‚ï¼šæŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯ä½†æ˜¯æ²¡æœ‰è¢«æ•è·ï¼‰ã€‚</li></ul><h3 id="å®é™…è¿ç”¨çš„ä¾‹å­-6" tabindex="-1"><a class="header-anchor" href="#å®é™…è¿ç”¨çš„ä¾‹å­-6"><span>å®é™…è¿ç”¨çš„ä¾‹å­</span></a></h3><h4 id="_1-æ­£å¸¸é€€å‡º" tabindex="-1"><a class="header-anchor" href="#_1-æ­£å¸¸é€€å‡º"><span>1. æ­£å¸¸é€€å‡º</span></a></h4><p>å¦‚æœä½ å†™äº†ä¸€ä¸ªç®€å•çš„ Node.js ç¨‹åºï¼Œæ¯”å¦‚æ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Hello, Node.js!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿è¡Œè¿™ä¸ªç¨‹åºä¹‹åï¼Œå®ƒåº”è¯¥ä¼šæ­£å¸¸ç»“æŸï¼Œå¹¶ä¸”é€€å‡ºä»£ç æ˜¯<code>0</code>ï¼Œè¡¨ç¤ºæˆåŠŸå®Œæˆã€‚</p><h4 id="_2-æŠ›å‡ºæœªæ•è·çš„å¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#_2-æŠ›å‡ºæœªæ•è·çš„å¼‚å¸¸"><span>2. æŠ›å‡ºæœªæ•è·çš„å¼‚å¸¸</span></a></h4><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªç¨‹åºï¼Œé‡Œé¢æœ‰ä¸€æ®µä»£ç å°è¯•è®¿é—®ä¸€ä¸ªæœªå®šä¹‰çš„å˜é‡ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">nonExistentVariable</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™ä¼šå¯¼è‡´ä¸€ä¸ªæœªæ•è·çš„å¼‚å¸¸ï¼ŒNode.js ä¼šä»¥é€€å‡ºä»£ç <code>1</code>ç»“æŸï¼Œè¡¨ç¤ºæœ‰é”™è¯¯å‘ç”Ÿã€‚</p><h4 id="_3-æ‰‹åŠ¨è®¾ç½®é€€å‡ºä»£ç " tabindex="-1"><a class="header-anchor" href="#_3-æ‰‹åŠ¨è®¾ç½®é€€å‡ºä»£ç "><span>3. æ‰‹åŠ¨è®¾ç½®é€€å‡ºä»£ç </span></a></h4><p>ä½ å¯ä»¥åœ¨ä½ çš„ç¨‹åºä¸­æ‰‹åŠ¨è®¾ç½®é€€å‡ºä»£ç ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨ç¨‹åºçš„æŸä¸ªåœ°æ–¹æ£€æµ‹åˆ°äº†ä¸€ä¸ªé”™è¯¯æƒ…å†µï¼Œä½ å¯ä»¥å†³å®šç«‹å³ç»“æŸç¨‹åºå¹¶è¿”å›ä¸€ä¸ªç‰¹å®šçš„é”™è¯¯ä»£ç ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">errorDetected</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">  process</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// æ‰‹åŠ¨è®¾ç½®é€€å‡ºä»£ç ä¸º1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®é™…çš„è½¯ä»¶å¼€å‘ä¸­ï¼Œæ­£ç¡®åœ°ç†è§£å’Œä½¿ç”¨é€€å‡ºä»£ç éå¸¸é‡è¦ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ„å»ºæ›´åŠ å¥å£¯çš„ç³»ç»Ÿã€‚é€šè¿‡æ£€æŸ¥ä¸€ä¸ªç¨‹åºçš„é€€å‡ºä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å®ƒæ˜¯å¦æˆåŠŸæ‰§è¡Œï¼Œæˆ–è€…é‡åˆ°äº†ä»€ä¹ˆæ ·çš„é—®é¢˜ï¼Œè¿›è€Œé‡‡å–ç›¸åº”çš„æªæ–½ã€‚</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: kamiacgxu@gmail.com">kamishima-kaede</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/document/node-doc/Permissions.html" aria-label="Permissions"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Permissions</div></a><a class="route-link auto-link next" href="/document/node-doc/Punycode.html" aria-label="Punycode"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Punycode<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><div class="vp-copyright">Copyright Â© 2018-present hanekawa-shiki</div></footer></div><!--]--><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.b30e1963.js" defer></script><script src="/assets/js/9435.209d772b.js" defer></script><script src="/assets/js/app.e085f460.js" defer></script>
  </body>
</html>
